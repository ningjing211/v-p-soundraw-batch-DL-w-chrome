
let zM02_98=![],zM04_sis,init_sync=![],zM02_isP=![],zM02_pgu,zM04_pid,zM02_ath=null,zM02_ade=![];const zM02__gC=document['body']['appendChild'](Object['assign'](document['createElement']('div'))),zM02__shD=zM02__gC['attachShadow']({'mode':'open'});let zM02_cBd,zM02_ldC,zM02_ldS,zM02_hAll=[],zM04_hN=[],zM04_hD=[],zM04_hU=[],zM02_hDis=[],syncedOn,updatedAt,zM02_pT,zM07_pC;const zM03__cBD=()=>{zM02_cBd=document['createElement']('div'),zM02_cBd['style']['cssText']='display:none;background-color:transparent;position:fixed;z-index:99999999999999999991;top:0;right:0;height:100vh;width:100vw;',zM02__shD['appendChild'](zM02_cBd),zM02_ldC=document['createElement']('div'),zM02_ldC['className']='zM-lds';const a=document['createDocumentFragment']();for(let b=0;b<3;b++){a['appendChild'](document['createElement']('div'));}zM02_ldC['appendChild'](a),zM02_ldS=document['createElement']('style'),zM02_ldS['textContent']='.zM-lds,.zM-lds div{display:inline-block;box-sizing:border-box}.zM-lds{position:relative;width:80px;height:80px;top:30%;left:50%}.zM-lds div{position:absolute;left:8px;width:16px;background:#3ea997;animation:1.2s cubic-bezier(0,.5,.5,1) infinite zM-lds}.zM-lds div:first-child{left:8px;animation-delay:-.24s}.zM-lds div:nth-child(2){left:32px;animation-delay:-.12s}.zM-lds div:nth-child(3){left:56px;animation-delay:0s}@keyframes zM-lds{0%{top:8px;height:64px}100%,50%{top:24px;height:32px}}',zM02_cBd['append'](zM02_ldS,zM02_ldC);};async function zM02__gD(a=null,b){return new Promise(c=>{b?chrome['storage']['local']['get']({[a]:b},d=>{c(d[a]);}):chrome['storage']['local']['get'](a,d=>{c(d[a]);});});}const zM04__rHl=async()=>{const a=await zM02__gD(zM02_pgu,{'highlights':[]});zM02_hAll=a['highlights'],syncedOn=a['syncedOn'],updatedAt=a['updatedAt'],zM07_pC=a['note'],zM04_pid=a['_id'],zM02_pT=a['title']||(document['title']==='PDF viewer'?zM02_pgu:document['title']);if(!syncedOn){zM02_hDis=zM02_hAll['map'](({status:c,...d})=>d),zM04_hN=[...zM02_hDis];return;}if(!updatedAt){zM02_hDis=zM02_hAll['map'](({status:c,...d})=>d);return;}const b=new Set(zM04_hN['map'](c=>c['uid']));for(const c of zM02_hAll){const {status:d,...e}=c;if(d?.['includes']('deleted'))zM04_hD['push']({'_id':e['_id'],'uid':e['uid']});else{zM02_hDis['push'](e);if(d==='new'&&!b['has'](e['uid']))zM04_hN['push'](e),b['add'](e['uid']);else d==='updated'&&zM04_hU['push'](e);}}},zM04__fH=async()=>{zM02_ldC['style']['display']='inline-block',zM02_cBd['style']['display']='block';try{const a=await new Promise((b,c)=>{chrome['runtime']['sendMessage']({'type':'f-h','payload':{'zM02_ath':zM02_ath,'zM04_pid':zM04_pid,'zM02_pgu':zM02_pgu,'zM02_pT':zM02_pT}},d=>{chrome['runtime']['lastError']?c(new Error(chrome['runtime']['lastError']['message'])):b(d);});});zM02_cBd['style']['display']='none';if(a['message']==='No page found')zM02_hAll=[],zM02_hDis=[],zM04_hD=[],zM04_hU=[],zM04_hN=[],zM04_pid=null,syncedOn=null,zM04_sis='check',init_sync=!![];else a['message']==='success'?(zM02_hAll=a['data'],zM02_hDis=a['data'],zM07_pC=a['note'],zM04_hD=[],zM04_hU=[],zM04_hN=[],zM04_pid=a['_id'],syncedOn=Date['now'](),zM04_sis='check',init_sync=!![]):zM04_sis='fail';}catch(b){zM04_sis='fail';}},zM04__stH=async()=>{!init_sync&&(zM02_ldC['style']['display']='inline-block',zM02_cBd['style']['display']='block');try{const a=await new Promise((b,c)=>{chrome['runtime']['sendMessage']({'type':'s-hN','payload':{'zM02_ath':zM02_ath,'u':zM02_pgu,'d':zM04_hN,'pt':zM02_pT,'zM07_pC':zM07_pC}},d=>{if(chrome['runtime']['lastError'])return c(new Error(chrome['runtime']['lastError']['message']));b(d);});});if(!init_sync)zM02_cBd['style']['display']='none';a['message']==='success'?(updatedAt=null,syncedOn=Date['now'](),zM04_pid=a['_id'],zM02_hAll=a['data'],zM02_hDis=a['data'],zM07_pC=a['note'],zM04_hD=[],zM04_hU=[],zM04_hN=[],zM04_sis='check',init_sync=!![]):zM04_sis='fail';}catch(b){zM04_sis='fail';}},zM04__syH=async()=>{zM02_ldC['style']['display']='inline-block',zM02_cBd['style']['display']='block';try{const a=await new Promise((b,c)=>{chrome['runtime']['sendMessage']({'type':'s-h','payload':{'zM02_ath':zM02_ath,'zM02_pgu':zM02_pgu,'zM04_pid':zM04_pid,'hN':zM04_hN,'hU':zM04_hU,'hD':zM04_hD,'zM02_pT':zM02_pT,'zM07_pC':zM07_pC}},d=>{if(chrome['runtime']['lastError'])return c(new Error(chrome['runtime']['lastError']['message']));b(d);});});zM02_cBd['style']['display']='none',a['message']==='success'||a['message']==='No page found'?(zM02_hAll=[],zM02_hDis=[],zM04_hD=[],zM04_hU=[],zM04_hN=[],a['message']==='success'?(updatedAt=null,syncedOn=Date['now'](),zM04_pid=a['_id'],zM02_hAll=a['data'],zM02_hDis=a['data'],zM07_pC=a['note'],zM04_sis='check',init_sync=!![]):(syncedOn=null,zM04_pid=null,updatedAt=null,zM04_sis='check',init_sync=!![])):zM04_sis='fail';}catch(b){zM04_sis='fail';}},zM04__iSi=async()=>{if(!updatedAt){await zM04__fH();return;}if(!syncedOn){await zM04__stH();return;}await zM04__syH();},zM04__cMl=(a,b,c='400',d='light')=>{let e=document['createElement']('div');return e['style']['cssText']='font-size:13px;line-height:2;width:'+c+'px;font-family:Roboto,Arial;direction:ltr;position:fixed;z-index:99999999999999;border-radius:16px;transform:translate(-50%, -50%);top:50%;left:50%;padding:20px;background-color:'+(d==='light'?'#f1f2f4':'#1e1e1e')+';box-shadow:0 4px 8px rgba(0, 0, 0, .6);color:'+(d==='light'?'#000':'#fff'),e['innerHTML']='<div style="font-size:17px;font-weight:700;text-align:center;">'+chrome['i18n']['getMessage'](a)+'</div>'+(b?chrome['i18n']['getMessage'](b):''),e;};((async()=>{zM03__cBD(),chrome['storage']['local']['remove']('pdfData');const a=()=>{zM02_isP?document['body']['appendChild'](Object['assign'](document['createElement']('script'),{'src':'../../c-r.js'})):chrome['runtime']['sendMessage']({'type':'ij-c'});};if(document['contentType']==='application/pdf')chrome['runtime']['sendMessage']({'type':'f-p','payload':{'url':location['href']}},b=>{b['success']&&chrome['storage']['local']['set']({'pdfData':b},()=>{location['href']=chrome['runtime']['getURL']('viewer/web/zetaviewer.html?url='+location['href']);});});else{const b=await zM02__gD('auth');b&&(zM02_ath=b['token'],zM02_ade=b['deactivated']?!![]:![]);let c=![];if(location['pathname']==='/viewer/web/zetaviewer.html'){zM02_isP=!![];const d=window['location']['href']['match'](/url=(.*)/),e=d?new URL(decodeURIComponent(d[1])):null;if(e&&e['protocol']==='file:')zM02_pgu=e['pathname']['slice'](1);else e&&(zM02_pgu=e['hostname']+e['pathname']+e['search']);}else zM02_pgu=location['hostname']+location['pathname']+location['search'];await zM04__rHl();!zM02_ath||zM02_ade?zM04_sis='slash':await zM04__iSi();if(zM04_sis==='fail'&&!c){let f=zM04__cMl('failed_sync','fail_intro','380');const g=document['createElement']('div');g['style']['cssText']='margin:20px 20px 0;display:flex;justify-content:flex-end;';const h=document['createElement']('button');h['style']['cssText']='border-radius:20px;cursor:pointer;padding:10px 20px;border-color:rgba(0,0,0,.5);border-width:0.5px;margin-right:20px;',h['innerText']=chrome['i18n']['getMessage']('dismiss'),h['onclick']=()=>{f['remove'](),a();};const i=document['createElement']('button');i['style']['cssText']='border-radius:20px;cursor:pointer;padding:10px 20px;background-color:#47ceaf;border:none;font-weight:600;',i['innerText']=chrome['i18n']['getMessage']('retry'),i['onclick']=async()=>{c=!![],f['remove'](),await zM04__iSi(),a();},g['appendChild'](h),g['appendChild'](i),f['appendChild'](g),zM02__shD['appendChild'](f);}else a();}})());
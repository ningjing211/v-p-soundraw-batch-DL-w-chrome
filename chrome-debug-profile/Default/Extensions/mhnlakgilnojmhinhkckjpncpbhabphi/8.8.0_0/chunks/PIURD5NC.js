import{n as C}from"./QS3NDLSA.js";import{u as v}from"./76I7HRZL.js";import{g as k}from"./3MKI6XLK.js";import{b,c as x}from"./7SPDRKKT.js";import{ga as h}from"./NSOQXCT3.js";import{a as E}from"./P3KYY2HQ.js";import{j as z}from"./U7QPOJB4.js";import{Fa as P,ka as w}from"./ONVH27HX.js";import{a as B}from"./4B6UFNBQ.js";import{f as W}from"./GAV6HCJA.js";var e=W(B()),D=h(({className:o,...r})=>e.default.createElement(x,{...r,classes:{popper:o}}))(({theme:o})=>({[`& .${b.tooltip}`]:{backgroundColor:o.palette.background.paper,color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:o.shadows[1],maxWidth:"none"},[`& .${b.arrow}`]:{color:o.palette.background.paper}})),J=h("img")({}),K=o=>{let{src:r,alt:y,height:I,width:S="100%",SkeletonSx:R,maxRetryTimes:$=1,maxLoadingTime:A=10*1e3,preview:H,placement:M,imgStyle:c,fileId:O,onError:L,imageSx:U,onImageClick:j,onLoaded:F}=o,[s,d]=(0,e.useState)(null),[N,n]=(0,e.useState)(!0),g=(0,e.useRef)(w()),V=k(F),u=C();return(0,e.useEffect)(()=>{let q=async()=>{let f=async()=>new Promise(t=>{let l=setTimeout(()=>{n(!1),t(!1)},A),m=new Image;m.src=r,m.onload=()=>{clearTimeout(l),d(r),n(!1),t(!0),V.current?.(m)},m.onerror=async()=>{clearTimeout(l);try{let a=await P.fetch(r,{parse:"blob",method:"GET"});if(a){let T=a.response?.status;if(E(T)&&T>=400){n(!1),O?(d(z("/images/svg-icons/image-invalid.svg")),t(!0)):t(!1);return}a.success&&d(URL.createObjectURL(a.data)),n(!1),t(a.success)}else t(!1)}catch{t(!1)}}});for(let t=-1;t<$;t++)if(await f())return!0;return!1},p=new IntersectionObserver(f=>{f.forEach(t=>{t.isIntersecting&&(q().then(l=>{l||L&&L()}),p.unobserve(t.target))})}),G=`#lazy-image-${g.current}`,i=null;return i=(u??document.body).querySelector(G),i&&p.observe(i),()=>{i&&p.unobserve(i)}},[r,u]),e.default.createElement(e.default.Fragment,null,N?e.default.createElement(v,{className:"maxai--lazy-load--skeleton",id:`lazy-image-${g.current}`,variant:"rectangular",height:I,"data-src":s,sx:{width:S,borderRadius:c?.borderRadius||0,...R}}):e.default.createElement(D,{placement:M||"top",title:H?e.default.createElement("img",{style:{objectFit:"contain",...c},src:s,alt:y,width:256,height:256}):null,PopperProps:{container:u,style:{zIndex:"2147483660!important"}}},e.default.createElement(J,{id:`lazy-image-${g.current}`,src:s??void 0,alt:y,width:S,height:I,"data-src":s,style:{...c},sx:U,onClick:j})))},ne=K;export{ne as a};

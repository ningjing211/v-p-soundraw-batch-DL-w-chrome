import{q as N}from"./GIH46LXY.js";import{h as W,i as A,l as K,o as $,t as q,u as H}from"./QMYX3O5Q.js";import{h as F}from"./KFSXHSE2.js";import{f as T}from"./4AHPLCY6.js";import{e as z,k as B}from"./7DLHESNS.js";import{c as E}from"./P3KSR7Y5.js";import{e as S}from"./I3C4LBBJ.js";import{b as X}from"./BCWF2JUJ.js";import{ka as C,oa as _}from"./NSOQXCT3.js";import{a as U,b as w}from"./454JMIH7.js";import{ja as P,l as M,sa as D}from"./DPE42NE6.js";import{f as O}from"./ONVH27HX.js";import{a as L}from"./4B6UFNBQ.js";import{f as I}from"./GAV6HCJA.js";var t=I(L());var V=I(X());var r=I(L());function j(n,{inputValue:s}){return n.filter(c=>{let m=c.label.toLowerCase(),u=c.value.toLowerCase(),f=s.toLowerCase();return m.includes(f)||u.includes(f)})}function Y(n,{inputValue:s}){let c=j(n,{inputValue:s});if(s.length>2){s.split(".")[1]||(s.endsWith(".")?s+="com":s+=".com");try{let m=new URL(/^http[s]?/.test(s)?s:`https://${s}`).hostname.replace(/^www\./,"").replace(/:\d+$/,"");if(c.find(u=>u.value===m))return c;c.push({label:m,value:m,origin:{inputValue:s}})}catch{}}return c}var Z=n=>{let{label:s="Enter website URL",onChange:c,disabled:m,popperIndex:u=2147483620,sx:f,options:l=[],multiple:d}=n,[v,h]=(0,r.useState)(!1),[b,y]=(0,r.useState)(null),g=(0,r.useMemo)(()=>{if(l?.length>0)return l;let e=[...U];if(n?.value?.[0]){if(d)return n.value.forEach(o=>{e.find(i=>i.value===o)||e.push({label:o,value:o})}),e;if(!e.find(o=>o.value===n.value[0]))return e.concat({label:n.value[0],value:n.value[0]})}return e},[n.value,l,d]),x=(0,r.useMemo)(()=>{if(d){let e=[];return n?.value?.forEach(o=>{let i=g.find(p=>p.value===o);i&&e.push(i)}),e}else return g.find(e=>e.value===n?.value?.[0])},[n.value,g,d]);return r.default.createElement(A,{multiple:d,onKeyDown:e=>{e.key==="Enter"&&e.stopPropagation()},disabled:m,open:l.length===0?v&&!b:void 0,onInputChange:l.length===0?(e,o)=>{o!==n?.value?.[0]&&y(null),o.length===0?h(!1):h(!0)}:void 0,slotProps:{popper:{sx:{zIndex:u}}},value:x,onClose:()=>h(!1),freeSolo:l?.length===0,disableClearable:!0,clearOnBlur:!0,blurOnSelect:!0,size:"small",sx:{width:160,[`.${W.popupIndicator} .${V.svgIconClasses.root}`]:{fontSize:24},...f},autoHighlight:!0,getOptionLabel:e=>e.label||"",options:g,onChange:(e,o)=>{y(o),c?.(d?o.map(({value:i})=>i):[o.value])},filterOptions:l?.length===0?Y:j,renderInput:e=>r.default.createElement(F,{...e,label:s,inputProps:{...e.inputProps,autoComplete:"new-password"}}),renderOption:(e,o)=>r.default.createElement("li",{...e},r.default.createElement("img",{width:16,height:16,src:w(o.label==="MaxAI PDF Viewer"?"maxai.me":o.value),style:{marginRight:8}}),r.default.createElement(_,{color:"text.primary",noWrap:!0,fontSize:14},o.label))})},G=(0,r.memo)(Z);var R=n=>{let{defaultValue:s,onChange:c,disabled:m,mode:u}=n,f=u==="black",{t:l}=O(["settings","common"]),[d,v]=(0,t.useState)([""]),[h,b]=(0,t.useState)(!1),y=(0,t.useRef)(null),g=()=>{v([""]),b(!0),setTimeout(()=>{y.current?.querySelector("input")?.focus()},100)},x=()=>{b(!1)},e=()=>{p(f?{...i,isWhitelistMode:!1,blacklist:D([...d,...i.blacklist]).filter(Boolean)}:{...i,isWhitelistMode:!0,whitelist:D([...d,...i.whitelist]).filter(Boolean)}),b(!1),setTimeout(()=>{b(!1)},0)},o=(0,t.useRef)(!1),[i,p]=(0,t.useState)(()=>M(s));(0,t.useEffect)(()=>{if(!o.current)if(!P(s,i))o.current=!0;else return;if(i.isWhitelistMode&&i.whitelist.length===0){p({...i,isWhitelistMode:!1,blacklist:[],whitelist:[]});return}c(i)},[i]);let J=(0,t.useMemo)(()=>i.isWhitelistMode?i.whitelist:i.blacklist,[i]);return t.default.createElement(C,{sx:{...n.sx}},t.default.createElement(z,{sx:{p:0,bgcolor:a=>a.palette.mode==="dark"?"rgb(32, 33, 36)":"rgb(255,255,255)",borderRadius:"4px",border:"1px solid",borderColor:"border.main","& .MuiListItem-root":{p:2},"& .MuiListItemText-root":{m:0,mr:2}}},t.default.createElement(T,{sx:{p:0}},t.default.createElement(B,{primary:n.textTitle||l(f?"settings:visibility_card__black_list_title":"settings:visibility_card__white_list_title"),secondary:n.textDescription||l(f?"settings:visibility_card__black_list_description":"settings:visibility_card__white_list_description")}),t.default.createElement(S,{variant:"outlined",sx:{flexShrink:0,borderColor:"border.main",color:"text.primary"},onClick:g,disabled:m,"data-testid":"Visibility-setting-card--add-button"},l("common:add"))),J.map(a=>{let Q=w(a);return t.default.createElement(T,{key:a,sx:{boxSizing:"border-box",p:"12px 16px",borderTop:"1px solid",borderColor:"border.main"}},t.default.createElement(B,{primary:t.default.createElement(C,{direction:"row",alignItems:"center",spacing:2},t.default.createElement("img",{src:Q,alt:a,style:{width:20,height:20,flexShrink:0}}),t.default.createElement(_,{component:"span",noWrap:!0,fontSize:14},a))}),t.default.createElement(E,{sx:{flexShrink:0},disabled:m,onClick:()=>{p(f?{...i,blacklist:i.blacklist.filter(k=>k!==a)}:{...i,whitelist:i.whitelist.filter(k=>k!==a)})}},t.default.createElement(N,{icon:"Delete",sx:{fontSize:20}})))})),t.default.createElement(K,{open:h,onClose:x,onKeyDownCapture:a=>{a.key==="Enter"&&d[0]&&e()}},t.default.createElement(H,null,l("settings:visibility_card__add_a_site_dialog__title")),t.default.createElement(q,null,t.default.createElement(C,{width:500,ref:y,spacing:1},t.default.createElement(_,{fontSize:16},l("settings:visibility_card__add_a_site_dialog__field_site__title")),t.default.createElement(G,{label:l("settings:visibility_card__add_a_site_dialog__field_site__placeholder"),value:d,sx:{width:"100%"},disabled:m,onChange:async a=>{a&&v(a)}}))),t.default.createElement($,null,t.default.createElement(S,{variant:"outlined",onClick:x},l("common:cancel")),t.default.createElement(S,{disabled:!d[0],variant:"contained",onClick:e},l("common:add")))))},It=R;export{It as a};

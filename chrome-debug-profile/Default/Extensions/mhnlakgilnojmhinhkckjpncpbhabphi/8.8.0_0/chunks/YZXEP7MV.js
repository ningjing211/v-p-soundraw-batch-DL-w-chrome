import{a as DC}from"./USDCAZJ2.js";import{a as VC}from"./FJSH5QH4.js";import{a as zC,d as RC}from"./VFZLKGN7.js";import{a as ZC}from"./Z7Q55TW6.js";import{a as jw}from"./MGZ4NASJ.js";import{a as iy}from"./2UXEOAF5.js";import{b as ry,c as _m}from"./X72BYYWR.js";import{A as Tm,B as Aa,C as Pn,D as hy,E as gy,F as wl,G as xy,H as _y,I as mh,J as Ui,K as Cy,L as yy,N as Ml,O as wm,P as Wp,Q as tr,R as Ar,S as Gp,U as Kw,V as $w,W as Mm,X as Em,Y as Iy,a as cs,b as Er,c as FC,d as HC,e as sh,f as Ta,g as bi,h as NC,i as Tt,j as JC,k as wa,l as Il,m as xm,n as ey,o as jr,p as ty,q as Gw,r as Sl,s as oy,t as ny,u as qw,v as ay,w as my,x as Sm,y as dy,z as vm}from"./CL5ONEUR.js";import{a as Zo,b as QC,e as gm}from"./AZ7IDPMI.js";import{a as Cl,b as kC,c as LC,d as OC,e as BC,f as ps,g as se}from"./PX63O6JF.js";import{a as Uw,b as __,d as C_,e as y_,f as b_,g as I_,h as S_,i as EC,j as PC}from"./XD2GDRAC.js";import{a as zu,q as Mn,v as l_}from"./X3V4PAB6.js";import{a as Nu,b as $u,d as th,e as AC}from"./XCJE7H4N.js";import{p as Ku}from"./2KV3QHEC.js";import{a as g_,b as dl}from"./YRXPW3SH.js";import{a as x_}from"./LU2HGRXL.js";import{c as J1}from"./IAZGMYQO.js";import{c as oh,d as Ww,e as em,f as W_,g as fl,h as G_,i as j_,j as q_,k as K_,l as nh,m as X_,n as tm,o as Y_,p as mm,q as An,s as xl,t as dm,u as _l,v as MC,x as Sa}from"./ZAU6XNUZ.js";import{a as xi}from"./PIURD5NC.js";import{a as En}from"./QTPNPZSF.js";import{a as Ri,b as $_}from"./V2XRVCZW.js";import{A as H_,Aa as er,B as N_,Ba as xC,C as Ju,Ca as _C,D as z_,Da as um,E as rh,Ea as CC,F as Z_,Fa as yC,G as om,Ga as mn,H as Q_,I as J_,J as eC,Ja as bC,K as Yt,Ka as ah,La as gl,M as tC,Ma as ke,N as nm,Na as vC,O as oC,Oa as TC,P as nC,Pa as Ue,Q as rC,Qa as wC,R as Uo,S as fe,T as dt,U as iC,V as un,W as aC,X as ie,Y as ot,Z as _i,_ as sC,a as n_,b as r_,ba as pC,c as he,ca as Mr,d as cl,da as cC,ea as uC,f as ul,fa as ss,g as k_,ga as Gr,ia as rm,ja as im,k as Qn,ka as mC,l as Xu,la as dC,m as zi,ma as io,na as Ci,o as Yu,oa as sm,p as zp,pa as hl,q as L_,qa as Wo,r as wr,ra as lm,s as Zu,sa as pm,t as O_,ta as cm,u as Qu,ua as Ia,v as Jn,va as yi,wa as ls,x as B_,xa as fC,y as D_,ya as hC,z as F_,za as gC}from"./BBEJE4ZB.js";import{g as Ur,h as Vu,i as Vo,j as pl,k as s_}from"./6WYGM23H.js";import{d as am,g as ih}from"./YQYYOIEY.js";import{b as Nw,d as Y1,f as zw,h as Uu,i as Rw,k as Vw,m as Z1,p as Np,q as G}from"./GIH46LXY.js";import{d as i_}from"./IA7EOSRE.js";import{a as f2,b as h2,c as tl,d as rl,e as q1,f as vu}from"./3YHG6AB5.js";import{j as Ou}from"./SDKIB65Q.js";import{b as Bp,d as _u,e as di,f as S2,h as il,i as Qe}from"./WAO3NQ2W.js";import{b as g2,c as x2,e as _2,f as Hw,g as Tu,h as v2,i as Ca,k as Mu,m as V2,n as St,o as U2,p as W2}from"./QS3NDLSA.js";import{a as Wn}from"./SYG5TBVI.js";import{a as Vr,b as Eu,c as E2,d as A2,e as al,f as P2,j as Zn,k as L2,l as ku,n as sl,o as ll,p as D2,q as F2,r as H2,u as fo,x as z2,y as R2,z as $e}from"./76I7HRZL.js";import{c as Dp,f as mt}from"./M5EUKMX7.js";import{f as Au,h as k2,i as Pu,l as O2,t as B2}from"./QMYX3O5Q.js";import{a as xe,c as N2,d as vr}from"./GAQAA6QT.js";import{b as Sr,h as zt}from"./KFSXHSE2.js";import{F as hi,O as Su,R as gi,W as xa,Y as _a,a as Fw,c as fa,h as b2,m as j1,t as I2,u as ha}from"./IGY2MCYY.js";import{e as Iu,h as Lu,k as Fp}from"./7DLHESNS.js";import{g as ga}from"./ONOBNLBL.js";import{a as G1,b as Yn}from"./TK3EYKNW.js";import{a as Z2}from"./X23QQTWI.js";import{a as d2,d as J2,g as e_,k as Yo}from"./PM3LLVI3.js";import{c as Lt}from"./QACMIT2E.js";import{a as Al}from"./JA46Y234.js";import{a as v_}from"./7E2Y3OCR.js";import{a as Kx}from"./EB7L6AT6.js";import{b as qx}from"./6I47KYK3.js";import{c as C2,d as y2}from"./EDMY23AH.js";import{c as fi}from"./DHWD6FYA.js";import{a as nl,c as T2,e as w2,f as M2,g as et}from"./3MKI6XLK.js";import{c as Ct}from"./PGX2QCH2.js";import{c as Re}from"./P3KSR7Y5.js";import{a as wu}from"./UXV3QMB6.js";import{a as Nt}from"./ZBHADXRO.js";import{b as B}from"./2SX2IMMC.js";import{a as q2}from"./TBKKANRK.js";import{a as Dw,b as Ep,c as hx,d as _x}from"./3MCM3VGT.js";import{D as ix}from"./TFXC3JZR.js";import{a as Tr}from"./MIYXIYDF.js";import{a as lx,b as px,c as cx,d as ux}from"./TT6LKJCT.js";import{b as j2,c as tt}from"./S6H5XQH6.js";import{a as wn}from"./2KT44S3D.js";import{a as da}from"./AWZ7Z3LK.js";import{a as Ir}from"./GHDEJCPS.js";import{b as vn,c as yr}from"./7SPDRKKT.js";import{a as ax,b as sx,k as js,l as lu}from"./KFLHMKZY.js";import{f as pi,l as ci,o as zn,p as gx,r as xx}from"./QSM5JSHK.js";import{b as ua,e as de}from"./I3C4LBBJ.js";import{g as qs}from"./YUYFDNT7.js";import{f as fx}from"./2KFG7XKF.js";import{b as pa}from"./BCWF2JUJ.js";import{U as dx,a as nx,b as Ow,c as rx,d as Bw,f as Ht,ga as Io,ka as g,oa as T,w as mx}from"./NSOQXCT3.js";import{a as Ft}from"./PCHDBHHN.js";import{a as Sy,b as vy}from"./XLCMRJDB.js";import{a as Vi,c as Ea}from"./ADNQVRZ5.js";import{a as IC}from"./OXBAKQ6O.js";import{a as SC}from"./IRJH4GTA.js";import{a as m2}from"./Y6ZMR5CC.js";import{A as fy,J as El,a as Cm,c as sy,d as qr,e as vl,f as ly,g as ym,h as py,i as cy,k as uy,l as bm,m as Ma,n as Tl,o as Im}from"./YXBTMGDF.js";import{a as Up}from"./VNZROBYV.js";import{c as P_}from"./PW2PVNG6.js";import{e as R_,f as V_,p as U_,q as eh}from"./Z2GQCHLU.js";import{b as a_}from"./6CLNRQN2.js";import{b as Q2}from"./XMSUU4RH.js";import{b as by,d as Pl}from"./BYL62TPW.js";import{I as hm,J as bl,a as UC,b as yl,c as lh,e as dn,f as ph,g as WC,h as GC,i as jC,j as qC,k as KC,l as $C,m as ch,n as XC,o as Vp,q as uh,r as YC,s as fm}from"./W76RXALD.js";import{c as va,d as Rp}from"./454JMIH7.js";import{a as ol,b as Cu,c as yu,d as bu,e as p_,f as Q1,h as c_,i as u_,j as m_,k as d_,l as Wu,m as f_,n as Gu,o as ju,p as ba,q as ml,s as qu,t as h_}from"./RY63BUJF.js";import{a as T_,d as w_,e as M_,g as E_,h as A_,j as vt,n as lC}from"./DRLHFEB5.js";import{a as Ru}from"./P3KYY2HQ.js";import{a as Wr}from"./AVXABA5R.js";import{a as Bu}from"./SNEXM654.js";import{a as K2,b as $2,c as Fu,d as X2,e as cn,f as Y2,g as ya,j as as,k as Hu}from"./4VYUSQN4.js";import{a as $x,b as Hi,c as R1}from"./JVSFDP7Y.js";import{a as t_,d as K1,e as $1,f as X1,j as o_,l as Hp}from"./VOKYBSBD.js";import{a as Du}from"./DBAIQPWT.js";import{a as G2}from"./V3YOWZUQ.js";import{A as i2,C as a2,F as s2,G as l2,H as Op,J as Un,K as _t,b as Xx,c as Yx,d as pn,j as Qx,n as ma,o as V1,s as e2,v as xu,y as U1}from"./RHEDGG6N.js";import{b as Tn}from"./ENA3LJHP.js";import{Ea as el,F as Zs,I as o2,Ia as p2,M as mi,Ma as c2,Na as u2,Pa as Ni,S as Qs,V as W1,W as Js,a as Zx,ba as n2,c as Jx,f as is,l as Ee,r as t2,sa as r2}from"./DPE42NE6.js";import{D as Pp,E as F1,L as fu,M as hu,O as gu,P as N1,R as z1,S as jx,T as Lp,d as Ox,i as Bx,j as Ap,k as $s,q as Dx,u as D1}from"./U7QPOJB4.js";import{Da as wx,Db as Vx,Ea as Mx,Eb as Ux,Fa as Vn,Fb as Wx,Gb as Gx,H as yx,Ia as Ex,Jb as kp,K as bx,Kb as Xs,Lb as pu,Mb as cu,Nb as uu,Qb as Oe,Sb as mu,T as Ix,U as Sx,Ub as Ro,Zb as Ys,_b as du,c as O1,da as vx,f as k,g as Gs,i as la,ka as Xo,m as $t,ma as rs,mb as Ax,n as li,na as br,o as bo,ob as Px,q as B1,qb as kx,r as ca,ra as Tx,rb as Lx,s as Rn,tb as H1,ua as Ks,ub as Fx,v as Cx,va as ui,vb as Hx,wb as Nx,yb as zx,zb as Rx}from"./ONVH27HX.js";import{b as k1,e as Us,g as L1,h as tx,i as ox,j as si,k as Ws}from"./HFEXSQX6.js";import{a as E}from"./4B6UFNBQ.js";import{b as Nn,c as A1,h as Mp,i as Q0,l as Vs,m as ii,n as ai,r as J0,u as P1}from"./WUP5AHVL.js";import{a as ex}from"./PJ57C2TE.js";import{c as ee,d as Lw,f as I,h as Z0}from"./GAV6HCJA.js";var Qy=ee(Hm=>{"use strict";"use client";var I7=Ft();Object.defineProperty(Hm,"__esModule",{value:!0});Hm.default=void 0;var S7=I7(Nt()),v7=Ht(),vU=Hm.default=(0,S7.default)((0,v7.jsx)("path",{d:"m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7z"}),"South")});var lb=ee(Nm=>{"use strict";"use client";var H7=Ft();Object.defineProperty(Nm,"__esModule",{value:!0});Nm.default=void 0;var N7=H7(Nt()),sb=Ht(),MW=Nm.default=(0,N7.default)([(0,sb.jsx)("path",{d:"m21.67 18.17-5.3-5.3h-.99l-2.54 2.54v.99l5.3 5.3c.39.39 1.02.39 1.41 0l2.12-2.12c.39-.38.39-1.02 0-1.41"},"0"),(0,sb.jsx)("path",{d:"m17.34 10.19 1.41-1.41 2.12 2.12c1.17-1.17 1.17-3.07 0-4.24l-3.54-3.54-1.41 1.41V1.71l-.7-.71-3.54 3.54.71.71h2.83l-1.41 1.41 1.06 1.06-2.89 2.89-4.13-4.13V5.06L4.83 2.04 2 4.87 5.03 7.9h1.41l4.13 4.13-.85.85H7.6l-5.3 5.3c-.39.39-.39 1.02 0 1.41l2.12 2.12c.39.39 1.02.39 1.41 0l5.3-5.3v-2.12l5.15-5.15z"},"1")],"Handyman")});var pb=ee(zm=>{"use strict";"use client";var z7=Ft();Object.defineProperty(zm,"__esModule",{value:!0});zm.default=void 0;var R7=z7(Nt()),V7=Ht(),AW=zm.default=(0,R7.default)((0,V7.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"}),"Error")});var cb=ee(Rm=>{"use strict";"use client";var U7=Ft();Object.defineProperty(Rm,"__esModule",{value:!0});Rm.default=void 0;var W7=U7(Nt()),G7=Ht(),kW=Rm.default=(0,W7.default)((0,G7.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-6h2zm0-8h-2V7h2z"}),"Info")});var Eb=ee((RG,Mb)=>{"use strict";function vb(e){return(vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function Yp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ib(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zp(e,t,o){return t&&Ib(e.prototype,t),o&&Ib(e,o),e}function oM(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tb(e,t)}function Ih(e){return(Ih=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function Tb(e,t){return(Tb=Object.setPrototypeOf||function(o,n){return o.__proto__=n,o})(e,t)}function nM(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function rM(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iM(e,t){return!t||typeof t!="object"&&typeof t!="function"?rM(e):t}function aM(e){var t=nM();return function(){var o,n=Ih(e);if(t){var r=Ih(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return iM(this,o)}}function Sb(e){return sM(e)||lM(e)||pM(e)||cM()}function sM(e){if(Array.isArray(e))return Sh(e)}function lM(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function pM(e,t){if(e){if(typeof e=="string")return Sh(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return o==="Object"&&e.constructor&&(o=e.constructor.name),o==="Map"||o==="Set"?Array.from(e):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?Sh(e,t):void 0}}function Sh(e,t){(t==null||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function cM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vh=function(){function e(t){Yp(this,e),this._listeners=[],this._mute=!1,this._accumulate=!1,this._accumulatedEvents=[],this._name=t||"",this._onListenerAdded=null,this._onFirstListenerAdded=null,this._onListenerRemoved=null,this._onLastListenerRemoved=null}return Zp(e,[{key:"addListener",value:function(t,o){this._pushListener(t,o,!1)}},{key:"addOnceListener",value:function(t,o){this._pushListener(t,o,!0)}},{key:"removeListener",value:function(t,o){this._ensureListener(t);var n=this._indexOfListener(t,o);0<=n&&this._spliceListener(n)}},{key:"removeAllListeners",value:function(){for(;this.hasListeners();)this._spliceListener(0)}},{key:"hasListener",value:function(t,o){return this._ensureListener(t),0<=this._indexOfListener(t,o)}},{key:"hasListeners",value:function(){return 0<this._listeners.length}},{key:"dispatch",value:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];this._invokeListeners({args:o,async:!1})}},{key:"dispatchAsync",value:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];this._invokeListeners({args:o,async:!0})}},{key:"mute",value:function(t){var o=0<arguments.length&&t!==void 0?t:{};this._mute=!0,o.accumulate?this._accumulate=!0:(this._accumulate=!1,this._accumulatedEvents=[])}},{key:"unmute",value:function(){this._mute=!1,this._accumulate&&(this._dispatchAccumulated(),this._accumulate=!1)}},{key:"_invokeListeners",value:function(t){var o=this,n=0<arguments.length&&t!==void 0?t:{args:[],async:!1};this._mute?this._accumulate&&this._accumulatedEvents.push(n):this._listeners.slice().forEach(function(r){o._invokeListener(r,n),r.once&&o.removeListener(r.callback,r.context)})}},{key:"_invokeListener",value:function(t,o){var n,r,i=t.callback instanceof e;o.async?i?(n=t.callback).dispatchAsync.apply(n,Sb(o.args)):setTimeout(function(){return t.callback.apply(t.context,o.args)},0):i?(r=t.callback).dispatch.apply(r,Sb(o.args)):t.callback.apply(t.context,o.args)}},{key:"_ensureListener",value:function(t){if(!e.isValidListener(t))throw new Error("Channel "+this._name+": listener is not a function and not a Channel")}},{key:"_dispatchInnerAddEvents",value:function(){var t,o;this._onListenerAdded&&(t=this._onListenerAdded).dispatch.apply(t,arguments),this._onFirstListenerAdded&&this._listeners.length===1&&(o=this._onFirstListenerAdded).dispatch.apply(o,arguments)}},{key:"_dispatchInnerRemoveEvents",value:function(){var t,o;this._onListenerRemoved&&(t=this._onListenerRemoved).dispatch.apply(t,arguments),this._onLastListenerRemoved&&this._listeners.length===0&&(o=this._onLastListenerRemoved).dispatch.apply(o,arguments)}},{key:"_indexOfListener",value:function(t,o){for(var n=0;n<this._listeners.length;n++){var r=this._listeners[n],i=r.callback===t,a=t instanceof e,s=o===void 0&&r.context===void 0,l=o===r.context;if(i&&(a||s||l))return n}}},{key:"_dispatchAccumulated",value:function(){var t=this;this._accumulatedEvents.forEach(function(o){return t._invokeListeners(o)}),this._accumulatedEvents=[]}},{key:"_pushListener",value:function(t,o,n){this._ensureListener(t),this._checkForDuplicates(t,o),this._listeners.push({callback:t,context:o,once:n}),this._dispatchInnerAddEvents(t,o,n)}},{key:"_checkForDuplicates",value:function(t,o){if(this.hasListener(t,o))throw new Error("Channel "+this._name+": duplicating listeners")}},{key:"_spliceListener",value:function(t){var o=this._listeners[t],n=o.callback,r=o.context,i=o.once;this._listeners.splice(t,1),this._dispatchInnerRemoveEvents(n,r,i)}},{key:"onListenerAdded",get:function(){return this._onListenerAdded||(this._onListenerAdded=new e("".concat(this._name,":onListenerAdded"))),this._onListenerAdded}},{key:"onFirstListenerAdded",get:function(){return this._onFirstListenerAdded||(this._onFirstListenerAdded=new e("".concat(this._name,":onFirstListenerAdded"))),this._onFirstListenerAdded}},{key:"onListenerRemoved",get:function(){return this._onListenerRemoved||(this._onListenerRemoved=new e("".concat(this._name,":onListenerRemoved"))),this._onListenerRemoved}},{key:"onLastListenerRemoved",get:function(){return this._onLastListenerRemoved||(this._onLastListenerRemoved=new e("".concat(this._name,":onLastListenerRemoved"))),this._onLastListenerRemoved}}],[{key:"isValidListener",value:function(t){return typeof t=="function"||t instanceof e}}]),e}(),uM=function(){function e(){Yp(this,e),this._channels=new Map}return Zp(e,[{key:"addListener",value:function(t,o,n){this._getChannel(t).addListener(o,n)}},{key:"on",value:function(t,o,n){this.addListener(t,o,n)}},{key:"addOnceListener",value:function(t,o,n){this._getChannel(t).addOnceListener(o,n)}},{key:"once",value:function(t,o,n){this.addOnceListener(t,o,n)}},{key:"removeListener",value:function(t,o,n){this._getChannel(t).removeListener(o,n)}},{key:"off",value:function(t,o,n){this.removeListener(t,o,n)}},{key:"hasListener",value:function(t,o,n){return this._getChannel(t).hasListener(o,n)}},{key:"has",value:function(t,o,n){return this.hasListener(t,o,n)}},{key:"hasListeners",value:function(t){return this._getChannel(t).hasListeners()}},{key:"dispatch",value:function(t){for(var o,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(o=this._getChannel(t)).dispatch.apply(o,r)}},{key:"emit",value:function(t){for(var o=arguments.length,n=new Array(1<o?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];this.dispatch.apply(this,[t].concat(n))}},{key:"_getChannel",value:function(t){return this._channels.has(t)||this._channels.set(t,new vh(t)),this._channels.get(t)}}]),e}(),mM=function(){function e(t){Yp(this,e),this._params=t,this._isOn=!1,this._assertParams()}return Zp(e,[{key:"on",value:function(){if(!this._isOn){var t=this._params.channel,o=t.addListener||t.addEventListener||t.on;this._applyMethod(o),this._isOn=!0}}},{key:"off",value:function(){if(this._isOn){var t=this._params.channel,o=t.removeListener||t.removeEventListener||t.off;this._applyMethod(o),this._isOn=!1}}},{key:"_applyMethod",value:function(t){var o=this._params,n=o.channel,r=o.event,i=o.listener,a=r?[r,i]:[i];t.apply(n,a)}},{key:"_assertParams",value:function(){var t=this._params,o=t.channel,n=t.event,r=t.listener;if(!o||vb(o)!=="object")throw new Error("Channel should be object");if(n&&typeof n!="string")throw new Error("Event should be string");if(!r||!vh.isValidListener(r))throw new Error("Listener should be function or Channel")}}]),e}(),wb=function(){function e(t){Yp(this,e),this._items=t.map(function(o){return new mM(o)})}return Zp(e,[{key:"on",value:function(){return this._items.forEach(function(t){return t.on()}),this}},{key:"off",value:function(){return this._items.forEach(function(t){return t.off()}),this}}]),e}(),dM=function(){oM(t,wb);var e=aM(t);function t(o,n){var r;return Yp(this,t),(r=e.call(this,n))._overrideComponentCallback(o,"componentDidMount","on"),r._overrideComponentCallback(o,"componentWillUnmount","off"),r}return Zp(t,[{key:"_overrideComponentCallback",value:function(o,n,r){var i=this,a=o[n];o[n]=function(){if(i[r](),typeof a=="function"){for(var s=arguments.length,l=new Array(s),p=0;p<s;p++)l[p]=arguments[p];return a.apply(o,l)}}}}]),t}(),Wm=vh;Wm.EventEmitter=uM,Wm.Subscription=wb,Wm.ReactSubscription=dM,Mb.exports=Wm});var Pb=ee((VG,Ab)=>{Ab.exports={timeout:0,timeoutReason:"Promise rejected by PromiseController timeout {timeout} ms.",resetReason:"Promise rejected by PromiseController reset."}});var kb=ee(Gm=>{Gm.isPromise=function(e){return e&&typeof e.then=="function"};Gm.tryCall=function(e){return typeof e=="function"?e():e};Gm.createErrorType=function(e){function t(o){Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=o}return t.prototype=new Error,t.prototype.name=e,t.prototype.constructor=t,t}});var Th=ee((WG,Db)=>{var fM=Pb(),{isPromise:Lb,createErrorType:Bb,tryCall:Ob}=kb(),Qp=class e{constructor(t){this._options=Object.assign({},fM,t),this._resolve=null,this._reject=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._promise=null,this._timer=null}get promise(){return this._promise}get value(){return this._value}get isPending(){return this._isPending}get isFulfilled(){return this._isFulfilled}get isRejected(){return this._isRejected}get isSettled(){return this._isFulfilled||this._isRejected}call(t){return this._isPending||(this.reset(),this._createPromise(),this._createTimer(),this._callFn(t)),this._promise}resolve(t){this._isPending&&(Lb(t)?this._tryAttachToPromise(t):(this._settle(t),this._isFulfilled=!0,this._resolve(t)))}reject(t){this._isPending&&(this._settle(t),this._isRejected=!0,this._reject(t))}reset(){if(this._isPending){let t=Ob(this._options.resetReason),o=new e.ResetError(t);this.reject(o)}this._promise=null,this._isPending=!1,this._isFulfilled=!1,this._isRejected=!1,this._value=void 0,this._clearTimer()}configure(t){Object.assign(this._options,t)}_createPromise(){this._promise=new Promise((t,o)=>{this._isPending=!0,this._resolve=t,this._reject=o})}_handleTimeout(){let t=Ob(this._options.timeoutReason),o=typeof t=="string"?t.replace("{timeout}",this._options.timeout):"",n=new e.TimeoutError(o);this.reject(n)}_createTimer(){this._options.timeout&&(this._timer=setTimeout(()=>this._handleTimeout(),this._options.timeout))}_clearTimer(){this._timer&&(clearTimeout(this._timer),this._timer=null)}_settle(t){this._isPending=!1,this._value=t,this._clearTimer()}_callFn(t){if(typeof t=="function")try{let o=t();this._tryAttachToPromise(o)}catch(o){this.reject(o)}}_tryAttachToPromise(t){Lb(t)&&t.then(o=>this.resolve(o),o=>this.reject(o))}};Qp.TimeoutError=Bb("TimeoutError");Qp.ResetError=Bb("ResetError");Db.exports=Qp});var Fb=ee(jm=>{"use strict";Object.defineProperty(jm,"__esModule",{value:!0});jm.PromisedMap=void 0;var hM=function(){function e(){this.map=new Map}return Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!1,configurable:!0}),e.prototype.set=function(t,o){var n=this.createMapItem(o);return this.map.set(t,n),n.promise},e.prototype.get=function(t){var o=this.map.get(t);return o&&o.data},e.prototype.has=function(t){return this.map.has(t)},e.prototype.delete=function(t){return this.map.delete(t)},e.prototype.resolve=function(t,o){var n=this.map.get(t);n&&(this.delete(t),n.resolve(o))},e.prototype.reject=function(t,o){var n=this.map.get(t);n&&(this.delete(t),n.reject(o))},e.prototype.resolveAll=function(t){this.map.forEach(function(o){return o.resolve(t)}),this.map.clear()},e.prototype.rejectAll=function(t){this.map.forEach(function(o){return o.reject(t)}),this.map.clear()},e.prototype.forEach=function(t){this.map.forEach(function(o,n,r){return t(o.data,n,r)})},e.prototype.clear=function(){return this.map.clear()},e.prototype.createMapItem=function(t){var o={data:t};return o.promise=new Promise(function(n,r){o.resolve=n,o.reject=r}),o},e}();jm.PromisedMap=hM});var zb=ee((jG,Nb)=>{"use strict";var gM="Function.prototype.bind called on incompatible ",xM=Object.prototype.toString,_M=Math.max,CM="[object Function]",Hb=function(t,o){for(var n=[],r=0;r<t.length;r+=1)n[r]=t[r];for(var i=0;i<o.length;i+=1)n[i+t.length]=o[i];return n},yM=function(t,o){for(var n=[],r=o||0,i=0;r<t.length;r+=1,i+=1)n[i]=t[r];return n},bM=function(e,t){for(var o="",n=0;n<e.length;n+=1)o+=e[n],n+1<e.length&&(o+=t);return o};Nb.exports=function(t){var o=this;if(typeof o!="function"||xM.apply(o)!==CM)throw new TypeError(gM+o);for(var n=yM(arguments,1),r,i=function(){if(this instanceof r){var c=o.apply(this,Hb(n,arguments));return Object(c)===c?c:this}return o.apply(t,Hb(n,arguments))},a=_M(0,o.length-n.length),s=[],l=0;l<a;l++)s[l]="$"+l;if(r=Function("binder","return function ("+bM(s,",")+"){ return binder.apply(this,arguments); }")(i),o.prototype){var p=function(){};p.prototype=o.prototype,r.prototype=new p,p.prototype=null}return r}});var qm=ee((qG,Rb)=>{"use strict";var IM=zb();Rb.exports=Function.prototype.bind||IM});var Ub=ee((KG,Vb)=>{"use strict";Vb.exports=Error});var Gb=ee(($G,Wb)=>{"use strict";Wb.exports=EvalError});var qb=ee((XG,jb)=>{"use strict";jb.exports=RangeError});var $b=ee((YG,Kb)=>{"use strict";Kb.exports=ReferenceError});var Km=ee((ZG,Xb)=>{"use strict";Xb.exports=SyntaxError});var or=ee((QG,Yb)=>{"use strict";Yb.exports=TypeError});var Qb=ee((JG,Zb)=>{"use strict";Zb.exports=URIError});var e4=ee((ej,Jb)=>{"use strict";Jb.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},o=Symbol("test"),n=Object(o);if(typeof o=="string"||Object.prototype.toString.call(o)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var r=42;t[o]=r;for(o in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==o||!Object.prototype.propertyIsEnumerable.call(t,o))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,o);if(a.value!==r||a.enumerable!==!0)return!1}return!0}});var n4=ee((tj,o4)=>{"use strict";var t4=typeof Symbol<"u"&&Symbol,SM=e4();o4.exports=function(){return typeof t4!="function"||typeof Symbol!="function"||typeof t4("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:SM()}});var i4=ee((oj,r4)=>{"use strict";var wh={__proto__:null,foo:{}},vM=Object;r4.exports=function(){return{__proto__:wh}.foo===wh.foo&&!(wh instanceof vM)}});var Jp=ee((nj,a4)=>{"use strict";var TM=Function.prototype.call,wM=Object.prototype.hasOwnProperty,MM=qm();a4.exports=MM.call(TM,wM)});var vi=ee((rj,u4)=>{"use strict";var Ve,EM=Ub(),AM=Gb(),PM=qb(),kM=$b(),zl=Km(),Nl=or(),LM=Qb(),c4=Function,Mh=function(e){try{return c4('"use strict"; return ('+e+").constructor;")()}catch{}},fs=Object.getOwnPropertyDescriptor;if(fs)try{fs({},"")}catch{fs=null}var Eh=function(){throw new Nl},OM=fs?function(){try{return arguments.callee,Eh}catch{try{return fs(arguments,"callee").get}catch{return Eh}}}():Eh,Fl=n4()(),BM=i4()(),Go=Object.getPrototypeOf||(BM?function(e){return e.__proto__}:null),Hl={},DM=typeof Uint8Array>"u"||!Go?Ve:Go(Uint8Array),hs={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Ve:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Ve:ArrayBuffer,"%ArrayIteratorPrototype%":Fl&&Go?Go([][Symbol.iterator]()):Ve,"%AsyncFromSyncIteratorPrototype%":Ve,"%AsyncFunction%":Hl,"%AsyncGenerator%":Hl,"%AsyncGeneratorFunction%":Hl,"%AsyncIteratorPrototype%":Hl,"%Atomics%":typeof Atomics>"u"?Ve:Atomics,"%BigInt%":typeof BigInt>"u"?Ve:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Ve:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Ve:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Ve:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":EM,"%eval%":eval,"%EvalError%":AM,"%Float32Array%":typeof Float32Array>"u"?Ve:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Ve:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Ve:FinalizationRegistry,"%Function%":c4,"%GeneratorFunction%":Hl,"%Int8Array%":typeof Int8Array>"u"?Ve:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Ve:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Ve:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Fl&&Go?Go(Go([][Symbol.iterator]())):Ve,"%JSON%":typeof JSON=="object"?JSON:Ve,"%Map%":typeof Map>"u"?Ve:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Fl||!Go?Ve:Go(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Ve:Promise,"%Proxy%":typeof Proxy>"u"?Ve:Proxy,"%RangeError%":PM,"%ReferenceError%":kM,"%Reflect%":typeof Reflect>"u"?Ve:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Ve:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Fl||!Go?Ve:Go(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Ve:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Fl&&Go?Go(""[Symbol.iterator]()):Ve,"%Symbol%":Fl?Symbol:Ve,"%SyntaxError%":zl,"%ThrowTypeError%":OM,"%TypedArray%":DM,"%TypeError%":Nl,"%Uint8Array%":typeof Uint8Array>"u"?Ve:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Ve:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Ve:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Ve:Uint32Array,"%URIError%":LM,"%WeakMap%":typeof WeakMap>"u"?Ve:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Ve:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Ve:WeakSet};if(Go)try{null.error}catch(e){s4=Go(Go(e)),hs["%Error.prototype%"]=s4}var s4,FM=function e(t){var o;if(t==="%AsyncFunction%")o=Mh("async function () {}");else if(t==="%GeneratorFunction%")o=Mh("function* () {}");else if(t==="%AsyncGeneratorFunction%")o=Mh("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(o=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var r=e("%AsyncGenerator%");r&&Go&&(o=Go(r.prototype))}return hs[t]=o,o},l4={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ec=qm(),$m=Jp(),HM=ec.call(Function.call,Array.prototype.concat),NM=ec.call(Function.apply,Array.prototype.splice),p4=ec.call(Function.call,String.prototype.replace),Xm=ec.call(Function.call,String.prototype.slice),zM=ec.call(Function.call,RegExp.prototype.exec),RM=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,VM=/\\(\\)?/g,UM=function(t){var o=Xm(t,0,1),n=Xm(t,-1);if(o==="%"&&n!=="%")throw new zl("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&o!=="%")throw new zl("invalid intrinsic syntax, expected opening `%`");var r=[];return p4(t,RM,function(i,a,s,l){r[r.length]=s?p4(l,VM,"$1"):a||i}),r},WM=function(t,o){var n=t,r;if($m(l4,n)&&(r=l4[n],n="%"+r[0]+"%"),$m(hs,n)){var i=hs[n];if(i===Hl&&(i=FM(n)),typeof i>"u"&&!o)throw new Nl("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:i}}throw new zl("intrinsic "+t+" does not exist!")};u4.exports=function(t,o){if(typeof t!="string"||t.length===0)throw new Nl("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof o!="boolean")throw new Nl('"allowMissing" argument must be a boolean');if(zM(/^%?[^%]*%?$/,t)===null)throw new zl("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=UM(t),r=n.length>0?n[0]:"",i=WM("%"+r+"%",o),a=i.name,s=i.value,l=!1,p=i.alias;p&&(r=p[0],NM(n,HM([0,1],p)));for(var c=1,u=!0;c<n.length;c+=1){var m=n[c],d=Xm(m,0,1),f=Xm(m,-1);if((d==='"'||d==="'"||d==="`"||f==='"'||f==="'"||f==="`")&&d!==f)throw new zl("property names with quotes must have matching quotes");if((m==="constructor"||!u)&&(l=!0),r+="."+m,a="%"+r+"%",$m(hs,a))s=hs[a];else if(s!=null){if(!(m in s)){if(!o)throw new Nl("base intrinsic for "+t+" exists, but the property is not available.");return}if(fs&&c+1>=n.length){var h=fs(s,m);u=!!h,u&&"get"in h&&!("originalValue"in h.get)?s=h.get:s=s[m]}else u=$m(s,m),s=s[m];u&&!l&&(hs[a]=s)}}return s}});var tc=ee((ij,m4)=>{"use strict";var GM=vi(),Ym=GM("%Object.defineProperty%",!0)||!1;if(Ym)try{Ym({},"a",{value:1})}catch{Ym=!1}m4.exports=Ym});var Ah=ee((aj,d4)=>{"use strict";var jM=vi(),Zm=jM("%Object.getOwnPropertyDescriptor%",!0);if(Zm)try{Zm([],"length")}catch{Zm=null}d4.exports=Zm});var Qm=ee((sj,g4)=>{"use strict";var f4=tc(),qM=Km(),Rl=or(),h4=Ah();g4.exports=function(t,o,n){if(!t||typeof t!="object"&&typeof t!="function")throw new Rl("`obj` must be an object or a function`");if(typeof o!="string"&&typeof o!="symbol")throw new Rl("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Rl("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Rl("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Rl("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Rl("`loose`, if provided, must be a boolean");var r=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,s=arguments.length>6?arguments[6]:!1,l=!!h4&&h4(t,o);if(f4)f4(t,o,{configurable:a===null&&l?l.configurable:!a,enumerable:r===null&&l?l.enumerable:!r,value:n,writable:i===null&&l?l.writable:!i});else if(s||!r&&!i&&!a)t[o]=n;else throw new qM("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var oc=ee((lj,_4)=>{"use strict";var Ph=tc(),x4=function(){return!!Ph};x4.hasArrayLengthDefineBug=function(){if(!Ph)return null;try{return Ph([],"length",{value:1}).length!==1}catch{return!0}};_4.exports=x4});var S4=ee((pj,I4)=>{"use strict";var KM=vi(),C4=Qm(),$M=oc()(),y4=Ah(),b4=or(),XM=KM("%Math.floor%");I4.exports=function(t,o){if(typeof t!="function")throw new b4("`fn` is not a function");if(typeof o!="number"||o<0||o>4294967295||XM(o)!==o)throw new b4("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,i=!0;if("length"in t&&y4){var a=y4(t,"length");a&&!a.configurable&&(r=!1),a&&!a.writable&&(i=!1)}return(r||i||!n)&&($M?C4(t,"length",o,!0,!0):C4(t,"length",o)),t}});var td=ee((cj,Jm)=>{"use strict";var kh=qm(),ed=vi(),YM=S4(),ZM=or(),w4=ed("%Function.prototype.apply%"),M4=ed("%Function.prototype.call%"),E4=ed("%Reflect.apply%",!0)||kh.call(M4,w4),v4=tc(),QM=ed("%Math.max%");Jm.exports=function(t){if(typeof t!="function")throw new ZM("a function is required");var o=E4(kh,M4,arguments);return YM(o,1+QM(0,t.length-(arguments.length-1)),!0)};var T4=function(){return E4(kh,w4,arguments)};v4?v4(Jm.exports,"apply",{value:T4}):Jm.exports.apply=T4});var Lh=ee((uj,P4)=>{"use strict";var A4=Object.prototype.toString;P4.exports=function(t){var o=A4.call(t),n=o==="[object Arguments]";return n||(n=o!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&A4.call(t.callee)==="[object Function]"),n}});var z4=ee((mj,N4)=>{"use strict";var H4;Object.keys||(nc=Object.prototype.hasOwnProperty,Oh=Object.prototype.toString,k4=Lh(),Bh=Object.prototype.propertyIsEnumerable,L4=!Bh.call({toString:null},"toString"),O4=Bh.call(function(){},"prototype"),rc=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],od=function(e){var t=e.constructor;return t&&t.prototype===e},B4={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},D4=function(){if(typeof window>"u")return!1;for(var e in window)try{if(!B4["$"+e]&&nc.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{od(window[e])}catch{return!0}}catch{return!0}return!1}(),F4=function(e){if(typeof window>"u"||!D4)return od(e);try{return od(e)}catch{return!1}},H4=function(t){var o=t!==null&&typeof t=="object",n=Oh.call(t)==="[object Function]",r=k4(t),i=o&&Oh.call(t)==="[object String]",a=[];if(!o&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var s=O4&&n;if(i&&t.length>0&&!nc.call(t,0))for(var l=0;l<t.length;++l)a.push(String(l));if(r&&t.length>0)for(var p=0;p<t.length;++p)a.push(String(p));else for(var c in t)!(s&&c==="prototype")&&nc.call(t,c)&&a.push(String(c));if(L4)for(var u=F4(t),m=0;m<rc.length;++m)!(u&&rc[m]==="constructor")&&nc.call(t,rc[m])&&a.push(rc[m]);return a});var nc,Oh,k4,Bh,L4,O4,rc,od,B4,D4,F4;N4.exports=H4});var W4=ee((dj,U4)=>{"use strict";var JM=Array.prototype.slice,eE=Lh(),R4=Object.keys,nd=R4?function(t){return R4(t)}:z4(),V4=Object.keys;nd.shim=function(){if(Object.keys){var t=function(){var o=Object.keys(arguments);return o&&o.length===arguments.length}(1,2);t||(Object.keys=function(n){return eE(n)?V4(JM.call(n)):V4(n)})}else Object.keys=nd;return Object.keys||nd};U4.exports=nd});var Dh=ee((fj,K4)=>{"use strict";var tE=W4(),oE=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",nE=Object.prototype.toString,rE=Array.prototype.concat,G4=Qm(),iE=function(e){return typeof e=="function"&&nE.call(e)==="[object Function]"},j4=oc()(),aE=function(e,t,o,n){if(t in e){if(n===!0){if(e[t]===o)return}else if(!iE(n)||!n())return}j4?G4(e,t,o,!0):G4(e,t,o)},q4=function(e,t){var o=arguments.length>2?arguments[2]:{},n=tE(t);oE&&(n=rE.call(n,Object.getOwnPropertySymbols(t)));for(var r=0;r<n.length;r+=1)aE(e,n[r],t[n[r]],o[n[r]])};q4.supportsDescriptors=!!j4;K4.exports=q4});var rd=ee((hj,$4)=>{"use strict";$4.exports=function(){if(typeof Promise!="function")throw new TypeError("`Promise.prototype.finally` requires a global `Promise` be available.")}});var Q4=ee((gj,Z4)=>{"use strict";var sE=vi(),lE=td(),pE=Km(),X4=sE("%Promise.resolve%",!0),Y4=X4&&lE(X4);Z4.exports=function(t,o){if(!Y4)throw new pE("This environment does not support Promises.");return Y4(t,o)}});var o5=ee((xj,t5)=>{"use strict";var e5=Function.prototype.toString,Vl=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Hh,id;if(typeof Vl=="function"&&typeof Object.defineProperty=="function")try{Hh=Object.defineProperty({},"length",{get:function(){throw id}}),id={},Vl(function(){throw 42},null,Hh)}catch(e){e!==id&&(Vl=null)}else Vl=null;var cE=/^\s*class\b/,Nh=function(t){try{var o=e5.call(t);return cE.test(o)}catch{return!1}},Fh=function(t){try{return Nh(t)?!1:(e5.call(t),!0)}catch{return!1}},ad=Object.prototype.toString,uE="[object Object]",mE="[object Function]",dE="[object GeneratorFunction]",fE="[object HTMLAllCollection]",hE="[object HTML document.all class]",gE="[object HTMLCollection]",xE=typeof Symbol=="function"&&!!Symbol.toStringTag,_E=!(0 in[,]),zh=function(){return!1};typeof document=="object"&&(J4=document.all,ad.call(J4)===ad.call(document.all)&&(zh=function(t){if((_E||!t)&&(typeof t>"u"||typeof t=="object"))try{var o=ad.call(t);return(o===fE||o===hE||o===gE||o===uE)&&t("")==null}catch{}return!1}));var J4;t5.exports=Vl?function(t){if(zh(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{Vl(t,null,Hh)}catch(o){if(o!==id)return!1}return!Nh(t)&&Fh(t)}:function(t){if(zh(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(xE)return Fh(t);if(Nh(t))return!1;var o=ad.call(t);return o!==mE&&o!==dE&&!/^\[object HTML/.test(o)?!1:Fh(t)}});var Rh=ee((_j,n5)=>{"use strict";n5.exports=o5()});var i5=ee((Cj,r5)=>{"use strict";r5.exports=vi()});var sd=ee((yj,a5)=>{"use strict";var CE=or(),ic=Jp(),yE={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};a5.exports=function(t){if(!t||typeof t!="object")return!1;for(var o in t)if(ic(t,o)&&!yE[o])return!1;var n=ic(t,"[[Value]]")||ic(t,"[[Writable]]"),r=ic(t,"[[Get]]")||ic(t,"[[Set]]");if(n&&r)throw new CE("Property Descriptors may not be both accessor and data descriptors");return!0}});var Vh=ee((bj,p5)=>{"use strict";var s5=vi(),l5=td(),bE=l5(s5("String.prototype.indexOf"));p5.exports=function(t,o){var n=s5(t,!!o);return typeof n=="function"&&bE(t,".prototype.")>-1?l5(n):n}});var m5=ee((Ij,u5)=>{"use strict";var IE=vi(),c5=IE("%Array%"),SE=!c5.isArray&&Vh()("Object.prototype.toString");u5.exports=c5.isArray||function(t){return SE(t)==="[object Array]"}});var g5=ee((Sj,h5)=>{"use strict";var vE=oc(),d5=tc(),f5=vE.hasArrayLengthDefineBug(),TE=f5&&m5(),wE=Vh(),ME=wE("Object.prototype.propertyIsEnumerable");h5.exports=function(t,o,n,r,i,a){if(!d5){if(!t(a)||!a["[[Configurable]]"]||!a["[[Writable]]"]||i in r&&ME(r,i)!==!!a["[[Enumerable]]"])return!1;var s=a["[[Value]]"];return r[i]=s,o(r[i],s)}return f5&&i==="length"&&"[[Value]]"in a&&TE(r)&&r.length!==a["[[Value]]"]?(r.length=a["[[Value]]"],r.length===a["[[Value]]"]):(d5(r,i,n(a)),!0)}});var _5=ee((vj,x5)=>{"use strict";x5.exports=function(t){if(typeof t>"u")return t;var o={};return"[[Value]]"in t&&(o.value=t["[[Value]]"]),"[[Writable]]"in t&&(o.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(o.get=t["[[Get]]"]),"[[Set]]"in t&&(o.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(o.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(o.configurable=!!t["[[Configurable]]"]),o}});var y5=ee((Tj,C5)=>{"use strict";var EE=or(),AE=sd(),PE=_5();C5.exports=function(t){if(typeof t<"u"&&!AE(t))throw new EE("Assertion failed: `Desc` must be a Property Descriptor");return PE(t)}});var S5=ee((wj,I5)=>{"use strict";var kE=or(),b5=Jp(),LE=sd();I5.exports=function(t){if(typeof t>"u")return!1;if(!LE(t))throw new kE("Assertion failed: `Desc` must be a Property Descriptor");return!(!b5(t,"[[Value]]")&&!b5(t,"[[Writable]]"))}});var T5=ee((Mj,v5)=>{"use strict";v5.exports=function(t){return typeof t=="string"||typeof t=="symbol"}});var M5=ee((Ej,w5)=>{"use strict";w5.exports=Number.isNaN||function(t){return t!==t}});var P5=ee((Aj,A5)=>{"use strict";var E5=M5();A5.exports=function(t,o){return t===o?t===0?1/t===1/o:!0:E5(t)&&E5(o)}});var L5=ee((Pj,k5)=>{"use strict";k5.exports=function(t){if(t===null)return"Null";if(typeof t>"u")return"Undefined";if(typeof t=="function"||typeof t=="object")return"Object";if(typeof t=="number")return"Number";if(typeof t=="boolean")return"Boolean";if(typeof t=="string")return"String"}});var ac=ee((kj,O5)=>{"use strict";var OE=L5();O5.exports=function(t){return typeof t=="symbol"?"Symbol":typeof t=="bigint"?"BigInt":OE(t)}});var D5=ee((Lj,B5)=>{"use strict";B5.exports=function(t){return!!t}});var N5=ee((Oj,H5)=>{"use strict";var Ti=Jp(),ld=or(),BE=ac(),Uh=D5(),F5=Rh();H5.exports=function(t){if(BE(t)!=="Object")throw new ld("ToPropertyDescriptor requires an object");var o={};if(Ti(t,"enumerable")&&(o["[[Enumerable]]"]=Uh(t.enumerable)),Ti(t,"configurable")&&(o["[[Configurable]]"]=Uh(t.configurable)),Ti(t,"value")&&(o["[[Value]]"]=t.value),Ti(t,"writable")&&(o["[[Writable]]"]=Uh(t.writable)),Ti(t,"get")){var n=t.get;if(typeof n<"u"&&!F5(n))throw new ld("getter must be a function");o["[[Get]]"]=n}if(Ti(t,"set")){var r=t.set;if(typeof r<"u"&&!F5(r))throw new ld("setter must be a function");o["[[Set]]"]=r}if((Ti(o,"[[Get]]")||Ti(o,"[[Set]]"))&&(Ti(o,"[[Value]]")||Ti(o,"[[Writable]]")))throw new ld("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return o}});var V5=ee((Bj,R5)=>{"use strict";var Wh=or(),z5=sd(),DE=g5(),FE=y5(),HE=S5(),NE=T5(),zE=P5(),RE=N5(),VE=ac();R5.exports=function(t,o,n){if(VE(t)!=="Object")throw new Wh("Assertion failed: Type(O) is not Object");if(!NE(o))throw new Wh("Assertion failed: IsPropertyKey(P) is not true");var r=z5(n)?n:RE(n);if(!z5(r))throw new Wh("Assertion failed: Desc is not a valid Property Descriptor");return DE(HE,zE,FE,t,o,r)}});var W5=ee((Dj,qh)=>{"use strict";var UE=i5(),U5=UE("%Reflect.construct%",!0),pd=V5();try{pd({},"",{"[[Get]]":function(){}})}catch{pd=null}pd&&U5?(Gh={},jh={},pd(jh,"length",{"[[Get]]":function(){throw Gh},"[[Enumerable]]":!0}),qh.exports=function(t){try{U5(t,jh)}catch(o){return o===Gh}}):qh.exports=function(t){return typeof t=="function"&&!!t.prototype};var Gh,jh});var K5=ee((Fj,q5)=>{"use strict";var WE=vi(),G5=WE("%Symbol.species%",!0),Kh=or(),GE=W5(),j5=ac();q5.exports=function(t,o){if(j5(t)!=="Object")throw new Kh("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return o;if(j5(n)!=="Object")throw new Kh("O.constructor is not an Object");var r=G5?n[G5]:void 0;if(r==null)return o;if(GE(r))return r;throw new Kh("no constructor found")}});var X5=ee((Hj,$5)=>{"use strict";var lc=function(){return typeof function(){}.name=="string"},sc=Object.getOwnPropertyDescriptor;if(sc)try{sc([],"length")}catch{sc=null}lc.functionsHaveConfigurableNames=function(){if(!lc()||!sc)return!1;var t=sc(function(){},"name");return!!t&&!!t.configurable};var jE=Function.prototype.bind;lc.boundFunctionsHaveNames=function(){return lc()&&typeof jE=="function"&&function(){}.bind().name!==""};$5.exports=lc});var Q5=ee((Nj,Z5)=>{"use strict";var Y5=Qm(),qE=oc()(),KE=X5().functionsHaveConfigurableNames(),$E=or();Z5.exports=function(t,o){if(typeof t!="function")throw new $E("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return(!n||KE)&&(qE?Y5(t,"name",o,!0,!0):Y5(t,"name",o)),t}});var $h=ee((zj,e6)=>{"use strict";var XE=rd();XE();var YE=or(),J5=Q4(),ZE=Rh(),QE=K5(),JE=ac(),eA=Q5(),tA=Promise,oA=function(t,o){return function(n){var r=o(),i=J5(t,r),a=function(){return n};return i.then(a)}},nA=function(t,o){return function(n){var r=o(),i=J5(t,r),a=function(){throw n};return i.then(a)}};e6.exports=eA(function(t){var o=this;if(JE(o)!=="Object")throw new YE("receiver is not an Object");var n=QE(o,tA),r=t,i=t;return ZE(t)&&(r=oA(n,t),i=nA(n,t)),o.then(r,i)},"finally",!0)});var Xh=ee((Rj,t6)=>{"use strict";var rA=rd(),iA=$h();t6.exports=function(){return rA(),typeof Promise.prototype.finally=="function"?Promise.prototype.finally:iA}});var n6=ee((Vj,o6)=>{"use strict";var aA=rd(),sA=Xh(),lA=Dh();o6.exports=function(){aA();var t=sA();return lA(Promise.prototype,{finally:t},{finally:function(){return Promise.prototype.finally!==t}}),t}});var s6=ee((Uj,a6)=>{"use strict";var pA=td(),cA=Dh(),uA=$h(),r6=Xh(),mA=n6(),i6=pA(r6());cA(i6,{getPolyfill:r6,implementation:uA,shim:mA});a6.exports=i6});var p6=ee((Gj,l6)=>{var dA=Th(),fA=s6();l6.exports=class{constructor(){this._items=new Map}create(t,o,n){return this._rejectExistingRequest(t),this._createNewRequest(t,o,n)}resolve(t,o){t&&this._items.has(t)&&this._items.get(t).resolve(o)}rejectAll(t){this._items.forEach(o=>o.isPending?o.reject(t):null)}_rejectExistingRequest(t){let o=this._items.get(t);o&&o.isPending&&o.reject(new Error(`WebSocket request is replaced, id: ${t}`))}_createNewRequest(t,o,n){let r=new dA({timeout:n,timeoutReason:`WebSocket request was rejected by timeout (${n} ms). RequestId: ${t}`});return this._items.set(t,r),fA(r.call(o),()=>this._deleteRequest(t,r))}_deleteRequest(t,o){this._items.get(t)===o&&this._items.delete(t)}}});var u6=ee((jj,c6)=>{c6.exports={createWebSocket:e=>new WebSocket(e),packMessage:null,unpackMessage:null,attachRequestId:null,extractRequestId:null,extractMessageData:e=>e.data,timeout:0,connectionTimeout:0}});var m6=ee(Yh=>{Yh.throwIf=(e,t)=>{if(e)throw new Error(t)};Yh.isPromise=e=>e&&typeof e.then=="function"});var g6=ee((Kj,h6)=>{var Oa=Eb(),d6=Th(),{PromisedMap:hA}=Fb(),gA=p6(),f6=u6(),{throwIf:cd,isPromise:xA}=m6(),ud={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3},Zh=class{constructor(t,o){this._assertOptions(o),this._url=t,this._options=Object.assign({},f6,o),this._requests=new gA,this._promisedMap=new hA,this._ws=null,this._wsSubscription=null,this._createOpeningController(),this._createClosingController(),this._createChannels()}get ws(){return this._ws}get url(){return this._url}get isOpening(){return!!(this._ws&&this._ws.readyState===ud.CONNECTING)}get isOpened(){return!!(this._ws&&this._ws.readyState===ud.OPEN)}get isClosing(){return!!(this._ws&&this._ws.readyState===ud.CLOSING)}get isClosed(){return!this._ws||this._ws.readyState===ud.CLOSED}get onOpen(){return this._onOpen}get onSend(){return this._onSend}get onMessage(){return this._onMessage}get onUnpackedMessage(){return this._onUnpackedMessage}get onResponse(){return this._onResponse}get onClose(){return this._onClose}get onError(){return this._onError}open(){return this.isClosing?Promise.reject(new Error("Can't open WebSocket while closing.")):this.isOpened?this._opening.promise:this._opening.call(()=>{this._opening.promise.catch(t=>this._cleanup(t)),this._createWS()})}sendRequest(t,o={}){let n=o.requestId||`${Math.random()}`,r=o.timeout!==void 0?o.timeout:this._options.timeout;return this._requests.create(n,()=>{this._assertRequestIdHandlers();let i=this._options.attachRequestId(t,n);this.sendPacked(i)},r)}sendPacked(t){this._assertPackingHandlers();let o=this._options.packMessage(t);this.send(o)}send(t){cd(!this.isOpened,"Can't send data because WebSocket is not opened."),this._ws.send(t),this._onSend.dispatchAsync(t)}waitUnpackedMessage(t,o={}){return cd(typeof t!="function",`Predicate must be a function, got ${typeof t}`),o.timeout&&setTimeout(()=>{if(this._promisedMap.has(t)){let n=o.timeoutError||new Error("Timeout");this._promisedMap.reject(t,n)}},o.timeout),this._promisedMap.set(t)}close(t,o){return this.isClosed?Promise.resolve(this._closing.value):this._closing.call(()=>this._ws.close(t,o))}removeAllListeners(){this._onOpen.removeAllListeners(),this._onMessage.removeAllListeners(),this._onUnpackedMessage.removeAllListeners(),this._onResponse.removeAllListeners(),this._onSend.removeAllListeners(),this._onClose.removeAllListeners(),this._onError.removeAllListeners()}_createOpeningController(){let t=this._options.connectionTimeout||this._options.timeout;this._opening=new d6({timeout:t,timeoutReason:`Can't open WebSocket within allowed timeout: ${t} ms.`})}_createClosingController(){let t=this._options.timeout;this._closing=new d6({timeout:t,timeoutReason:`Can't close WebSocket within allowed timeout: ${t} ms.`})}_createChannels(){this._onOpen=new Oa,this._onMessage=new Oa,this._onUnpackedMessage=new Oa,this._onResponse=new Oa,this._onSend=new Oa,this._onClose=new Oa,this._onError=new Oa}_createWS(){this._ws=this._options.createWebSocket(this._url),this._wsSubscription=new Oa.Subscription([{channel:this._ws,event:"open",listener:t=>this._handleOpen(t)},{channel:this._ws,event:"message",listener:t=>this._handleMessage(t)},{channel:this._ws,event:"error",listener:t=>this._handleError(t)},{channel:this._ws,event:"close",listener:t=>this._handleClose(t)}]).on()}_handleOpen(t){this._onOpen.dispatchAsync(t),this._opening.resolve(t)}_handleMessage(t){let o=this._options.extractMessageData(t);this._onMessage.dispatchAsync(o),this._tryUnpack(o)}_tryUnpack(t){this._options.unpackMessage&&(t=this._options.unpackMessage(t),xA(t)?t.then(o=>this._handleUnpackedData(o)):this._handleUnpackedData(t))}_handleUnpackedData(t){t!==void 0&&(this._onUnpackedMessage.dispatchAsync(t),this._tryHandleResponse(t)),this._tryHandleWaitingMessage(t)}_tryHandleResponse(t){if(this._options.extractRequestId){let o=this._options.extractRequestId(t);o&&(this._onResponse.dispatchAsync(t,o),this._requests.resolve(o,t))}}_tryHandleWaitingMessage(t){this._promisedMap.forEach((o,n)=>{let r=!1;try{r=n(t)}catch(i){this._promisedMap.reject(n,i);return}r&&this._promisedMap.resolve(n,t)})}_handleError(t){this._onError.dispatchAsync(t)}_handleClose(t){this._onClose.dispatchAsync(t),this._closing.resolve(t);let o=new Error(`WebSocket closed with reason: ${t.reason||t.message} (${t.code}).`);this._opening.isPending&&this._opening.reject(o),this._cleanup(o)}_cleanupWS(){this._wsSubscription&&(this._wsSubscription.off(),this._wsSubscription=null),this._ws=null}_cleanup(t){this._cleanupWS(),this._requests.rejectAll(t)}_assertOptions(t){Object.keys(t||{}).forEach(o=>{if(!f6.hasOwnProperty(o))throw new Error(`Unknown option: ${o}`)})}_assertPackingHandlers(){let{packMessage:t,unpackMessage:o}=this._options;cd(!t||!o,"Please define 'options.packMessage / options.unpackMessage' for sending packed messages.")}_assertRequestIdHandlers(){let{attachRequestId:t,extractRequestId:o}=this._options;cd(!t||!o,"Please define 'options.attachRequestId / options.extractRequestId' for sending requests.")}};h6.exports=Zh});var O6=ee(_d=>{"use strict";"use client";var EA=Ft();Object.defineProperty(_d,"__esModule",{value:!0});_d.default=void 0;var AA=EA(Nt()),PA=Ht(),rK=_d.default=(0,AA.default)((0,PA.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3m-1-9c0-.55.45-1 1-1s1 .45 1 1v6c0 .55-.45 1-1 1s-1-.45-1-1zm6 6c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92z"}),"MicNoneOutlined")});var pc=ee(Cd=>{"use strict";"use client";var DA=Ft();Object.defineProperty(Cd,"__esModule",{value:!0});Cd.default=void 0;var FA=DA(Nt()),HA=Ht(),MK=Cd.default=(0,FA.default)((0,HA.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")});var og=ee(yd=>{"use strict";"use client";var NA=Ft();Object.defineProperty(yd,"__esModule",{value:!0});yd.default=void 0;var zA=NA(Nt()),RA=Ht(),AK=yd.default=(0,zA.default)((0,RA.jsx)("path",{d:"M6 6h12v12H6z"}),"Stop")});var U6=ee(Sd=>{"use strict";"use client";var KA=Ft();Object.defineProperty(Sd,"__esModule",{value:!0});Sd.default=void 0;var $A=KA(Nt()),XA=Ht(),o$=Sd.default=(0,$A.default)((0,XA.jsx)("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"InfoOutlined")});var QS=ee(Cf=>{"use strict";"use client";var BO=Ft();Object.defineProperty(Cf,"__esModule",{value:!0});Cf.default=void 0;var DO=BO(Nt()),FO=Ht(),jde=Cf.default=(0,DO.default)((0,FO.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp")});var l8=ee(If=>{"use strict";"use client";var $O=Ft();Object.defineProperty(If,"__esModule",{value:!0});If.default=void 0;var XO=$O(Nt()),YO=Ht(),o1e=If.default=(0,XO.default)((0,YO.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")});var g8=ee((l0,p0)=>{(function(e,t){typeof define=="function"&&define.amd?define([],t):typeof l0<"u"?t():(t(),e.FileSaver={})})(l0,function(){"use strict";function e(s,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}function t(s,l,p){var c=new XMLHttpRequest;c.open("GET",s),c.responseType="blob",c.onload=function(){a(c.response,l,p)},c.onerror=function(){},c.send()}function o(s){var l=new XMLHttpRequest;l.open("HEAD",s,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function n(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(s,l,p){var c=r.URL||r.webkitURL,u=document.createElement("a");l=l||s.name||"download",u.download=l,u.rel="noopener",typeof s=="string"?(u.href=s,u.origin===location.origin?n(u):o(u.href)?t(s,l,p):n(u,u.target="_blank")):(u.href=c.createObjectURL(s),setTimeout(function(){c.revokeObjectURL(u.href)},4e4),setTimeout(function(){n(u)},0))}:"msSaveOrOpenBlob"in navigator?function(s,l,p){if(l=l||s.name||"download",typeof s!="string")navigator.msSaveOrOpenBlob(e(s,p),l);else if(o(s))t(s,l,p);else{var c=document.createElement("a");c.href=s,c.target="_blank",setTimeout(function(){n(c)})}}:function(s,l,p,c){if(c=c||open("","_blank"),c&&(c.document.title=c.document.body.innerText="downloading..."),typeof s=="string")return t(s,l,p);var u=s.type==="application/octet-stream",m=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||u&&m||i)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var x=f.result;x=d?x:x.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=x:location=x,c=null},f.readAsDataURL(s)}else{var h=r.URL||r.webkitURL,_=h.createObjectURL(s);c?c.location=_:location.href=_,c=null,setTimeout(function(){h.revokeObjectURL(_)},4e4)}});r.saveAs=a.saveAs=a,typeof p0<"u"&&(p0.exports=a)})});var Ef=ee(Mf=>{"use strict";"use client";var OB=Ft();Object.defineProperty(Mf,"__esModule",{value:!0});Mf.default=void 0;var BB=OB(Nt()),DB=Ht(),zxe=Mf.default=(0,BB.default)((0,DB.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")});var d0=ee(Af=>{"use strict";"use client";var GB=Ft();Object.defineProperty(Af,"__esModule",{value:!0});Af.default=void 0;var jB=GB(Nt()),qB=Ht(),w2e=Af.default=(0,jB.default)((0,qB.jsx)("path",{d:"m19 15-6 6-1.42-1.42L15.17 16H4V4h2v10h9.17l-3.59-3.58L13 9z"}),"SubdirectoryArrowRight")});var f0=ee(kf=>{"use strict";"use client";var XB=Ft();Object.defineProperty(kf,"__esModule",{value:!0});kf.default=void 0;var YB=XB(Nt()),ZB=Ht(),k2e=kf.default=(0,YB.default)((0,ZB.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"}),"ErrorOutlineOutlined")});var K8=ee(Bf=>{"use strict";"use client";var cD=Ft();Object.defineProperty(Bf,"__esModule",{value:!0});Bf.default=void 0;var uD=cD(Nt()),mD=Ht(),O_e=Bf.default=(0,uD.default)((0,mD.jsx)("path",{d:"M9.4 16.6 4.8 12l4.6-4.6L8 6l-6 6 6 6zm5.2 0 4.6-4.6-4.6-4.6L16 6l6 6-6 6z"}),"Code")});var y9=ee(Rf=>{"use strict";"use client";var DD=Ft();Object.defineProperty(Rf,"__esModule",{value:!0});Rf.default=void 0;var FD=DD(Nt()),HD=Ht(),a4e=Rf.default=(0,FD.default)((0,HD.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNew")});var b9=ee(Vf=>{"use strict";"use client";var ND=Ft();Object.defineProperty(Vf,"__esModule",{value:!0});Vf.default=void 0;var zD=ND(Nt()),RD=Ht(),l4e=Vf.default=(0,zD.default)((0,RD.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos")});var B9=ee(Wf=>{"use strict";"use client";var KD=Ft();Object.defineProperty(Wf,"__esModule",{value:!0});Wf.default=void 0;var $D=KD(Nt()),XD=Ht(),J4e=Wf.default=(0,$D.default)((0,XD.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20z"}),"ArrowBack")});var Y9=ee(jf=>{"use strict";"use client";var sF=Ft();Object.defineProperty(jf,"__esModule",{value:!0});jf.default=void 0;var lF=sF(Nt()),pF=Ht(),Y6e=jf.default=(0,lF.default)((0,pF.jsx)("path",{d:"M19 6H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2m0 10H5V8h14z"}),"Crop32Outlined")});var Z9=ee(qf=>{"use strict";"use client";var cF=Ft();Object.defineProperty(qf,"__esModule",{value:!0});qf.default=void 0;var uF=cF(Nt()),mF=Ht(),Q6e=qf.default=(0,uF.default)((0,mF.jsx)("path",{d:"M19 4H5c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H5V6h14z"}),"Crop54Outlined")});var Q9=ee(Kf=>{"use strict";"use client";var dF=Ft();Object.defineProperty(Kf,"__esModule",{value:!0});Kf.default=void 0;var fF=dF(Nt()),hF=Ht(),eIe=Kf.default=(0,fF.default)((0,hF.jsx)("path",{d:"M19 5H5c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 12H5V7h14z"}),"Crop75Outlined")});var J9=ee($f=>{"use strict";"use client";var gF=Ft();Object.defineProperty($f,"__esModule",{value:!0});$f.default=void 0;var xF=gF(Nt()),_F=Ht(),oIe=$f.default=(0,xF.default)((0,_F.jsx)("path",{d:"M19 7H5c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2m0 8H5V9h14z"}),"Crop169Outlined")});var ev=ee(Xf=>{"use strict";"use client";var CF=Ft();Object.defineProperty(Xf,"__esModule",{value:!0});Xf.default=void 0;var yF=CF(Nt()),bF=Ht(),rIe=Xf.default=(0,yF.default)((0,bF.jsx)("path",{d:"M18 4H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2m0 14H6V6h12z"}),"CropSquareOutlined")});var dT=ee(u1=>{"use strict";"use client";var UH=Ft();Object.defineProperty(u1,"__esModule",{value:!0});u1.default=void 0;var WH=UH(Nt()),GH=Ht(),FAe=u1.default=(0,WH.default)((0,GH.jsx)("path",{fillRule:"evenodd",d:"M16 9V4h1c.55 0 1-.45 1-1s-.45-1-1-1H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3"}),"PushPin")});var fT=ee(m1=>{"use strict";"use client";var jH=Ft();Object.defineProperty(m1,"__esModule",{value:!0});m1.default=void 0;var qH=jH(Nt()),KH=Ht(),NAe=m1.default=(0,qH.default)((0,KH.jsx)("path",{d:"M14 4v5c0 1.12.37 2.16 1 3H9c.65-.86 1-1.9 1-3V4zm3-2H7c-.55 0-1 .45-1 1s.45 1 1 1h1v5c0 1.66-1.34 3-3 3v2h5.97v7l1 1 1-1v-7H19v-2c-1.66 0-3-1.34-3-3V4h1c.55 0 1-.45 1-1s-.45-1-1-1"}),"PushPinOutlined")});var _T=ee(f1=>{"use strict";"use client";var XH=Ft();Object.defineProperty(f1,"__esModule",{value:!0});f1.default=void 0;var YH=XH(Nt()),ZH=Ht(),qAe=f1.default=(0,YH.default)((0,ZH.jsx)("path",{d:"M15.61 7.41 14.2 6l-6 6 6 6 1.41-1.41L11.03 12z"}),"NavigateBeforeOutlined")});var CT=ee(h1=>{"use strict";"use client";var QH=Ft();Object.defineProperty(h1,"__esModule",{value:!0});h1.default=void 0;var JH=QH(Nt()),eN=Ht(),$Ae=h1.default=(0,JH.default)((0,eN.jsx)("path",{d:"M10.02 6 8.61 7.41 13.19 12l-4.58 4.59L10.02 18l6-6z"}),"NavigateNextOutlined")});var mw=ee((ou,T1)=>{(function(e,t){"use strict";var o="1.0.38",n="",r="?",i="function",a="undefined",s="object",l="string",p="major",c="model",u="name",m="type",d="vendor",f="version",h="architecture",_="console",x="mobile",C="tablet",y="smarttv",b="wearable",v="embedded",S=500,M="Amazon",P="Apple",O="ASUS",L="BlackBerry",H="Browser",z="Chrome",R="Edge",V="Firefox",F="Google",q="Huawei",X="LG",W="Microsoft",j="Motorola",w="Opera",ne="Samsung",pe="Sharp",A="Sony",U="Xiaomi",N="Zebra",ce="Facebook",Z="Chromium OS",re="Mac OS",bt=function(Y,$){var J={};for(var D in Y)$[D]&&$[D].length%2===0?J[D]=$[D].concat(Y[D]):J[D]=Y[D];return J},be=function(Y){for(var $={},J=0;J<Y.length;J++)$[Y[J].toUpperCase()]=Y[J];return $},Ce=function(Y,$){return typeof Y===l?we($).indexOf(we(Y))!==-1:!1},we=function(Y){return Y.toLowerCase()},qe=function(Y){return typeof Y===l?Y.replace(/[^\d\.]/g,n).split(".")[0]:t},Ze=function(Y,$){if(typeof Y===l)return Y=Y.replace(/^\s\s*/,n),typeof $===a?Y:Y.substring(0,S)},Kt=function(Y,$){for(var J=0,D,K,Q,ae,oe,He;J<$.length&&!oe;){var It=$[J],te=$[J+1];for(D=K=0;D<It.length&&!oe&&It[D];)if(oe=It[D++].exec(Y),oe)for(Q=0;Q<te.length;Q++)He=oe[++K],ae=te[Q],typeof ae===s&&ae.length>0?ae.length===2?typeof ae[1]==i?this[ae[0]]=ae[1].call(this,He):this[ae[0]]=ae[1]:ae.length===3?typeof ae[1]===i&&!(ae[1].exec&&ae[1].test)?this[ae[0]]=He?ae[1].call(this,He,ae[2]):t:this[ae[0]]=He?He.replace(ae[1],ae[2]):t:ae.length===4&&(this[ae[0]]=He?ae[3].call(this,He.replace(ae[1],ae[2])):t):this[ae]=He||t;J+=2}},Fe=function(Y,$){for(var J in $)if(typeof $[J]===s&&$[J].length>0){for(var D=0;D<$[J].length;D++)if(Ce($[J][D],Y))return J===r?t:J}else if(Ce($[J],Y))return J===r?t:J;return Y},pt={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},ct={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},kt={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[u,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,f],[/opios[\/ ]+([\w\.]+)/i],[f,[u,w+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[f,[u,w+" GX"]],[/\bopr\/([\w\.]+)/i],[f,[u,w]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[f,[u,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[u,f],[/\bddg\/([\w\.]+)/i],[f,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[u,"UC"+H]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[f,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[f,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[f,[u,"Smart Lenovo "+H]],[/(avast|avg)\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure "+H],f],[/\bfocus\/([\w\.]+)/i],[f,[u,V+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[u,w+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[u,w+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[u,"MIUI "+H]],[/fxios\/([-\w\.]+)/i],[f,[u,V]],[/\bqihu|(qi?ho?o?|360)browser/i],[[u,"360 "+H]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1 "+H],f],[/samsungbrowser\/([\w\.]+)/i],[f,[u,ne+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[u,/_/g," "],f],[/metasr[\/ ]?([\d\.]+)/i],[f,[u,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,"Sogou Mobile"],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[u,f],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,ce],f],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[u,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[u,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[f,[u,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[u,z+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,z+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[u,"Android "+H]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[u,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[f,Fe,pt]],[/(webkit|khtml)\/([\w\.]+)/i],[u,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[u,V+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[u,f],[/(cobalt)\/([\w\.]+)/i],[u,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,we]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows (ce|mobile); ppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[h,/ower/,n,we]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,we]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[d,ne],[m,C]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[c,[d,ne],[m,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[c,[d,P],[m,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[c,[d,P],[m,C]],[/(macintosh);/i],[c,[d,P]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[d,pe],[m,x]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[c,[d,q],[m,C]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[c,[d,q],[m,x]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[c,/_/g," "],[d,U],[m,x]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[c,/_/g," "],[d,U],[m,C]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[d,"OPPO"],[m,x]],[/\b(opd2\d{3}a?) bui/i],[c,[d,"OPPO"],[m,C]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[d,"Vivo"],[m,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[c,[d,"Realme"],[m,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[c,[d,j],[m,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[d,j],[m,C]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[d,X],[m,C]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[d,X],[m,x]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[c,[d,"Lenovo"],[m,C]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[c,/_/g," "],[d,"Nokia"],[m,x]],[/(pixel c)\b/i],[c,[d,F],[m,C]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[c,[d,F],[m,x]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[d,A],[m,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[d,A],[m,C]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[d,"OnePlus"],[m,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[d,M],[m,C]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[d,M],[m,x]],[/(playbook);[-\w\),; ]+(rim)/i],[c,d,[m,C]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[c,[d,L],[m,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[d,O],[m,C]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[d,O],[m,x]],[/(nexus 9)/i],[c,[d,"HTC"],[m,C]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[d,[c,/_/g," "],[m,x]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[d,"Acer"],[m,C]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[d,"Meizu"],[m,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[c,[d,"Ulefone"],[m,x]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[d,c,[m,x]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[d,c,[m,C]],[/(surface duo)/i],[c,[d,W],[m,C]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[d,"Fairphone"],[m,x]],[/(u304aa)/i],[c,[d,"AT&T"],[m,x]],[/\bsie-(\w*)/i],[c,[d,"Siemens"],[m,x]],[/\b(rct\w+) b/i],[c,[d,"RCA"],[m,C]],[/\b(venue[\d ]{2,7}) b/i],[c,[d,"Dell"],[m,C]],[/\b(q(?:mv|ta)\w+) b/i],[c,[d,"Verizon"],[m,C]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[c,[d,"Barnes & Noble"],[m,C]],[/\b(tm\d{3}\w+) b/i],[c,[d,"NuVision"],[m,C]],[/\b(k88) b/i],[c,[d,"ZTE"],[m,C]],[/\b(nx\d{3}j) b/i],[c,[d,"ZTE"],[m,x]],[/\b(gen\d{3}) b.+49h/i],[c,[d,"Swiss"],[m,x]],[/\b(zur\d{3}) b/i],[c,[d,"Swiss"],[m,C]],[/\b((zeki)?tb.*\b) b/i],[c,[d,"Zeki"],[m,C]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[d,"Dragon Touch"],c,[m,C]],[/\b(ns-?\w{0,9}) b/i],[c,[d,"Insignia"],[m,C]],[/\b((nxa|next)-?\w{0,9}) b/i],[c,[d,"NextBook"],[m,C]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[d,"Voice"],c,[m,x]],[/\b(lvtel\-)?(v1[12]) b/i],[[d,"LvTel"],c,[m,x]],[/\b(ph-1) /i],[c,[d,"Essential"],[m,x]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[c,[d,"Envizen"],[m,C]],[/\b(trio[-\w\. ]+) b/i],[c,[d,"MachSpeed"],[m,C]],[/\btu_(1491) b/i],[c,[d,"Rotor"],[m,C]],[/(shield[\w ]+) b/i],[c,[d,"Nvidia"],[m,C]],[/(sprint) (\w+)/i],[d,c,[m,x]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[d,W],[m,x]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[d,N],[m,C]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[d,N],[m,x]],[/smart-tv.+(samsung)/i],[d,[m,y]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[d,ne],[m,y]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[d,X],[m,y]],[/(apple) ?tv/i],[d,[c,P+" TV"],[m,y]],[/crkey/i],[[c,z+"cast"],[d,F],[m,y]],[/droid.+aft(\w+)( bui|\))/i],[c,[d,M],[m,y]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[d,pe],[m,y]],[/(bravia[\w ]+)( bui|\))/i],[c,[d,A],[m,y]],[/(mitv-\w{5}) bui/i],[c,[d,U],[m,y]],[/Hbbtv.*(technisat) (.*);/i],[d,c,[m,y]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[d,Ze],[c,Ze],[m,y]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,y]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[d,c,[m,_]],[/droid.+; (shield) bui/i],[c,[d,"Nvidia"],[m,_]],[/(playstation [345portablevi]+)/i],[c,[d,A],[m,_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[d,W],[m,_]],[/((pebble))app/i],[d,c,[m,b]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[c,[d,P],[m,b]],[/droid.+; (glass) \d/i],[c,[d,F],[m,b]],[/droid.+; (wt63?0{2,3})\)/i],[c,[d,N],[m,b]],[/(quest( \d| pro)?)/i],[c,[d,ce],[m,b]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[d,[m,v]],[/(aeobc)\b/i],[c,[d,M],[m,v]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[c,[m,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[c,[m,C]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,C]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,x]],[/(android[-\w\. ]{0,9});.+buil/i],[c,[d,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[u,R+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,u]],os:[[/microsoft (windows) (vista|xp)/i],[u,f],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[u,[f,Fe,ct]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,Fe,ct],[u,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[u,re],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,u],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[u,f],[/\(bb(10);/i],[f,[u,L]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[u,V+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[u,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[u,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[u,z+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[u,Z],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[u,f],[/(sunos) ?([\w\.\d]*)/i],[[u,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,f]]},Ke=function(Y,$){if(typeof Y===s&&($=Y,Y=t),!(this instanceof Ke))return new Ke(Y,$).getResult();var J=typeof e!==a&&e.navigator?e.navigator:t,D=Y||(J&&J.userAgent?J.userAgent:n),K=J&&J.userAgentData?J.userAgentData:t,Q=$?bt(kt,$):kt,ae=J&&J.userAgent==D;return this.getBrowser=function(){var oe={};return oe[u]=t,oe[f]=t,Kt.call(oe,D,Q.browser),oe[p]=qe(oe[f]),ae&&J&&J.brave&&typeof J.brave.isBrave==i&&(oe[u]="Brave"),oe},this.getCPU=function(){var oe={};return oe[h]=t,Kt.call(oe,D,Q.cpu),oe},this.getDevice=function(){var oe={};return oe[d]=t,oe[c]=t,oe[m]=t,Kt.call(oe,D,Q.device),ae&&!oe[m]&&K&&K.mobile&&(oe[m]=x),ae&&oe[c]=="Macintosh"&&J&&typeof J.standalone!==a&&J.maxTouchPoints&&J.maxTouchPoints>2&&(oe[c]="iPad",oe[m]=C),oe},this.getEngine=function(){var oe={};return oe[u]=t,oe[f]=t,Kt.call(oe,D,Q.engine),oe},this.getOS=function(){var oe={};return oe[u]=t,oe[f]=t,Kt.call(oe,D,Q.os),ae&&!oe[u]&&K&&K.platform&&K.platform!="Unknown"&&(oe[u]=K.platform.replace(/chrome os/i,Z).replace(/macos/i,re)),oe},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return D},this.setUA=function(oe){return D=typeof oe===l&&oe.length>S?Ze(oe,S):oe,this},this.setUA(D),this};Ke.VERSION=o,Ke.BROWSER=be([u,f,p]),Ke.CPU=be([h]),Ke.DEVICE=be([c,d,m,_,x,y,C,b,v]),Ke.ENGINE=Ke.OS=be([u,f]),typeof ou!==a?(typeof T1!==a&&T1.exports&&(ou=T1.exports=Ke),ou.UAParser=Ke):typeof define===i&&define.amd?define(function(){return Ke}):typeof e!==a&&(e.UAParser=Ke);var Dt=typeof e!==a&&(e.jQuery||e.Zepto);if(Dt&&!Dt.ua){var ut=new Ke;Dt.ua=ut.getResult(),Dt.ua.get=function(){return ut.getUA()},Dt.ua.set=function(Y){ut.setUA(Y);var $=ut.getResult();for(var J in $)Dt.ua[J]=$[J]}}})(typeof window=="object"?window:ou)});var Am=I(E()),Ty=()=>{let e=(0,Am.useRef)(null);return(0,Am.useEffect)(()=>{let t=async o=>{e.current?.onMouseUp(o)};return window.addEventListener("contextmenu",t),()=>{window.removeEventListener("contextmenu",t)}},[]),e};var fn=I(E()),wy=(0,fn.forwardRef)(e=>{let{title:t,showConfirmButton:o=!0,showCancelButton:n=!0,confirmButtonText:r,cancelButtonText:i,onConfirm:a,onCancel:s,onClose:l,confirmButtonDisabled:p,cancelButtonDisabled:c,PaperProps:u,children:m,ConfirmButtonProps:d,CancelButtonProps:f,hideCloseButton:h=!1,loading:_,actionRef:x,...C}=e,[y,b]=(0,fn.useState)(!1),{t:v}=k(),S=async()=>{if(a){b(!0);try{if(!await a())return}catch{}finally{b(!1)}}l?.({},"confirm")},M=async()=>{if(s){b(!0);try{if(!await s())return}catch{}finally{b(!1)}}l?.({},"backdropClick")};return(0,fn.useImperativeHandle)(x,()=>({submit:S,cancel:M})),fn.default.createElement(ci,{onClose:l,...C,disableScrollLock:!0},fn.default.createElement(B,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",outline:"none"}},fn.default.createElement(zn,{...u,sx:{overflowY:"auto",maxHeight:"calc(100vh - 32px)",position:"relative",borderRadius:"8px",maxWidth:"768px!important",width:"calc(100vw - 32px)",margin:"0 auto",p:"24px",display:"flex",flexDirection:"column",gap:"24px",boxSizing:"border-box",bgcolor:P=>P.palette.mode==="dark"?"#2C2C2C":"#FFFFFF",...u?.sx}},!h&&fn.default.createElement(se,{sx:{padding:"8px",width:"36px",height:"36px",position:"absolute",top:"8px",right:"8px"},onClick:()=>{s?.(),l?.({},"backdropClick")}},fn.default.createElement(G,{sx:{fontSize:"16px!important"},icon:"Close"})),t&&fn.default.createElement(T,{fontSize:"24px",fontWeight:700,textAlign:"left"},t),m,o||n?fn.default.createElement(g,{sx:{gap:"8px",width:"100%"}},o&&fn.default.createElement(Yn,{loading:y||_,variant:"contained",onClick:S,disabled:p,...d},r||v("package__features:context_menu__lite_editor__modal__common__confirm")),n&&fn.default.createElement(Yn,{loading:y||_,onClick:M,disabled:c,...f},i||v("package__features:context_menu__lite_editor__modal__common__cancel"))):null)))});wy.displayName="LiteModal";var Gn=wy;var dh=I(E()),Xw=()=>{let{t:e}=k(),{groupData:t,isOpenDeleteGroupConfirm:o,closeDeleteGroupConfirm:n}=cs(),{refetch:r}=Er(),i=St();return dh.default.createElement(Gn,{container:i,PaperProps:{sx:{maxWidth:"448px"}},open:o,onClose:()=>{n()},title:e("package__features:context_menu__lite_editor__modal__delete_group__title"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_group__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(t?.prompt_id&&(await Mr.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id),await r("LiteContextMenuPromptDeleteConfirm")),!0)},dh.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__delete_group__description")))},My=Xw;var hn=I(E()),Yw=()=>{let{t:e}=k(),t=St(),o=(0,hn.createRef)(),{groupData:n,updateGroup:r,isOpen:i,closeEditor:a}=cs(),{changeMode:s}=io(),[l,p]=(0,hn.useState)(!1),[c,u]=(0,hn.useState)(!1),[m,d]=(0,hn.useState)(""),{refetch:f}=Er(),h=n?.prompt_id?e("package__features:context_menu__lite_editor__modal__edit_group__title__edit"):e("package__features:context_menu__lite_editor__modal__edit_group__title__add"),_=async()=>{try{if(p(!0),n){let x=Ee(n),C=await Mr.addOrUpdateContextMenuGroup(x);return C.data&&C.success?(d(""),await f("LiteContextMenuGroupEditor"),s("edit")):d(C.error),u(!C.success),C.success}return!0}catch{return!1}finally{p(!1)}};return(0,hn.useEffect)(()=>{i?setTimeout(()=>{o.current&&o.current.focus()},100):(u(!1),d(""))},[i]),hn.default.createElement(hn.default.Fragment,null,hn.default.createElement(Gn,{container:t,loading:l,title:h,open:i,onConfirm:async()=>await _(),confirmButtonDisabled:!n?.prompt_title||n?.prompt_title==="",onClose:()=>{a()}},n&&hn.default.createElement(g,{gap:"8px"},hn.default.createElement(T,{fontSize:"16px",fontWeight:500,textAlign:"left",color:"text.primary"},e("package__features:context_menu__lite_editor__modal__edit_group__variable_name__title")),hn.default.createElement(zt,{error:c,helperText:m,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},inputRef:o,onKeyUpCapture:x=>{x.stopPropagation()},onKeyDown:x=>{x.stopPropagation()},onKeyUp:x=>{x.stopPropagation()},onKeyPress:x=>{x.stopPropagation()},onKeyPressCapture:x=>{x.stopPropagation()},onKeyDownCapture:async x=>{x.stopPropagation(),x.key==="Enter"&&!x.shiftKey?n&&await _()&&a():x.key==="Escape"&&a()},value:n.prompt_title,onChange:x=>{r({prompt_title:x.target.value})},size:"small",placeholder:e("package__features:context_menu__lite_editor__modal__edit_group__variable_name__label")}))),hn.default.createElement(My,null))},Ey=Yw;var us=I(E()),Zw=e=>{let{sx:t,groupData:o,icon:n,onChange:r}=e,{t:i}=k(),{createNewGroup:a,editGroup:s}=cs(),{isOpen:l}=cs(),p=(0,us.useRef)(!1),c=o?.prompt_id?i("package__features:context_menu__lite_editor__modal__edit_group__title__edit"):i("package__features:context_menu__lite_editor__modal__edit_group__title__add"),u=async()=>{await Qe({emitEvent:!0})&&(p.current=!0,o?.prompt_id?s(o):await a())};return(0,us.useEffect)(()=>{!l&&p.current&&(p.current=!1,r?.())},[l,r]),us.default.createElement(se,{disabledClickEvent:!0,placement:"top-end",onClick:u,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},title:c,sx:t},us.default.createElement(G,{icon:n||"PromptEdit"}))},Ay=Zw;var Wi=I(E()),fh=async e=>{let o=(await Mr.getContextMenuChildren(e)).filter(n=>n.type==="group");return J2(o,{labelKey:"prompt_title",valueKey:"prompt_id"})},Qw=e=>{let{defaultValue:t,onChange:o,contextMenuPath:n,...r}=e,[i,a]=(0,Wi.useState)(t||""),s=Wi.default.useRef(null),{data:l,isLoading:p,refetch:c}=i_({queryKey:[t_.GET_LITE_CONTEXT_MENU_GROUP,n],queryFn:async()=>{let u=await fh(n);if(u.length>0)return u;let m=await Mr.getContextMenuByPath(n);if(!m)throw new Error("Parent prompt not found");return await Mr.addOrUpdateContextMenuGroup({parent_prompt_id:m.prompt_id,prompt_title:"My tools",prompt_icon:void 0,visibility_settings:{blocked_domains:[],allowed_domains:[],use_allow_list:!1},prompt_id:Xo()}),await fh(n)},enabled:!!n,initialData:[]});return(0,Wi.useEffect)(()=>{if(l&&l.length>0){if(s.current){a(s.current.prompt_id),o?.(s.current.prompt_id,s.current),s.current=null;return}l.some(m=>m.value===i)||(a(l[0].value),o?.(l[0].value,l[0].origin))}},[l,i]),Wi.default.createElement(DC,{value:i,onChange:(u,m)=>{a(u),o?.(u,m.origin)},sx:{padding:0},MenuProps:{slotProps:{paper:{sx:{textAlign:"left",marginTop:"8px","& > ul":{padding:"8px 0 0 0"}}}}},renderFooter:Wi.default.createElement(g,{direction:"row",sx:{justifyContent:"flex-end",alignItems:"center",gap:"8px",padding:"4px",borderTop:"1px solid",borderColor:"border.main"}},Wi.default.createElement(Ay,{icon:"Add",onChange:async()=>{let m=(await fh(n)).find(d=>!l.some(f=>f.value===d.value));m?.origin&&(s.current=m.origin,c())},sx:{minWidth:"26px",width:"26px",height:"26px",padding:"4px"}})),loading:p,options:l,...r})},Py=Qw;var hh=I(E()),Jw=()=>{let{t:e}=k(),{promptData:t,isOpenDeletePromptConfirm:o,closeDeletePromptConfirm:n}=bi(),{refetch:r}=Er(),i=St();return hh.default.createElement(Gn,{container:i,PaperProps:{sx:{maxWidth:"448px"}},open:o,onClose:()=>{n()},title:e("package__features:context_menu__lite_editor__modal__delete_tool__title"),confirmButtonText:e("package__features:context_menu__lite_editor__modal__delete_tool__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(t?.prompt_id&&(await Mr.deleteContextMenuNode(t.prompt_id,t.parent_prompt_id),await r("LiteContextMenuPromptDeleteConfirm")),!0)},hh.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__delete_tool__description")))},ky=Jw;var Ii=I(E()),e7=e=>{let{onCreateVariable:t,onUpdateVariable:o}=e,{t:n}=k(),{isOpenEditVariableModal:r,closeEditVariableModal:i,editVariable:a,updateVariable:s,saveEditVariable:l,variables:p}=Ta(),[c,u]=(0,Ii.useState)(""),m=Ii.default.createRef(),d=!a.hint?.trim(),f=()=>{let h=Ee(a);if(h.hint=h.hint.trim(),p.find(x=>x.hint===h.hint&&x.name!==h.name))return u(n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__error__name_repeated")),!1;if(h.name)l(h),o?.(h);else{let x=pC(h.hint),C={...h,name:x};l(C),t?.(C)}return!0};return(0,Ii.useEffect)(()=>{r&&(u(""),setTimeout(()=>{m.current&&m.current.focus()},100))},[r]),Ii.default.createElement(Gn,{disableRestoreFocus:!0,title:a.name?n("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"):n("package__features:context_menu__lite_editor__modal__edit_variable__title__add"),open:r,confirmButtonDisabled:d,onClose:()=>{i()},onConfirm:async()=>f(),sx:{zIndex:2147483623}},Ii.default.createElement(g,{gap:"8px"},Ii.default.createElement(T,{fontSize:"16px",fontWeight:500,textAlign:"left",color:"text.primary"},n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__title")),Ii.default.createElement(zt,{inputRef:m,error:c!=="",helperText:c,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},value:a.hint,onChange:h=>{s({...a,hint:h.target.value})},onKeyUpCapture:h=>{h.stopPropagation()},onKeyDown:h=>{h.stopPropagation()},onKeyUp:h=>{h.stopPropagation()},onKeyPress:h=>{h.stopPropagation()},onKeyPressCapture:h=>{h.stopPropagation()},onKeyDownCapture:h=>{if(h.stopPropagation(),h.key==="Enter"&&!h.shiftKey){if(h.preventDefault(),d)return;a&&f()&&i()}else h.key==="Escape"&&(h.preventDefault(),i())},size:"small",placeholder:n("package__features:context_menu__lite_editor__modal__edit_variable__variable_name__label")})))},Ly=e7;var kn=I(E()),t7=Io(({className:e,...t})=>kn.default.createElement(yr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${vn.tooltip}`]:{backgroundColor:"#fff",color:"rgba(0, 0, 0, 0.87)",maxWidth:"unset",border:"1px solid #E0E0E0",boxShadow:e.shadows[5]},"& button > svg":{color:"rgba(0, 0, 0, 0.87)!important"},'&[data-popper-placement="bottom"] > div':{marginTop:"8px !important"},'&[data-popper-placement="top"] > div':{marginBottom:"8px !important"},[`& > .${vn.arrow}`]:{color:"#fff"}})),o7=e=>{let{variable:t,onClick:o,onDelete:n,onEdit:r}=e,{t:i}=k(),{theme:a}=Wn(),[s,l]=(0,kn.useState)(!1),p=a.palette.mode==="dark",c=FC(t.name,p),u=HC(c,p?.3:.8,p?.1:.3);return kn.default.createElement("div",null,kn.default.createElement(t7,{title:kn.default.createElement(g,{direction:"row",gap:"4px"},kn.default.createElement(se,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__edit_variable__title__edit"),onClick:()=>{r&&r()}},kn.default.createElement(G,{sx:{fontSize:"16px!important"},icon:"PromptEdit"})),kn.default.createElement(se,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{width:"20px",height:"20px",minWidth:"20px",borderRadius:"2px"},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),onClick:()=>{l(!0)}},kn.default.createElement(G,{sx:{fontSize:"16px!important"},icon:"Delete"}))),placement:"top",PopperProps:{disablePortal:!0}},kn.default.createElement(de,{key:t.name,sx:{minWidth:"unset",padding:"2px 6px",color:c,bgcolor:u,"&:hover":{color:c,bgcolor:u}},onClick:()=>{o&&o()}},kn.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0,maxWidth:"240px"},`{{${t.hint}}}`))),kn.default.createElement(Gn,{PaperProps:{sx:{maxWidth:"448px"}},open:s,onClose:()=>{l(!1)},title:i("package__features:context_menu__lite_editor__modal__delete_variable__title__delete"),confirmButtonText:i("package__features:context_menu__lite_editor__modal__delete_variable__button__delete"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onConfirm:async()=>(n&&n(),l(!1),!0)},kn.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},i("package__features:context_menu__lite_editor__modal__delete_variable__description"))))},Oy=o7;var By=I(Fw());var Pa=I(E()),n7=e=>{let{sx:t,onInsertVariable:o,children:n}=e,{t:r}=k(),{variables:i,openEditVariableModal:a,deleteVariable:s}=Ta(),{secondaryElementMouseLeave:l,secondaryElementMouseEnter:p,secondaryElementSx:c}=bi(),u=m=>{a(m)};return Pa.default.createElement(g,{onMouseLeave:l,onMouseEnter:p,direction:"row",sx:{flexWrap:"wrap",gap:"8px",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"#363839":"#f9f9f9",...c,...t}},i.map(m=>m.hidden||m.type==="select"?null:Pa.default.createElement(Oy,{variable:m,onClick:()=>o(m),onEdit:()=>u(m),onDelete:()=>{s(m)},key:m.name+m.hint})),Pa.default.createElement(de,{sx:{padding:"2px 6px",gap:"4px",display:"flex",alignItems:"center",bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)","&:hover":{bgcolor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"}},onClick:()=>{a({name:"",hint:"",type:"text"})}},Pa.default.createElement(T,{lineHeight:"20px",fontSize:"14px",fontWeight:400,textAlign:"left",color:"inherit",noWrap:!0},r("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable")),Pa.default.createElement(xe,{title:r("package__features:context_menu__lite_editor__modal__edit_variable__button__new_variable__tooltip"),PopperProps:{disablePortal:!0},disableInteractive:!0},Pa.default.createElement(By.default,{sx:{fontSize:"12px"}}))),Pa.default.createElement(Ly,{onCreateVariable:m=>{o(m)}}),n)},Dy=n7;var kl=I(E()),r7=typeof Element<"u",i7=typeof Map=="function",a7=typeof Set=="function",s7=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView,Pm=(e,t)=>{if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;let o,n,r;if(Array.isArray(e)){if(o=e.length,o!=t.length)return!1;for(n=o;n--!==0;)if(!Pm(e[n],t[n]))return!1;return!0}let i;if(i7&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;for(i=e.entries();!(n=i.next()).done;)if(!Pm(n.value[1],t.get(n.value[0])))return!1;return!0}if(a7&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(n=i.next()).done;)if(!t.has(n.value[0]))return!1;return!0}if(s7&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(o=e.length,o!=t.length)return!1;for(n=o;n--!==0;)if(e[n]!==t[n])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&typeof e.valueOf=="function"&&typeof t.valueOf=="function")return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&typeof e.toString=="function"&&typeof t.toString=="function")return e.toString()===t.toString();if(r=Object.keys(e),o=r.length,o!==Object.keys(t).length)return!1;for(n=o;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;if(r7&&e instanceof Element)return!1;for(n=o;n--!==0;)if(!((r[n]==="_owner"||r[n]==="__v"||r[n]==="__o")&&e.$$typeof)&&!Pm(e[r[n]],t[r[n]]))return!1;return!0}return e!==e&&t!==t};function Fy(e){return e&&e.replace(/&nbsp;|\u202F|\u00A0/g," ").replace(/<br\s*\/>/g,"<br>")}function Hy(e){return e.replace(/(<br\s*\/?>)+$/i,"")}function gh(e){if(!e)return"";let t=e.replace(/<br\s*\/>/gi,"<br>");return/<br>$/i.test(t)?t:t+"<br>"}function Ny(e){let t=document.createTextNode("");e.appendChild(t);let o=document.activeElement===e;if(t.nodeValue!==null&&o){let n=window.getSelection();if(n!==null){let r=document.createRange();r.setStart(t,t.nodeValue.length),r.collapse(!0),n.removeAllRanges(),n.addRange(r)}e.focus()}}var jp=class extends kl.Component{constructor(){super(...arguments);this.lastHtml=this.props.html;this.el=typeof this.props.innerRef=="function"?{current:null}:kl.createRef();this.getEl=()=>(this.props.innerRef&&typeof this.props.innerRef!="function"?this.props.innerRef:this.el).current;this.emitChange=o=>{let n=this.getEl();if(!n)return;let r=Hy(n.innerHTML);if(this.props.onChange&&r!==this.lastHtml){let i=Object.assign({},o,{target:{value:r}});this.props.onChange(i)}this.lastHtml=r};this._recordCompositionPrevElement=null;this._recordCompositionPrevElementParentNode=null}_focusRecordCompositionPrevElement(){if(!this._recordCompositionPrevElement)return;let o=document.createRange(),n=window.getSelection();n&&(this._recordCompositionPrevElement===this.getEl()?o.setStart(this.getEl(),0):this._recordCompositionPrevElement.nextSibling?this._recordCompositionPrevElement.nextSibling.contentEditable==="false"&&this._recordCompositionPrevElementParentNode?o.setStart(this._recordCompositionPrevElementParentNode,Array.from(this._recordCompositionPrevElementParentNode.childNodes).indexOf(this._recordCompositionPrevElement.nextSibling)):o.setStart(this._recordCompositionPrevElement.nextSibling,0):this._recordCompositionPrevElementParentNode&&o.setStart(this._recordCompositionPrevElementParentNode,this._recordCompositionPrevElementParentNode.childNodes.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o),this.getEl()?.focus())}getPreviousElementFromCaret(){let n=(this.getEl()?.getRootNode()||window).getSelection();if(!n?.rangeCount)return null;let r=this.getEl();if(!r)return null;let i=n.getRangeAt(0);if(!r.contains(i.commonAncestorContainer))return null;let a=i.startContainer,s=i.startOffset;if(a===r){if(s===0)return r;if(s<=r.childNodes.length)return r.childNodes[s-1]}return a.nodeType===Node.TEXT_NODE&&s===0?a.previousSibling:null}shouldComponentUpdate(o){let n=this.getEl();if(!n)return!0;let r=Hy(n.innerHTML);return Fy(o.html)!==Fy(r)?!0:this.props.disabled!==o.disabled||this.props.tagName!==o.tagName||this.props.className!==o.className||this.props.innerRef!==o.innerRef||this.props.placeholder!==o.placeholder||!Pm(this.props.style,o.style)}componentDidUpdate(){let o=this.getEl();if(!o)return;let n=gh(this.props.html);n!==o.innerHTML&&(o.innerHTML=n),this.lastHtml=this.props.html,Ny(o)}componentDidMount(){let o=this.getEl();if(!o)return;let n=gh(this.props.html);n!==o.innerHTML&&(o.innerHTML=n),this.lastHtml=this.props.html,Ny(o)}render(){let{tagName:o,html:n,innerRef:r,children:i,...a}=this.props,s=gh(n);return kl.createElement(o||"div",{...a,ref:typeof r=="function"?l=>{r(l),this.el.current=l}:r||this.el,onInput:this.emitChange,onBlur:this.props.onBlur||this.emitChange,onKeyUp:this.props.onKeyUp||this.emitChange,onKeyDown:this.props.onKeyDown||this.emitChange,onCompositionStart:l=>{this._recordCompositionPrevElement=this.getPreviousElementFromCaret(),this._recordCompositionPrevElementParentNode=this._recordCompositionPrevElement?.parentNode||null,this.props.onCompositionStart?.(l)},onCompositionEnd:l=>{l.data||this._focusRecordCompositionPrevElement(),this.props.onCompositionEnd?.(l)},contentEditable:!this.props.disabled,dangerouslySetInnerHTML:{__html:s}},i)}};var Ot=I(E()),l7=e=>{let{promptId:t,error:o,disabled:n,placeholder:r,minHeight:i=80,maxHeight:a=80,sx:s,onData:l,onClose:p,...c}=e,[u,m]=(0,Ot.useState)(!1),{t:d}=k(),{theme:f}=Wn(),h=U2(),{template:_,setTemplate:x,variables:C,html:y,setIsDarkMode:b,htmlToTemplate:v}=Ta(),S=(0,Ot.useRef)(null),M=(0,Ot.useRef)(""),P=(0,Ot.useRef)(!1),O=!!t,L=(0,Ot.useMemo)(()=>Ro([{pointerEvents:n?"none":"auto",borderRadius:"8px",display:"flex",flexDirection:"column",width:"100%",border:"1px solid",outline:"0px solid",height:"100%",outlineColor:F=>F.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",borderColor:F=>F.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",boxSizing:"border-box","& > div":{"&:first-of-type":{borderRadius:"8px 8px 0 0"},"&:last-of-type":{borderRadius:"0 0 8px 8px"},padding:"8px",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},"&:hover":{outlineColor:F=>F.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:F=>F.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)"},"&:has( > div:active),&:has( > div:focus)":{outlineColor:F=>F.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",borderColor:F=>F.palette.mode==="dark"?"#fff":"rgba(0, 0, 0,.87)",outlineWidth:1},".prompt-template-input[contenteditable=true]:empty:before":{content:"attr(data-placeholder)",display:"block",color:"#aaa",fontFamily:"Roboto, Helvetica, Arial, sans-serif!important"},".prompt-template-input":{display:"block",outline:"none!important",boxSizing:"border-box",width:"calc(100% - 4px)",minHeight:u?"unset":`${i}px`,height:u?"unset":`calc(95vh - ${O?"420":"495"}px)`,flex:u?1:"unset",overflow:"auto",fontSize:16,lineHeight:1.4,letterSpacing:"0.4px",WebkitUserModify:"read-write-plaintext-only"}},s,o?{"&:":{"--borderColor":F=>`${F.palette.error.main}!important`}}:{}]),[n,i,a,s,o,u,O]);(0,Ot.useEffect)(()=>{b(f.palette.mode==="dark")},[f.palette.mode]);let H=()=>{S.current&&setTimeout(()=>{sh(S.current,M.current,h)},0)},z=async F=>{if(S.current){let q=S.current.innerText.replace(/\n$/,""),X=M.current;q.startsWith(X)?(M.current=X+`{{${F.hint}}}`,q=M.current+q.slice(X.length)):(M.current=q+`{{${F.hint}}}`,q+=`{{${F.hint}}}`);let W=new Map;C.forEach(pe=>{W.set(pe.hint,pe.name)}),W.set(F.hint,F.name);let j=/\{\{([^{}]+?)\}\}/g,w=document.createElement("textarea");w.textContent=q;let ne=w.innerHTML;w.remove(),q=ne.replace(j,(pe,A)=>{let U=W.get(A);return U?`{{${U}}}`:pe}),x(q),H()}},R=F=>{if(S.current)if(h()?.rangeCount){let X=h()?.getRangeAt(0),W=X?.cloneRange();X&&W&&(X.collapsed&&X.startContainer.parentElement?.tagName==="SPAN"&&X.setStartAfter(X.startContainer.parentElement),W.selectNodeContents(S.current),W.setEnd(X.startContainer,X.startOffset),M.current=W.toString())}else S.current.focus()};(0,Ot.useEffect)(()=>{l?.({template:_,variables:C})},[_,C]),(0,Ot.useEffect)(()=>{setTimeout(()=>{S.current&&(M.current=S.current.innerText,S.current.focus(),sh(S.current,M.current,h))},100)},[t,u]);let V=()=>Ot.default.createElement(B,{sx:L},Ot.default.createElement(jp,{style:{textAlign:"left"},innerRef:S,html:y,className:"prompt-template-input",id:"prompt-template-input","data-testid":"prompt-template-input","data-placeholder":r,onChange:F=>{if(P.current)return;let q=F.target.value;R("onChange"),v(q)},onCompositionStart:F=>{P.current=!0},onCompositionEnd:F=>{if(P.current=!1,!F.data)return;let q=F.target.innerHTML;R("onCompositionEnd"),v(q)},onKeyDownCapture:F=>{F.stopPropagation(),F.key==="Escape"&&(u?m(!1):p?.())},onKeyUpCapture:F=>{F.stopPropagation(),!P.current&&R("onKeyUp")},onKeyPress:F=>{F.stopPropagation()},onKeyPressCapture:F=>{F.stopPropagation()},onKeyDown:F=>{F.stopPropagation()},onKeyUp:F=>{F.stopPropagation()},onMouseUp:()=>{R("onMouseUp")},...c}),Ot.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",sx:{padding:"4px!important","&:empty":{display:"none"}}},!u&&Ot.default.createElement(se,{placement:"top",tooltipProps:{disableInteractive:!0,PopperProps:{disablePortal:!0}},sx:{alignItems:"flex-end",marginLeft:"auto"},title:d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__expand"),onClick:()=>{m(!0)},"data-testid":"maxai-prompt-template-input--expand"},Ot.default.createElement(G,{icon:"ExpandContent"}))),Ot.default.createElement(Dy,{onInsertVariable:z}));return u?Ot.default.createElement(ci,{open:!0,sx:{position:"fixed",zIndex:2147483622},onClose:()=>{m(!1)}},Ot.default.createElement(zn,{component:"div",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",my:0,boxShadow:"none",overflow:"hidden",height:"95vh",width:"80vw",padding:"24px",alignItems:"center",justifyContent:"center",boxSizing:"border-box"}},Ot.default.createElement(g,{width:"100%",gap:"24px",height:"100%"},Ot.default.createElement(g,{width:"100%",height:0,flex:1},V()),Ot.default.createElement(g,{direction:"row",sx:{flexShrink:0,alignItems:"center",justifyContent:"end",height:"40px"}},Ot.default.createElement(de,{variant:"contained",onClick:()=>{m(!1)}},d("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__close")))))):Ot.default.createElement(Ot.default.Fragment,null,V())},zy=l7;var wt=I(E()),Ry=Ee(Np).map(e=>({label:e,value:e})),p7=({defaultValue:e="",placement:t="bottom-start",tooltipProps:o,onChange:n,disabled:r})=>{let i=St(),{t:a}=k(),s=(0,wt.useRef)(null),l=(0,wt.useRef)(null),[p,c]=(0,wt.useState)(!1),[u,m]=(0,wt.useState)(""),d=(0,wt.useMemo)(()=>Ry.filter(_=>_.label.toLowerCase().includes(u.toLowerCase())||_.value.toLowerCase().includes(u.toLowerCase())),[u]),[f,h]=(0,wt.useState)(()=>Ry.find(_=>_.value===e)||void 0);return(0,wt.useEffect)(()=>{p?setTimeout(()=>{l.current?.focus()},100):m("")},[p]),wt.default.createElement(xe,{title:a("package__ui:contextmenu_icon_selector__title"),PopperProps:{container:i},...o,disabled:r},wt.default.createElement("div",{style:{flexShrink:0}},wt.default.createElement(de,{ref:s,variant:"outlined",sx:{height:"40px",padding:"8px",display:"flex",alignItems:"center",gap:"8px",width:"fit-content",boxSizing:"border-box",borderColor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)"},onClick:()=>{r||c(!p)}},f?wt.default.createElement(G,{sx:{fontSize:"24px"},icon:f.value}):wt.default.createElement(B,{sx:{bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)":"rgba(0, 0, 0, 0.06)",width:"24px",height:"24px"}}),wt.default.createElement(G,{sx:{fontSize:"18px",color:"text.secondary"},icon:p?"ArrowDropUp":"ArrowDropDown"})),wt.default.createElement(dl,{anchorEl:s.current,open:p,placement:t,container:i,onClose:()=>{c(!1)}},wt.default.createElement(g,{sx:{padding:"8px",gap:"24px"}},wt.default.createElement(zt,{onKeyUpCapture:_=>{_.stopPropagation()},onKeyDown:_=>{_.stopPropagation()},onKeyUp:_=>{_.stopPropagation()},onKeyPress:_=>{_.stopPropagation()},onKeyPressCapture:_=>{_.stopPropagation()},inputRef:l,placeholder:a("package__ui:contextmenu_icon_selector__filter_label"),inputProps:{style:{fontSize:"16px",textAlign:"left"}},size:"small",InputProps:{startAdornment:wt.default.createElement(vr,{position:"start"},wt.default.createElement(G,{icon:"Search"}))},value:u,onChange:_=>{m(_.target.value)}}),wt.default.createElement(g,{direction:"row",sx:{gap:"16px",flexWrap:"wrap",width:"288px",maxHeight:"224px",overflowY:"auto"}},d.map((_,x)=>wt.default.createElement("div",{key:x},wt.default.createElement(se,{title:_.label,tooltipProps:{PopperProps:{disablePortal:!0},disableInteractive:!0},sx:{backgroundColor:_.value===f?.value?"rgba(0, 0, 0, 0.04)":"transparent"},onClick:()=>{h(_),c(!1),n?.(_.value)}},wt.default.createElement(G,{icon:_.value})))),d.length===0&&wt.default.createElement(T,{sx:{color:"text.secondary"},textAlign:"center",fontSize:"14px",fontWeight:400,width:"100%"},a("package__ui:contextmenu_icon_selector__no_result")))))))},Vy=p7;var rt=I(E());var xh=I(E());var c7=()=>{let{t:e}=k(),{isOpenDiscardConfirmModal:t,closeDiscardConfirmModal:o,closeEditor:n}=bi(),r=St();return xh.default.createElement(Gn,{container:r,PaperProps:{sx:{maxWidth:"448px"}},open:t,title:e("package__features:context_menu__lite_editor__modal__discard_edits__title"),confirmButtonText:e("package__common:discard"),ConfirmButtonProps:{sx:{bgcolor:"#ED5050",color:"white","&:hover":{bgcolor:"rgba(255, 14, 39, 1)",color:"white"}}},onClose:()=>{o()},onConfirm:async()=>(n(),!0)},xh.default.createElement(T,{lineHeight:"24px",fontSize:"16px",textAlign:"left",color:"text.primary",fontWeight:400},e("package__features:context_menu__lite_editor__modal__discard_edits__description")))},Uy=c7;var u7=e=>{let{sx:t}=e,o=St(),{t:n}=k(),{contextMenuPath:r,changeMode:i}=io(),[a,s]=rt.default.useState(!1),[l,p]=rt.default.useState(""),c=(0,rt.useRef)(null),{updatePrompt:u,closeEditor:m,isOpen:d,promptData:f,secondaryElementSx:h,secondaryElementMouseLeave:_,secondaryElementMouseEnter:x,openDiscardConfirmModal:C,originalPromptData:y}=bi(),{refetch:b}=Er();(0,rt.useEffect)(()=>{d||(s(!1),p(""))},[d]);let v=et(f),S=et(y),M=O=>({template:O?.prompt_template?.default?.trim()||"",title:O?.prompt_title?.trim()||"",icon:O?.prompt_icon,variables:O?.variables||[]}),P=()=>{let O=v.current,L=S.current;if(!O||!L)return!1;let H=M(O),z=M(L);return H.template!==z.template||H.title!==z.title||H.icon!==z.icon||!e_(H.variables,z.variables)?(C(),!0):!1};return rt.default.createElement(rt.default.Fragment,null,rt.default.createElement(Gn,{actionRef:c,container:o,open:d,PaperProps:{sx:{height:"95vh"}},title:f?.prompt_id?n("package__features:context_menu__lite_editor__modal__edit_tool__title__edit"):n("package__features:context_menu__lite_editor__modal__edit_tool__title__add"),confirmButtonDisabled:f?.prompt_template?.default===""||f?.prompt_title==="",onConfirm:async()=>{if(f){let O=Ee(f);O.variables=O.variables.filter(H=>!!(H.hidden||O.prompt_template?.default?.includes(H.name)));let L=await Mr.addOrUpdateContextMenu(O);return L.data&&L.success?(p(""),await b("LiteContextMenuPromptEditor"),i("edit")):p(L.error),s(!L.success),L.success}return!0},onClose:(O,L)=>{L!=="confirm"&&P()||m()}},rt.default.createElement(g,{width:"100%",sx:{...t}},rt.default.createElement(g,{gap:"16px"},f&&rt.default.createElement(g,{gap:"4px"},rt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between"},rt.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center"},rt.default.createElement(T,{fontSize:"16px",fontWeight:500,color:"text.primary"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__label"))),rt.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center"},rt.default.createElement(T,{fontSize:"14px",fontWeight:400,color:"text.secondary"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_1")),rt.default.createElement(T,{href:"https://www.maxai.me/docs/help/my-own-prompts/ai-prompt-writing-guide/",target:"_blank",component:"a",fontSize:"14px",fontWeight:400,color:"text.primary",sx:{textDecoration:"underline",cursor:"pointer"}},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_prompt__help_2")))),rt.default.createElement(zy,{promptId:f?.prompt_id,onClose:()=>{P()||m()},onData:O=>{u({prompt_template:{default:O.template},variables:O.variables})},placeholder:n("package__features:context_menu__lite_editor__modal__edit_tool__prompt_template__placeholder")}))),rt.default.createElement(g,{onMouseEnter:x,onMouseLeave:_,sx:{gap:"16px",flexWrap:"wrap",width:"100%",pt:"16px",...h}},rt.default.createElement(g,{gap:"4px"},rt.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__label")),rt.default.createElement(g,{direction:"row",gap:"4px"},rt.default.createElement(Vy,{defaultValue:f?.prompt_icon,onChange:O=>{u({prompt_icon:O})}}),rt.default.createElement(zt,{error:a,helperText:l,inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{fontSize:"12px"}},size:"small",fullWidth:!0,placeholder:n("package__features:context_menu__lite_editor__modal__edit_tool__variable_name__placeholder"),defaultValue:f?.prompt_title||"",onKeyDownCapture:O=>{if(O.stopPropagation(),O.key==="Escape"){if(P())return;m()}O.key==="Enter"&&f?.prompt_title&&f.prompt_template?.default&&(O.preventDefault(),c.current?.submit())},onKeyUpCapture:O=>{O.stopPropagation()},onKeyDown:O=>{O.stopPropagation()},onKeyUp:O=>{O.stopPropagation()},onKeyPress:O=>{O.stopPropagation()},onKeyPressCapture:O=>{O.stopPropagation()},onChange:O=>{u({prompt_title:O.target.value})}}))),!f?.prompt_id&&rt.default.createElement(g,{gap:"4px"},rt.default.createElement(T,{fontWeight:500,fontSize:"16px",color:"text.primary",textAlign:"left"},n("package__features:context_menu__lite_editor__modal__edit_tool__variable_parent_group__label")),rt.default.createElement(Py,{contextMenuPath:r||"",sx:{width:"100%",height:"40px"},defaultValue:f?.parent_prompt_id||"",onChange:O=>{u({parent_prompt_id:O})}}))))),rt.default.createElement(ky,null),rt.default.createElement(Uy,null))},Wy=u7;var Kr=I(E()),m7=e=>{let{defaultContextMenuPath:t,defaultMode:o,children:n,panelId:r}=e,[i,a]=(0,Kr.useState)(o||"list"),[s,l]=(0,Kr.useState)(t!==void 0?t:null),c={panelId:(0,Kr.useRef)(r||Xo()).current,contextMenuPath:s,mode:i,changeMode:a,changeContextMenuPath:l};return Kr.default.createElement(mC.Provider,{value:c},Kr.default.createElement(Kr.default.Fragment,null,n,Kr.default.createElement(Wy,null),Kr.default.createElement(Ey,null)))},ka=m7;var ms=I(E()),Yy=I(Gs());var Lm=I(E()),d7=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},e(t,o)};return function(t,o){e(t,o);function n(){this.constructor=t}t.prototype=o===null?Object.create(o):(n.prototype=o.prototype,new n)}}(),So=function(){return So=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},So.apply(this,arguments)},Gy={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},jy={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},km={width:"20px",height:"20px",position:"absolute"},f7={top:So(So({},Gy),{top:"-5px"}),right:So(So({},jy),{left:void 0,right:"-5px"}),bottom:So(So({},Gy),{top:void 0,bottom:"-5px"}),left:So(So({},jy),{left:"-5px"}),topRight:So(So({},km),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:So(So({},km),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:So(So({},km),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:So(So({},km),{left:"-10px",top:"-10px",cursor:"nw-resize"})},qy=function(e){d7(t,e);function t(){var o=e!==null&&e.apply(this,arguments)||this;return o.onMouseDown=function(n){o.props.onResizeStart(n,o.props.direction)},o.onTouchStart=function(n){o.props.onResizeStart(n,o.props.direction)},o}return t.prototype.render=function(){return Lm.createElement("div",{className:this.props.className||"",style:So(So({position:"absolute",userSelect:"none"},f7[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(Lm.PureComponent);var h7=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},e(t,o)};return function(t,o){e(t,o);function n(){this.constructor=t}t.prototype=o===null?Object.create(o):(n.prototype=o.prototype,new n)}}(),Si=function(){return Si=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++){t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},Si.apply(this,arguments)},g7={width:"auto",height:"auto"},Om=function(e,t,o){return Math.max(Math.min(e,o),t)},Ky=function(e,t,o){var n=Math.round(e/t);return n*t+o*(n-1)},Ll=function(e,t){return new RegExp(e,"i").test(t)},Bm=function(e){return!!(e.touches&&e.touches.length)},x7=function(e){return!!((e.clientX||e.clientX===0)&&(e.clientY||e.clientY===0))},$y=function(e,t,o){o===void 0&&(o=0);var n=t.reduce(function(i,a,s){return Math.abs(a-e)<Math.abs(t[i]-e)?s:i},0),r=Math.abs(t[n]-e);return o===0||r<o?t[n]:e},_h=function(e){return e=e.toString(),e==="auto"||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},Dm=function(e,t,o,n){if(e&&typeof e=="string"){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%")){var r=Number(e.replace("%",""))/100;return t*r}if(e.endsWith("vw")){var r=Number(e.replace("vw",""))/100;return o*r}if(e.endsWith("vh")){var r=Number(e.replace("vh",""))/100;return n*r}}return e},_7=function(e,t,o,n,r,i,a){return n=Dm(n,e.width,t,o),r=Dm(r,e.height,t,o),i=Dm(i,e.width,t,o),a=Dm(a,e.height,t,o),{maxWidth:typeof n>"u"?void 0:Number(n),maxHeight:typeof r>"u"?void 0:Number(r),minWidth:typeof i>"u"?void 0:Number(i),minHeight:typeof a>"u"?void 0:Number(a)}},C7=function(e){return Array.isArray(e)?e:[e,e]},y7=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Xy="__resizable_base__",Zy=function(e){h7(t,e);function t(o){var n,r,i,a,s=e.call(this,o)||this;return s.ratio=1,s.resizable=null,s.parentLeft=0,s.parentTop=0,s.resizableLeft=0,s.resizableRight=0,s.resizableTop=0,s.resizableBottom=0,s.targetLeft=0,s.targetTop=0,s.appendBase=function(){if(!s.resizable||!s.window)return null;var l=s.parentNode;if(!l)return null;var p=s.window.document.createElement("div");return p.style.width="100%",p.style.height="100%",p.style.position="absolute",p.style.transform="scale(0, 0)",p.style.left="0",p.style.flex="0 0 100%",p.classList?p.classList.add(Xy):p.className+=Xy,l.appendChild(p),p},s.removeBase=function(l){var p=s.parentNode;p&&p.removeChild(l)},s.state={isResizing:!1,width:(r=(n=s.propsSize)===null||n===void 0?void 0:n.width)!==null&&r!==void 0?r:"auto",height:(a=(i=s.propsSize)===null||i===void 0?void 0:i.height)!==null&&a!==void 0?a:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},s.onResizeStart=s.onResizeStart.bind(s),s.onMouseMove=s.onMouseMove.bind(s),s.onMouseUp=s.onMouseUp.bind(s),s}return Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||g7},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var o=0,n=0;if(this.resizable&&this.window){var r=this.resizable.offsetWidth,i=this.resizable.offsetHeight,a=this.resizable.style.position;a!=="relative"&&(this.resizable.style.position="relative"),o=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:r,n=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:i,this.resizable.style.position=a}return{width:o,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var o=this,n=this.props.size,r=function(s){var l;if(typeof o.state[s]>"u"||o.state[s]==="auto")return"auto";if(o.propsSize&&o.propsSize[s]&&(!((l=o.propsSize[s])===null||l===void 0)&&l.toString().endsWith("%"))){if(o.state[s].toString().endsWith("%"))return o.state[s].toString();var p=o.getParentSize(),c=Number(o.state[s].toString().replace("px","")),u=c/p[s]*100;return u+"%"}return _h(o.state[s])},i=n&&typeof n.width<"u"&&!this.state.isResizing?_h(n.width):r("width"),a=n&&typeof n.height<"u"&&!this.state.isResizing?_h(n.height):r("height");return{width:i,height:a}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var o=this.appendBase();if(!o)return{width:0,height:0};var n=!1,r=this.parentNode.style.flexWrap;r!=="wrap"&&(n=!0,this.parentNode.style.flexWrap="wrap"),o.style.position="relative",o.style.minWidth="100%",o.style.minHeight="100%";var i={width:o.offsetWidth,height:o.offsetHeight};return n&&(this.parentNode.style.flexWrap=r),this.removeBase(o),i},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var o=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:o.flexBasis!=="auto"?o.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(o,n){var r=this.propsSize&&this.propsSize[n];return this.state[n]==="auto"&&this.state.original[n]===o&&(typeof r>"u"||r==="auto")?"auto":o},t.prototype.calculateNewMaxFromBoundary=function(o,n){var r=this.props.boundsByDirection,i=this.state.direction,a=r&&Ll("left",i),s=r&&Ll("top",i),l,p;if(this.props.bounds==="parent"){var c=this.parentNode;c&&(l=a?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),p=s?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=a?this.resizableRight:this.window.innerWidth-this.resizableLeft,p=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=a?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),p=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(o=o&&o<l?o:l),p&&Number.isFinite(p)&&(n=n&&n<p?n:p),{maxWidth:o,maxHeight:n}},t.prototype.calculateNewSizeFromDirection=function(o,n){var r=this.props.scale||1,i=C7(this.props.resizeRatio||1),a=i[0],s=i[1],l=this.state,p=l.direction,c=l.original,u=this.props,m=u.lockAspectRatio,d=u.lockAspectRatioExtraHeight,f=u.lockAspectRatioExtraWidth,h=c.width,_=c.height,x=d||0,C=f||0;return Ll("right",p)&&(h=c.width+(o-c.x)*a/r,m&&(_=(h-C)/this.ratio+x)),Ll("left",p)&&(h=c.width-(o-c.x)*a/r,m&&(_=(h-C)/this.ratio+x)),Ll("bottom",p)&&(_=c.height+(n-c.y)*s/r,m&&(h=(_-x)*this.ratio+C)),Ll("top",p)&&(_=c.height-(n-c.y)*s/r,m&&(h=(_-x)*this.ratio+C)),{newWidth:h,newHeight:_}},t.prototype.calculateNewSizeFromAspectRatio=function(o,n,r,i){var a=this.props,s=a.lockAspectRatio,l=a.lockAspectRatioExtraHeight,p=a.lockAspectRatioExtraWidth,c=typeof i.width>"u"?10:i.width,u=typeof r.width>"u"||r.width<0?o:r.width,m=typeof i.height>"u"?10:i.height,d=typeof r.height>"u"||r.height<0?n:r.height,f=l||0,h=p||0;if(s){var _=(m-f)*this.ratio+h,x=(d-f)*this.ratio+h,C=(c-h)/this.ratio+f,y=(u-h)/this.ratio+f,b=Math.max(c,_),v=Math.min(u,x),S=Math.max(m,C),M=Math.min(d,y);o=Om(o,b,v),n=Om(n,S,M)}else o=Om(o,c,u),n=Om(n,m,d);return{newWidth:o,newHeight:n}},t.prototype.setBoundingClientRect=function(){var o=1/(this.props.scale||1);if(this.props.bounds==="parent"){var n=this.parentNode;if(n){var r=n.getBoundingClientRect();this.parentLeft=r.left*o,this.parentTop=r.top*o}}if(this.props.bounds&&typeof this.props.bounds!="string"){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left*o,this.targetTop=i.top*o}if(this.resizable){var a=this.resizable.getBoundingClientRect(),s=a.left,l=a.top,p=a.right,c=a.bottom;this.resizableLeft=s*o,this.resizableRight=p*o,this.resizableTop=l*o,this.resizableBottom=c*o}},t.prototype.onResizeStart=function(o,n){if(!(!this.resizable||!this.window)){var r=0,i=0;if(o.nativeEvent&&x7(o.nativeEvent)?(r=o.nativeEvent.clientX,i=o.nativeEvent.clientY):o.nativeEvent&&Bm(o.nativeEvent)&&(r=o.nativeEvent.touches[0].clientX,i=o.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var a=this.props.onResizeStart(o,n,this.resizable);if(a===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var s,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var p=this.parentNode;if(p){var c=this.window.getComputedStyle(p).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",s=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var u={original:{x:r,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:Si(Si({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(o.target).cursor||"auto"}),direction:n,flexBasis:s};this.setState(u)}},t.prototype.onMouseMove=function(o){var n=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&Bm(o))try{o.preventDefault(),o.stopPropagation()}catch{}var r=this.props,i=r.maxWidth,a=r.maxHeight,s=r.minWidth,l=r.minHeight,p=Bm(o)?o.touches[0].clientX:o.clientX,c=Bm(o)?o.touches[0].clientY:o.clientY,u=this.state,m=u.direction,d=u.original,f=u.width,h=u.height,_=this.getParentSize(),x=_7(_,this.window.innerWidth,this.window.innerHeight,i,a,s,l);i=x.maxWidth,a=x.maxHeight,s=x.minWidth,l=x.minHeight;var C=this.calculateNewSizeFromDirection(p,c),y=C.newHeight,b=C.newWidth,v=this.calculateNewMaxFromBoundary(i,a);this.props.snap&&this.props.snap.x&&(b=$y(b,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(y=$y(y,this.props.snap.y,this.props.snapGap));var S=this.calculateNewSizeFromAspectRatio(b,y,{width:v.maxWidth,height:v.maxHeight},{width:s,height:l});if(b=S.newWidth,y=S.newHeight,this.props.grid){var M=Ky(b,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),P=Ky(y,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),O=this.props.snapGap||0,L=O===0||Math.abs(M-b)<=O?M:b,H=O===0||Math.abs(P-y)<=O?P:y;b=L,y=H}var z={width:b-d.width,height:y-d.height};if(f&&typeof f=="string"){if(f.endsWith("%")){var R=b/_.width*100;b=R+"%"}else if(f.endsWith("vw")){var V=b/this.window.innerWidth*100;b=V+"vw"}else if(f.endsWith("vh")){var F=b/this.window.innerHeight*100;b=F+"vh"}}if(h&&typeof h=="string"){if(h.endsWith("%")){var R=y/_.height*100;y=R+"%"}else if(h.endsWith("vw")){var V=y/this.window.innerWidth*100;y=V+"vw"}else if(h.endsWith("vh")){var F=y/this.window.innerHeight*100;y=F+"vh"}}var q={width:this.createSizeForCssProperty(b,"width"),height:this.createSizeForCssProperty(y,"height")};this.flexDir==="row"?q.flexBasis=q.width:this.flexDir==="column"&&(q.flexBasis=q.height);var X=this.state.width!==q.width,W=this.state.height!==q.height,j=this.state.flexBasis!==q.flexBasis,w=X||W||j;w&&(0,Yy.flushSync)(function(){n.setState(q)}),this.props.onResize&&w&&this.props.onResize(o,m,this.resizable,z)}},t.prototype.onMouseUp=function(o){var n,r,i=this.state,a=i.isResizing,s=i.direction,l=i.original;if(!(!a||!this.resizable)){var p={width:this.size.width-l.width,height:this.size.height-l.height};this.props.onResizeStop&&this.props.onResizeStop(o,s,this.resizable,p),this.props.size&&this.setState({width:(n=this.props.size.width)!==null&&n!==void 0?n:"auto",height:(r=this.props.size.height)!==null&&r!==void 0?r:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:Si(Si({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(o){var n,r;this.setState({width:(n=o.width)!==null&&n!==void 0?n:"auto",height:(r=o.height)!==null&&r!==void 0?r:"auto"})},t.prototype.renderResizer=function(o){var n=this,r=this.props,i=r.enable,a=r.handleStyles,s=r.handleClasses,l=r.handleWrapperStyle,p=r.handleWrapperClass,c=r.handleComponent;if(!i)return null;var u=o.filter(function(m){return i[m]!==!1}).map(function(m){return i[m]!==!1?ms.createElement(qy,{key:m,direction:m,onResizeStart:n.onResizeStart,replaceStyles:a&&a[m],className:s&&s[m]},c&&c[m]?c[m]:null):null});return ms.createElement("div",{className:p,style:l},u)},t.prototype.render=function(){var o=this,n=Object.keys(this.props).reduce(function(a,s){return y7.indexOf(s)!==-1||(a[s]=o.props[s]),a},{}),r=Si(Si(Si({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(r.flexBasis=this.state.flexBasis);var i=this.props.as||"div";return ms.createElement(i,Si({style:r,className:this.props.className},n,{ref:function(a){a&&(o.resizable=a)}}),this.state.isResizing&&ms.createElement("div",{style:this.state.backgroundStyle}),this.renderResizer(["topLeft","top","topRight","left"]),this.props.children,this.renderResizer(["right","bottomLeft","bottom","bottomRight"]))},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(ms.PureComponent);var b7=({children:e})=>Q0!=="prod"||Vs?e:null,Fm=b7;var Ol=I(Qy());var Ie=I(E()),Jy=e=>{let{conversationId:t}=e,o=(0,Ie.useRef)(null),[n,r]=(0,Ie.useState)([]),i=Tn(()=>{if(o.current){let s=o.current?.querySelector(".max-ai__action_status__loading");s?o.current?.scrollTo({top:s.offsetTop-s.offsetHeight/2-o.current.offsetHeight/2,behavior:"smooth"}):o.current?.scrollTo({top:o.current?.scrollHeight,behavior:"smooth"})}},200);(0,Ie.useEffect)(()=>{let{shortcutsEngine:s}=um(t);if(!s)return;let l=(p,c)=>{let u=Ee(c.shortcutsEngine.actions);r(u)};return s.addListener(l),()=>{s.removeListener(l)}},[t]),(0,Ie.useEffect)(()=>{i()},[n]);let a=(s,l=0)=>s.map((p,c)=>{let u="#ebebeb",m="text.primary";p.status==="running"?(u="primary.main",m="primary.main"):p.status==="error"?(u="error.main",m="error.main"):p.status==="complete"&&(u="success.main",m="success.main");let d=p.type==="ASK_CHATGPT",f=d?p.question:"",h=p.status==="complete",_=h?p.output:p.error;typeof f=="object"&&(f=JSON.stringify(f,null,2)),p.type==="SET_VARIABLES_MODAL"?_=JSON.stringify(p.parameters.SetVariablesModalConfig,null,2):p.type==="SET_VARIABLE_MAP"?_=JSON.stringify(p.parameters.VariableMap,null,2):typeof _=="object"&&(_=JSON.stringify(_,null,2));let x=JSON.stringify(p.parameters,null,2);return Ie.default.createElement(g,{key:p.type+c+l,sx:{px:1,alignItems:"center"}},Ie.default.createElement(yr,{PopperProps:{disablePortal:!0,sx:{zIndex:2147483647}},placement:"right",title:Ie.default.createElement(g,{sx:{maxHeight:500,overflowY:"auto",gap:1}},`[${p.type}]`,d&&Ie.default.createElement(g,null,Ie.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[Question]",Ie.default.createElement(An,{copyText:f,sx:{color:"text.primary",height:"12px"}})),Ie.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},f)),Ie.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},"[parameters]",Ie.default.createElement(An,{copyText:x,sx:{color:"text.primary",height:"12px"}})),Ie.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},x),Ie.default.createElement(T,{fontSize:"12px",display:"flex",alignItems:"center",gap:1},h?"[Answer]":"[Error]",Ie.default.createElement(An,{copyText:_,sx:{color:"text.primary",height:"12px"}})),Ie.default.createElement(T,{sx:{whiteSpace:"pre-wrap"},fontSize:"12px"},_))},Ie.default.createElement(g,{className:p.status==="running"?"max-ai__action_status__loading":"",sx:{width:"100%",border:"1px solid",alignItems:"center",justifyContent:"center",borderColor:u,color:m,fontSize:"12px",borderRadius:"4px",position:"relative",padding:"8px 4px"}},p.status==="running"&&Ie.default.createElement(g,{sx:{position:"absolute",right:1,top:1}},Ie.default.createElement(Lt,{size:16,thickness:4,color:"inherit",variant:"indeterminate",sx:{color:m}})),Ie.default.createElement(g,{direction:"row",alignItems:"center",gap:1,height:16,width:"100%"},p.status!=="idle"&&p.status!=="running"&&Ie.default.createElement(An,{sx:{flexShrink:0},size:"small",copyText:JSON.stringify(p)}),Ie.default.createElement(T,{noWrap:!0,fontSize:"12px"},p.type)))),p.type==="SCRIPTS_CONDITIONAL"&&p.status==="complete"&&Ie.default.createElement(g,{direction:"row",gap:1,mt:1},Ie.default.createElement(g,null,p.output==="true"?Ie.default.createElement(Ol.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)",marginLeft:"auto"}}):Ie.default.createElement(g,{height:16}),Ie.default.createElement(g,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:p.output==="true"?"success.main":"error.main"}},a(p.parameters.WFConditionalIfTrueActions||[],l+1)),p.output==="true"?Ie.default.createElement(Ol.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)",marginLeft:"auto"}}):Ie.default.createElement(g,{height:16})),Ie.default.createElement(g,null,p.output==="false"?Ie.default.createElement(Ol.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(-45deg)"}}):Ie.default.createElement(g,{height:16}),Ie.default.createElement(g,{sx:{p:.5,borderRadius:"4px",border:"1px solid",borderColor:p.output==="false"?"success.main":"error.main"}},a(p.parameters.WFConditionalIfFalseActions||[],l+1)),p.output==="false"?Ie.default.createElement(Ol.default,{sx:{fontSize:"11px",mt:.5,transform:"rotate(45deg)"}}):Ie.default.createElement(g,{height:16}))),p.type!=="SCRIPTS_CONDITIONAL"&&c+1!==s.length&&Ie.default.createElement(Ol.default,{sx:{fontSize:"11px",mt:.5}}))});return Ie.default.createElement(Fm,null,Ie.default.createElement(g,{width:"100%",sx:{flexShrink:0,gap:1,overflowY:"auto",maxHeight:500},ref:o},Ie.default.createElement(g,null,"ConversationId: ",t),Ie.default.createElement(g,{sx:{position:"sticky",top:0,p:1,bgcolor:"background.paper",zIndex:1}},"Actions"),a(n)))};var vo=I(E());var T7=()=>{let[e,t]=vo.default.useState(!1),{conversationIds:o,chatDocuments:n}=he(r=>({conversationIds:r.conversationIds,chatDocuments:r.chatDocuments}));return vo.default.createElement(g,null,vo.default.createElement(de,{onClick:()=>t(!e)},e?"Collapse":"Expand"),vo.default.createElement(g,{gap:"8px",direction:"row"},vo.default.createElement(g,{width:"66%",gap:"8px",direction:"row",flexWrap:"wrap"},o.map((r,i)=>vo.default.createElement(M7,{expanded:e,key:r,conversationId:r,order:i}))),vo.default.createElement(g,{width:"33%",gap:"8px"},vo.default.createElement(T,{color:"text.primary"},"Chat Documents"),n.map(r=>vo.default.createElement(w7,{expanded:e,key:r.id,chatDocument:r})))))},w7=e=>{let{chatDocument:t,expanded:o}=e,{document:n}=am(t.maxAIDocumentId);return vo.default.createElement(g,{sx:{width:"100%",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",whiteSpace:"pre-wrap",overflow:"auto",wordBreak:"break-all",maxHeight:o?"unset":"auto"}},JSON.stringify(t,null,2),vo.default.createElement("br",null),o&&JSON.stringify(n||{},null,2))},M7=e=>{let{conversationId:t,order:o,expanded:n}=e,r=Uo(t),i=$t(Z_(t)),a=$t(om(t));return vo.default.createElement(g,{sx:{width:"calc(50% - 4px)",border:"1px solid",borderColor:"border.main",padding:"8px",fontSize:"12px",color:"text.primary",gap:"8px",maxHeight:n?"unset":"auto"}},vo.default.createElement("div",null,"conversationId:",vo.default.createElement("br",null),t),vo.default.createElement("div",null,"order: ",o),vo.default.createElement("div",null,"chatBoxLoading: ",i?"\u{1F4AB}":"\u2705"),vo.default.createElement("div",null,"chatBoxShortcutsStatus: ",a),vo.default.createElement(Jy,{conversationId:t}),n&&vo.default.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"}},JSON.stringify(r,null,2)))},eb=T7;var gn=I(E()),E7=Np.reduce((e,t)=>{let o=t[0].toUpperCase();return e[o]||(e[o]=[]),e[o].push(t),e},{}),A7=Zs(Object.entries(E7).map(([e,t])=>({key:e,value:t})),"key","asc"),P7=()=>gn.default.createElement(g,{gap:"16px"},gn.default.createElement(g,null,gn.default.createElement(T,{color:"text.primary"},"Contextmenu icons")),gn.default.createElement(g,null,gn.default.createElement(fi,{href:"https://mui.com/material-ui/material-icons/?theme=Outlined",target:"_blank"},"MUI icons")),gn.default.createElement(T,{color:"text.primary"},"Total"),gn.default.createElement(g,{direction:"row",flexWrap:"wrap",gap:"8px"},Np.map(e=>gn.default.createElement(se,{onClick:()=>{navigator.clipboard.writeText(e)},title:e,sx:{border:"1px solid",borderColor:"border.main",padding:"0"}},gn.default.createElement(G,{icon:e,sx:{fontSize:"24px"}})))),A7.map(e=>gn.default.createElement(g,{key:e.key,gap:"4px"},gn.default.createElement(T,{color:"text.primary"},e.key),gn.default.createElement(g,{direction:"row",flexWrap:"wrap",gap:"8px"},e.value.map(t=>gn.default.createElement(se,{onClick:()=>{navigator.clipboard.writeText(t)},sx:{width:"unset",border:"1px solid",borderColor:"border.main",padding:"0 8px",gap:"4px"}},gn.default.createElement(G,{icon:t,sx:{fontSize:"24px"}}),gn.default.createElement(T,{color:"text.primary"},t))))))),tb=P7;var La=I(E()),k7=()=>{let{devShowAuxiliaryLine:e,devAlwaysShowTooltip:t,devAlwaysExpandAllButtons:o,updateQuickAccessDevContent:n}=NC();return La.default.createElement(g,null,La.default.createElement("label",null,La.default.createElement("input",{type:"checkbox",checked:e,onChange:()=>n({showAuxiliaryLine:!e})}),"\u663E\u793A\u8F85\u52A9\u7EBF"),La.default.createElement("label",null,La.default.createElement("input",{type:"checkbox",checked:t,onChange:()=>n({alwaysShowTooltip:!t})}),"\u603B\u662F\u663E\u793Atooltip"),La.default.createElement("label",null,La.default.createElement("input",{type:"checkbox",checked:o,onChange:()=>n({alwaysExpandAllButtons:!o})}),"\u603B\u662F\u5C55\u5F00\u6240\u6709\u6309\u94AE"))},ob=k7;var Gi=I(E()),L7=()=>Gi.default.createElement(g,null,Gi.default.createElement(g,null,Gi.default.createElement(T,null,"Indexed DB")),Gi.default.createElement(g,null,Gi.default.createElement(de,{onClick:async()=>{await Q2(U_,"documents").clear().then(),window.location.reload()}},"Clear Document"),Gi.default.createElement(de,{onClick:async()=>{await Rn.set({CHROME_EXTENSION_USE_CHAT_GPT_AI_ON_BOARDING_SAVE_KEY:""}),await Rn.set({[TC]:""})}},"Clear Onboarding"),Gi.default.createElement(de,{onClick:async()=>{await Ue.resetOnboardingData()}},"Clear maxai-client Onboarding settings"),Gi.default.createElement(de,{onClick:async()=>{await Ju.getService("CONTEXT_MENU_SUGGEST").clearUsageHistory()}},"Clear [CONTEXT_MENU] suggestion"))),nb=L7;var xn=I(E());var Bl=I(E()),O7=()=>{let e=document.createElement("style");e.id="debug-react-component-style",e.textContent=`
    .maxai_debug_react_component {
      outline: 1px solid red;
    }

    .maxai_need_relative {
      position: relative;
    }
  `;let t=Ch();return t&&!t.getElementById("debug-react-component-style")&&t.insertBefore(e,t.firstChild),()=>{let r=Ch()?.getElementById("debug-react-component-style");r&&r.parentNode&&r.parentNode.removeChild(r)}},Ch=()=>document.querySelector("use-chat-gpt-ai")?.shadowRoot,B7=({name:e})=>{let t=document.createElement("div");return t.classList.add("maxai_debug_react_component_helper"),t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="rgba(0, 0, 0, 0)",t.style.color="white",t.style.zIndex="1",t.textContent=e,t},D7=()=>{let[e,t]=(0,Bl.useState)(!1),o=()=>{let n=!e;t(n);let r=Ch()?.querySelectorAll("[data-debug-react-component]");r&&(r.forEach(i=>{}),r.forEach(i=>{n?(i.classList.add("maxai_debug_react_component"),window.getComputedStyle(i).getPropertyValue("position")==="static"&&i.classList.add("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")||i.appendChild(B7({name:i.getAttribute("data-debug-react-component")}))):(i.classList.remove("maxai_debug_react_component"),i.classList.remove("maxai_need_relative"),i.querySelector(".maxai_debug_react_component_name")?.remove())}))};return(0,Bl.useEffect)(()=>{let n=O7();return()=>n()},[]),Bl.default.createElement("button",{onClick:o},e?"\u5173\u95ED":"\u5F00\u542F")},rb=D7;var ib=[{label:"ChatHub",value:"ChatHub"},{label:"ReactComponent",value:"ReactComponent"},{label:"QuickAccess",value:"QuickAccess"},{label:"Storage",value:"Storage"},{label:"Icons",value:"Icons"}],F7=()=>{let[e,t]=xn.default.useState(ib[0].value);return xn.default.createElement(g,{sx:{width:"100%",height:"100%",flex:1}},xn.default.createElement(R2,{value:e,onChange:(n,r)=>{t(r)},variant:"scrollable",scrollButtons:"auto"},ib.map(n=>xn.default.createElement(z2,{key:n.value,value:n.value,label:n.label}))),xn.default.createElement(qp,{active:e==="ChatHub",keepAlive:!0},xn.default.createElement(eb,null)),xn.default.createElement(qp,{active:e==="ReactComponent"},xn.default.createElement(rb,null)),xn.default.createElement(qp,{active:e==="QuickAccess"},xn.default.createElement(ob,null)),xn.default.createElement(qp,{active:e==="Storage"},xn.default.createElement(nb,null)),xn.default.createElement(qp,{active:e==="Icons"},xn.default.createElement(tb,null)))},qp=e=>{let{active:t,keepAlive:o=!1}=e;return xn.default.createElement(g,{sx:{width:"100%",height:0,flex:1,display:t?"block":"none",padding:2,textAlign:"left"}},o||t?e.children:null)},ab=F7;var gb=I(lb());var Vt=I(E());var ub=I(Y1()),mb=I(pb()),db=I(cb());var ji=I(E());var Vm=il(e=>({message:"",type:"info",show:!1,setToast:(t,o)=>e({message:t,type:o,show:!0}),hideToast:()=>e({show:!1})})),yh={info:e=>Vm.getState().setToast(e,"info"),success:e=>Vm.getState().setToast(e,"success"),error:e=>Vm.getState().setToast(e,"error")},j7=()=>{let{message:e,type:t,show:o,hideToast:n}=Vm(),[r,i]=(0,ji.useState)(!1);if((0,ji.useEffect)(()=>{if(o){let l=setTimeout(()=>{i(!0),setTimeout(()=>{n(),i(!1)},200)},1e3);return()=>clearTimeout(l)}},[o,n]),!o)return null;let a=()=>{switch(t){case"success":return"#4caf50";case"error":return"#f44336";default:return"#2196f3"}};return ji.default.createElement(g,{direction:"row",alignItems:"center",gap:1.5,sx:{position:"fixed",bottom:"24px",right:"24px",backgroundColor:"rgba(33, 33, 33, 0.95)",color:"#fff",padding:"10px 16px",borderRadius:"6px",zIndex:2147483701,transition:"all 0.2s ease",opacity:r?0:1,transform:r?"translateY(10px)":"translateY(0)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",fontSize:"14px",fontWeight:500,minWidth:"200px",maxWidth:"400px",backdropFilter:"blur(8px)","&::before":{content:'""',position:"absolute",inset:0,borderRadius:"6px",padding:"1px",background:"linear-gradient(to bottom right, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.05))",WebkitMask:"linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0)",WebkitMaskComposite:"xor",maskComposite:"exclude"}}},(()=>{let l={sx:{color:a(),fontSize:20}};switch(t){case"success":return ji.default.createElement(ub.default,{...l});case"error":return ji.default.createElement(mb.default,{...l});default:return ji.default.createElement(db.default,{...l})}})(),e)},fb=j7;var Rt=I(E());var q7={position:"fixed",border:"2px solid #1976d2",background:"rgba(25, 118, 210, 0.1)",pointerEvents:"none",zIndex:2147483700,boxSizing:"border-box",borderRadius:"4px"},K7={position:"fixed",background:"rgba(0, 0, 0, 0.8)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",pointerEvents:"none",zIndex:2147483701,left:"16px",bottom:"16px",whiteSpace:"nowrap"},hb=(e,t)=>{let{sourcePathAttribute:o,tooltipConfig:n}=t,[r,i]=(0,Rt.useState)(!1),[a,s]=(0,Rt.useState)(null),l=(0,Rt.useRef)(null),p=(0,Rt.useRef)(null),c=(0,Rt.useRef)(null),u=(0,Rt.useCallback)(P=>e.querySelector('[data-testid="dev-tools-button"]')?.contains(P),[e]),m=(0,Rt.useCallback)(()=>{if(!e||l.current)return;let P=document.createElement("div");return P.id="component-highlight",Object.assign(P.style,q7),e.appendChild(P),l.current=P,P},[e]),d=(0,Rt.useCallback)(()=>{if(!e||p.current)return;let P=document.createElement("div");return P.id="component-tooltip",Object.assign(P.style,K7),e.appendChild(P),p.current=P,P},[e]),f=(0,Rt.useCallback)(P=>{let O=P.getAttribute(o);if(!O||n?.show===!1)return null;let L=O,H="\u6587\u4EF6\u8DEF\u5F84";if(!n?.attribute)return{title:H,content:L};let z=P.getAttribute(n.attribute);return z?(H=n.attribute,L=z,{title:H,content:L}):n.showDefaultInfo?{title:H,content:L}:null},[o,n]),h=(0,Rt.useCallback)(P=>{if(!e)return;let O=l.current||m(),L=p.current||d();if(!O||!L)return;let H=P.getBoundingClientRect();Object.assign(O.style,{left:`${H.left}px`,top:`${H.top}px`,width:`${H.width}px`,height:`${H.height}px`,display:"block"});let z=f(P);if(z){let{title:R,content:V}=z;L.textContent=`${R}: ${V}\uFF08\u6309 C \u590D\u5236\uFF09`,L.style.display="block",c.current=V}else c.current=null,L.style.display="none"},[e,m,d,f]),_=(0,Rt.useCallback)(P=>{if(!r||u(P.target))return;let O=P.target;s(O),h(O)},[r,h,u]),x=(0,Rt.useCallback)(()=>{l.current&&(l.current.style.display="none"),p.current&&(p.current.style.display="none")},[]),C=(0,Rt.useCallback)(()=>{i(!1),s(null),x()},[x]),y=(0,Rt.useCallback)(P=>{C(),requestAnimationFrame(()=>{window.open(P,"_blank")})},[C]),b=(0,Rt.useCallback)(P=>{!r||u(P.target)||(x(),s(null))},[r,x,u]),v=(0,Rt.useCallback)(P=>{if(!r||u(P.target))return;let L=P.target.getAttribute(o);L&&(P.stopPropagation(),P.preventDefault(),y(L))},[r,y,u,o]),S=(0,Rt.useCallback)(P=>{r&&(P.preventDefault(),P.stopPropagation(),i(!1),s(null),x())},[r,x]),M=(0,Rt.useRef)(null);return(0,Rt.useEffect)(()=>{r?yh.success("\u5DF2\u5F00\u542F\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"):M.current&&yh.info("\u5DF2\u5173\u95ED\u7EC4\u4EF6\u6620\u5C04\u5DE5\u5177"),M.current=r},[r]),(0,Rt.useEffect)(()=>{let P=O=>{if(O.code==="KeyX"&&O.metaKey&&O.altKey){if(O.preventDefault(),O.stopPropagation(),O.shiftKey){i(!1),s(null),x(),l.current&&(l.current.remove(),l.current=null);return}r?(i(!1),s(null),x()):i(!0)}O.code==="KeyC"&&r&&c.current&&(O.preventDefault(),navigator.clipboard.writeText(c.current).then(()=>{let L=p.current.textContent;p.current.textContent="\u5DF2\u590D\u5236\uFF01",setTimeout(()=>{p.current&&(p.current.textContent=L)},1e3)}).catch(console.error)),O.key==="Escape"&&r&&(i(!1),s(null),x())};return window.addEventListener("keydown",P,!0),()=>{window.removeEventListener("keydown",P,!0)}},[r,x]),(0,Rt.useEffect)(()=>{if(e)return r&&(e.addEventListener("mouseover",_,!0),e.addEventListener("mouseout",b,!0),e.addEventListener("click",v,!0),e.addEventListener("contextmenu",S,!0)),()=>{e.removeEventListener("mouseover",_,!0),e.removeEventListener("mouseout",b,!0),e.removeEventListener("click",v,!0),e.removeEventListener("contextmenu",S,!0)}},[r,_,b,v,S,e]),(0,Rt.useEffect)(()=>()=>{l.current&&(l.current.remove(),l.current=null),p.current&&(p.current.remove(),p.current=null)},[]),{needOpenIDE:r,setNeedOpenIDE:i,currentHoverElement:a}};var Um="maxa-devtools-cache",Dl=il(e=>({open:!1,setOpen:t=>e({open:t}),position:{x:0,y:0},size:{width:300,height:200},setPosition:t=>e({position:t}),setSize:t=>e({size:t})})),$7=e=>{let o=Math.max(Math.min(e.position.x,window.innerWidth-e.size.width),10),n=Math.max(Math.min(e.position.y,window.innerHeight-e.size.height),10),r=Math.min(e.size.width,window.innerWidth-10),i=Math.min(e.size.height,window.innerHeight-10);return{position:{x:o,y:n},size:{width:r,height:i}}},bh=()=>{let e=Dl(p=>p.open),t=Dl(p=>p.position),o=Dl(p=>p.size),n=Dl(p=>p.setPosition),r=Dl(p=>p.setSize),i=Dl(p=>p.setOpen);return(0,Vt.useEffect)(()=>{Rn.getItem(Um).then(p=>{if(p){let{position:c,size:u}=$7(p);n(c),r(u),i(p.open)}})},[]),{position:t,size:o,setPosition:p=>{n(p),Rn.setItem(Um,{open:e,position:p,size:o})},setSize:p=>{r(p),Rn.setItem(Um,{open:e,position:t,size:p})},setOpen:p=>{i(p),Rn.setItem(Um,{open:p,position:t,size:o})},open:e}},X7=e=>{let{sx:t,...o}=e.fabProps||{},{position:n,setPosition:r}=bh(),i=(0,Vt.useRef)(null),a=(0,Vt.useRef)(!1),s=(0,Vt.useRef)(!1),l=(0,Vt.useRef)({x:0,y:0}),p=f=>{if(i.current){a.current=!0;let h=i.current.getBoundingClientRect();l.current={x:f.clientX-h.left,y:f.clientY-h.top}}},c=()=>{s.current||e.onToolsClick()},u=(0,Vt.useCallback)(f=>{if(a.current){s.current=!0;let h=f.clientX-l.current.x,_=f.clientY-l.current.y,x=window.innerWidth-44,C=window.innerHeight-44;r({x:Math.min(Math.max(0,h),x),y:Math.min(Math.max(0,_),C)})}},[a,l,r]),m=()=>{s.current&&(s.current=!1),a.current=!1};(0,Vt.useEffect)(()=>(window.addEventListener("mousemove",u),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m)}),[u]);let d=e.onComponentToIDEClick&&e.needOpenIDE!==void 0;return Vt.default.createElement(D2,{"data-testid":"dev-tools-button",ref:i,size:"small","aria-label":"add",onMouseDown:p,sx:{color:"text.primary",backgroundColor:"background.paper","&:hover":{backgroundColor:"background.paper"},position:"fixed",left:`${n.x}px`,top:`${n.y}px`,width:"44px",height:"44px",cursor:"move",px:1,touchAction:"none",userSelect:"none",zIndex:2047483647,...t},...o},Vt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"center",gap:1},Vt.default.createElement(gb.default,{onMouseUp:c}),d&&Vt.default.createElement(zC,{onMouseUp:()=>{s.current||e.onComponentToIDEClick&&e.onComponentToIDEClick()},sx:{color:e.needOpenIDE?"text.primary":"text.secondary"}})))},Y7=e=>{let{open:t}=e,{position:o,size:n,setSize:r}=bh(),i=Ty(),a=(s,l,p,c)=>{let u={width:Math.min(p.offsetWidth,window.innerWidth),height:Math.min(p.offsetHeight,window.innerHeight)};r(u)};return Vt.default.createElement(g,{sx:{position:"fixed",left:`${o.x}px`,top:`${o.y}px`,zIndex:2047483646,display:t?"block":"none"}},Vt.default.createElement(Zy,{ref:i,size:n,onResize:a,minWidth:100,minHeight:100,style:{position:"fixed",zIndex:2047483646,display:t?"block":"none"}},Vt.default.createElement(zn,{elevation:3,style:{width:"100%",height:"100%",overflow:"auto",boxSizing:"border-box"},sx:{padding:"36px"}},Vt.default.createElement(ab,null))))},Z7={sourcePathAttribute:"debug-open-path",tooltipConfig:{attribute:"data-testid",showDefaultInfo:!1}},Q7=()=>{let e=St(),{setOpen:t,open:o}=bh(),{needOpenIDE:n,setNeedOpenIDE:r}=hb(e,Z7);return Vt.default.createElement(Vt.default.Fragment,null,Vt.default.createElement(fb,null),Vt.default.createElement(X7,{needOpenIDE:n,onToolsClick:()=>t(!o),onComponentToIDEClick:()=>r(!n),fabProps:{variant:"extended",sx:{width:"auto"}}}),Vt.default.createElement(Y7,{open:o}))},J7=()=>Vt.default.createElement(Fm,null,Vt.default.createElement(Q7,null)),xb=J7;var _b=e=>{let{sigOutMaxAIAccount:t}=i2();wn(()=>{Vn.request.use(wx(async()=>{await ma.checkAccessToken();let o=await ma.getAccessToken();return ai&&ma.isTokenExpired(o)&&(o=await ma.getRefreshToken()),{userId:await xu.getUserId()||"",token:o||""}},["/app/send_mixpanel_log","/app/uplog",...Object.values(Qx),...e??[]])),Vn.response.use(Mx(()=>{t()}))})};var Kp=class{constructor(){this.cacheStorage=new V1({saveKey:"MAXAI_CLIENT__FEATURES__MARKETING__REWARDS_STATUS",cacheTime:V1.DAILY*2})}async fetchRewardDashboard(){let t=await Vn.fetch("/user/get_referral_dashboard",{method:"GET"});return t.success&&t.data?.data?t.data.data:null}async getRewardDashboard(t=!1){let o=await this.cacheStorage.get();if(t||o.expired){let n=await this.fetchRewardDashboard();n&&(o.data=n,await this.cacheStorage.sync(n))}return o.data}async uploadRewardScreenshot(t){let o=Date.now(),n=new FormData;n.append("file",t);let{success:r,message:i}=await Vn.fetch("/app/upload_review_screenshot",{method:"POST",body:n}),a=Date.now()-o;a<P1.SECOND*2&&await new Promise(l=>setTimeout(l,P1.SECOND*2-a)),r&&await Bp.refreshModelUsage();let s=await this.getRewardDashboard(r);return{success:r,data:s,message:i}}async clearRewardDashboard(){await this.cacheStorage.clear()}};Z0([Zx({cacheArgs:!0})],Kp.prototype,"getRewardDashboard",1);var $p=new Kp;var Xp=I(E());var ds=il(e=>({loading:!1,dashboard:null,setLoading:t=>e({loading:t}),setDashboard:t=>e({dashboard:t})})),eM=()=>ds(),tM=()=>{let{loadModelUsage:e}=_u(),t=(0,Xp.useCallback)(async()=>{ds.setState({loading:!0});let i=await $p.getRewardDashboard();ds.setState({loading:!1,dashboard:i})},[]),o=(0,Xp.useCallback)(async()=>{ds.setState({loading:!0});let i=await $p.getRewardDashboard(!0);ds.setState({loading:!1,dashboard:i})},[]),n=(0,Xp.useCallback)(async()=>{await $p.clearRewardDashboard(),ds.setState({loading:!1,dashboard:null})},[]),r=(0,Xp.useCallback)(async i=>{let{success:a,data:s,message:l}=await $p.uploadRewardScreenshot(i);return a?e():Ni.error(l),ds.setState({dashboard:s}),{success:a,data:s,message:l}},[]);return{loadRewardDashboard:t,refreshRewardDashboard:o,clearRewardDashboard:n,uploadRewardScreenshot:r}},Cb=()=>{let e=eM(),t=tM();return{...e,...t}};var yb=I(E()),bb=()=>{let{loading:e,dashboard:t,loadRewardDashboard:o,refreshRewardDashboard:n,clearRewardDashboard:r}=Cb(),i=et({loading:e,dashboard:t});(0,yb.useEffect)(()=>{o();let a=(s,l)=>{l.proChatReward&&!i.current.loading&&!i.current.dashboard?.is_webstore_commented&&n()};return Bp.addListener("onUsageChange",a),()=>{Bp.removeListener("onUsageChange",a)}},[]),IC(()=>{n()}),SC(()=>{r()})};var sn=I(E());var x6=I(g6());var _A=()=>{let e=new Map,t=new K2,o=async(n,r,i)=>{await t.postMessage({event:"Client_ListenProxyWebsocketResponse",data:{data:r,taskId:n,listenerType:i}})};hm(async(n,r)=>{switch(n){case"Client_ListenProxyWebsocket":{let{taskId:i,data:a,type:s}=r;switch(s){case"Open":{let l=new x6.default(a.url,{});return l.onUnpackedMessage.addListener(p=>{o(i,p,"onUnpackedMessage")}),l.onMessage.addListener(async p=>{o(i,p,"onMessage")}),l.onClose.addListener(()=>{o(i,{},"onClose")}),await l.open(),e.set(i,l),{success:!0,data:"success",message:"ok"}}break;case"Close":{let l=e.get(i);return l?(l.removeAllListeners(),await l.close(),e.delete(i),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;case"SendPacked":{let l=e.get(i);return l?(l.sendPacked(a),{success:!0,data:"success",message:"ok"}):{success:!1,message:"websocket not found",data:!1}}break;default:return{success:!0,data:"success",message:"ok"}}}break}})},_6=_A;var Ul=I(E());var C6=(e,t)=>{for(let o=e.length-1;o>=0;o--){let n=e[o];if(t(n))return n}};var y6=()=>{let e=(0,Ul.useRef)(!1),{conversationMessages:t,conversationIdRef:o}=_i(),{createMessage:n}=yi(),r=(0,Ul.useRef)(!1),i=(0,Ul.useRef)("");return _2(a=>{a.name!=="free"&&(r.current=!0,a.name==="elite"?i.current="You have successfully upgraded to MaxAI Elite.":a.name==="pro"?i.current="You have successfully upgraded to MaxAI Pro.":a.name==="basic"&&(i.current="You have successfully upgraded to MaxAI Basic."))}),(0,Ul.useEffect)(()=>{!r.current||!i.current||e.current||o.current&&!C6(t,a=>a.text==="You have successfully upgraded to MaxAI Elite."||a.text==="You have successfully upgraded to MaxAI Pro."||a.text==="You have successfully upgraded to MaxAI Basic.")&&n(o.current,{messageId:Xo(),type:"system",parentMessageId:void 0,text:i.current,meta:{status:"success"}}).then().catch().finally(()=>{e.current=!0})},[t]),null};var b6="maxai-artifacts-portal";var I6=I(E()),S6=I(Gs()),CA=e=>{let o=St()?.querySelector(`#${b6}`);return o?(0,S6.createPortal)(e.children,o):I6.default.createElement(g,{flex:1,sx:{...e.sx,"&:empty":{display:"none"}}},e.children)},v6=CA;var T6=I(E()),yA=({children:e,...t})=>{let{sx:o,...n}=t;return T6.default.createElement(ll,{anchor:"bottom",open:!0,sx:{display:"flex",zIndex:1502,position:"absolute",[`& .${sl.paper}`]:{position:"absolute",borderTopRightRadius:8,borderTopLeftRadius:8,height:"80vh",bgcolor:"background.paper",backgroundImage:"unset"},"& .maxai--browser-window":{border:"none !important",borderRadius:"0px !important",boxShadow:"none !important"},...o},disableScrollLock:!0,disableEnforceFocus:!0,slotProps:{root:{},backdrop:{sx:{position:"absolute"}}},...n},e)},md=yA;var wi=I(E()),bA=e=>{let{children:t,reference:o,offset:n=16,sx:r}=e,[i,a]=(0,wi.useState)(0),[s,l]=(0,wi.useState)(0),[p,c]=(0,wi.useState)(0),u=(0,wi.useCallback)(()=>{if(!o)return;let d=o.getBoundingClientRect(),f=n*2,h=Math.min(680,d.left-f),_=Math.max(n,d.left-h-n);c(d.top),l(_),a(h)},[n,o]);(0,wi.useEffect)(()=>{if(!o)return;let d=Wr(()=>{u()},0),f=new ResizeObserver(d);return f.observe(o),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d),f.disconnect()}},[u,o]);let m=Tu("maxai-animation-slide-in",{duration:250});return wi.default.createElement(g,{sx:{position:"fixed",zIndex:1e3,width:i,marginTop:`${n}px`,height:`calc(100vh - ${n*2}px)`,left:s,top:p,display:i>0?"flex":"none",flexDirection:"column","&:empty":{display:"none"},...m,...r}},t)},dd=bA;var $r=I(E()),fd=()=>{let e=(0,$r.useRef)(null),{conversationId:t}=ie(),o=fe(t),{showStatus:n,closeArtifacts:r,hideArtifacts:i}=tC(),a=St();return(0,$r.useEffect)(()=>{let s=a?.children?.[0];s&&(e.current=s)},[a]),n!=="open"?null:ii&&e.current?window.innerWidth-e.current.offsetWidth<450?$r.default.createElement(md,{onClose:o?i:r},$r.default.createElement(dm,null)):$r.default.createElement(dd,{reference:e.current},$r.default.createElement(dm,null)):$r.default.createElement(v6,null,$r.default.createElement(dm,{sx:{width:"calc(100% - 24px)",height:"calc(100% - 32px)",margin:"16px 0 12px 8px"}}))};var hd=I(E()),M6={},Qh=hd.default.createContext({}),E6=()=>(0,hd.useContext)(Qh);var A6=I(pa());var Xr=I(E()),SA=e=>{let{children:t,onClick:o,link:n,dataTestId:r,tooltip:i,tooltipProps:a,...s}=e,[l,p]=(0,Xr.useState)(!1),c=Tu("maxai-animation-hover-left-bottom-slide-in",{duration:200});return Xr.default.createElement(xe,{title:i,...a},Xr.default.createElement(B,null,Xr.default.createElement(de,{"data-testid":r,component:n?"a":"button",...n?{href:n,target:"_blank"}:{},sx:{minWidth:"unset",textAlign:"center",color:"text.primary",opacity:.55,"&:hover":{opacity:1},[`& .${fx.root}`]:{borderRadius:"7px"}},onClick:o,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),...s},Xr.default.createElement(T,{component:"h2",sx:{fontSize:"12px",fontWeight:400,lineHeight:"150%"}},t),l?Xr.default.createElement(A6.default,{sx:{ml:"4px",fontSize:"16px",color:"inherit",...c}},Xr.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Xr.default.createElement("path",{d:"M4.03076 11.9679L11.9687 4.02991M11.9687 4.02991H5.51913M11.9687 4.02991V10.2039",stroke:"currentColor",strokeWidth:"1.24031",strokeLinecap:"round",strokeLinejoin:"round"}))):Xr.default.createElement(B,{sx:{width:"20px",height:"16px"}}))))},Jh=SA;var gd=I(E()),vA=e=>{let{sx:t}=e,{t:o}=k();return gd.default.createElement(g,{direction:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center",sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",zIndex:1502,...t}},gd.default.createElement(Jh,{dataTestId:"maxai--chat-home-view--chat-with-any-content--write",link:`${Nn}/ai-writing-tools/`},o("package__features:home_view__chat_with_any_content__tab__write__title")),gd.default.createElement(Jh,{dataTestId:"maxai--chat-home-view--chat-with-any-content--create-image",link:`${Nn}/ai-tools/ai-art/`},o("package__features:home_view__chat_with_any_content__tab__create_image__title")))},xd=vA;var Xt=I(E());var TA=30*1e3,P6=async(e,t)=>{let{signal:o}=t||{};try{let n=new FormData;n.append("audio_file",e),n.append("feature_name",ai?"immersive_chat":"sidebar"),n.append("prompt_name","Use microphone"),n.append("event_source",m2);let r=new AbortController,i=r.signal;return new Promise(a=>{let s=setTimeout(()=>{r.abort()},TA);Vn.fetch("/gpt/speech_to_text",{signal:o?AbortSignal.any([i,o]):i,method:"POST",body:n}).then(async l=>{clearTimeout(s);let p=await l.data;p.status!=="OK"&&a({status:"error",data:{speechText:""},error:p.detail||""}),a({status:"success",data:{speechText:p?.data?.speech_text||""}})}).catch(l=>{if(l.name==="AbortError"){a({status:"timeout",data:{speechText:""}});return}clearTimeout(s),a({status:"error",data:{speechText:""}})})})}catch{return{status:"error",data:{speechText:""}}}};var nr=I(E()),wA=(e,t,o)=>{let[n,r]=(0,nr.useState)(!1),[i,a]=(0,nr.useState)(!1),[s,l]=(0,nr.useState)(0),[p,c]=(0,nr.useState)(),[u,m]=(0,nr.useState)(),[d,f]=(0,nr.useState)(),h=(0,nr.useCallback)(()=>{let b=setInterval(()=>{l(v=>v+1)},1e3);m(b)},[l,m]),_=(0,nr.useCallback)(()=>{u!=null&&clearInterval(u),m(void 0)},[u,m]),x=(0,nr.useCallback)(()=>{u==null&&navigator.mediaDevices.getUserMedia({audio:e??!0}).then(b=>{r(!0);let v=new MediaRecorder(b,o);c(v),v.start(),h(),v.addEventListener("dataavailable",S=>{f(S.data),v.stream.getTracks().forEach(M=>M.stop()),c(void 0)})}).catch(b=>{t?.(b)})},[u,r,c,h,f,t,o]),C=(0,nr.useCallback)(()=>{p?.stop(),_(),l(0),r(!1),a(!1)},[p,l,r,a,_]),y=(0,nr.useCallback)(()=>{i?(a(!1),p?.resume(),h()):(a(!0),_(),p?.pause())},[p,a,h,_]);return{startRecording:x,stopRecording:C,togglePauseResume:y,recordingBlob:d,isRecording:n,isPaused:i,recordingTime:s,mediaRecorder:p}},k6=wA;var eg=(e,t)=>{if(!/^#?([a-f\d]{3}|[a-f\d]{6}|[a-f\d]{8})$/i.test(e))return null;let n=e.replace("#",""),r=0,i=0,a=0,s=0;return n.length===3?(r=parseInt(n[0]+n[0],16),i=parseInt(n[1]+n[1],16),a=parseInt(n[2]+n[2],16),s=t!==void 0?Math.max(0,Math.min(1,t)):1):(r=parseInt(n.substring(0,2),16),i=parseInt(n.substring(2,4),16),a=parseInt(n.substring(4,6),16),n.length===8?s=t!==void 0?Math.max(0,Math.min(1,t)):parseInt(n.substring(6,8),16)/255:s=t!==void 0?Math.max(0,Math.min(1,t)):1),isNaN(r)||isNaN(i)||isNaN(a)||isNaN(s)?null:`rgba(${r}, ${i}, ${a}, ${s})`};var To=I(E()),MA=({stream:e,boxStyle:t,barStyle:o,leftMaskStyle:n,rightMaskStyle:r,barWidth:i=2,barGap:a=2})=>{let s=(0,To.useRef)(null),[l,p]=(0,To.useState)([]),c=(0,To.useRef)([]),u=(0,To.useRef)(0),{isDarkMode:m,theme:{palette:d}}=Wn();(0,To.useEffect)(()=>{if(!s.current)return;let x=()=>{if(s.current){let b=s.current.clientWidth,v=i+a,S=Math.floor(b/v);if(u.current===0){let M=Array(S).fill({type:"idle",volume:8});p(M),c.current=[...M],u.current=S}else if(S!==u.current){let M=[...c.current];if(S>u.current){let P={type:"idle",volume:8},H=[...Array(S-u.current).fill(P),...M].slice(-S);p(H),c.current=H}else{let P=M.slice(-S);p(P),c.current=P}u.current=S}}};x();let C=new ResizeObserver(x),y=s.current;return C.observe(y),()=>{y&&C.unobserve(y),C.disconnect()}},[i,a]);let f=(0,To.useRef)(new Uint8Array(0));(0,To.useEffect)(()=>{if(!e)return;let x=window.AudioContext||window.webkitAudioContext,C=new x,y=C.createMediaStreamSource(e),b=C.createAnalyser();b.fftSize=2048,b.smoothingTimeConstant=.5,f.current=new Uint8Array(b.frequencyBinCount),y.connect(b);let v,S=()=>{b.getByteFrequencyData(f.current);let M={type:"idle",volume:3},P=14,O=Math.min(140,f.current.length-1),L=0,H=0;for(let ne=P;ne<=O;ne++)L+=f.current[ne],H++;let z=H>0?L/H:0,R=8,V=24,F=V-R,q=z/255,W=Math.pow(q,.8),j=Math.max(R,Math.min(V,R+Math.round(F*W)));M.type="recording",M.volume=j;let w=c.current;w.length!==0&&(w.shift(),w.push(M),p([...w]),v=requestAnimationFrame(S))};return v=requestAnimationFrame(S),()=>{cancelAnimationFrame(v),b.disconnect(),y.disconnect(),C.close().catch(console.error)}},[e]);let h=(0,To.useMemo)(()=>eg(d.background.paper,0),[d.background.paper]),_=(0,To.useMemo)(()=>eg(d.background.paper,1),[d.background.paper]);return To.default.createElement("div",{ref:s,style:{flex:1,height:"32px",display:"flex",alignItems:"center",position:"relative",overflow:"hidden",gap:`${a}px`,...t}},l.map((x,C)=>{let y=m?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",b=x.type==="recording";return To.default.createElement("div",{key:C,style:{width:`${i}px`,height:`${x.volume}px`,backgroundColor:b?d.primary.main:y,borderRadius:"1px",flexShrink:0,...o}})}),To.default.createElement("div",{style:{position:"absolute",left:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to left, ${h}, ${_})`,pointerEvents:"none",...n}}),To.default.createElement("div",{style:{position:"absolute",right:0,top:0,width:"12px",height:"100%",background:`linear-gradient(to right, ${h}, ${_})`,pointerEvents:"none",...r}}))},L6=(0,To.memo)(MA);var F6=I(Sr()),H6=I(O6());var Be=I(E()),N6=I(Gs());var Wl=I(E()),B6=(0,Wl.createContext)({isVoiceInput:!1,setIsVoiceInput:()=>{},isUseInternalState:!0}),D6=()=>(0,Wl.useContext)(B6),Gl=({children:e,value:t})=>Wl.default.createElement(B6.Provider,{value:t},e);var kA=60,tg=e=>e===3||e===4||e===5||e===6,LA=async(e,t,o={canceled:!1})=>{let r=new Set,i=window.AudioContext||window.webkitAudioContext,a=new i,s=a.createMediaStreamSource(e),l=a.createAnalyser();l.fftSize=2048,s.connect(l);let p=new Uint8Array(l.frequencyBinCount),c=!1,u=()=>{l.getByteTimeDomainData(p);for(let f of Array.from(p))if(r.add(f),f>138||f<118){c=!0;break}},m=a.currentTime,d=t;return new Promise(f=>{let h=()=>{if(u(),c||a.currentTime-m>=d||o.canceled){a.close(),f(c);return}setTimeout(h,100)};h()})},OA="max-ai__actions__button--voice-input",BA=e=>{let{sx:t,onStartRecording:o,onStopRecording:n,onVoiceInputStatusChange:r,onSpeechToTextSuccess:i,onSpeechToTextFinally:a,disabled:s,...l}=e,{t:p}=k(),{conversationId:c,inputMediator:u}=ie(),m=fe(c),[d,f]=(0,Be.useState)(""),[h,_]=(0,Be.useState)(!1),[x,C]=(0,Be.useState)(0),{startRecording:y,stopRecording:b,recordingBlob:v,isRecording:S,mediaRecorder:M,recordingTime:P}=k6(void 0,()=>{C(3)}),O=(0,Be.useRef)(0);P&&(O.current=P);let L=et(r),H=(0,Be.useRef)(new AbortController),z=(0,Be.useMemo)(()=>({0:p("package__features:chat__inputbox__button__voice_input__idle__tooltip"),1:p("package__features:chat__inputbox__button__voice_input__done__tooltip"),2:p("package__features:chat__inputbox__button__voice_input__transcribing__tooltip"),3:p("package__features:chat__inputbox__button__voice_input__permission_denied__tooltip"),4:p("package__features:chat__inputbox__button__voice_input__no_speech__tooltip"),5:p("package__features:chat__inputbox__button__voice_input__timeout__tooltip"),6:d})[x],[x,d,p]),R=(0,Be.useMemo)(()=>tg(x)||h,[x,h]),V=(0,Be.useRef)(!1),F=(0,Be.useRef)(x),q=(0,Be.useRef)(!1),X=(0,Be.useRef)(null),W=(0,Be.useCallback)(()=>{X.current&&(X.current.getTracks().forEach(Fe=>Fe.stop()),X.current=null)},[]),j=et(o),w=(0,Be.useCallback)(async()=>{try{if(q.current)return;q.current=!0,X.current=await navigator.mediaDevices.getUserMedia({audio:!0}),q.current=!1,O.current=0,H.current=new AbortController,y(),C(1),j.current?.()}catch{C(3),q.current=!1}},[j,y]),ne=et(n),pe=(0,Be.useCallback)(Fe=>{b(),W(),C(2),ne.current?.(Fe)},[ne,b,W]),A=async()=>{S?pe("done"):await w()},U=async Fe=>{Fe.key==="Enter"?S?pe("done"):await w():Fe.key==="Escape"&&S&&(b(),W(),C(0),ne.current?.("cancel"),Fe.stopPropagation())},N=()=>{_(!0)},ce=()=>{_(!1)};(0,Be.useEffect)(()=>{if(F.current=x,tg(x)){let Fe=setTimeout(()=>{C(pt=>tg(pt)?0:pt)},3e3);return()=>{clearTimeout(Fe)}}},[x]),(0,Be.useEffect)(()=>{L.current?.(x)},[L,x]),(0,Be.useEffect)(()=>{if(S&&M){let Fe=kA,pt=setInterval(()=>{Fe--,Fe<=0&&S&&pe("timeout")},1e3),ct={canceled:!1};return LA(M.stream,5,ct).then(kt=>{kt||(C(Ke=>Ke===1?4:Ke),b(),W(),F.current!==2&&ne.current?.("timeout"))}).catch(kt=>{}),()=>{ct.canceled=!0,clearTimeout(pt)}}},[pe,S,M,b,W,ne]);let Z=et(i),re=et(a);(0,Be.useEffect)(()=>{if(v&&x===2&&!V.current){V.current=!0;let Fe=new File([v],"audio.webm",{type:"audio/webm"});P6(Fe,{signal:H.current.signal}).then(pt=>{if(pt.status==="success"){let ct=pt.data.speechText;Z.current?Z.current(ct):u.updateInputValue(u.getInputValue()+ct),(0,N6.flushSync)(()=>{C(0)})}else pt.status==="timeout"?C(5):pt.error?(f(pt.error),C(6)):C(0)}).catch().finally(()=>{V.current=!1,re.current?.()})}},[u,Z,re,v,x]);let bt=(0,Be.useMemo)(()=>({height:"30px"}),[]),be=x!==0&&x!==3&&x!==4,Ce=x===2,{isVoiceInput:we,setIsVoiceInput:qe,isUseInternalState:Ze}=D6();(0,Be.useEffect)(()=>{qe(be)},[be,qe]);let Kt=Ze?be:we;return m?null:Be.default.createElement(g,{direction:"row",spacing:1,flex:Kt?1:void 0,justifyContent:"flex-end",overflow:"hidden"},Kt&&Be.default.createElement(Be.default.Fragment,null,Be.default.createElement(se,{title:p("package__common:cancel"),placement:"top",variant:"secondary",onClick:()=>{H.current.abort(),b(),W(),C(0),ne.current?.("cancel")}},Be.default.createElement(F6.default,null)),Be.default.createElement(g,{direction:"row",gap:1,sx:{flex:1,alignItems:"center",justifyContent:"center",height:"32px",overflow:"hidden"}},Be.default.createElement(L6,{stream:M?.stream,boxStyle:bt}),Be.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"}},P_(O.current)))),Be.default.createElement(xe,{key:x,title:z,open:R,onOpen:N,onClose:ce},Be.default.createElement("span",null,Be.default.createElement(Yn,{onKeyDownCapture:U,tabIndex:-1,loading:Ce,onClick:A,id:"MaxAISidebarVoiceInputButton",variant:"contained","data-testid":OA,disabled:Ce||s,sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box",boxShadow:"none",[`&.${G1.loading}`]:{backgroundColor:"transparent"},[`& .${G1.loadingIndicator}`]:{color:"text.secondary"},...t},...l},Kt?Be.default.createElement(G,{icon:"Done",sx:{color:"inherit!important",fontSize:"20px"}}):Be.default.createElement(H6.default,{sx:{color:"inherit!important",fontSize:"20px"}})))))},jl=BA;var z6=I(pc()),R6=I(og()),cc=I(E()),VA=e=>{let{onSpeechToTextSuccess:t,voiceButtonProps:o,loading:n,inputMediator:r,onSend:i,...a}=e,{t:s}=k(),{conversationId:l}=ie(),p=fe(l),c=Ia(r),{askAIQuestionV2:u,stopGenerate:m}=ke(),d=c.getInputValue(),{localSettings:f}=tt(),h=n||p,_=async()=>{if(!await Qe({emitEvent:!0})){c.focus();return}h?m?.():d&&(await u({type:"user",text:d,meta:{includeHistory:!0}}),i?.())};return f.chatMode==="pro_chat"&&d===""&&!h?cc.default.createElement(jl,{onSpeechToTextSuccess:t,...o}):cc.default.createElement(se,{title:s(h?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:h?void 0:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:x=>x.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:!d&&!h,onClick:_,styleType:"default",...a},h?cc.default.createElement(R6.default,{sx:{fontSize:"16px",color:"inherit !important"}}):cc.default.createElement(z6.default,{sx:{fontSize:"16px",color:"inherit !important"}}))},ql=VA;var Qo=I(E()),Ba=24,ng=0,UA=e=>{let t=e||window.innerHeight*.4;return Math.max(Math.floor(t/Ba),5)},uc=(e,t)=>{let o=e?.parentElement;if(e&&o){let n=window.getComputedStyle(e),r=Number(e.getAttribute("data-min-line"))||1,i=parseInt(n.paddingTop??ng,10)+parseInt(n.paddingBottom??ng,10);e.style.cssText="height:0px";let a=e.value?e.scrollHeight:Ba*r+i,s=e?.previousElementSibling?.offsetHeight||0,l=Math.min(Ba*UA(t),a),p=Math.max(Ba*r+i,s),c=Math.max(p,l);e.style.cssText=`height: ${c}px`,o.style.cssText=`height: ${c}px`}},WA=(e,t)=>{uc(e,t),setTimeout(()=>{if(uc(e,t),!e)return;let o=e.value;e.focus(),e.setSelectionRange(o.length,o.length)},100)},GA=(e,t)=>{if(!e)return;let o=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(o?.nextElementSibling&&o.nextElementSibling.getAttribute("tabindex")==="-1"&&o.nextElementSibling.removeAttribute("tabindex"),window.location.host==="www.linkedin.com"){let r=document.querySelector('div[tabindex="-1"][role="dialog"]');r&&(r.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{r.setAttribute("tabindex","-1")},100))}let n=document.activeElement;n?.shadowRoot&&(n=n.shadowRoot.activeElement),(!n||!e.isSameNode(n))&&WA(e,t)},V6=(0,Qo.forwardRef)((e,t)=>{let{t:o}=k(),{loading:n,value:r,placeholder:i=o("package__features:chat__input__chat__placeholder"),onChange:a,onChangeText:s,onPasteFiles:l,onPaste:p,onEnter:c,sx:u,stopPropagation:m=!0,minLine:d=1,maxHeight:f,...h}=e,_=(0,Qo.useRef)(null),x=M2(_,t),C=(0,Qo.useRef)(!1),y=(0,Qo.useMemo)(()=>Wr(uc,200),[]),b=(0,Qo.useCallback)(v=>{let S=v.target.value;a?.(v),s?.(S)},[a,s]);return(0,Qo.useEffect)(()=>{y(_.current,f);let v=setTimeout(()=>{uc(_.current,f)},0);return()=>clearTimeout(v)},[r,f,y]),(0,Qo.useEffect)(()=>{let v=()=>{uc(_.current,f)};return window.addEventListener("resize",v),()=>{window.removeEventListener("resize",v)}},[f]),Qo.default.createElement(B,{component:"div",className:n?"chat-box__input--loading":"",borderRadius:1,width:"100%",minHeight:Ba*d+ng*2,sx:{overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...u}},Qo.default.createElement(B,{component:"div",className:"chat-box__input-skeleton"},Qo.default.createElement(fo,{height:Ba})),Qo.default.createElement(B,{component:"textarea",sx:{boxSizing:"border-box",display:"block",maxHeight:n?Ba*d+16:"unset",color:v=>v.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",fontSize:"16px",lineHeight:Ba+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::placeholder":{fontWeight:"400",color:v=>v.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}},placeholder:i,disabled:n,ref:x,value:r,rows:1,"data-min-line":d,onCopy:v=>{v.stopPropagation()},onCut:v=>{v.stopPropagation()},onPaste:v=>{if(v.stopPropagation(),p&&p(v),l){let S=v.clipboardData,M=Array.from(S?.items||[]).map(P=>P.getAsFile?.()).filter(P=>P!==null);M&&M.length>0&&(v.preventDefault(),l(M,v))}},onKeyUp:v=>{m&&v.stopPropagation()},onKeyPress:v=>{m&&v.stopPropagation()},onKeyDown:v=>{if(m&&v.stopPropagation(),!C.current&&!(v.key==="Enter"&&v.shiftKey)){if(v.key==="Enter"){v.preventDefault();let S=v.currentTarget.value;c?.(S)}else if(v.code==="Space"){v.stopPropagation();return}}},onClick:v=>{GA(v.currentTarget,f)},onCompositionUpdate:v=>{m&&v.stopPropagation()},onCompositionStart:v=>{m&&v.stopPropagation(),C.current=!0},onCompositionEnd:v=>{m&&v.stopPropagation(),C.current=!1,b(v)},onInput:v=>{m&&v.stopPropagation(),C.current?s?.(v.currentTarget.value):b(v)},onBlur:v=>{y(v.currentTarget,f)},...h}))});V6.displayName="AutoHeightTextarea";var Kl=V6;var jA=e=>{let{enableChatMode:t,disableChatMode:o,children:n}=e,{localSettings:r}=j2(),i=r.chatMode||"free_chat";return typeof n=="function"?n(i):t&&i!==t||o&&i===o?null:n},bd=jA;var Id=class{async sendUserAction(t,o){let n=await Vn.fetch("/user/send_user_action",{method:"POST",body:JSON.stringify({action:t,...o})});return n.data?.paywall&&(n.data.info&&(n.data.paywall.info=n.data.info),Object.keys(n.data.paywall).forEach(r=>{let i=r,a=n.data?.paywall?.[i]||{};Object.keys(a).length===0&&delete n.data?.paywall?.[i]})),n.data}};var qA=new Id,gs=qA;var W6=I(U6());var ye=I(E()),YA=(e,t)=>e.left<=t.right&&e.right>=t.left&&e.top<=t.bottom&&e.bottom>=t.top,ZA=(e,t)=>!(e.left>=t.left&&e.right<=t.right&&e.top>=t.top&&e.bottom<=t.bottom),QA=e=>{let{total:t,remaining:o}=e;return ye.default.createElement(g,{direction:"row",sx:{width:"100%",gap:"2px"}},Array.from({length:t},(n,r)=>ye.default.createElement(B,{key:r,sx:{flex:1,height:"4px",bgcolor:i=>i.palette.mode==="light"?r<o?"primary.main":"#d9d9d9":r<o?"primary.main":"#4f4f4f",borderRadius:"2px"}})))},JA=e=>{let{total:t,remaining:o}=e;return ye.default.createElement(B,{position:"relative"},ye.default.createElement(B,{sx:{flex:1,height:"4px",bgcolor:n=>n.palette.mode==="light"?"#d9d9d9":"#4f4f4f",borderRadius:"2px"}}),ye.default.createElement(B,{sx:{position:"absolute",top:0,width:`${o/t*100}%`,height:"4px",bgcolor:"primary.main",borderRadius:"2px"}}))},rg=()=>{let{t:e}=k(),{modelUsage:t}=di(),{showPricingHooksPopup:o}=ul(),n=he(r=>r.conversationIds[0]);return ye.default.createElement(g,{sx:{gap:"8px",width:"100%"}},ye.default.createElement(T,{sx:{fontSize:"18px",fontWeight:500,color:"text.primary",textAlign:"left",lineHeight:1.5}},"Pro chat"),ye.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__description")),ye.default.createElement(g,{sx:{padding:"8px 0 16px 0",gap:"8px",width:"100%"}},t.proChatReward?ye.default.createElement(ye.default.Fragment,null,ye.default.createElement(JA,{total:gu+N1,remaining:t.proChat+t.proChatReward}),ye.default.createElement(g,{direction:"row",alignItems:"center",gap:1},ye.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat+t.proChatReward<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat+t.proChatReward,NAME:t.proChat+t.proChatReward<=1?"Pro chat":"Pro chats"})),ye.default.createElement(_x,{title:ye.default.createElement(g,{minWidth:250},ye.default.createElement(T,{fontSize:"14px",fontWeight:600,mb:1},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:"",NAME:"Pro chats"})),ye.default.createElement(g,{direction:"row",justifyContent:"space-between",gap:1,mb:.5},ye.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__daily_free__title")),ye.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChat," / ",gu)),ye.default.createElement(g,{direction:"row",justifyContent:"space-between",gap:1},ye.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},e("package__features:chat__pro_chat_switch__usage_card__rewarded__title")),ye.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, 0.7)"},t.proChatReward," /"," ",N1))),arrow:!0},ye.default.createElement(W6.default,{sx:{fontSize:18,color:"text.secondary"}})))):ye.default.createElement(ye.default.Fragment,null,ye.default.createElement(QA,{total:gu,remaining:t.proChat}),ye.default.createElement(T,{sx:{fontSize:"14px",fontWeight:400,color:t.proChat<=0?"#f44336":"text.secondary",textAlign:"left",lineHeight:1.4}},e("package__features:chat__pro_chat_switch__usage_card__daily_left_single__title",{LEFT_COUNT:t.proChat,NAME:t.proChat<=1?"Pro chat":"Pro chats"})))),ye.default.createElement(de,{variant:"contained",sx:{width:"100%",minHeight:"44px",gap:1},onClick:async r=>{Ur("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"upgrade",targetElement:r?.currentTarget});let i=await gs.sendUserAction("click_upgrade_cta_pro_chat");i?.paywall&&o(n,i.paywall)}},ye.default.createElement(lu,{sx:{fontSize:"20px",color:"inherit"}}),ye.default.createElement(T,{sx:{fontSize:"16x",fontWeight:500,textAlign:"left",color:"inherit"}},e("package__features:chat__pro_chat_switch__usage_card__button__upgrade",{NAME:"Pro chat"}))))},eP=e=>{let{children:t}=e,[o,n]=(0,ye.useState)("top-start"),r=(0,ye.useMemo)(()=>x_(o,8),[o]),i=ye.default.useRef(null),a=ye.default.useRef(null),[s,l]=ye.default.useState(!1),p=ye.default.useRef({width:320,height:240}),{paywallShowDebounce:c}=cl(),u=()=>{let m=p.current;if(i.current){let d=i.current.getBoundingClientRect(),f={left:0,right:window.innerWidth,top:0,bottom:window.innerHeight},_=[{placement:"top-start",top:d.top-m.height-8,bottom:d.top-8,left:d.left,right:m.width+d.left},{placement:"bottom-start",top:d.bottom+8,bottom:d.bottom+m.height+8,left:d.left,right:m.width+d.left},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:d.top-m.height/2-20,bottom:d.top+m.height/2},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:d.top-m.height/2,bottom:d.top+m.height/2},{placement:"left",left:d.left-m.width-8,right:d.left-8,top:0,bottom:m.height},{placement:"right",...m,left:d.right+8,right:d.right+m.width+8,top:0,bottom:m.height}].find(x=>!ZA(x,f)&&!YA(x,d));n(_?.placement||"top")}};return(0,ye.useEffect)(()=>{s&&c({paywallType:"pro_chat_card",paywallReason:"ProChat"})},[s,c]),ye.default.createElement(OC,{popupId:"maxai_client__features__chat__pro_chat_switch",variant:"popover",disableAutoFocus:!0},m=>{let d=LC(m);return l(d.open),d.open&&u(),ye.default.createElement("div",null,ye.default.createElement("div",{ref:i,...kC(m),onMouseEnter:()=>{u()}},t),ye.default.createElement(BC,{...d,anchorOrigin:r.anchorOrigin,transformOrigin:r.transformOrigin,disableScrollLock:!0,slotProps:{paper:{elevation:0,sx:{background:"transparent",overflow:"unset"}}}},ye.default.createElement(zn,{ref:a,elevation:0,sx:{width:"280px",padding:"16px",marginBottom:"6px",border:"1px solid",borderColor:"border.main",boxShadow:"0px 0px 1px 0px rgba(0, 0, 0, 0.20), 0px 0px 16px 0px rgba(0, 0, 0, 0.10), 0px 16px 24px 0px rgba(0, 0, 0, 0.08);"}},ye.default.createElement(rg,null))))})},G6=eP;var ig=I(E()),tP=()=>{let e=he(m=>m.conversationIds[0]),{localSettings:t,setLocalSettings:o}=tt(),{isFreeUser:n}=_t(),{modelUsage:r,refreshModelUsage:i}=di(),{showPricingHooksPopup:a}=ul(),s=(0,ig.useRef)(null),l=(0,ig.useRef)(!1),{paywallShow:p}=cl(),c=async m=>(l.current=!1,new Promise(d=>{s.current=setTimeout(()=>{gs.sendUserAction("turn_on_pro_chat_mode").then(f=>{l.current||(f?.paywall?(a(e,f.paywall),p({paywallType:"modal",paywallReason:"ProChat"}),o({chatMode:"free_chat"}),d(!1)):(i(),d(!0)))})},m)})),u=async(m,d)=>{let{asyncConfirm:f=!0,asyncConfirmDelay:h=100}=d||{};return await Qe({emitEvent:!0})?(l.current=!0,s.current&&clearTimeout(s.current),m==="pro_chat"?(await o({chatMode:"pro_chat"}),n&&f&&r.proChat===0&&r.proChatReward===0?await c(h):!0):(await o({chatMode:m}),!0)):!1};return{chatMode:t.chatMode,updateChatMode:u}},Da=tP;var qi=I(E()),oP=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=k(),{modelUsage:a}=di(),{isPayingUser:s}=_t(),{localSettings:l}=tt(),[p,c]=(0,qi.useState)(!1),[u,m]=qi.default.useState(!0);return(0,qi.useEffect)(()=>{Ue.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP").then(d=>m(!!d))},[]),(0,qi.useEffect)(()=>{let d=!1;return!s&&a.proChat===0&&a.proChatReward===0&&l.chatMode==="free_chat"&&Ue.getOnboardingData().then(f=>{d||f.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP||f.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH&&c(!0)}),()=>{d=!0}},[s,a.proChat,l.chatMode]),u?null:qi.default.createElement(Tt,{trigger:p,arrow:!1,hideCTAButton:!0,placement:o,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData("ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{n&&n()},...r},qi.default.createElement(rg,null))},j6=oP;var mc="ON_BOARDING_POPOVER__PRO_CHAT__OPENED",vd="ON_BOARDING_POPOVER__PRO_CHAT__CLOSED",dc="ON_BOARDING_POPOVER__NEW_CHAT",j$="ON_BOARDING_POPOVER__CHAT_IN_FULL_PAGE",ag="ON_BOARDING_POPOVER__CHAT_HISTORY",sg="ON_BOARDING_POPOVER__CHAT_HUB_SELECTOR",fc="ON_BOARDING_POPOVER__AI_MODEL_SELECTOR";var rr=I(E()),nP=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=k(),[a,s]=rr.default.useState(!1),[l,p]=rr.default.useState(!0),c=he(x=>x.conversationIds),u=un(c[0]),m=fe(c[0]),d=(0,rr.useRef)(!1),{localSettings:f}=tt(),{isFreeUser:h}=_t(),_=mn.use.setChatAIModelAndProvider();return(0,rr.useEffect)(()=>{Ue.getOnboardingDataByKey(mc).then(x=>p(!!x))},[]),(0,rr.useEffect)(()=>{if(l)return;let x=u.find(C=>C.type==="ai");x&&x.originalMessage?.metadata?.chatMode==="free_chat"&&f.chatMode==="free_chat"&&!m&&d.current&&s(!0)},[u,f.chatMode,l,m]),(0,rr.useEffect)(()=>{m&&(d.current=!0)},[m]),l?null:rr.default.createElement(Tt,{trigger:a,placement:o,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData(mc,!0),h&&_({AIModel:Pp.value,AIProvider:Pp.AIProvider})},onClose:()=>{Ue.setOnboardingData(vd,!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{n&&n()},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Try it"},...r},rr.default.createElement(g,{spacing:.5},rr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),rr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__description"))))},q6=nP;var Yr=I(E()),rP=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-pro-chat-switch"]',placement:o="top-start",onTryIt:n,...r}=e,{t:i}=k(),{modelUsage:a}=di(),{isPayingUser:s}=_t(),{localSettings:l}=tt(),[p,c]=(0,Yr.useState)(!1),[u,m]=Yr.default.useState(!0);return(0,Yr.useEffect)(()=>{Ue.getOnboardingData().then(d=>{d.ON_BOARDING__RECORD_FIRST_AUTO_CLOSE_PRO_CHAT_SWITCH_TOOLTIP&&m(d.ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP===!0)})},[]),(0,Yr.useEffect)(()=>{!s&&a.proChat>0&&l.chatMode==="free_chat"&&c(!0)},[s,a.proChat,l.chatMode]),u?null:Yr.default.createElement(Tt,{trigger:p,placement:o,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData("ON_BOARDING__RECORD_FIRST_RESET_DAILY_USAGE_PRO_CHAT_SWITCH_TOOLTIP",!0)},ctaButtonText:i("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async d=>{n&&n(d)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Pro chat > Got it"},...r},Yr.default.createElement(g,{spacing:.5},Yr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),Yr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("package__features:onboarding__onboarding_popover__pro_chat__first_reset_daily_usage__description",{NAME:"Pro chats"}))))},K6=rP;var ho=I(E()),$6=e=>{let{sx:t,children:o,...n}=e;return ho.default.createElement(g,{direction:"row",alignItems:"center",sx:{padding:"6px 4px",gap:"4px",cursor:"pointer",transform:"translateY(0)",...t},...n},o,ho.default.createElement(T,{sx:{fontSize:"14px",fontWeight:500,color:"text.primary",textAlign:"left"}},"Pro"))},X6=e=>{let{children:t,title:o}=e;return ho.default.createElement(xe,{disableInteractive:!0,testId:"maxai--chat-pro-chat-switch--tooltip",placement:"top",title:o},ho.default.createElement("div",null,t))},iP=()=>{let{t:e}=k();return ho.default.createElement(X6,{title:e("package__features:chat__pro_chat_switch__pay_user_tooltip")},ho.default.createElement($6,{sx:{cursor:"default"}},ho.default.createElement(js,{sx:{color:"text.primary"},"data-testid":"maxai--chat-pro-chat-switch"})))},aP=e=>{let{hideOnboarding:t=!1}=e,{chatMode:o,updateChatMode:n}=Da(),{isLogin:r}=pn(),{t:i}=k(),a=async l=>{await Ue.setOnboardingData("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH",!0),await n(o==="free_chat"?"pro_chat":"free_chat")===!1&&Ur("click",{paywallType:"pro_chat_card",paywallReason:"ProChat",buttonType:"pro_switch",targetElement:l?.target})},s=ho.default.createElement($6,{onClick:a},ho.default.createElement("div",{"data-testid":"maxai--chat-pro-chat-switch"},ho.default.createElement(xl,{...e,checked:o==="pro_chat"})));return r?ho.default.createElement("div",null,ho.default.createElement(G6,null,s),ho.default.createElement(j6,null),ho.default.createElement(K6,{onTryIt:a}),!t&&ho.default.createElement(q6,{onTryIt:a})):ho.default.createElement(X6,{title:i("package__features:chat__pro_chat_switch__not_login_user_tooltip",{NAME:"Pro chat"})},s)},sP=e=>{let{isPayingUser:t}=_t(),{isLogin:o}=pn(),{setLocalSettings:n,localSettings:r}=tt();return(0,ho.useEffect)(()=>{o&&t&&r.chatMode!=="pro_chat"&&n({chatMode:"pro_chat"})},[o,t,r.chatMode]),o&&t?ho.default.createElement(iP,null):ho.default.createElement(aP,{...e})},Fa=sP;var Y6=I(E()),lP=e=>{let{onChanged:t,...o}=e,{userSettings:n,setUserSettings:r}=Un(),i=a_(),a=ai&&typeof i.query.locale=="string"?i.query.locale:"",s=async p=>{r({language:p}),t?.(p)},l=s2(n?.language||"",a||n?.preferredLanguage||"");return Y6.default.createElement(ZC,{options:J0,value:l,onChange:s,...o})},Z6=lP;var Q6=I(E()),pP=e=>{let{onChanged:t,tooltipProps:o,popoverProps:n,...r}=e,{t:i}=k(),{conversationId:a,inputMediator:s}=ie(),l=fe(a);return Q6.default.createElement(Z6,{onChanged:p=>{s.focus(),t?.(p)},disabled:l,tooltipProps:{title:i("package__features:chat__ai_language_selector__button__tooltip"),...o},popoverProps:{offset:5,...n},...r})},Ha=pP;var hc=I(E()),J6=I(E()),cP=e=>{let{type:t="floating",sx:o}=e,{t:n}=k(),r=(0,J6.useMemo)(()=>[{value:"clear_suggested",label:n("package__features:context_menu__more_button__clear_suggested_tools"),ButtonProps:{tooltipProps:{placement:"right",disabled:!1}},labelSx:{color:"rgba(255, 14, 39, 1) !important"},icon:hc.default.createElement(G,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1) !important"}})}],[n]),i=async u=>{if(u==="clear_suggested"){if(!await Qe({emitEvent:!0}))return;await l()}},{contextMenuPath:a}=io(),{contextMenuSuggestions:s,resetContextMenuSuggestions:l}=jr(a||""),{contextMenuSuggestions:p}=jr("/rewrite"),{contextMenuSuggestions:c}=jr("/my_own_tools");return a&&s.length===0||p.length===c.length&&p.length===0?null:hc.default.createElement(B,{sx:{padding:0,...o}},hc.default.createElement(se,{options:r,placement:"bottom-end",onSelectOption:u=>{i(u)},OptionsCardProps:{sx:{width:"auto",marginRight:"-13px"}},sx:{width:"26px",height:"26px",padding:"8px"}},hc.default.createElement(G,{size:t==="floating"?18:16,icon:"More"})))},$l=cP;var gc=class{constructor(){this.menuList=[];this.path=[];this.onUpdate=()=>{}}setOnUpdate(t){this.onUpdate=t}updatePath(t){this.path=t,this.onUpdate()}setMenuList(t){if(t!==this.menuList)if(this.menuList=t,this.menuList.length===0)this.updatePath([]);else{let o=null,n=[];for(let r of this.menuList){if(r.type==="chat_complete"){o=r,n=this.menuList;break}if(r.type==="group"){let i=!1;for(let a of r.children)if(a.type==="chat_complete"){o=a,n=r.children,i=!0;break}if(i)break}}this.updatePath(o?[{item:o,siblingList:n,triggerByHover:!1}]:[])}}onHover(t){let o=[];function n(r){let i=r;for(let a of r){if(a.prompt_id===t.prompt_id)return o.unshift({item:a,siblingList:i,triggerByHover:!0}),!0;a.type==="group"&&n(a.children??[])&&o.unshift({item:a,siblingList:i,triggerByHover:!0})}return!1}n(this.menuList),this.updatePath(o)}proxyKeyboardEvent(t){return t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight"?this.onNavigate(t.key.slice(5)):!1}onNavigate(t){if(this.path.length===0)return!1;let o=this.path[this.path.length-1];switch(t){case"Up":{let n=o.siblingList.indexOf(o.item);if(n===-1)throw Error("onNavigate up index = -1");return n===0?!1:(o.item=o.siblingList[n-1],this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}case"Down":{let n=o.siblingList.indexOf(o.item);if(n===-1)throw Error("onNavigate down index = -1");return n===o.siblingList.length-1?!1:(o.item=o.siblingList[n+1],this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}case"Left":return this.path.length===1?!1:(this.updatePath(this.path.slice(0,this.path.length-1).map(n=>({...n,triggerByHover:!1}))),!0);case"Right":{if(o.item.type!=="group")return!1;let n=o.item;return!n.children||n.children.length===0?!1:(this.path.push({item:n.children[0],siblingList:n.children,triggerByHover:!1}),this.updatePath(this.path.map(r=>({...r,triggerByHover:!1}))),!0)}}}getSelectedItem(){let t=mi(this.path);if(t&&t.item.type==="chat_complete")return t.item}match(t){return!!this.path.find(n=>n.item===t)}matchOpenGroup(t){let o=this.path.findIndex(n=>n.item===t);return o===-1?!1:o!==this.path.length-1||this.path[o].triggerByHover}onLeave(){this.updatePath(this.path.slice(0,1).map(t=>({...t,triggerByHover:!1})))}};var tI=I(ty()),oI=I(Gw());var it=I(E()),lg=I(E()),pg=(0,it.forwardRef)(function({disabled:t,data:o,onHover:n,isActive:r,label:i,iconKey:a,includeChildren:s,onClick:l,stopClickEventPropagation:p,...c},u){let m=(0,it.useRef)();(0,it.useEffect)(()=>{if(r&&m.current&&m.current.parentElement){let f=m.current,h=m.current.parentElement,_={top:h.scrollTop,bottom:h.clientHeight+h.scrollTop};if(f.offsetTop+f.clientHeight>_.bottom)h.scrollTo({behavior:"instant",top:f.offsetTop+f.clientHeight-h.clientHeight,left:h.scrollLeft});else if(f.offsetTop<_.top){let x=f;f.previousElementSibling instanceof HTMLElement&&f.previousElementSibling.classList.contains("maxai-context-menu-group-label")&&(x=f.previousElementSibling),h.scrollTo({behavior:"instant",top:x.offsetTop,left:h.scrollLeft})}}},[r]);let d=(0,lg.useMemo)(()=>{try{return`dropdown-menu--item--${o.text.replace(/\s+/g,"-").toLowerCase()}`}catch{return""}},[o.text]);return it.default.createElement(B,{...c,"aria-disabled":t,className:`floating-context-menu-item ${r?"floating-context-menu-item--active":""}`,tabIndex:r?0:-1,"data-testid":d,sx:{display:"flex",alignItems:"center",flexDirection:"row",gap:1,boxSizing:"border-box",px:1,borderRadius:"3px",height:"28px",fontSize:"14px",width:"100%",cursor:"pointer","&.floating-context-menu-item--active":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}},"& .floating-context-menu-item__footer-icon":{display:"none",flexShrink:0},"& .floating-context-menu-item__footer-icon--active":{display:"flex"},"&:hover":{bgcolor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(55, 53, 47, 0.08)","& .floating-context-menu-item__footer-icon":{display:"flex"}}},ref:f=>{f&&(u&&(typeof u=="function"?u(f):u.current=f),m.current=f)},component:"div",role:"menuitem",onMouseEnter:()=>{n?.(o)},onClick:f=>{l?.(o),p&&f.stopPropagation()}},a&&it.default.createElement(G,{size:16,icon:a,sx:{color:"primary.main",flexShrink:0}}),it.default.createElement(T,{fontSize:14,textAlign:"left",color:"text.primary",width:0,noWrap:!0,flex:1,lineHeight:"28px"},i),it.default.createElement("span",{className:"floating-context-menu-item__footer-icon "+(s?"floating-context-menu-item__footer-icon--active":"")},s?it.default.createElement(tI.default,{sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}):it.default.createElement(oI.default,{className:"floating-context-menu-item__footer-hover-icon",sx:{color:f=>f.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}})))}),uP=(e,t,o)=>ol(e,t,o,{animationFrame:!0}),eI=(0,it.forwardRef)(function({referenceElement:t,referenceElementRef:o,zIndex:n=1,children:r,root:i=document.body,open:a,needAutoUpdate:s=!0,sx:l,defaultPlacement:p,defaultFallbackPlacements:c,data:u,menuMaxHeight:m,menuWidth:d,onHover:f,onLeave:h,stopClickEventPropagation:_,...x},C){let y=c_(),b=Q1(),v=!b,S=!!b,[M,P]=(0,it.useState)(a??!1),O=(0,lg.useMemo)(()=>M||a,[a,M]),L=p||(v?"bottom-start":"right-start"),H=c||(v?["bottom-start","left","left-end","top-start","right"]:["right","right-start","right-end","left","left-start","left-end"]),{x:z,y:R,strategy:V,placement:F,refs:q,context:X}=ba({nodeId:y,open:O,onOpenChange:(N,ce,Z)=>{P(N),Z==="hover"&&(N?f?.(u):h?.(u))},placement:L,middleware:[Cu({mainAxis:v?4:0,alignmentAxis:v?0:-4}),bu({fallbackPlacements:H}),yu()],whileElementsMounted:s?uP:void 0}),W=qu(X,{role:"menu"}),j=ju(X),w=d_(X,{delay:{open:70,close:70},handleClose:h_({blockPointerEvents:!0})}),{getReferenceProps:ne,getFloatingProps:pe,getItemProps:A}=ml([W,j,w]),U=p_([q.setReference,C,o]);return it.default.createElement(u_,{id:y},t&&it.default.isValidElement(t)&&it.default.cloneElement(t,{...ne({...x,className:`${S?"MenuItem":"RootMenu"}`,...S&&{role:"menuitem"},ref:U})}),it.default.createElement(Wu,{root:i},O&&it.default.Children.count(r)!==0&&it.default.createElement(f_,{context:X,modal:!1,initialFocus:-1,visuallyHiddenDismiss:!0},it.default.createElement(g,{sx:{zIndex:n+1,display:"flex",flexDirection:"column",p:it.default.Children.count(r)===0?0:.5,outline:"none!important",maxHeight:m||340,boxSizing:"border-box",overflowY:"auto",border:"1px solid",borderColor:N=>N.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",bgcolor:"background.paper",borderRadius:1,boxShadow:F.includes("top")?"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px -3px 6px, rgba(15, 15, 15, 0.05) 0px -9px 24px":"rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px, rgba(15, 15, 15, 0.2) 0px 9px 24px","& *":{outline:"none!important"},"&:has(.max-ai--popper-wrapper)":{overflowY:"unset"},width:d,...l},component:"div",ref:q.setFloating,className:"Menu dropdown-menu",onClick:N=>{_&&N.stopPropagation()},style:{position:V,top:R??0,left:z??0},...pe()},it.default.Children.map(r,N=>it.default.isValidElement(N)&&it.default.cloneElement(N,{...A({})}))))))}),mP=(0,it.forwardRef)(function(t,o){return Q1()?it.default.createElement(eI,{...t,ref:o}):it.default.createElement(m_,null,it.default.createElement(eI,{...t,ref:o}))}),cg=mP;var Mt=I(E()),Td=(0,Mt.forwardRef)((e,t)=>{let{menuItem:o,onClick:n,root:r,zIndex:i,menuWidth:a,contextMenuNavigator:s,onClickGroup:l,...p}=e,{t:c}=k(),u=(0,Mt.useMemo)(()=>{let m=`context_menu__prompt__${o.prompt_id.replace(Zo,"")}`,d=`package__features:${m}`,f=c(d);return f!==d&&f!==m?f:o.prompt_title},[o.prompt_title,c]);return o.type==="group"?Mt.default.createElement(cg,{zIndex:i,ref:t,root:r,label:u,data:o,menuWidth:a,open:s.matchOpenGroup(o),onHover:()=>{s.onHover(o)},stopClickEventPropagation:!0,referenceElement:Mt.default.createElement(pg,{label:u,data:o,includeChildren:!0,onClick:l,iconKey:o.prompt_icon,isActive:s.match(o)})},(o.children??[]).map(m=>Mt.default.createElement(Td,{...p,zIndex:i+1,onClick:n,root:r,contextMenuNavigator:s,key:m.prompt_id,menuItem:m,menuWidth:a}))):Mt.default.createElement(pg,{data:o,ref:t,label:u,iconKey:o.prompt_icon,onClick:n,isActive:s.match(o),onHover:()=>{s.onHover(o)}})});Td.displayName="DropdownItemWrapper";var nI=()=>Mt.default.createElement(B,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,onClick:e=>{e.stopPropagation(),e.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0,0,0,0.12)",my:.5}}),dP=(0,Mt.forwardRef)(function(t,o){let{root:n,referenceElement:r,referenceElementRef:i,menuList:a=[],open:s,needAutoUpdate:l,defaultPlacement:p,defaultFallbackPlacements:c,onClickItem:u,menuWidth:m=450,zIndex:d=Ks()?0:2147483601,menuMaxHeight:f,noOptionFallback:h,onClickGroup:_,sx:x}=t,C=w2(),y=(0,Mt.useMemo)(()=>{let b=new gc;return b.setOnUpdate(C),b},[]);return(0,Mt.useImperativeHandle)(o,()=>({proxyKeyboardEvent:b=>y.proxyKeyboardEvent(b),getSelectedItem:()=>y.getSelectedItem()})),(0,Mt.useEffect)(()=>{y.setMenuList(a.filter(b=>typeof b=="object"))},[a]),Mt.default.createElement(cg,{zIndex:d,root:n,open:s,needAutoUpdate:l,referenceElement:r,referenceElementRef:i,defaultPlacement:p,defaultFallbackPlacements:c,onClick:u,menuMaxHeight:f,menuWidth:m,stopClickEventPropagation:!0,onLeave:()=>{y.onLeave()},sx:x},a.length===0&&h,a.map((b,v)=>{if(typeof b=="string"){let S=b.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[0],M=b.split("__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__")[1];return Mt.default.createElement(Mt.Fragment,{key:M+"_group_name"},v!==0&&nI(),Mt.default.createElement(B,{"aria-disabled":!0,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},className:"maxai-context-menu-group-label",onClick:P=>{P.stopPropagation(),P.preventDefault()}},Mt.default.createElement(B,{sx:{p:"3px 0 6px 0",pointerEvents:"none"}},Mt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},S)),M===Zo&&Mt.default.createElement($l,{sx:{ml:"auto"}})))}return b.type==="group"?Mt.default.createElement(Mt.Fragment,{key:b.prompt_id+"_group_name"},QC.includes(b.prompt_id)&&nI(),Mt.default.createElement(Td,{menuItem:b,root:n,zIndex:d+1,menuWidth:m,contextMenuNavigator:y,onClick:u,onClickGroup:_})):Mt.default.createElement(Td,{key:b.prompt_id,zIndex:d+1,root:n,menuItem:b,menuWidth:m,contextMenuNavigator:y,onClick:u})}))}),wd=dP;var Ed=I(E());var rI=I(pa());var xc=I(E()),ug=[{language_code:"uk",value:"Ukrainian",label:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},{language_code:"so",value:"Somali",label:"Af Soomaali"},{language_code:"af",value:"Afrikaans",label:"Afrikaans"},{language_code:"az",value:"Azerbaijani",label:"Az\u0259rbaycan dili"},{language_code:"id",value:"Indonesian",label:"Bahasa Indonesia"},{language_code:"ms-MY",value:"Malaysian Malay",label:"Bahasa Malaysia"},{language_code:"ms",value:"Malay",label:"Bahasa Melayu"},{language_code:"jv",value:"Javanese",label:"Basa Jawa"},{language_code:"su",value:"Sundanese",label:"Basa Sunda"},{language_code:"bs",value:"Bosnian",label:"Bosanski jezik"},{language_code:"ca",value:"Catalan",label:"Catal\xE0"},{language_code:"cs",value:"Czech",label:"\u010Ce\u0161tina"},{language_code:"ny",value:"Chichewa",label:"Chichewa"},{language_code:"cy",value:"Welsh",label:"Cymraeg"},{language_code:"da",value:"Danish",label:"Dansk"},{language_code:"de",value:"German",label:"Deutsch"},{language_code:"et",value:"Estonian",label:"Eesti keel"},{language_code:"en",value:"English",label:"English"},{language_code:"en-GB",value:"English (UK)",label:"English (UK)"},{language_code:"en-US",value:"English (US)",label:"English (US)"},{language_code:"es",value:"Spanish",label:"Espa\xF1ol"},{language_code:"eo",value:"Esperanto",label:"Esperanto"},{language_code:"eu",value:"Basque",label:"Euskara"},{language_code:"fr",value:"French",label:"Fran\xE7ais"},{language_code:"ga",value:"Irish",label:"Gaeilge"},{language_code:"gl",value:"Galician",label:"Galego"},{language_code:"hr",value:"Croatian",label:"Hrvatski jezik"},{language_code:"xh",value:"Xhosa",label:"isiXhosa"},{language_code:"zu",value:"Zulu",label:"isiZulu"},{language_code:"is",value:"Icelandic",label:"\xCDslenska"},{language_code:"it",value:"Italian",label:"Italiano"},{language_code:"sw",value:"Swahili",label:"Kiswahili"},{language_code:"ht",value:"Haitian Creole",label:"Krey\xF2l Ayisyen"},{language_code:"ku",value:"Kurdish",label:"Kurd\xEE"},{language_code:"la",value:"Latin",label:"Lat\u012Bna"},{language_code:"lv",value:"Latvian",label:"Latvie\u0161u valoda"},{language_code:"lb",value:"Luxembourgish",label:"L\xEBtzebuergesch"},{language_code:"lt",value:"Lithuanian",label:"Lietuvi\u0173 kalba"},{language_code:"hu",value:"Hungarian",label:"Magyar"},{language_code:"mg",value:"Malagasy",label:"Malagasy"},{language_code:"mt",value:"Maltese",label:"Malti"},{language_code:"mi",value:"Maori",label:"M\u0101ori"},{language_code:"nl",value:"Dutch",label:"Nederlands"},{language_code:"no",value:"Norwegian",label:"Norsk"},{language_code:"uz",value:"Uzbek",label:"O'zbek tili"},{language_code:"pl",value:"Polish",label:"Polski"},{language_code:"pt",value:"Portuguese",label:"Portugu\xEAs"},{language_code:"ro",value:"Romanian",label:"Rom\xE2n\u0103"},{language_code:"st",value:"Sesotho",label:"Sesotho"},{language_code:"sq",value:"Albanian",label:"Shqip"},{language_code:"sk",value:"Slovak",label:"Sloven\u010Dina"},{language_code:"sl",value:"Slovenian",label:"Sloven\u0161\u010Dina"},{language_code:"fi",value:"Finnish",label:"Suomi"},{language_code:"sv",value:"Swedish",label:"Svenska"},{language_code:"tl",value:"Tagalog",label:"Tagalog"},{language_code:"tt",value:"Tatar",label:"Tatar\xE7a"},{language_code:"tr",value:"Turkish",label:"T\xFCrk\xE7e"},{language_code:"vi",value:"Vietnamese",label:"Vi\u1EC7t ng\u1EEF"},{language_code:"yo",value:"Yoruba",label:"Yor\xF9b\xE1"},{language_code:"el",value:"Greek",label:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC"},{language_code:"be",value:"Belarusian",label:"\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F \u043C\u043E\u0432\u0430"},{language_code:"bg",value:"Bulgarian",label:"\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438 \u0435\u0437\u0438\u043A"},{language_code:"ky",value:"Kyrgyz",label:"\u041A\u044B\u0440"},{language_code:"kk",value:"Kazakh",label:"\u049A\u0430\u0437\u0430\u049B \u0442\u0456\u043B\u0456"},{language_code:"mk",value:"Macedonian",label:"\u041C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438 \u0458\u0430\u0437\u0438\u043A"},{language_code:"mn",value:"Mongolian",label:"\u041C\u043E\u043D\u0433\u043E\u043B \u0445\u044D\u043B"},{language_code:"ru",value:"Russian",label:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439"},{language_code:"sr",value:"Serbian",label:"\u0421\u0440\u043F\u0441\u043A\u0438 \u0458\u0435\u0437\u0438\u043A"},{language_code:"tg",value:"Tajik",label:"\u0422\u043E\u04B7\u0438\u043A\u04E3"},{language_code:"ka",value:"Georgian",label:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8"},{language_code:"hy",value:"Armenian",label:"\u0540\u0561\u0575\u0565\u0580\u0565\u0576"},{language_code:"yi",value:"Yiddish",label:"\u05D9\u05D9\u05B4\u05D3\u05D9\u05E9"},{language_code:"he",value:"Hebrew",label:"\u05E2\u05D1\u05E8\u05D9\u05EA"},{language_code:"ug",value:"Uyghur",label:"\u0626\u06C7\u064A\u063A\u06C7\u0631\u0686\u06D5"},{language_code:"ur",value:"Urdu",label:"\u0627\u0631\u062F\u0648"},{language_code:"ar",value:"Arabic",label:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},{language_code:"ps",value:"Pashto",label:"\u067E\u069A\u062A\u0648"},{language_code:"fa",value:"Persian",label:"\u0641\u0627\u0631\u0633\u06CC"},{language_code:"ne",value:"Nepali",label:"\u0928\u0947\u092A\u093E\u0932\u0940"},{language_code:"mr",value:"Marathi",label:"\u092E\u0930\u093E\u0920\u0940"},{language_code:"hi",value:"Hindi",label:"\u0939\u093F\u0928\u094D\u0926\u0940"},{language_code:"bn",value:"Bengali",label:"\u09AC\u09BE\u0982\u09B2\u09BE"},{language_code:"pa",value:"Punjabi",label:"\u0A2A\u0A70\u0A1C\u0A3E\u0A2C\u0A40"},{language_code:"gu",value:"Gujarati",label:"\u0A97\u0AC1\u0A9C\u0AB0\u0ABE\u0AA4\u0AC0"},{language_code:"or",value:"Oriya",label:"\u0B13\u0B21\u0B3C\u0B3F\u0B06"},{language_code:"ta",value:"Tamil",label:"\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD"},{language_code:"te",value:"Telugu",label:"\u0C24\u0C46\u0C32\u0C41\u0C17\u0C41"},{language_code:"kn",value:"Kannada",label:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},{language_code:"ml",value:"Malayalam",label:"\u0D2E\u0D32\u0D2F\u0D3E\u0D33\u0D02"},{language_code:"si",value:"Sinhala",label:"\u0DC3\u0DD2\u0D82\u0DC4\u0DBD"},{language_code:"th",value:"Thai",label:"\u0E44\u0E17\u0E22"},{language_code:"lo",value:"Lao",label:"\u0E9E\u0EB2\u0EAA\u0EB2\u0EA5\u0EB2\u0EA7"},{language_code:"my",value:"Burmese",label:"\u1017\u1019\u102C\u1005\u102C"},{language_code:"km",value:"Khmer",label:"\u1797\u17B6\u179F\u17B6\u1781\u17D2\u1798\u17C2\u179A"},{language_code:"ko",value:"Korean",label:"\uD55C\uAD6D\uC5B4"},{language_code:"zh",value:"Chinese",label:"\u4E2D\u6587"},{language_code:"zh-TW",value:"Traditional Chinese",label:"\u7E41\u9AD4\u4E2D\u6587"},{language_code:"ja",value:"Japanese",label:"\u65E5\u672C\u8A9E"}];function fP(e,{inputValue:t}){return e.filter(o=>{let n=o.label.toLowerCase(),r=o.value.toLowerCase(),i=t.toLowerCase();return n.includes(i)||r.includes(i)})}var hP=e=>{let{label:t="Output language",defaultValue:o="",onChange:n=l=>{},placeholder:r,sx:i}=e,[a,s]=(0,xc.useState)(()=>ug.find(l=>l.value===o)||ug[0]);return xc.default.createElement(Pu,{"data-testid":"system-variable--language-select",disablePortal:!0,disableClearable:!0,value:a,size:"small",sx:{[`.${I2.root}`]:{fontSize:16},[`.${j1.root}`]:{fontSize:16,paddingRight:"28px!important"},[`.${j1.root} fieldset > legend`]:{fontSize:14},[`.${k2.popupIndicator} .${rI.svgIconClasses.root}`]:{fontSize:24},...i},slotProps:{paper:{sx:{fontSize:16}}},ListboxProps:{style:{maxHeight:"144px"}},autoHighlight:!0,getOptionLabel:l=>l.label,options:ug,onChange:(l,p)=>{l.stopPropagation(),s(p),n(p.value)},onKeyDown:l=>{l.stopPropagation()},onPaste:l=>{l.stopPropagation()},filterOptions:fP,renderInput:l=>xc.default.createElement(zt,{...l,label:t,placeholder:r,InputLabelProps:{sx:{fontSize:"16px"},...l.InputLabelProps},inputProps:{sx:{fontSize:"16px"},...l.inputProps}})})},iI=hP;var aI=I(Y1()),mg=I(Z1());var Et=I(E()),gP=({onSelectOption:e,options:t,selectedOption:o,menuListBoxSx:n,sx:r})=>{let{t:i}=k(),a=(0,Et.useRef)(null),s=(0,Et.useRef)(null),[l,p]=(0,Et.useState)(""),[c,u]=(0,Et.useState)(null),m=(0,Et.useMemo)(()=>l===""?t:t.filter(x=>{let C=x.label.toLowerCase(),y=String(x.value).toLowerCase(),b=l.toLowerCase();return C.includes(b)||y.includes(b)}),[l,t]),d=(0,Et.useRef)(!1),f=m.length-1,h=x=>{u(C=>{if(C!==null){let y=x==="increase"?C+1:C-1;return y>=f?f:y<=0?0:y}return C})};(0,Et.useEffect)(()=>{s.current&&(s.current.focus(),setTimeout(()=>{s.current?.focus()},200))},[]),(0,Et.useEffect)(()=>{l!==""&&u(0)},[l]),(0,Et.useEffect)(()=>{if(a.current&&c!==null){let x=m[c];if(x){let C=a.current,y=C.querySelector(`[data-testid="maxai-client--ui--select-option--${x.value}"]`);if(y){let b=y.offsetTop-C.offsetTop;C.scrollTo({top:b,behavior:"smooth"})}}}},[c,m]);let _=()=>{if(!m.length)return Et.default.createElement(g,{width:"100%",justifyContent:"center",alignItems:"center",spacing:1},Et.default.createElement(mg.default,{sx:{fontSize:32,color:"text.secondary"}}),Et.default.createElement(T,{fontSize:12,color:"text.secondary"},i("package__ui:select__no_options__title")));let x=(C,y)=>{let b=o===C.value;return Et.default.createElement(Lu,{"data-testid":`maxai-client--ui--select-option--${C.value}`,selected:c===y,key:`${y}-${C.value}`,sx:[{py:"6px",px:"10px",borderRadius:1,mt:.5,"&.Mui-selected":{backgroundColor:"rgba(0, 0, 0, 0.04)"}}],onClick:v=>{v.stopPropagation(),e&&e(C)}},Et.default.createElement(Fp,{sx:{my:0},primary:Et.default.createElement(g,{direction:"row",alignItems:"center",sx:{color:"text.primary",fontSize:14}},Et.default.createElement(T,{fontSize:"inherit",noWrap:!0,sx:{color:"inherit"}},C.label),b?Et.default.createElement(aI.default,{sx:{fontSize:"inherit",color:"text.primary",ml:"auto"}}):null)}))};return Et.default.createElement(Iu,{sx:{p:0,width:"100%"},onKeyDown:C=>{C.key==="ArrowDown"&&(C.preventDefault(),h("increase")),C.key==="ArrowUp"&&(C.preventDefault(),h("decrease"))}},m.map((C,y)=>x(C,y)))};return Et.default.createElement(g,{sx:r},Et.default.createElement(zt,{inputRef:s,size:"small",value:l,onChange:x=>p(x.target.value),onCompositionStart:()=>d.current=!0,onCompositionEnd:()=>d.current=!1,placeholder:i("package__common:search"),InputProps:{startAdornment:Et.default.createElement(vr,{position:"start"},Et.default.createElement(mg.default,null)),sx:{fontSize:16}},inputProps:{autoComplete:"off"},sx:{pt:1,px:1,pb:.5},onKeyUp:x=>{x.stopPropagation()},onKeyDown:x=>{x.stopPropagation();let C=x.key;if((C==="ArrowDown"||C==="ArrowUp")&&(x.preventDefault(),c===null?u(0):h(C==="ArrowDown"?"increase":"decrease")),C==="Enter"&&c!==null&&!d.current){let y=m[c];x.preventDefault(),y&&e&&e(y)}}}),Et.default.createElement(B,{sx:{overflow:"auto",maxHeight:310,minHeight:310,px:1,pb:0,mb:1,overscrollBehavior:"contain",scrollbarColor:x=>x.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent",boxSizing:"border-box",display:"flex",...n},ref:a},_()))},sI=gP;var Mo=I(E()),xP=e=>{let{title:t,dataTestId:o,options:n,defaultValue:r,value:i="",onChange:a,disabled:s,sx:l,startIcon:p,endIcon:c="ExpandMore",labelMaxWidth:u=64,tooltipProps:m,popoverProps:d,...f}=e,[h,_]=(0,Mo.useState)(!1),[x,C]=(0,Mo.useState)(()=>n.find(M=>M.value===i)||n.find(M=>M.value===r)||n[0]),[y,b]=(0,Mo.useState)(!1),v=(0,Mo.useRef)(null),S=s?!1:h;return(0,Mo.useLayoutEffect)(()=>{let M=n.find(P=>P.value===i);M&&M.value!==x.value&&C(M)},[i]),wu(()=>{_(!1)}),Mo.default.createElement(Mo.default.Fragment,null,Mo.default.createElement(xe,{title:t,open:y&&!S,disabled:s,...m},Mo.default.createElement(de,{ref:v,disableRipple:!0,onMouseEnter:()=>{b(!0)},onMouseLeave:()=>{b(!1)},onClick:()=>{s||_(M=>!M)},className:h?"MAXAI_CLIENT__UI__SELECT":"","data-testid":o,startIcon:p?Mo.default.createElement(vr,{position:"start",sx:{marginRight:0}},typeof p=="string"?Mo.default.createElement(G,{icon:p,sx:{fontSize:"18px",mx:"4px",color:"text.secondary"}}):p):void 0,endIcon:c?Mo.default.createElement(vr,{position:"end",sx:{marginLeft:0,position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",zIndex:1,p:"6px"}},typeof c=="string"?Mo.default.createElement(G,{icon:c,sx:{color:"text.secondary",fontSize:"16px",transform:h?"rotate(180deg)":"rotate(0)"}}):c):void 0,sx:{minWidth:"unset",maxWidth:"120px",borderRadius:1,cursor:s?"default":"pointer","&:focus":{cursor:"default"},color:"text.secondary",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)",[`& .${ua.startIcon}`]:{mr:0},[`& .${ua.endIcon}`]:{ml:0,p:0},[`& .${ua.endIcon} .${N2.root}`]:{position:"static",transform:"none"},height:"32px",display:"flex",flexWrap:"nowrap",p:"4px 6px",alignItems:"center",justifyContent:"flex-start",fontSize:14,...l},...f},Mo.default.createElement(T,{noWrap:!0,fontSize:"inherit",maxWidth:u,textAlign:"left"},x.label))),Mo.default.createElement(dl,{transitionDuration:0,disableScrollLock:!0,...d,placement:"bottom-start",fallbackPlacements:["top-start"],open:h,onClose:()=>{_(!1)},anchorEl:v.current},Mo.default.createElement(sI,{selectedOption:i,options:n,onSelectOption:M=>{C(M),a?.(M.value),_(!1)}})))},Md=xP;var lI=I(E()),_P=[{label:"Default tone",value:"Default"},{label:"Authoritative",value:"Authoritative"},{label:"Casual",value:"Casual"},{label:"Clinical",value:"Clinical"},{label:"Cold",value:"Cold"},{label:"Confident",value:"Confident"},{label:"Cynical",value:"Cynical"},{label:"Emotional",value:"Emotional"},{label:"Empathetic",value:"Empathetic"},{label:"Formal",value:"Formal"},{label:"Friendly",value:"Friendly"},{label:"Humorous",value:"Humorous"},{label:"Informal",value:"Informal"},{label:"Ironic",value:"Ironic"},{label:"Optimistic",value:"Optimistic"},{label:"Pessimistic",value:"Pessimistic"},{label:"Playful",value:"Playful"},{label:"Professional",value:"Professional"},{label:"Sarcastic",value:"Sarcastic"},{label:"Serious",value:"Serious"},{label:"Straightforward",value:"Straightforward"},{label:"Sympathetic",value:"Sympathetic"},{label:"Tentative",value:"Tentative"},{label:"Warm",value:"Warm"}],CP=e=>{let{t}=k();return lI.default.createElement(Md,{title:t("package__features:shortcuts__set_variables_modal__system_selector__tone"),labelMaxWidth:"unset",startIcon:"GraphicEqualizer",sx:{maxWidth:"unset"},...e,options:_P})},pI=CP;var cI=I(E()),yP=[{label:"Default writing style",value:"Default"},{value:"Academic",label:"Academic"},{value:"Analytical",label:"Analytical"},{value:"Argumentative",label:"Argumentative"},{value:"Conversational",label:"Conversational"},{value:"Creative",label:"Creative"},{value:"Critical",label:"Critical"},{value:"Descriptive",label:"Descriptive"},{value:"Epigrammatic",label:"Epigrammatic"},{value:"Epistolary",label:"Epistolary"},{value:"Expository",label:"Expository"},{value:"Informative",label:"Informative"},{value:"Instructive",label:"Instructive"},{value:"Journalistic",label:"Journalistic"},{value:"Metaphorical",label:"Metaphorical"},{value:"Narrative",label:"Narrative"},{value:"Persuasive",label:"Persuasive"},{value:"Poetic",label:"Poetic"},{value:"Satirical",label:"Satirical"},{value:"Technical",label:"Technical"}],bP=e=>{let{t}=k();return cI.default.createElement(Md,{title:t("package__features:shortcuts__set_variables_modal__system_selector__writing_style"),labelMaxWidth:"unset",startIcon:"Feather",sx:{maxWidth:"unset"},...e,options:yP})},uI=bP;var IP=e=>{let{systemVariableSelectKey:t,...o}=e;switch(t){case"AI_RESPONSE_WRITING_STYLE":return Ed.default.createElement(uI,{...o});case"AI_RESPONSE_LANGUAGE":return Ed.default.createElement(iI,{...o});case"AI_RESPONSE_TONE":return Ed.default.createElement(pI,{...o});default:return null}},Ad=IP;var _c=class{constructor(){this.SET_VARIABLES_MODAL_SELECT_KEY="MAXAI_CLIENT__FEATURES__SET_VARIABLES_MODAL_SELECT_KEY"}async getSetVariablesModalSelectCache(){return await Rn.getItem(this.SET_VARIABLES_MODAL_SELECT_KEY)||{}}async setVariablesModalSelectCache(t,o){try{let n=await this.getSetVariablesModalSelectCache();return n[t]=o,await Rn.setItem(this.SET_VARIABLES_MODAL_SELECT_KEY,n),!0}catch{return!1}}};var Xl=new _c;var dI=I(Sr()),fI=I(pc()),hI=I(og());var Ae=I(E()),gI=I(Gs());var mI=!0,xI=(0,Ae.forwardRef)((e,t)=>{let{title:o,variables:n,modelKey:r,onShow:i,onClose:a,onBeforeRunShortcuts:s,onChange:l,onBeforeClose:p,onInputCustomVariable:c,actions:u,answerInsertMessageId:m,askChatGPTActionParameters:d,showCloseButton:f=!0,isSaveLastRunShortcuts:h,disabled:_,sx:x,notBuiltInVariables:C,includeHistory:y,autoFocusAfterBlur:b=!1,disableCachingSystemVariableValue:v=!1,disabledResetFormOnConfirmModal:S=!1,MaxAIPromptActionConfig:M}=e,{betaSettings:P}=Wo(),{askAIWithShortcutsV2:O,askAIWithShortcuts:L,shortCutsEngine:H,stopGenerate:z}=ke(),R=St(),{conversationId:V,conversationType:F,conversation:q}=ie(),X=fe(V),{localSettings:W}=tt(),{t:j}=k(),[w,ne]=(0,Ae.useState)(!1),pe=(0,Ae.useMemo)(()=>F!=="Chat"&&!w,[F,w]),A=Ca(),[U,N]=(0,Ae.useState)(null),ce=(0,Ae.useRef)(null),[Z,re]=(0,Ae.useState)([]),{control:bt,getValues:be,setValue:Ce,register:we,trigger:qe,reset:Ze,clearErrors:Kt,formState:{errors:Fe,isValid:pt}}=vu(),[ct,kt]=(0,Ae.useState)({}),Ke=async te=>{p&&!p()||(Z.forEach(ze=>{ze.resolve({data:be(),type:te?"cancel":"close",success:!1})}),r!=="PromptPreview"&&(Ze(),kt({}),ne(!1),a?.("close")))},Dt=async()=>{let te=await qe();return!te&&!w&&ne(!0),te},ut=async te=>{if(!(X||_)){if(Ru(te)){let ze=ce.current?.querySelectorAll("textarea[id]")?.[te+1];if(ze){ze.focus();return}}if(U?.waitForUserAction){if(!await Dt())return;Z.forEach(ze=>{ze.resolve({data:be(),type:"confirm",success:!0})})}else await Y(!1)}},Y=(0,Ae.useCallback)(async(te,ze={})=>{let{ignoreChatHubLoading:gt=!1}=ze,xt=Object.values(be()).filter(zs=>String(zs||"").trim()==="").length>0;if(!await Dt()){te&&xt&&Kt();return}if(te&&xt){ne(!0);return}let Je=Ee(be());r!=="PromptPreview"&&!S&&(kt({}),Ze(),ne(!1)),l?.({data:Je,type:"change",success:!0},"runPromptStart");let Oo=[];if(U?.template||U?.MaxAIPromptActionConfig||M){let zs=String(Je?.TEMPLATE||U?.template||U?.title||""),E1={...U?.variables?.reduce((ve,ro)=>({...ve,[ro.name]:ro}),{})},ln={};if(Object.keys(Je).forEach(ve=>{let ro=E1[ve];if(ro?.hidden){if(mI)return;ro.hint="(Dev show) "+ro.hint}ro?(ln[ve]={key:ve,value:Je[ve],overwrite:!0,label:ro.hint},(C||U?.notBuiltInVariables)?.includes(ve)&&(ln[ve].isBuiltIn=!1)):ln[ve]={key:ve,value:Je[ve],overwrite:!0}}),!ln.SELECTED_TEXT){let ve=U?.variables?.find(ro=>ro.name==="SELECTED_TEXT");ve&&(ln.SELECTED_TEXT={key:"SELECTED_TEXT",value:ve.default_value,isBuiltIn:!0,overwrite:!0,label:"patch selected text not found"})}if(!ln.SELECTED_TEXT&&ln.MAXAI_CONTINUE_WRITING_TEXT_DRAFT&&(ln.MAXAI_CONTINUE_WRITING_TEXT_DRAFT.isBuiltIn=!0,ln.SELECTED_TEXT={...ln.MAXAI_CONTINUE_WRITING_TEXT_DRAFT,key:"SELECTED_TEXT"}),W.chatMode!=="pro_chat"){let ve=ln.AI_RESPONSE_TONE;ve&&(ve.value="Default");let ro=ln.AI_RESPONSE_WRITING_STYLE;ro&&(ro.value="Default")}Oo.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:ln}});let nu=Ee(u||U?.actions||[]);Oo.push(...nu),Oo.push({type:"RENDER_TEMPLATE",parameters:{template:zs}});let wp=m||U?.answerInsertMessageId||"",ru=d||U?.askChatGPTActionParameters||{},iu=y??U?.includeHistory??void 0,au={type:"ASK_CHATGPT",parameters:{template:"{{LAST_ACTION_OUTPUT}}",AskChatGPTActionType:wp?"ASK_CHAT_GPT_HIDDEN":"ASK_CHAT_GPT_WITH_PREFIX",AskChatGPTActionQuestion:{text:"{{LAST_ACTION_OUTPUT}}",meta:Ro([{includeHistory:!0,...wp?{outputMessageId:wp}:{}},U?.questionMeta||{}])},MaxAIPromptActionConfig:Ee(U?.MaxAIPromptActionConfig||M),...ru}};iu!==void 0&&(au.parameters.AskChatGPTActionQuestion.meta.includeHistory=iu),Oo.push(au);let su=await s?.();await(P?.appearance_v2_enabled?O:L)(Oo,{isSaveLastRunShortcuts:h,conversationId:su?su.id:void 0,isNeedAttachments:!1}).then(()=>{let ve=H?.getNextAction()?.error||""}).catch(ve=>{}).finally(()=>{r!=="PromptPreview"&&!S&&(Ze(),kt({}),ne(!1),a?.("runPrompt")),l?.({data:be(),type:"change",success:!0},"runPromptEnd")})}},[W.chatMode,O,P?.appearance_v2_enabled,L,Kt,be,h,l,a,Ze,H,Dt,U,u,m,d,r,C,y,S,q]),$=(0,Ae.useMemo)(()=>{let te={},ze=n||U?.variables||[],gt=o||U?.title||"";if(U?.MaxAIPromptActionConfig?.prompt_id){let ve=U.MaxAIPromptActionConfig.prompt_id,ro=`package__features:context_menu__prompt__${ve}`;O1().t(ro).includes(ve)||(gt=O1().t(ro))}let xt=[],Je=[],Oo=be();r==="PromptPreview"&&Ze(),ze.forEach(ve=>{let ro=r==="PromptPreview"&&Oo[ve.name]!==void 0?Oo[ve.name]:ve.default_value?.trim();if(ve.hidden){if(mI)return;ve.hint?.startsWith("(Dev show) ")||(ve.hint="(Dev show) "+ve.hint)}ve.type==="select"&&xt.push(ve),ve.type==="text"&&(Je.push(ve),Object.prototype.hasOwnProperty.call(Oo,ve.name)&&Ce(ve.name,ro));let Rs=ve.optional?[]:[{required:!0,message:""}];te[ve.name]=we(ve.name,{value:ro,validate:kw=>{for(let Y0 of Rs)if(Y0.required&&!kw)return Y0.message||`${ve.hint} is required`;return!0}})});let zs=xt.length,E1=typeof window>"u"?580:window.innerHeight*.6,ln=xt.length+Je.length>0?36:30,nu=Math.ceil(zs/3),wp=nu*48+(nu-1)*16,ru=Je.length,iu=(ru-1)*16,au=16*3,su=E1-ln-wp-iu-au,X0=Math.max(Math.floor(su/24/ru)-3,2);return Xl.getSetVariablesModalSelectCache().then(ve=>{let ro=Object.keys(te);ro.length!==0&&(ro.forEach(Rs=>{ve[Rs]!==void 0&&Ce(Rs,ve[Rs])}),kt(te))}),{titleHeight:ln,currentTitle:gt,currentSelectTotalCount:zs,selectTypeVariables:xt,textTypeVariables:Je,maxTextareaMaxRows:X0,minTextareaMaxRows:2}},[n,o,r,U]);(0,Ae.useEffect)(()=>{let te=is.receive(`SetVariablesModal_${V}`,ze=>new Promise((gt,xt)=>{ze.task==="open"&&(kt({}),Ze(),N(ze.config),ne(!1),setTimeout(()=>{ze.config.waitForUserAction?re([{resolve:gt,reject:xt}]):gt({data:Ee(ct),type:"confirm",success:!0})},200))}));return()=>{te()}},[V]);let J=(0,Ae.useRef)(Y);J.current=Y,(0,Ae.useEffect)(()=>{if(!H)return;let te=(ze,{currentAction:gt})=>{ze==="afterRunAction"&&gt&&gt.type==="SET_VARIABLES_MODAL"&&J.current(!0,{ignoreChatHubLoading:!0}).then().catch(xt=>{})};return H.addListener(te),()=>{H.removeListener(te)}},[H]);let D=()=>{let te=Array.from(ce.current?.querySelectorAll("textarea")||[]);if(te.length===0)return;let ze=te.find(gt=>!gt.hasAttribute("aria-hidden")&&gt.value==="")||te[0];return ze&&(ze.focus(),ze.setSelectionRange(0,0)),ze};(0,Ae.useEffect)(()=>{if(w){if(pe)a?.("reset");else if(setTimeout(()=>{D()},500),i?.(),b){let te=()=>{D()};return setTimeout(()=>{ce.current?.removeEventListener("focusout",te)},500),ce.current?.addEventListener("focusout",te),()=>{ce.current?.removeEventListener("focusout",te)}}}},[w,pe]);let K=(0,Ae.useRef)(null),Q=te=>{K.current=te},ae=()=>{K.current?K.current.focus():D()};(0,Ae.useImperativeHandle)(t,()=>({discard:()=>Ke(!0),focusLastFocusInput:ae}));let oe=fe(V),He=(0,Ae.useRef)(!1);return!e.show&&(!w||pe||Object.keys(ct).length===0)||oe?null:Ae.default.createElement(g,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,gap:1,boxSizing:"border-box",...x},maxHeight:"60vh",onKeyPressCapture:te=>{te.stopPropagation()},onKeyPress:te=>{te.stopPropagation()}},Ae.default.createElement(g,{flexShrink:0,height:$.titleHeight,direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%"},Ae.default.createElement(B,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},Ae.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:30,lineHeight:"30px",sx:{textAlign:"left",borderRadius:"8px",p:"0 8px",bgcolor:"rgba(0, 0, 0, 0.87)",width:r!=="PromptPreview"?"100%":"auto"},noWrap:!0},$.currentTitle)),f&&Ae.default.createElement(Re,{"data-testid":"close-modal-button",onClick:async()=>await Ke(!0),sx:{flexShrink:0,position:"relative",top:"-8px",right:"-8px"}},Ae.default.createElement(dI.default,{sx:{fontSize:"24px"}}))),Ae.default.createElement(g,{flexShrink:0,flexWrap:"wrap",direction:"row",display:$.selectTypeVariables.length?void 0:"none",sx:{gap:"16px"}},$.selectTypeVariables.map((te,ze)=>{if(te.type==="select"){let gt=R?.querySelector('div[data-testid="maxai--chat-box--tools--left-container--portal-root"]');return gt?gI.default.createPortal(Ae.default.createElement(rl,{key:te.name,control:bt,name:te.name,defaultValue:te.default_value,render:({field:xt})=>Ae.default.createElement(Ad,{systemVariableSelectKey:te.name,key:te.name,defaultValue:xt.value,onChange:Je=>{v||Xl.setVariablesModalSelectCache(te.name,Je),xt.onChange(Je)}})}),gt):void 0}return null})),Ae.default.createElement(g,{component:"div",direction:"row",flexWrap:"wrap",gap:2,paddingTop:1,ref:ce,flex:1,height:0,display:$.textTypeVariables.length?void 0:"none",sx:{overflowY:"auto"}},$.textTypeVariables.map((te,ze)=>{let gt=(A==="lg"||A==="xl")&&$.textTypeVariables.length>1?"calc(50% - 8px)":"100%",xt=$.minTextareaMaxRows*23+17;return Ae.default.createElement(zt,{"data-testid":`custom-variable--${te.name}`,sx:{width:gt},size:"small",key:te.name,label:te.label||te.hint||"Label",...ct[te.name],onKeyUp:Je=>{c?.({data:be(),type:"input",success:!0,variables:$.textTypeVariables}),Je.stopPropagation()},onKeyDown:async Je=>{Je.key==="Enter"&&!Je.shiftKey&&!He.current?(Je.stopPropagation(),Je.preventDefault(),await ut(ze)):Je.stopPropagation()},onCompositionStart:()=>{He.current=!0},onCompositionEnd:()=>{He.current=!1},onPaste:Je=>{Je.stopPropagation()},InputProps:{sx:{fontSize:"16px",minHeight:xt}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},error:!!Fe[te.name],helperText:Fe[te.name]?.message||"",InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:te.hint,minRows:$.minTextareaMaxRows,maxRows:$.maxTextareaMaxRows,onFocus:Je=>Q(Je.target)})})),Ae.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",gap:1,flexShrink:0},Ae.default.createElement(xe,{title:j(X?"package__features:chat__inputbox__button__stop_generating__tooltip":"package__features:chat__inputbox__button__send_to_ai__tooltip"),description:X?void 0:"\u23CE",placement:"bottom",disabled:_||!pt},Ae.default.createElement(de,{"data-testid":"sidebar-variables-modal--send-btn",disabled:X?_:_||!pt,onClick:()=>{X?z():ut()},variant:"contained",sx:{width:"32px",height:"32px",minWidth:"unset",borderRadius:"8px"}},X?Ae.default.createElement(hI.default,{sx:{fontSize:"16px",color:"white !important"}}):Ae.default.createElement(fI.default,{sx:{fontSize:"16px"}})))))});xI.displayName="ActionSetVariablesModal";var Pd=Ae.default.memo(xI);var FI=I(Sr());var _e=I(E());var Fd=I(E());var OI=I(E());var Pr=I(E()),SP=e=>{let{anchorElementSelectors:t='[data-testid="max-ai__ai-provider-floating-button"]',placement:o="top",...n}=e,{t:r}=k(),[i,a]=Pr.default.useState(!0),{localSettings:s}=tt(),[l,p]=Pr.default.useState(!1),c=(0,Pr.useCallback)(async()=>{await Ue.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_CLICK_PRO_CHAT_SWITCH")&&s.chatMode==="pro_chat"&&p(!0)},[s.chatMode]);return(0,Pr.useEffect)(()=>{Ue.getOnboardingDataByKey(fc).then(u=>a(!!u))},[]),(0,Pr.useEffect)(()=>{i||c()},[i,c]),i?null:Pr.default.createElement(Tt,{placement:o,trigger:l,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData(fc,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Choose a smarter AI > Got it"},...n},Pr.default.createElement(g,{spacing:.5},Pr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__ai_model_selector__title")),Pr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__ai_model_selector__description"))))},_I=SP;var kd=class{constructor(t=!1){this.defaultCaptureEvent=t;this.executionIndex=new Map;this.eventMap=new Map}add(t,o,n,r=0,i=this.defaultCaptureEvent){this.eventMap.has(t)||this.eventMap.set(t,new Map);let a=this.eventMap.get(t);if(!a.has(o)){a.set(o,[]);let l=p=>{let c=!0,u=a.get(o).sort((m,d)=>d.priority-m.priority);for(let m of u){let d=new Proxy(p,{get(f,h){if(h==="stopSpread")return()=>{c=!1};let _=f[h];return typeof _=="function"?_.bind(f):_}});if(m.handler(d),!c)break}};t.addEventListener(o,l,i),a.set(`${o}_proxy`,[{handler:l,priority:0}])}a.get(o).push({handler:n,priority:r})}remove(t,o,n,r=this.defaultCaptureEvent){let i=this.eventMap.get(t);if(!i)return;let a=i.get(o);if(!a)return;let s=a.findIndex(l=>l.handler===n);if(s>-1&&a.splice(s,1),a.length===0){let l=i.get(`${o}_proxy`);l&&l[0]&&t.removeEventListener(o,l[0].handler,r),i.delete(o),i.delete(`${o}_proxy`)}i.size===0&&this.eventMap.delete(t)}removeAll(t){let o=this.eventMap.get(t);if(o){for(let n of o.keys()){if(n.endsWith("_proxy"))continue;let r=o.get(`${n}_proxy`);r&&r[0]&&t.removeEventListener(n,r[0].handler)}this.eventMap.delete(t)}}executeOnPriority(t,o,n){let r=this.eventMap.get(t);if(!r)return!0;let i=r.get(o);if(!i||i.length===0)return!0;if(o==="keydown"&&n?.event instanceof KeyboardEvent){let m=n.event;if(n.keys&&!n.keys.includes(m.key))return!0}let a=`${t.toString()}_${String(o)}`,s=this.executionIndex.get(a)??0,l=[...i].sort((m,d)=>d.priority-m.priority);if(s>=l.length)return this.executionIndex.delete(a),!0;let p=l[s],c=n?.event||new Event(o),u=new Proxy(c,{get:(m,d)=>{if(d==="stopSpread")return()=>{this.executionIndex.delete(a)};let f=m[d];return typeof f=="function"?f.bind(m):f}});return p.handler(u),this.executionIndex.set(a,s+1),!1}};var Ld=class{static{this.managers=new Map}static getManager(t,o=!1){return this.managers.has(t)||this.managers.set(t,new kd(o)),this.managers.get(t)}static removeManager(t){this.managers.has(t)&&this.managers.delete(t)}static clear(){this.managers.clear()}};var Ki=I(E()),CI=(0,Ki.createContext)(null);function yI({children:e,managerId:t="default",defaultCaptureEvent:o=!1}){let n=(0,Ki.useRef)(Ld.getManager(t,o)),r=(0,Ki.useRef)((a,s)=>{a.stopPropagation(),a.preventDefault(),s&&a.stopSpread()}),i={domEventManager:n.current,stopPropagation:r.current};return Ki.default.createElement(CI.Provider,{value:i},e)}function Od(){let e=(0,Ki.useContext)(CI);if(!e)throw new Error("useDomEventManager must be used within DomEventManagerProvider");return e}var ir=I(E());function Yl({open:e,onOpenChange:t,onOpen:o,onClose:n,delay:r=100}={}){let[i,a]=(0,ir.useState)(!1),s=e??i,l=typeof r=="object"?r.open??100:r,p=typeof r=="object"?r.close??-1:r,c=(0,ir.useRef)(),u=(0,ir.useCallback)(()=>{c.current&&(clearTimeout(c.current),c.current=void 0)},[]),m=(0,ir.useCallback)(x=>{if(e!==void 0){t?.(x);return}a(x),x?o?.():n?.()},[e,t,o,n]),d=(0,ir.useCallback)(()=>{if(u(),l<0){m(!0);return}c.current=setTimeout(()=>{m(!0)},l)},[u,m,l]),f=(0,ir.useCallback)(()=>{if(u(),p<0){m(!1);return}c.current=setTimeout(()=>{m(!1)},p)},[u,m,p]),h=(0,ir.useRef)(s);h.current=s;let _=(0,ir.useCallback)((x=h.current)=>{x?f():d()},[f,d]);return(0,ir.useEffect)(()=>()=>{u()},[u]),{open:s,setUncontrolledOpen:a,setOpen:m,handleOpen:d,handleClose:f,handleToggle:_,clearTimer:u}}var Eo=I(E()),bI="maxai-popper-dropdown-menu",vP=({referenceElement:e,children:t,contentSx:o,contentProps:n,hoverOpen:r=!1,delay:i=0,open:a,onOpenChange:s,width:l=200,onMouseEnter:p,onMouseLeave:c,onOpen:u,onClose:m,sx:d,customTransitionProps:f,referenceElementBoxProps:h,isMirror:_=!1,headless:x=!1,isCloseOnBlur:C=!0,...y})=>{let{open:b,handleOpen:v,handleClose:S,setUncontrolledOpen:M}=Yl({open:a,onOpenChange:s,onOpen:u,onClose:m,delay:i}),P=(0,Eo.useRef)(null),O=(0,Eo.useRef)(null),L=(0,Eo.useCallback)(()=>{r||M(V=>!V)},[r,M]);(0,Eo.useEffect)(()=>{let V=F=>{if(!O.current||!P.current)return;if(F instanceof FocusEvent){S();return}let{clientX:q,clientY:X}=F,W=O.current.getBoundingClientRect(),j=P.current.getBoundingClientRect(),w=ne=>q>=ne.left&&q<=ne.right&&X>=ne.top&&X<=ne.bottom;w(j)||w(W)||(S(),F.stopPropagation())};return document.addEventListener("mousedown",V),C&&window.addEventListener("blur",V),()=>{document.removeEventListener("mousedown",V),C&&window.removeEventListener("blur",V)}},[S,C]);let H=(0,Eo.useCallback)(V=>{r&&v(),p?.(V)},[r,v,p]),z=(0,Eo.useCallback)(V=>{r&&S(),c?.(V)},[r,S,c]),R=(0,Eo.useMemo)(()=>({onMouseEnter:H,onMouseLeave:z}),[H,z]);return Eo.default.createElement(Eo.default.Fragment,null,Eo.default.createElement(B,{ref:P,onClick:L,...R,...h},e),Eo.default.createElement(xx,{...y,...R,sx:{zIndex:1,...p2({isMirror:_,popperSelector:"data-popper-placement",menuClassName:bI}),...d},open:b,anchorEl:P.current,transition:!0},({TransitionProps:V})=>Eo.default.createElement(gx,{className:bI,...V,...f},Eo.default.createElement(B,{...n,component:"div",ref:O,sx:x?{width:l,...o}:{borderRadius:1,border:"1px solid",borderColor:"border.main",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",boxSizing:"border-box",overflow:"hidden",width:l,bgcolor:F=>F.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...o},onMouseDownCapture:F=>F.stopPropagation()},t))))},Na=(0,Eo.memo)(vP);var ft=I(E());var go=I(E());var dg=class e extends Jx{constructor(){super()}static getInstance(){return this.instance||(this.instance=new e),this.instance}},Zl=()=>dg.getInstance();var za=I(E());var _s=I(E()),TP=({model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:p})=>{let{t:c}=k(),{label:u,children:m}=e,d=ca(u||"",c);return _s.default.createElement(_s.default.Fragment,null,d&&_s.default.createElement(mt,{sx:{fontSize:"12px",lineHeight:"18px",fontWeight:500,p:"2px 8px",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",opacity:"1!important",mt:n===0?void 0:"4px",minHeight:"unset"},disabled:!0},d+" AI"),m?.map(f=>_s.default.createElement(p,{key:f.key,model:f,selectedModel:t,onSelect:o,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})))},II=(0,_s.memo)(TP);var SI=I(E()),wP=({sx:e,children:t,...o})=>SI.default.createElement(T,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"text.primary",...e},...o},t),Ql=wP;var Jo=I(E());var Bd=I(E()),MP=e=>{let{tag:t,...o}=e,{t:n}=k(),r=ca(t,n);return r==="New"?Bd.default.createElement(T,{component:"span",bgcolor:"rgba(52, 168, 83, 1)",color:"#fff",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r):r==="Beta"?Bd.default.createElement(T,{component:"span",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",border:"1px solid",borderColor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r):Bd.default.createElement(T,{component:"span",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.06)",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)",fontSize:"9px",fontWeight:500,px:"4px",py:"1px",borderRadius:"4px",lineHeight:1.5,whiteSpace:"nowrap",...o},r)},vI=MP;var EP=({model:e,selectedModel:t,onSelect:o,isKeyOrChildrenFocused:n,onFocusKey:r,zIndex:i,parentOpen:a})=>{let{t:s}=k(),{key:l,label:p,value:c}=e,u=ca(p||"",s),m=c,{open:d,handleOpen:f,handleClose:h}=Yl({delay:{open:100}});(0,Jo.useEffect)(()=>{a===!1&&h()},[a,h]),(0,Jo.useEffect)(()=>{n===!1&&h()},[n,h]);let _=(0,Jo.useCallback)(()=>{f(),r?.(l)},[l,r,f]),x=(0,Jo.useRef)(null);return Mu(x,C=>{C||requestAnimationFrame(()=>{h()})}),m?Jo.default.createElement(xe,{open:d,placement:"right",sx:{maxWidth:"200px"},disableInteractive:!0,TransitionProps:{timeout:{enter:300,exit:0}},PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["right","left"]}}]},zIndex:i,title:bC(m,s)},Jo.default.createElement(mt,{component:"div",key:l,ref:x,"data-testid":`maxai--ai-model-selector--menu-item--${m.value}`,"data-menu-item-key":l,disabled:m.disabled,selected:m.value===t,onClick:()=>{o(m),h()},onMouseEnter:_,onMouseLeave:h,sx:{...fu,...n&&{backgroundColor:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},Jo.default.createElement(g,{alignItems:"center",direction:"row",spacing:1,sx:hu},Jo.default.createElement(Mn,{model:m.value}),Jo.default.createElement(Ql,{fontSize:"14px",lineHeight:"21px"},u),Jo.default.createElement(g,{direction:"row",alignItems:"center",sx:{ml:"auto !important"}},m.tag&&Jo.default.createElement(vI,{tag:m.tag}))))):null},TI=(0,Jo.memo)(EP);var MI=I(ty());var yt=I(E());var AP=({model:e,selectedModel:t,onSelect:o,onFocusKey:n,zIndex:r,eventPriority:i,parentOpen:a,isKeyOrChildrenFocused:s,MainComponent:l})=>{let{t:p}=k(),{key:c,label:u,children:m}=e,d=ca(u||"",p),{open:f,handleOpen:h,handleClose:_}=Yl({delay:{open:100}}),[x,C]=(0,yt.useState)(!1),y=(0,yt.useRef)(0),[b,v]=(0,yt.useState)(""),S=(0,yt.useCallback)(()=>{_(),y.current=0,v(""),C(!1)},[_]),M=(0,yt.useCallback)((j=!0)=>{h(),j&&C(!0)},[h]);(0,yt.useEffect)(()=>{(!s||a===!1)&&S()},[S,a,s]);let P=(0,yt.useCallback)(j=>{o(j),S()},[o,S]),O=(0,yt.useRef)(null),L=(0,yt.useCallback)(()=>{O.current=setTimeout(()=>{S()},300)},[S]),H=(0,yt.useCallback)(()=>{n?.(c),O.current&&clearTimeout(O.current),M(!1)},[c,n,M]),z=(0,yt.useCallback)(j=>{C(!0),v(j),m&&(y.current=m?.findIndex(w=>w?.key===j))},[m]),{domEventManager:R,stopPropagation:V}=Od(),[F,q]=(0,yt.useState)(!1),X=Zl();(0,yt.useEffect)(()=>{let j=ne=>{if(!m?.length)return;let pe=()=>V(ne,!0);switch(["ArrowDown","ArrowUp"].includes(ne.key)&&m?.length>1&&(q(!0),requestAnimationFrame(()=>{X.emit("scrollToItem",m[y.current].key)})),ne.key){case"ArrowRight":if(!s)return;pe(),m?.[0]&&v(m[0].key),M();break;case"ArrowUp":if(!f||!x||!s)return;pe(),y.current=(y.current-1+m.length)%m.length,v(m[y.current].key);break;case"ArrowDown":if(!f||!x||!s)return;pe(),y.current=(y.current+1)%m.length,v(m[y.current].key);break;case"Enter":{if(!f||!x||!s)return;pe();let A=m[y.current];A?.value&&P(A.value);break}case"Tab":pe();break}},w=()=>{q(!1)};return R.add(document,"keydown",j,i),R.add(document,"mousemove",w),()=>{R.remove(document,"keydown",j),R.remove(document,"mousemove",w)}},[X,m,R,i,M,P,x,s,c,f,V]),(0,yt.useEffect)(()=>{let j=w=>{if(!m?.length)return;let ne=()=>V(w,!0);switch(w.key){case"Escape":case"ArrowLeft":if(!f)return;ne(),S();break}};return s&&R.add(document,"keydown",j,i,!0),()=>{R.remove(document,"keydown",j,!0)}},[m?.length,R,i,S,f,V,s]);let W=(0,yt.useRef)(null);return Mu(W,j=>{j||requestAnimationFrame(()=>{S()})}),yt.default.createElement(Na,{open:f,placement:"right-start",sx:{zIndex:r},contentSx:{display:s?"block":"none"},onMouseEnter:H,onMouseLeave:L,modifiers:[{name:"flip",options:{fallbackPlacements:["left-start"]}}],customTransitionProps:{timeout:{enter:300,exit:0}},referenceElementBoxProps:{component:"li","data-menu-item-key":c,"data-testid":`maxai--ai-model-selector--menu-more-item--${c}`,sx:{display:"flex",alignItems:"center",cursor:"pointer",...fu,...s&&{backgroundColor:j=>j.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},referenceElement:yt.default.createElement(g,{ref:W,alignItems:"center",direction:"row",spacing:1,sx:hu},yt.default.createElement(G,{icon:"More",size:20,sx:{color:j=>j.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)"}}),yt.default.createElement(Ql,{fontSize:"14px",lineHeight:"21px"},d),yt.default.createElement(MI.default,{sx:{ml:"auto !important",color:j=>j.palette.mode==="dark"?"#ffffff85":"rgba(55, 53, 47, 0.45)",fontSize:16}}))},yt.default.createElement(hi,{sx:{scrollPaddingBlock:"6px",cursor:F?"none":"default","& *":{cursor:F?"none !important":"",pointerEvents:F?"none":"auto"}}},m?.map(j=>yt.default.createElement(l,{key:j.key,model:j,selectedModel:t,onSelect:P,focusKey:b,onFocusKey:z,zIndex:r&&r+1,eventPriority:i&&i+1,parentOpen:f}))))},EI=(0,yt.memo)(AP);var fg=({model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l})=>{let{type:p="item"}=e,c=(0,za.useMemo)(()=>{let u=m=>m.key===r?!0:m.children?m.children.some(d=>u(d)):!1;return u(e)},[e,r]);switch(p){case"item":return za.default.createElement(TI,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,parentOpen:l,isKeyOrChildrenFocused:c});case"group":return za.default.createElement(II,{model:e,selectedModel:t,onSelect:o,listItemIndex:n,focusKey:r,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:fg});case"more":return za.default.createElement(EI,{model:e,selectedModel:t,onSelect:o,onFocusKey:i,zIndex:a,eventPriority:s,parentOpen:l,MainComponent:fg,isKeyOrChildrenFocused:c});default:return null}},AI=(0,za.memo)(fg);var PP=e=>{let{conversationType:t,AIModel:o,onSelect:n,onClose:r,buttonRef:i,sx:a,parentOpen:s}=e,l=(0,go.useMemo)(()=>s_(t),[t]),p=i?.current?.getBoundingClientRect()??{y:0,height:0},c=p.y-10,u=window.innerHeight-p.y-p.height-10,m=Math.max(c,u),d=Math.min(m,370),f=(0,go.useCallback)(async L=>{n?.(t,L.AIProvider,L.value)},[t,n]),h=(0,go.useMemo)(()=>l.flatMap(L=>L.children),[l]),_=(0,go.useRef)(-1),[x,C]=(0,go.useState)(""),y=(0,go.useCallback)(L=>{C(L),_.current=h.findIndex(H=>H?.key===L)},[h]),{domEventManager:b,stopPropagation:v}=Od(),[S,M]=(0,go.useState)(!1),P=Zl();(0,go.useEffect)(()=>{let L=z=>{if(!h?.length)return;let R=()=>v(z);switch(["ArrowDown","ArrowUp"].includes(z.key)&&(M(!0),requestAnimationFrame(()=>{P.emit("scrollToItem",h[_.current]?.key??"")})),z.key){case"ArrowDown":R(),_.current=(_.current+1)%h.length,C(h[_.current]?.key??"");break;case"ArrowUp":R(),_.current=_.current<0?h.length-1:(_.current-1+h.length)%h.length,C(h[_.current]?.key??"");break;case"Escape":R(),r?.();break;case"Enter":{R();let V=h?.[_.current];V?.value&&f(V.value);break}case"Tab":R();break}},H=()=>{M(!1)};return b.add(document,"keydown",L,1),b.add(document,"mousemove",H),()=>{b.remove(document,"keydown",L),b.remove(document,"mousemove",H)}},[h,f,v,r,b,P]),(0,go.useEffect)(()=>{let L=H=>{if(!h?.length)return;let z=()=>v(H);switch(H.key){case"Escape":z(),r?.();break}};return b.add(document,"keydown",L,1),()=>{b.remove(document,"keydown",L)}},[b,h?.length,x,r,v]);let O=(0,go.useRef)(null);return(0,go.useEffect)(()=>{let L=H=>{let z=_.current===0,R=_.current===h.length-1,V=O.current?.querySelector(`[data-menu-item-key="${H}"]`);V&&(V.scrollIntoView({block:"nearest"}),z?O.current?.scrollTo({top:0,behavior:"smooth"}):R&&O.current?.scrollTo({top:O.current.scrollHeight,behavior:"smooth"}))};return P.on("scrollToItem",L),()=>{P.off("scrollToItem",L)}},[h,P]),go.default.createElement(hi,{component:"div",ref:O,id:"maxai-ai-model-selector-menu","data-testid":"maxai--ai-model-selector-card","aria-labelledby":"maxai-ai-model-selector-menu",disableListWrap:!0,sx:{scrollPaddingBlock:"6px",cursor:S?"none":"default","& *":{cursor:S?"none !important":"",pointerEvents:S?"none":"auto"},overflowY:"auto",overflowX:"hidden",flexShrink:0,maxHeight:d,py:"6px",boxSizing:"border-box",bgcolor:L=>L.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...a}},l.map((L,H)=>go.default.createElement(AI,{key:L.key,listItemIndex:H,model:L,selectedModel:o,onSelect:f,focusKey:x,onFocusKey:y,zIndex:2147483622,eventPriority:2,parentOpen:s})))},PI=(0,go.memo)(PP);var kP=[...pl.FREE,...pl.FAST,...pl.SMART,...pl.REASONING,...pl.LEGACY],LP=e=>{let{mode:t,conversationType:o="Chat",AIProvider:n=z1[o].AIProvider,AIModel:r=z1[o].AIModel,onChange:i,sx:a,disabled:s,labelProps:l,tooltipProps:p,popperProps:c,domEventManagerId:u,defaultCaptureEvent:m=!0,...d}=e,{t:f}=k(),[h,_]=(0,ft.useState)(!1),{setIsWaitingSelectFile:x}=hl(),C=(0,ft.useMemo)(()=>{let W=kP.find(ne=>ne.value===r);if(W&&W.AIProvider===n)return{label:W.title,value:W.value,AIProvider:W.AIProvider};let j=jx[n],w=j.find(ne=>ne.value===r)||j?.[0];return w?{label:w?.title||"",value:w?.value||"",AIProvider:n}:{label:F1.title,value:F1.value,AIProvider:"USE_CHAT_GPT_PLUS"}},[n,r]),[y,b]=(0,ft.useState)(!1),v=(0,ft.useCallback)(()=>{b(!1)},[b]),S=(0,ft.useCallback)(()=>{b(!y)},[y,b]),M=(0,ft.useRef)(null),P=(0,ft.useCallback)(async(W,j,w)=>{v(),_(!1),await Ue.setOnboardingData("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL",!0),i?.(W,j,w)},[i,v]),O=[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:W}){if(W.modifiersData.popperOffsets){let w=W.rects.reference.x+W.rects.reference.width-W.rects.popper.width;w>0&&(W.modifiersData.popperOffsets.x=w)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],L=(0,ft.useRef)(y);(0,ft.useEffect)(()=>{L.current===!0&&y===!1&&M.current.focus(),L.current=y},[y]);let H=(0,ft.useCallback)(()=>{S(),x(!1)},[x,S]),z=(0,ft.useCallback)(W=>{b(W),W||_(!1)},[b]),R=(0,ft.useCallback)(()=>{z(!1),M.current?.matches(":hover")&&_(!0)},[z]),V=et(o),F=et(n),q=et(r),X=Zl();return(0,ft.useEffect)(()=>{let W=j=>{let w=j({conversationType:V.current,AIProvider:F.current,AIModel:q.current});w&&P(w.conversationType??V.current,w.AIProvider,w.AIModel)};return X.on("closePopper",R),X.on("selectModel",W),()=>{X.off("closePopper",R),X.off("selectModel",W)}},[X,P,R,V,F,q]),ft.default.createElement(yI,{managerId:u,defaultCaptureEvent:m},ft.default.createElement(Na,{width:220,sx:{zIndex:2147483621},open:y,onOpenChange:z,placement:"bottom-start",isMirror:!0,modifiers:O,referenceElement:ft.default.createElement(xe,{title:f("package__features:chat__ai_model_selector__button__tooltip"),testId:"maxai--ai-model-selector--tooltip",open:h&&!y,...p},ft.default.createElement(de,{disableRipple:!0,disabled:s,id:"max-ai__ai-provider-floating-button","data-testid":"max-ai__ai-provider-floating-button",ref:M,sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:t==="mini"?"auto":void 0,...a},"aria-controls":y?"composition-menu":void 0,"aria-expanded":y?"true":void 0,"aria-haspopup":"true",onClick:H,onMouseEnter:()=>{y||_(!0)},onMouseLeave:()=>{y||_(!1)},...d},ft.default.createElement(g,{direction:"row",alignItems:"center"},Vu(n)?ft.default.createElement(ix,{sx:{fontSize:"20px"}}):ft.default.createElement(Mn,{model:r}),t!=="mini"&&C?.label&&ft.default.createElement(T,{mx:.5,fontSize:14,lineHeight:1.4,color:"text.secondary",...l,sx:{userSelect:"none",...l?.sx}},C.label),ft.default.createElement(G,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"16px",transform:y?"rotate(180deg)":"rotate(0)"}})))),...c},ft.default.createElement(PI,{buttonRef:M,conversationType:o,AIProvider:n,AIModel:r,onSelect:P,onClose:R,parentOpen:y})),ft.default.createElement(_I,null))},LI=LP;var OP=e=>{let{disabled:t,onChanged:o,domEventManagerId:n,defaultCaptureEvent:r,AIModel:i,AIProvider:a,setAIModelAndProvider:s,...l}=e,{conversationId:p,conversationType:c,inputMediator:u}=ie(),m=fe(p);return OI.default.createElement(LI,{conversationType:c,AIProvider:a,AIModel:i,onChange:async(f,h,_)=>{let x=async()=>{s({AIProvider:h,AIModel:_}),u.focus(),o?.(a,i)};if(ii)x();else{if(!await Qe({emitEvent:!0}))return;x()}},disabled:t||m,domEventManagerId:n,defaultCaptureEvent:r,...l})},Dd=OP;var Ra=e=>{let{AIModel:t,AIProvider:o}=mn.use.chat(),n=mn.use.setChatAIModelAndProvider();return Fd.default.createElement(Dd,{AIModel:t,AIProvider:o,setAIModelAndProvider:n,...e})},BI=e=>{let{AIModel:t,AIProvider:o}=mn.use.art(),n=mn.use.setArtAIModelAndProvider();return Fd.default.createElement(Dd,{AIModel:t,AIProvider:o,setAIModelAndProvider:n,...e})},DI=({order:e,...t})=>{let{isPayingUser:o}=_t(),n=o?yC:CC,r=mn.use.chat(),i=mn.use.chatHub(),a=mn.use.setChatAIModelAndProvider(),s=mn.use.setChatHubAIModelAndProvider(),l=e===0?a:m=>{s(e,m)},p=e===0?r:i[e],{AIModel:c,AIProvider:u}=p||n;return Fd.default.createElement(Dd,{AIModel:c,AIProvider:u,setAIModelAndProvider:l,...t})};var BP=200,DP=({contentHeight:e})=>{let{t}=k(),{palette:o}=qs(),n=(0,_e.useMemo)(()=>typeof window>"u"?"immersive_rewrite":ui()?"sidebar_rewrite":"immersive_rewrite",[]),[r,i]=(0,_e.useState)(""),a=et(r),[s,l]=(0,_e.useState)(!1),[p,c]=(0,_e.useState)(!1),{askAIQuestion:u,askAIWithShortcuts:m,stopGenerate:d}=ke(),f=Ia(),{conversationId:h}=Yt(),_=fe(h),x=f.getInputValue(),{liteContextMenuActionsItems:C}=Sl(x),y=(0,_e.useRef)(null),b=(0,_e.useMemo)(()=>p?[]:C,[p,C,t]),v=(0,_e.useMemo)(()=>b.flatMap(N=>{if(N.type==="group"){let ce=`context_menu__prompt__${N.prompt_id}`,Z=`package__features:${ce}`,re=t(Z),bt=ai?re==="package__features:"+ce:re===ce;return(!re||re===N.prompt_id||bt||ce===Z)&&(re=N.prompt_title),[re+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+N.prompt_id,...N.children??[]]}return[N]}),[b,t]),S=async()=>{if(!await Qe({emitEvent:!0})){f.focus();return}if(_){d();return}let N=a.current;if(!N){l(!0);return}let ce=y.current?.getSelectedItem();if(ce)z(ce);else if(x.trim()){let Z=`${x}:
"""
{{SELECTED_TEXT}}
"""`;await u({type:"user",text:Z,meta:{includeHistory:!0}},{beforeActions:[{type:"RENDER_TEMPLATE",parameters:{template:"{{POPUP_DRAFT}}"}},{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",overwrite:!0,value:N,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:n,overwrite:!0,isBuiltIn:!0}}}]})}},M=(0,_e.useRef)(null),P=(0,_e.useRef)(null),O=(0,_e.useRef)(null),L=()=>{O.current?.querySelector("textarea")?.focus()},H=()=>{L()},z=async N=>{if(L(),!a.current){l(!0);return}if(!N||!N.prompt_id||N.type==="group")return;let Z=Ee(N.actions||[]);Z.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:a.current.trim(),overwrite:!0,isBuiltIn:!0,label:"Selected text overwrite"}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"SidebarRewrite",overwrite:!0,isBuiltIn:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"ANALYTICS_FEATURE_NAME",value:n,overwrite:!0,isBuiltIn:!0}}}),Z.length>0&&m(Z,{overwriteParameters:[{key:"SELECTED_TEXT",value:a.current,label:"Selected text",isBuiltIn:!0,overwrite:!0}]})},R=St(),[V,F]=(0,_e.useState)(10);(0,_e.useEffect)(()=>{let N=Math.floor((e-BP-140)/24);N<=0||F(Math.min(N,10))},[e]);let q=(0,_e.useMemo)(()=>Math.min(e-140-V*24,300),[e,V]),X=(0,_e.useRef)(null),W=()=>{ne.current?.()},j=()=>{P.current?.focus()},w=()=>{f.focus()},ne=(0,_e.useRef)(j),pe=N=>{ne.current=N},[A,U]=v2([["maxai-animation-slide-in",{duration:200}],["maxai-animation-slide-in",{fillMode:"forwards",delay:-100,duration:200}]]);return _e.default.createElement(_e.default.Fragment,null,_e.default.createElement(g,{gap:1,sx:{boxSizing:"border-box",border:"1px solid",borderColor:"border.main",bgcolor:o.background.paper,borderRadius:1,boxShadow:"rgb(15 15 15 / 5%) 0px 0px 0px 1px, rgb(15 15 15 / 10%) 0px 3px 6px, rgb(15 15 15 / 20%) 0px 9px 24px",overflow:"hidden",isolation:"isolate",width:"100%",py:1,px:1.5,maxWidth:"768px",...A},onKeyUp:N=>{N.stopPropagation()},onKeyDown:N=>{N.stopPropagation()}},_e.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{wordBreak:"break-word",color:N=>N.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)"},component:"div"},_e.default.createElement(g,{direction:"row",gap:.5},_e.default.createElement(Fa,null),_e.default.createElement(bd,{enableChatMode:"pro_chat"},_e.default.createElement(Ra,{conversationType:"ContextMenu",tooltipProps:{placement:"bottom"},sx:{height:"32px"},onChanged:W}),_e.default.createElement(Ha,{onChanged:W}))),_e.default.createElement(g,{direction:"row",gap:1,alignItems:"center"},p&&_e.default.createElement(xe,{title:t("package__common:discard")},_e.default.createElement(Re,{onClick:()=>{X.current?.discard()},sx:{width:"auto",color:"inherit",padding:"3px",marginLeft:"-4px",marginRight:"-3px"}},_e.default.createElement(FI.default,{sx:{fontSize:17,color:"text.secondary"}}))))),!p&&_e.default.createElement(B,{sx:{width:"100%",p:1,bgcolor:N=>N.palette.mode==="dark"?"#3B3D3E":"#F4F4F4",boxShadow:"0px 1px 2px rgba(16, 24, 40, 0.05)",borderRadius:1,boxSizing:"border-box",border:"1px solid",borderColor:s?dx[800]:"transparent","& > textarea":{border:"none",outline:"none",background:"transparent",width:"100%",height:"100%",resize:"none",color:"text.primary",lineHeight:"24px",fontFamily:"inherit",fontSize:"16px"}}},_e.default.createElement("textarea",{onFocus:()=>pe(j),ref:P,rows:V,onClick:N=>{N.stopPropagation()},value:r,onChange:N=>{l(!1),i(N.target.value)},placeholder:t("package__features:chat__home_view__rewrite__textarea__placeholder"),autoFocus:!0})),_e.default.createElement(Pd,{ref:X,showCloseButton:!1,onClose:()=>{c(!1)},onShow:()=>{c(!0)},modelKey:"SidebarRewrite"}),!p&&_e.default.createElement(g,{direction:"row",alignItems:"end",gap:1},_e.default.createElement(g,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",ref:O},_e.default.createElement(Kl,{ref:N=>f.bindRef(N),minLine:1,stopPropagation:!0,autoFocus:!0,onKeyDownCapture:N=>{y.current?.proxyKeyboardEvent(N.nativeEvent)?(N.preventDefault(),N.stopPropagation()):N.shiftKey&&N.key.toLowerCase()==="tab"&&(P.current?.focus(),N.preventDefault(),N.stopPropagation())},onFocusCapture:N=>{P.current&&P.current.value===""&&!P.current.getAttribute("data-autofocused")?(P.current.setAttribute("data-autofocused","true"),P.current.focus(),N.preventDefault(),pe(j)):pe(w)},value:x,onChangeText:N=>f.updateInputValue(N),placeholder:t("package__features:chat__home_view__rewrite__input__placeholder"),sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:"24px"},onEnter:S})),_e.default.createElement(ql,{placement:"bottom-end",disabled:(!x||!r)&&!_,onClick:S}))),_e.default.createElement(B,{sx:{maxWidth:"768px",width:"100%",display:v.length<=0?"none":void 0}},_e.default.createElement(wd,{sx:{opacity:0,...U},ref:y,open:!0,defaultPlacement:"bottom-start",needAutoUpdate:!0,root:R,menuList:v,referenceElementRef:M,menuWidth:415,referenceElement:_e.default.createElement(B,{"data-test-id":"ContextMenuList-referenceElementRef"}),onClickItem:z,onClickGroup:H,menuMaxHeight:`${q}px`})))},FP=()=>{let e=(0,_e.useRef)(),[t,o]=(0,_e.useState)(0);return(0,_e.useEffect)(()=>{e.current&&o(e.current.clientHeight)},[]),(0,_e.useEffect)(()=>{if(!e.current)return;let n=()=>{e.current&&o(e.current.clientHeight)},r=new ResizeObserver(n);return r.observe(e.current),()=>{r.disconnect()}},[]),_e.default.createElement(B,{ref:e,component:"div",width:"100%",padding:"10px",paddingBottom:0,flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center",sx:{boxSizing:"border-box"}},t!==0?_e.default.createElement(ka,{defaultContextMenuPath:"/rewrite"},_e.default.createElement(DP,{contentHeight:t})):null)},HI=FP;var Ic=I(E());var NI={MAXAI_FLUX:mu({prompt_id:Hx,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Oe.PRESET_VARIABLE__AI_RESPONSE_TONE,Oe.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Oe.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_STABLE_DIFFUSION:mu({prompt_id:Nx,prompt_title:"Prompt Optimization FLUX/SD",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},{hint:"The previous user inputs",name:"PREVIOUS_USER_INPUTS",type:"text"},Oe.PRESET_VARIABLE__AI_RESPONSE_TONE,Oe.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Oe.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]}),MAXAI_DALLE:mu({prompt_id:Fx,prompt_title:"Prompt Optimization DALL\xB7E",type:"chat_complete",variables:[{hint:"User input",name:"USER_INPUT",type:"text"},Oe.PRESET_VARIABLE__AI_RESPONSE_TONE,Oe.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE],output:[Oe.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE]})};var Cc=class{async createTextToArtActions(t,o){let n=await Yo.getService().getConversationById(t),r=n?.meta.AIProvider;if(!n||o.trim()===""||!r)return[];let i=await Jn.getService().dangerouslyGetTotalMessages(t),a=Xo(),s=await H_("MAXAI_DALLE"),l={prompt:o,model:$s.value,contentType:s?.contentType,resolution:s?.resolution,generateCount:s?.generateCount,aspectRatio:s?.aspectRatio},p=NI[n?.meta.AIProvider||"MAXAI_DALLE"],c=!0,u=[];if(c&&p){let m=[];for(let f=i.length-1;f>=0;f--){let h=i[f];if(Qn(h)&&h.originalMessage){let _=h.originalMessage.metadata?.title?.title||"",x=h.originalMessage.metadata?.artTextToImagePrompt||"";if(_&&x&&_&&m.unshift(_),h.originalMessage.metadata?.includeHistory===!1)break}}let d=m.map((f,h)=>`${h+1}. ${f}`).join(`
`);u=[{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:a,text:"",originalMessage:{metadata:{shareType:"art",title:{title:o},copilot:{title:{title:"AI art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Optimizing art prompt",status:"loading",icon:"CheckCircle"}]},artTextToImageMetadata:l}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"SET_VARIABLE_MAP",parameters:{VariableMap:{PREVIOUS_USER_INPUTS:d,USER_INPUT:o}}},{type:"ASK_CHATGPT",parameters:{isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",MaxAIPromptActionConfig:p,AskChatGPTActionQuestion:{text:o,meta:{historyMessages:[],outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o}}}},{type:"TEXT_HANDLER",parameters:{ActionTextHandleParameters:{trim:!0,noQuotes:!0,noCommand:!0}}},{type:"SET_VARIABLE",parameters:{VariableKey:"IMAGE_PROMPT"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{metadata:{isComplete:!1,copilot:{steps:[{title:"Optimizing art prompt",status:"complete",icon:"CheckCircle",value:"{{IMAGE_PROMPT}}",valueType:"text"}]},artTextToImagePrompt:"{{IMAGE_PROMPT}}"},content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:"{{IMAGE_PROMPT}}",meta:{outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:"{{IMAGE_PROMPT}}",contextMenu:{id:H1,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}]}else u=[{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"add",ActionChatMessageConfig:{type:"ai",messageId:a,text:"",originalMessage:{metadata:{includeHistory:!1,artTextToImagePrompt:o,shareType:"art",title:{title:o},copilot:{title:{title:"Pro art",titleIcon:"Awesome",titleIconSize:24},steps:[{title:"Generating art",status:"complete",icon:"CheckCircle",value:o}]},artTextToImageMetadata:l}}}}},{type:"SET_VARIABLE",parameters:{VariableKey:"AI_RESPONSE_MESSAGE_ID"}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",text:"",originalMessage:{content:{title:{title:"Image",titleIcon:"Image"},contentType:"image",text:""}}}}},{type:"ASK_CHATGPT",parameters:{AskChatGPTActionType:"ASK_CHAT_GPT_HIDDEN",isEnabledDetectAIResponseLanguage:!1,AskChatGPTActionQuestion:{text:o,meta:{includeHistory:!1,outputMessageId:"{{AI_RESPONSE_MESSAGE_ID}}",messageVisibleText:o,contextMenu:{id:H1,droppable:!1,parent:"",text:"[Art] text to image",data:{editable:!1,type:"shortcuts",actions:[]}}}}}},{type:"SCRIPTS_LIST",parameters:{}},{type:"CHAT_MESSAGE",parameters:{ActionChatMessageOperationType:"update",ActionChatMessageConfig:{type:"ai",text:"",messageId:"{{AI_RESPONSE_MESSAGE_ID}}",originalMessage:{content:{text:"",contentType:"image"},metadata:{attachments:"{{LAST_ACTION_OUTPUT}}"}}}}}];return u}};var zI=new Cc;var Bo=I(E());var HP=e=>{let{tip:t,sx:o,wrapSx:n,children:r,lineClamp:i=3,resizeListener:a=!1,tooltipZIndex:s,TooltipProps:l,startSlot:p,endSlot:c,hideTooltip:u,...m}=e,d=(0,Bo.useRef)(null),f=(0,Bo.useRef)(null),[h,_]=(0,Bo.useState)(!1),[x,C]=(0,Bo.useState)(!0),y=(0,Bo.useMemo)(()=>t??r,[r,t]),b=(0,Bo.useCallback)(()=>{if(f.current){let v=f.current;C(v.offsetHeight>=v.scrollHeight)}},[]);return(0,Bo.useEffect)(()=>{h&&r&&b()},[h,r,b]),(0,Bo.useEffect)(()=>{r&&!h&&_(!0)},[r,h]),(0,Bo.useEffect)(()=>{if(h&&a){let v=()=>b();d.current=new ResizeObserver(v),f.current&&d.current.observe(f.current)}return()=>{d.current?.disconnect()}},[h,a,b,f]),Bo.default.createElement(xe,{title:u||x?"":Bo.default.createElement(T,{fontSize:"14px"},y),PopperProps:{style:{zIndex:s||2147483620,maxWidth:180}},...l},Bo.default.createElement(g,{direction:"row",alignItems:"center",flex:1,gap:"4px",sx:n},p,Bo.default.createElement(T,{ref:f,sx:{MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:`${i}`,lineClamp:`${i}`,boxOrient:"vertical",display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",flex:1,...o},...m},r),c))},$i=HP;var Hd=I(E()),NP=({promptData:e,disabled:t,onClick:o,order:n,showLineClamp:r=1})=>Hd.default.createElement(pi,{in:!0,style:{transitionDelay:n?`${n*150}ms`:"0ms"}},Hd.default.createElement(zn,{component:"button","data-testid":`sample-prompt-item${n}`,sx:{width:"100%",px:2,py:1.5,bgcolor:t?"background.secondary":"background.paper",border:"1px solid",borderColor:"border.main",boxShadow:t?"none":"0px 1px 2px 0px #0000000D",cursor:t?"default":"pointer",transition:"border-color 0.3s",borderRadius:1,flex:1,"&:hover":{borderColor:t?"border.main":"primary.main"}},onClick:()=>{t||o&&o(e)}},Hd.default.createElement($i,{textAlign:"left",tip:e.title,resizeListener:!0,lineClamp:r,sx:{fontSize:"14px",lineHeight:"21px",whiteSpace:"normal",wordBreak:"break-word",minHeight:r*21,color:t?"text.disabled":"text.primary"}},e.title))),Nd=NP;var RI=[{title:"Product mockups",prompt:"Generate a realistic product mockup for an Elegant Glass Meal Prep Set, which will allow customers to envision the product before making a purchase."},{title:"Social media graphics ",prompt:"Design an attention-grabbing graphic for a social post on healthy eating trends. Focus on food and without human faces or text."},{title:"Email banners",prompt:"Create an email banner for email sharing Christmas holiday greetings. With clear text: Merry Christmas!. Without human faces or other texts."},{title:"Logos",prompt:"Generate one single logo for a business eco-friendly packaging firm. Without human faces or texts."},{title:"Ad campaign visuals",prompt:"Generate an image for a banner ad on the theme of fitness, without text or human face."},{title:"Blog post feature image",prompt:"Generate an image that will complement a blog post on the topic mental health."},{title:"Website hero image",prompt:"Generate a hero image for a website dedicated to online learning. With clear beautiful human faces. Highlight the online learning concept."},{title:"Brochure Design",prompt:"Design a visually appealing brochure showcasing the benefits of a premium skincare line, targeting business owners."},{title:"Event Poster",prompt:"Create a vibrant poster promoting an upcoming event hosted by my company that focuses on community events, featuring captivating visuals. Without text."},{title:"Promotional video thumbnails",prompt:"Generate a compelling thumbnail for a promotional video showcasing success stories from customers, designed to attract clicks and drive engagement on platforms like YouTube or social media. If there are human faces, they need to be clear and beautiful."},{title:"Blog images",prompt:"Create a custom graphic for a blog post on remote working best practices. Make sure to include related images. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Web page graphic",prompt:"Generate a graphic of homepage for a pet care services website that illustrates care and attention to pets."},{title:"Google ad",prompt:"Create a Google Ads banner to highlight a limited-time offer. Use images of Tablet products, and make sure the image grabs attention. With the text Limited Time Offer as the only text element."},{title:"Poster graphic",prompt:"Design a realistic graphic for a poster for a concert announcement. Make sure to incorporate detailed drawings of musical instruments."},{title:"Travel blogs/websites",prompt:"Generate a photo illustrating the vibrant and intricate rituals during the festival of Carnival. Without human faces."},{title:"E-commerce/online retail platforms",prompt:"Generate photos of a set of modern cookware in various settings, highlighting their non-stick surfaces and ergonomic handles."},{title:"Business websites/corporate blogs",prompt:"Generate photos of an executive team in a strategic retreat setting, fostering a sense of unity and vision. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Lifestyle magazines/websites",prompt:"Generate a photo illustrating a mid-century modern home with eclectic decor and cozy corners."},{title:"Educational platforms/e-Learning websites",prompt:"Generate photos of students actively participating in a coding workshop. If featuring human faces, ensure they are clear and radiate a sense of beauty and concentration."},{title:"Event management websites/promotion platforms",prompt:"Capture the excitement of professionals networking and exchanging ideas at an event in a photograph. If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Wellness blogs/healthcare platforms",prompt:"Showcase farmers harvesting organic produce for a healthy and sustainable lifestyle."},{title:"Food and beverage blogs/websites",prompt:"Generate mouthwatering images of pasta dish being cooked, showcasing the blend of colours and textures."},{title:"Fitness and exercise blogs/websites",prompt:"Generate motivational images of individuals engaged in intense workout routines, highlighting their determination and perseverance to achieve their fitness goals.If featuring human faces, ensure they are front, clear and radiate a sense of beauty and concentration. When the human figure in the picture is relatively small, the complete face does not appear."},{title:"Fashion accessories brands/websites",prompt:"Create visually stunning images of a designer handbag, showcasing their elegance and luxury against contrasting backgrounds."},{title:"Product photography",prompt:"Create studio-quality photos of wireless earphones, showcasing them from multiple angles, highlighting the Noise Blocking and Comfortable Fit feature. Without any text."},{title:"Property listings",prompt:"Generate exterior photos of a suburban home. Include shots of the swimming pool and landscaped front yard."},{title:"Hospitality",prompt:"Generate inviting photos of a deluxe king room. Highlight the modern decor and comfortable seating area, ensuring the room looks welcoming and well-appointed."},{title:"Feature articles",prompt:"Generate a photo for a feature story on urban gardening. Include images of community gardens and green rooftops, highlighting sustainability and community spirit. Without any text or human faces."},{title:"Storyboard",prompt:"Generate a storyboard sequence for a romantic comedy where two rival chefs fall in love while competing on a cooking show. Include key scenes like the emotional revelation that changes everything."},{title:"Art for theatrical productions",prompt:"Create a set design concepts for Hamlet. Include elaborate period costumes and props."},{title:"Editorial Art",prompt:"Create a feature illustration for National Geographic exploring climate change and its effects on global migration. Include juxtaposition of contrasting images."},{title:"Art for awareness campaigns",prompt:"Generate a marketing graphic for an ocean plastic pollution awareness campaign. Include emotive photography of affected individuals or environments."},{title:"Literary classics reimagined",prompt:'Reimagine scenes from the literary classic "Pride and Prejudice", blending traditional and modern elements to add a unique artistic touch for a modern graphic novel adaptation. Need to without any texts.'},{title:"Bedtime stories",prompt:"Create warm visuals with soft lighting, cozy setting, and a touch of magic on the theme of nighttime journey through the cosmos, tailored for a bedtime story."},{title:"Philosophical abstract expressions",prompt:"Generate abstract and thought-provoking visuals that resonate with the philosophical concept of the paradox of infinity."},{title:"Surrealistic depiction",prompt:"Create surreal dreamscapes on the theme of the passage of time blending reality and fantasy, using unconventional perspectives and dreamlike elements to evoke a sense of wonder and curiosity."},{title:"Mandalas",prompt:"Craft mandalas incorporating vibrant colors and unique patterns that will inspire feelings of happiness and well-being."},{title:"Artwork from quote",prompt:'"I think, therefore I am." - Ren\xE9 Descartes. Turn this quote into an image artwork.'},{title:"Portrait",prompt:"Generate a portrait of Leonardo da Vinci in impressionism for a blog exploring the history of the Italian Renaissance"},{title:"Pop culture icons redesigned",prompt:"Reimagine iconic characters from Harry Potter with a contemporary twist, incorporating modern fashion and technology elements to breathe new life into familiar favorites."},{title:"Abstract emotions",prompt:"Generate an abstract artwork exploring the depths of human emotion, using color, form, and texture to convey feelings of serenity and chaos."},{title:"Cartoonized web series or online content",prompt:"Create artwork for characters for an animated web series about space adventures. Include robotic appendages in the character design."},{title:"Cartoons and caricatures for promotional material",prompt:"Design a caricature for a social media campaign promoting a food festival. Include exaggerated, humorous depictions of the character eating, highlighting fun atmosphere."},{title:"Custom caricatures for souvenirs ",prompt:"Design beautiful custom caricature for a mug souvenir, showing it exploring landmarks."},{title:"Public Art",prompt:"Create a mural design for a community center. Include environmental sustainability themes in the mural. Without any text."},{title:"Realistic Cartoon",prompt:"Generate a semi-realistic cartoon character with intricate details, blending elements of realism with a cartoon aesthetic into one piece. Need to Without any text."},{title:"Anime Hero",prompt:"Generate an anime character with large, detailed eyes with distinctive Japanese anime aesthetics."},{title:"Minimalist Line Art",prompt:"Design a simple cartoon character using minimalist line art, focusing on clean lines and basic shapes."},{title:"Pixel Art Character",prompt:"Craft a pixel art character, reminiscent of old-school video games, with limited colors and a blocky, pixelated design."},{title:"Comic Book Superhero",prompt:"Create a powerful superhero character in the style of a comic book, complete with bold outlines and vibrant colors."},{title:"Children's Book Illustration",prompt:"Generate a whimsical cartoon character suitable for children's book illustrations, characterized by soft lines and pastel colors to bring a gentle and enchanting vibe to the illustrations."},{title:"Manga Chibi",prompt:"Design a cute and chibi-style manga character with oversized heads, small bodies, and adorable expressions."},{title:"Surreal Art Deco",prompt:"Craft a surreal character in the style of Art Deco, known for its geometric shapes, bold colors, and elegant, vintage feel."},{title:"Retro Cartoon",prompt:"Create a character reminiscent of the classic, retro cartoon era, featuring exaggerated movements and playful antics."},{title:"Historical figure cartoonized",prompt:"Transform a famous historical figure into a lovable cartoon character, depicting them in humorous situations or reimagining their achievements with a playful twist. ! AI image prompts for video game design"},{title:"Color schemes and themes",prompt:"Design a thematic color palette for a fantasy game. I want the colors to evoke a sense of wonder and enchantment."},{title:"Props and objects",prompt:"Create designs for magical props for a role-playing game. Include detailed illustrations of a weathered tome with arcane symbols."},{title:"NPCs and enemies",prompt:"Design a non-playable character for a cyberpunk role-playing game. Include the distinct visual traits of a ruthless corporate enforcer."},{title:"Visuals for the game's website, social media channels",prompt:"I have created a game that explores a fantastical world of magic and adventure. Create a banner image for the game's  Instagram highlight cover. Include the player character wielding a legendary weapon featuring the main characters, set against a backdrop of towering futuristic skyscrapers."},{title:"Epic Fantasy World",prompt:"Design a picture of a stunning fantasy world, complete with enchanted forests, towering castles, and mythical creatures, setting the stage for a grand adventure."},{title:"Cyberpunk Cityscape",prompt:"Craft a futuristic cyberpunk cityscape, with neon-lit skyscrapers, bustling streets, and intricate details that define the urban dystopia."},{title:"Playable Character Concept ",prompt:"Design a character image of a unique playable character, outlining their appearance for a protagonist in an RPG game."},{title:"Alien Planet Ecosystem",prompt:"Create an illusion of an alien planet's ecosystem, with bizarre flora and fauna, strange geology, and atmospheric anomalies."},{title:"Haunted Mansion Interior",prompt:"Generate a chilling interior layout for a haunted mansion, replete with eerie corridors, ghostly apparitions, and secrets waiting to be discovered."},{title:"Melee Weaponry Collection",prompt:"Craft a collection of melee weapons, each with its own distinct design, perfect for a combat-focused game."},{title:"Sci-Fi Space Station",prompt:"Design a massive, intricate space station, teeming with advanced technology, modular compartments, and areas for various in-game activities."},{title:"Ancient Ruins Exploration",prompt:"Generate the environment of a long-forgotten civilization's ruins."},{title:"Interstellar Starship Bridge",prompt:"Craft the interior of an interstellar starship bridge, featuring advanced control panels, holographic displays, and the latest in spacefaring technology."},{title:"Legendary Artifact",prompt:"Craft an iconic legendary artifact for players to discover in-game, featuring intricate detailing, mystical symbols."}];var zd=I(E()),zP=(e,t)=>E_(e).slice(0,t),RP=(e,t=4)=>{let[o,n]=(0,zd.useState)([]);return(0,zd.useLayoutEffect)(()=>{n(zP(e,t))},[]),{samplePromptList:o}},Rd=RP;var yc=I(E()),VP=({promptItemXs:e,showLineClamp:t})=>{let{samplePromptList:o}=Rd(RI),{conversationId:n}=ie(),{runShortcutsActions:r}=ke();return yc.default.createElement(g,{width:"100%","data-button-clicked-name":"art-sample-prompt-clicked"},yc.default.createElement(Vr,{container:!0,spacing:1.5},o.map((i,a)=>yc.default.createElement(Vr,{key:i.title,item:!0,xs:e},yc.default.createElement(Nd,{promptData:i,disabled:!1,onClick:async s=>{if(s&&s.prompt){let l=await zI.createTextToArtActions(n,s.prompt);l&&r(l)}},order:a+1,showLineClamp:t})))))},VI=VP;var UI=async(e,t=0)=>{let o=async()=>{t<=0?await e():setTimeout(async()=>{await e()},t)},n=await U1.isLogin();return new Promise(r=>{if(n)o().then(()=>{r(!0)});else{if(ii){r(!1);return}let i=document.querySelector('[data-testid="maxai--sign-in--button"]');if(i){i.dispatchEvent(new MouseEvent("click",{bubbles:!0}));let a=setInterval(async()=>{await U1.isLogin()?(clearInterval(a),await o(),r(!0)):i.disabled===!1&&(clearInterval(a),r(!1))},250)}}})};var WI="MAXAI_CLIENT__FEATURES__CHAT__SEARCH__SETTINGS",UP={searchEngine:"google",maxResultsCount:6,copilot:!1},Vd=class{async getSettings(){let t={...UP},o=await Rn.getItem(WI);return o&&Object.assign(t,o),t}async setSettings(t){let n={...this.getSettings(),...t};return await Rn.setItem(WI,n),!0}async createShortcutsActions(t,o,n){if(o.trim()==="")return[];let r=await Jn.getService().dangerouslyGetTotalMessages(t),i=[];for(let s=r.length-1;s>=0;s--){let l=r[s];if(l?.originalMessage&&i.unshift(l?.originalMessage?.metadata?.title?.title||l.text||""),l.type==="ai"&&l?.originalMessage?.metadata?.includeHistory===!1)break}let{actions:a}=await _C(o,i,n);return a}};var GI=new Vd;var jI=[{title:"Humanity's Last Exam"},{title:"New Blood Group Identified"},{title:"View the Comet of the Century"},{title:"Global Seed Vault Under Threat"},{title:"The Fed\u2019s Big Rate Cut"},{title:"23andMe's Fallout"},{title:"New Insights into the Multiverse"},{title:"Lionsgate's Runway AI Video Deal"},{title:"'Third State' Beyond Life and Death"},{title:"Snap's New Large AR Spectacles"},{title:"Earth's Ancient Ring System"},{title:"Neuralink Gets FDA Breakthrough Device"},{title:"CATL's Million-Mile Bus Battery"},{title:"Bitcoin's 66-bit Puzzle Solved"},{title:"Slack Debuts AI Agents"},{title:"Blue Origin Mars Mission Delayed"},{title:"Lucid's Upcoming Affordable SUV"},{title:"The History of Lehman Brothers Bankruptcy"},{title:"Larry Ellison's Take on AI"}];var bc=I(E()),GP=({promptItemXs:e,showLineClamp:t})=>{let{conversationId:o}=ie(),{runShortcutsActions:n}=ke(),{samplePromptList:r}=Rd(jI);return bc.default.createElement(g,{"data-button-clicked-name":"search-sample-prompt-clicked"},bc.default.createElement(Vr,{container:!0,spacing:1.5},r.map((i,a)=>bc.default.createElement(Vr,{key:i.title,item:!0,xs:e},bc.default.createElement(Nd,{promptData:i,disabled:!1,onClick:async s=>{if(s.title){let l=await GI.createShortcutsActions(o,s.title,!0);await UI(()=>{n(l)})}},order:a+1,showLineClamp:t})))))},qI=GP;var jP=()=>{let{conversationType:e}=ie(),t={promptItemXs:6,showLineClamp:2},o={Art:Ic.default.createElement(VI,{...t}),Search:Ic.default.createElement(qI,{...t})}[e]||null;return Ic.default.createElement(Ic.default.Fragment,null,o)},KI=jP;var qP=()=>{let[e,t]=(0,Xt.useState)(0);return(0,Xt.useEffect)(()=>{let o=()=>{t(window.innerHeight)};return t(window.innerHeight),window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}},[]),e},KP=e=>{let{sx:t,chatBoxHeight:o}=e,n=qP(),{t:r}=k();return Xt.default.createElement(g,{className:"maxai--chat-home-view",gap:1.5,m:1.5,sx:{"& *":{boxSizing:"border-box"},flex:1,overflow:"hidden",...t}},Xt.default.createElement(T,{"data-testid":"maxai--chat-home-view--title",sx:{height:"100%",display:"flex",alignItems:"flex-end",color:"text.primary",fontSize:"24px",fontWeight:700,lineHeight:"33.6px",textAlign:"center"}},r(ii?"package__features:chat__home_view__extension__title":"package__features:chat__home_view__website__title")),n>=(o?o+120:600)&&Xt.default.createElement(xd,null))},$P=e=>{let{sx:t,isMessageEmpty:o}=e,{t:n}=k(),r=he(i=>i.conversationType);return Xt.default.createElement(g,{className:"maxai--chat-home-view",flexGrow:1,width:"100%",sx:{overflowY:"auto","& *":{boxSizing:"border-box"},...t}},r==="ContextMenu"&&Xt.default.createElement(g,{direction:"column",sx:{width:"100%",padding:"32px 10px"},flexGrow:1},Xt.default.createElement(g,{direction:"column",alignItems:"center",justifyContent:"center",sx:{height:"175px"}},Xt.default.createElement(G,{icon:"Rewrite",sx:{color:"primary.main",fontSize:"40px",marginBottom:"12px"}}),Xt.default.createElement(T,{component:"h1",marginBottom:"8px",lineHeight:"140%",fontWeight:700,fontSize:20,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"},n("package__features:chat__home_view__rewrite__title")),Xt.default.createElement(T,{lineHeight:"150%",fontSize:14,textAlign:"center",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.60)"},n("package__features:chat__home_view__rewrite__description"))),o&&Xt.default.createElement(HI,null)),r==="Art"&&Xt.default.createElement(g,{px:2,width:"100%",height:"100%",justifyContent:"center",alignItems:"center",position:"relative"},Xt.default.createElement(g,{justifyContent:"center",alignItems:"center",maxWidth:680,width:"80%"},Xt.default.createElement(G,{icon:"Art",sx:{color:"primary.main",fontSize:"48px"}}),Xt.default.createElement(T,{component:"h1",mt:1.5,mb:1,fontSize:"20px",fontWeight:700,textAlign:"center",color:"text.primary"},n("package__features:chat__home_view__art__title")),Xt.default.createElement(T,{fontSize:"14px",fontWeight:400,textAlign:"center",color:"text.primary"},n("package__features:chat__home_view__art__description")))),r==="Summary"&&Xt.default.createElement(En,{sx:{my:0},loading:!0}),Xt.default.createElement(g,{alignItems:"center",maxWidth:768,mx:"auto",width:"100%",p:1.5,gap:1.5},Xt.default.createElement(KI,null)))},XP=e=>he(o=>o.conversationType)==="Chat"?Xt.default.createElement(KP,{...e}):Xt.default.createElement($P,{...e}),$I=XP;var dr=I(E());var Sc=I(E()),YP=e=>class extends Sc.Component{constructor(o){super(o),this.state={hasError:!1}}componentDidCatch(o,n){this.setState({hasError:!0})}render(){return this.state.hasError?Sc.default.createElement(e,{...this.props,liteMode:!0,hasError:!0}):Sc.default.createElement(e,{...this.props})}},Jl=YP;var c0=I(E());var kr=I(E()),Ud="chat-message--AI-tools",Wd=(0,kr.createContext)({AIMessage:{},usePromptOpen:!1,setUsePromptOpen:()=>{},onClickPromptItem:()=>{},onRegenerate:()=>{},content:{contentType:"text",text:""},metadata:{},processingStep:"RESPONDED",isLoading:!1,isWritingMessage:!1,isLastMessage:!1,isAutoHideTools:!0}),Gd=e=>{let{message:t,loading:o,children:n}=e,{conversationId:r,inputMediator:i}=Yt(),a=Uo(r),[s,l]=(0,kr.useState)(!1),{content:p,metadata:c,processingStep:u}=hC(t,o),m=!!o,d=t?.messageId===a?.lastMessageId||m,f=!d&&!s,h=!c.isComplete||m,{askAIWithShortcutsV2:_,regenerate:x}=ke(),C=(0,kr.useRef)(!1),y=async v=>{if(!C.current)try{if(C.current=!1,v&&v.length>0){let M=(t&&wr(t,!1)||"").replace(Ys,""),P=Ee(v||[]);P.unshift({type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:M||" ",label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}),i.focus(),await cC(P,async O=>{let L=O.parameters?.AskChatGPTActionQuestion;return L?.meta&&(L.meta.includeHistory=!0),O}),await _(P,{disabledMaxAIDocumentIds:!0})}}catch{}finally{C.current=!1}},b=(0,kr.useCallback)(()=>{x(r)},[x,r]);return kr.default.createElement(Wd.Provider,{value:{AIMessage:t,usePromptOpen:s,setUsePromptOpen:l,onClickPromptItem:y,onRegenerate:b,content:p,metadata:c,processingStep:u,isLoading:h,isWritingMessage:m,isLastMessage:d,isAutoHideTools:f}},n)},Xe=()=>(0,kr.useContext)(Wd);var XI=I(zw()),YI=I(Vw());var ao=I(E()),ZP=e=>{let{message:t}=e,{t:o}=k(),[n,r]=ao.default.useState(null),[i,a]=(0,ao.useState)(!1),s=!!n,{updateMessage:l}=yi(),{conversationId:p}=ie(),c=x=>{r(x.currentTarget)},u=()=>{r(null)},m=()=>{a(!0)},d=()=>{a(!1)},f=()=>{a(!1);let x=Ee(t);Qn(t)?(x.originalMessage?.metadata&&(x.originalMessage.metadata.includeHistory=!0),x=Ro([x,{originalMessage:{metadata:{includeHistory:!0}}}])):x=Ro([x,{meta:{includeHistory:!0}}]),l(p,x)},h=(0,ao.useMemo)(()=>ui(),[]);return!0?null:ao.default.createElement(Ct,{sx:{mb:2}},ao.default.createElement(g,{direction:"row",alignItems:"center"},ao.default.createElement(T,{color:"text.secondary",fontSize:"12px"},o("package__features:chat__context_cleared__title")),ao.default.createElement(de,{variant:"text",sx:{width:"30px",height:"30px",color:"inherit",minWidth:"unset",ml:"auto!important"},onClick:c},ao.default.createElement(YI.default,{sx:{fontSize:16,color:"text.primary"}}))),ao.default.createElement(gi,{anchorEl:n,open:s,onClose:u,slotProps:{}},ao.default.createElement(mt,{onClick:()=>{u(),m()},sx:{color:"error.main"}},ao.default.createElement(XI.default,{sx:{fontSize:16,mr:1,color:"inherit"}}),o("package__common:delete"))),ao.default.createElement(hx,{open:i,onClose:x=>{x.stopPropagation(),d()},sx:{position:h?"absolute":"fixed"}},ao.default.createElement(ku,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:"4px",bgcolor:"background.paper",maxWidth:"512px!important",width:h?"448px":"100%",p:2},onClick:x=>{x.stopPropagation()}},ao.default.createElement(g,{spacing:2},ao.default.createElement(T,{fontSize:"20px",fontWeight:700,lineHeight:"24px",color:"text.primary"},o("package__features:chat__context_cleared__delete__title")),ao.default.createElement(T,{fontSize:"16px",color:"text.primary"},o("package__features:chat__context_cleared__delete__description")),ao.default.createElement(g,{direction:"row",spacing:1,justifyContent:"end"},ao.default.createElement(de,{variant:"outlined",onClick:d},o("package__common:cancel")),ao.default.createElement(de,{variant:"contained",color:"error",onClick:f,sx:{bgcolor:"#f44336!important","&:hover":{bgcolor:"#d32f2f!important"}}},o("package__common:confirm")))))))},jd=ZP;var Ne=I(E());var ep=I(E()),QP=e=>{let{fontSx:t,iconSx:o,showLoading:n}=e,{title:r,titleIcon:i,titleIconSize:a}=e.title,s=`${a||20}px`;return ep.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},typeof i=="string"&&i?ep.default.createElement(g,{alignItems:"center",justifyContent:"center",width:s,height:s},ep.default.createElement(G,{sx:{color:"text.primary",fontSize:s,...o},icon:i})):i,ep.default.createElement(T,{sx:{color:"text.primary",fontWeight:400,fontSize:"18px",...t}},r),n&&ep.default.createElement(B,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:l=>l.palette.mode==="dark"?"#fff":"#000"}}))},Mi=QP;var Xi=I(E()),ZI=e=>{let{AIProvider:t,AIModel:o,icon:n,title:r,sx:i}=e,a=(0,Xi.useMemo)(()=>{let s=Vo(void 0,o),l=n;return!n&&s&&(l=Xi.default.createElement(Mn,{size:24,provider:t,model:s.value,sx:{outline:"1px solid rgba(0, 0, 0, 0.08)",borderRadius:"8px"}})),{icon:l,title:r||s?.title||""}},[t,o,n,r]);return!a.icon&&!a.title?null:Xi.default.createElement(g,{direction:"row",alignItems:"center",gap:1,height:24,className:"chat-ai-message--ai-model",sx:i},a.icon,Xi.default.isValidElement(a.title)?a.title:Xi.default.createElement(T,{sx:{fontSize:"16px",lineHeight:"24px",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)",fontWeight:500}},a.title))},Yi=e=>Xi.default.createElement(ZI,{icon:Xi.default.createElement(Ir,null),title:"MaxAI",...e}),tp=ZI;var np=I(E());var hg=I(E());var JP=()=>{let{processingStep:e}=Xe();return e==="RESPONDING"||e==="RESPONDED"?hg.default.createElement(g,{direction:"row",alignItems:"center",gap:1},hg.default.createElement(Yi,{title:"Answer"})):null},QI=JP;var JI=I(E()),ek=()=>{let{processingStep:e}=Xe();return e==="RESPONDING"||e==="RESPONDED"?JI.default.createElement(Yi,{title:"Answer"}):null},e3=ek;var op=I(E()),tk=e=>{let{message:t}=e,{content:o,metadata:n}=Xe(),r=n?.shareType==="summary",i=Uo(t.conversationId||"");if(i?.meta&&i.meta?.AIModel!==D1.value&&t.originalMessage?.metadata?.AIModel!==D1.value)return op.default.createElement(tp,{AIProvider:i?.meta?.AIProvider,AIModel:t.originalMessage?.metadata?.AIModel||i.meta.AIModel});let a=op.default.createElement(Lt,{size:18}),s="";return n.isComplete?(a=o.title?.titleIcon&&o.title?.titleIcon!=="Loading"?o.title?.titleIcon:op.default.createElement(Ep,{icon:"Read",sx:{fontSize:"24px"}}),s=o.title?.title||"Answer"):(o.contentType==="text"?s="Writing":o.contentType==="image"&&(s="Creating image"),o.title?.title&&(s=o.title.title),o.title?.titleIcon&&o.title?.titleIcon!=="Loading"&&(a=o.title?.titleIcon),r&&o?.title?.titleIcon!=="Loading"&&(a=o.title?.titleIcon||op.default.createElement(Ep,{icon:"Read",sx:{fontSize:"24px"}}),s=o.title?.title||"Answer")),op.default.createElement(Mi,{title:{title:s,titleIcon:a,titleIconSize:24}})},t3=tk;var ok=e=>{let{message:t}=e,{metadata:o}=Xe(),n=Uo(t.conversationId||"");if(o.chatMode==="free_chat")return np.default.createElement(QI,{message:t});if(o.chatMode==="pro_chat")return np.default.createElement(e3,{message:t});if(o.shareType==="summary")return np.default.createElement(t3,{message:t});let r=o.AIModel||n?.meta.AIModel;return r?np.default.createElement(tp,{AIProvider:n?.meta?.AIProvider,AIModel:r}):np.default.createElement(Yi,null)},gg=ok;var ys=I(E());var On=I(E()),nk=e=>{let{message:t}=e,o=(0,On.useRef)(null),[n,r]=(0,On.useState)([0,0]),[i]=(0,On.useState)(1),[a]=(0,On.useState)("1:1"),s=(0,On.useMemo)(()=>{try{let p=t.originalMessage?.metadata?.attachments||[],c=n[0],u=n[1];if(p.length>0&&c&&u){let d=2;p.length>=12?d=4:p.length>=9&&(d=3);let f=Math.ceil(p.length/d),h=p.length>=d,_=h?(d-1)*6*2:0,x=h?(f-1)*6*2:0,C=h?(c-_)/d:c,y=h?(u-x)/f:u,b=Math.min(C,y);return p.map((v,S)=>{let M=a||v?.meta?.aspectRatio||"1:1",[P,O]=M.split(":").map(Number),L=P>=O,H=P/O,z=L?b:b*H,R=L?b/H:b,V=Math.floor(S/d),F=S%d,q=V*(b+6*2),X=F*(b+6*2);return{imageBoxWidth:z,imageBoxHeight:R,imageBoxTop:q,imageBoxLeft:X,image:v}})}else return[]}catch{return[]}},[t.originalMessage?.metadata?.attachments,n,i,a]),l=(0,On.useMemo)(()=>Tn(()=>{if(o.current){let{width:p,height:c}=o.current.getBoundingClientRect();r([p,c])}},50),[]);return(0,On.useEffect)(()=>{let p=new ResizeObserver(()=>{l()});return o.current&&p.observe(o.current),()=>{p.disconnect()}},[o]),On.default.createElement(g,{component:"div",ref:o,mt:1,minHeight:"16px",width:"60%",minWidth:Lp-16-16,sx:{position:"relative"}},s.map(p=>{let u=(o.current?.getBoundingClientRect().width||Lp-16-16)/B_(p?.image?.meta?.aspectRatio);return On.default.createElement(B,{ref:o,key:1,className:"maxai-ai-message__image__content__box",sx:{position:"relative",zIndex:0,display:"inline-flex",alignItems:"center",justifyContent:"center",width:"auto",height:"auto",overflow:"hidden",borderRadius:"4px","& > img":{width:"100%",height:"100%",border:"2px solid rgba(0,0,0,0)",boxSizing:"border-box",borderRadius:"8px",transition:"border .1s cubic-bezier(0.22, 0.61, 0.36, 1)",userSelect:"none",overflow:"hidden"}}},On.default.createElement(xi,{SkeletonSx:{width:"100%"},fileId:p.image.uploadedFileId,height:u,src:p.image?.uploadedUrl||"",alt:`Variation 1 of ${s.length}`}))}))},o3=nk;var Cs=I(E()),rk=e=>{let{message:t}=e,{isDarkMode:o}=Wn(),{content:n,isLoading:r}=Xe(),i=n.status===void 0?!r:n.status==="complete";return Cs.default.createElement("div",{"data-testid":"chat-ai-message--markdown","data-disabled-button-clicked":!0,className:`markdown-body ${o?"markdown-body-dark":""}`,translate:i?void 0:"no"},Cs.default.createElement(Cs.Suspense,{fallback:Cs.default.createElement(En,{loading:!0})},Cs.default.createElement(Sa,{appendLoadingDot:!i,message:t},n.text)))},n3=rk;var r3=I(E()),Do=I(E()),ik=e=>{let{transcripts:t,loading:o}=e,{t:n}=k(),[r,i]=(0,r3.useState)({}),a=u=>{let m=document.createElement("textarea");return m.innerHTML=u.trim().replace(/\n/g,""),m.value},s=u=>{let d=u.split("[AI KNOWLEDGE]({})"),f=[];return d.forEach((h,_)=>{let x=h.trim();x&&f.push(x),_<d.length-1&&f.push(Do.default.createElement(Y_,null))}),f},l=u=>{r[u]=!r[u],i({...r})},p=!t||!Array.isArray(t),c=t?.length===0;return p?Do.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error")):c?Do.default.createElement(T,{fontSize:16,color:"text.primary",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__not_have__transcript")):Do.default.createElement(g,{gap:2},t.map((u,m)=>{if(u.text||u.status==="error"){let d=u?.children&&u?.children.length>0;return Do.default.createElement(g,{key:u.start},Do.default.createElement(g,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:m},Do.default.createElement(nh,{time:u.start,docId:u.docId,url:u.url}),u.status!=="error"&&Do.default.createElement(g,{sx:{flex:1,cursor:d?"pointer":"default"},onClick:()=>u.id&&l(u.id)},Do.default.createElement(T,{fontSize:16,color:"text.primary"},s(a(u.text||""))),d&&Do.default.createElement(g,{direction:"row",alignItems:"center"},Do.default.createElement(T,{fontSize:15,color:"text.secondary"},r[u.id||""]?n("package__features:chat__ai_message__youtube_summary__collapse"):n("package__features:chat__ai_message__youtube_summary__expand")),r[u.id||""]?Do.default.createElement(G,{sx:{transform:"rotate(180deg)",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}):Do.default.createElement(G,{sx:{color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},size:25,icon:"KeyboardArrowDown"}))),u.status==="error"&&Do.default.createElement(T,{fontSize:16,color:"error",sx:{p:0,flex:1}},n("package__features:chat__ai_message__youtube_summary__transcript_timestamped_error"))),u?.children&&r[u.id||""]&&u?.children?.map(f=>Do.default.createElement(g,{direction:"row",justifyContent:"flex-start",alignItems:"flex-start",spacing:1,key:f.id,sx:{marginTop:"5px",marginLeft:"10px"}},Do.default.createElement(nh,{mode:"lite",time:f.start,docId:f.docId,url:f.url}),Do.default.createElement(T,{fontSize:15,color:"text.secondary",onClick:()=>u.id&&l(u.id),sx:{p:0,flex:1,cursor:"pointer"}},s(a(f.text||""))))))}else if(o&&u.status==="loading")return Do.default.createElement(fo,{key:m,variant:"rounded",width:"100%",height:15});return null}))},xg=ik;var ak=e=>{let{message:t,hasError:o}=e,{content:n,metadata:r,processingStep:i,isLoading:a}=Xe(),s=()=>!Yu(t)||i==="RESPONDING"||i==="RESPONDED"?n.contentType==="image"||r.artTextToImageMetadata||r.shareType==="art"?ys.default.createElement(o3,{message:t}):(r.videoTimestamped?.length||r.videoTranscripts?.length)&&!n.text?null:ys.default.createElement(n3,{message:t}):null;return ys.default.createElement(ys.default.Fragment,null,!o&&r.videoTimestamped&&ys.default.createElement(xg,{transcripts:r.videoTimestamped,loading:a}),!o&&r.videoTranscripts&&ys.default.createElement(xg,{transcripts:r.videoTranscripts,loading:a}),s())},_g=ak;var Tc=I(E()),sk=()=>{let[e,t]=(0,Tc.useState)(()=>window.location.href),[o,n]=(0,Tc.useState)(document.title),r=(0,Tc.useRef)(null),i=()=>{a(),r.current=setInterval(()=>{n(document.title),t(window.location.href)},1e3)},a=()=>{r.current&&clearInterval(r.current)};return{pageUrl:e,documentTitle:o,startListen:i,stopListen:a}},i3=sk;var a3=[{itemId:zx,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Vx,count:10.3,timestamp:Date.now(),readonly:!0},{itemId:Wx,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Ux,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:Gx,count:10,timestamp:Date.now(),readonly:!0},{itemId:Rx,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:pu,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:cu,count:10.1,timestamp:Date.now(),readonly:!0},{itemId:uu,count:10.2,timestamp:Date.now(),readonly:!0},{itemId:Xs,count:10.2,timestamp:Date.now(),readonly:!0}];var s3=[{title:"DOGE Has 'God Mode' Access to Government Data"},{title:"Dan Bongino Named FBI Deputy Director"},{title:"Anthropic Releases Hybrid Reasoning Model"},{title:"Microsoft Cancels AI Data Center Leases"},{title:"Indoor Scent Pollution Hazards"},{title:"Zelenskyy Offers to Resign for Peace"},{title:"SEC Drops OpenSea Investigation"},{title:"DOGE Tells Federal Employees Document Your Work"},{title:"NBA Debuts AI Training Robots"},{title:"Trump Fires Military Leaders"},{title:"Nadella Dismisses AGI Benchmarks"},{title:"SEC Approves Interest-Bearing Stablecoin"},{title:"Musk Recommends ISS Deorbit"},{title:"DeepSeek Plans R1 Code Release"},{title:"Chinese Team Finds New Bat Coronavirus"},{title:"DHS Revokes TPS for Haitians"},{title:"SEC To Drop Charges Against Coinbase"},{title:"FTC Investigates Big Tech Censorship"},{title:"Kash Patel Confirmed as FBI Director"},{title:"Trump and Zelenskyy Feud Over Peace Talks"}];var wc=I(E()),Va=(e,t)=>{if(!e)return t;let o=e.toLowerCase();return t.filter(n=>n.prompt_title.toLowerCase().includes(o)||wa(n.prompt_id,n.prompt_title).toLowerCase().includes(o))},lk=e=>{let{t}=k(),{contextMenuPath:o}=io(),{conversationId:n}=Yt(),{selectedChatDocuments:r}=Ci(),i=un(n),{selectedType:a}=er(),s=(0,wc.useMemo)(()=>{let h=null;for(let _=i.length-1;_>=0;_--){let x=i[_];if(Xu(x)){h=x;break}}return h?.meta?.messageChatDocuments||[]},[i]),{liteContextMenuActionsItems:l}=Sl(e,{selectionInputAble:!0}),p=ey(),{contextMenuSuggestions:c}=jr("/rewrite",30),{contextMenuSuggestions:u}=jr("/my_own_tools",30),m=(0,wc.useMemo)(()=>s3.map(h=>Il({promptId:Xo(),parentPromptId:kp,promptTitle:h.title,question:h.title,icon:"Search"})),[t]),d=(0,wc.useMemo)(()=>{let h=r.map(O=>O.maxAIDocumentId).filter(Du),_=h.length===s.length&&i.length>0;for(let O of s){let L=O.maxAIDocumentId;if(ls(O.id)&&(L=O.id),L&&!h.includes(L)){_=!1;break}}let x=[],C={prompt_id:kp,parent_prompt_id:"",prompt_title:t("package__features:chat_box__auto_suggestion__suggested__title"),type:"group",children:[],actions:[]};if(x.push(C),_)return C.children=[],x;let y=r.length>0&&r.every(O=>O.maxAIDocumentType==="page_content__webpage"&&O.selected),b=r.length===1&&r[0].maxAIDocumentType==="page_content__youtube"&&r[0].selected,v=r.length===1&&r[0].maxAIDocumentType==="page_content__email"&&r[0].selected,S=r.length==1&&r[0].maxAIDocumentType==="search_results"&&r[0].selected,M=r.length>0&&r.every(O=>O.maxAIDocumentType==="image"&&O.selected),P=r.length>0&&r.every(O=>O.maxAIDocumentType!=="search_results"&&O.selected);if(y){let O=du.PAGE_SUMMARY;O&&C.children?.push(...Va(e,O(r)))}else if(b){let O=du.YOUTUBE_VIDEO_SUMMARY;O&&C.children?.push(...Va(e,O(r)))}else if(v){let O=du.DEFAULT_EMAIL_SUMMARY;O&&C.children?.push(...Va(e,O(r)))}else if(M){let O=[Il({promptId:pu,parentPromptId:C.prompt_id,icon:"DocumentScanner",promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__extract_text")}),Il({promptId:cu,parentPromptId:C.prompt_id,icon:"Question",question:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content"),promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__explain_content")})];C.children?.push(...Va(e,O))}else if(S)C.children?.push(...Va(e,m).slice(0,6));else if(P){let O=[Il({promptId:uu,parentPromptId:C.prompt_id,promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize"),question:t("package__features:chat_box__auto_suggestion__suggested__prompt__summarize")})];C.children?.push(...Va(e,O))}if(!S){let O=Va(e,c),L=Va(e,u);C.children?.push(...O,...L),C.children.length&&p.length&&(C.children=p.map(H=>C.children.find(z=>z.prompt_id.replace(Zo,"")===H)).filter(Boolean).slice(0,30))}if(e.trim()&&C.children?.length){let O=Il({promptId:Xs,parentPromptId:C.prompt_id,promptTitle:t("package__features:chat_box__auto_suggestion__suggested__prompt__ask_query",{QUERY:`"${e}"`}),question:e});S?C.children=[O,...C.children.slice(0,5)]:C.children.unshift(O)}return x},[i.length,p,u,c,s,r,e,t]),f=(0,wc.useMemo)(()=>o===null&&a==="SUGGESTED"?d.filter(h=>(h.children||[]).length>0):l,[o,d,a,l]);return{query:e,selectedContextMenuList:f}},l3=lk;var yg=I(E()),pk=e=>{let{t}=k(),{onClick:o}=e;return yg.default.createElement(se,{onClick:o,title:t("package__common:close"),placement:"bottom",sx:{width:"26px",height:"26px",padding:"8px"}},yg.default.createElement(G,{icon:"Close"}))},p3=pk;var bs=I(E()),ck=e=>{let{sx:t,children:o,LiteContextMenuEditViewProps:n,LiteContextMenuPositionSettingsProps:r,isBottom:i,hideToolbar:a=!1}=e,{mode:s,contextMenuPath:l}=io(),{refetch:p}=Er();return(0,bs.useEffect)(()=>{p("SidebarLiteContextMenuLayout")},[l]),bs.default.createElement(g,{sx:{width:"100%",height:"100%",...t}},s==="edit"&&bs.default.createElement(JC,{...r}),s==="list"&&o,s==="edit"&&bs.default.createElement(oy,{...n}),l!==null&&!a&&bs.default.createElement(ny,{sx:{...i?{borderTop:"1px solid",borderColor:"border.main",borderRadius:" 0 0 8px 8px"}:{borderBottom:"1px solid",borderColor:"border.main",borderRadius:"8px 8px 0 0"}}}))},c3=ck;var Ye=I(E()),uk=e=>{let{sx:t,inputElementRef:o,onBeforeRunSuggestion:n,filterContextMenuList:r}=e,{t:i}=k(),{conversationId:a,inputMediator:s}=Yt(),l=Ye.default.useRef(null),{layout:p,conversationType:c}=he(j=>({layout:j.layout,conversationType:j.conversationType})),{selectedType:u,resetMyOwnToolsType:m}=er(),d=fe(a),f=un(a),{loading:h,selectedChatDocuments:_}=Ci(),x=_.length===1&&_[0].maxAIDocumentType==="search_results"&&u==="SUGGESTED",[C,y]=(0,Ye.useState)(""),{selectedContextMenuList:b}=l3(C),v=(0,Ye.useMemo)(()=>r?r(b):b,[b,r]);(0,Ye.useEffect)(()=>{},[r]);let{askAIWithShortcutsV2:S}=ke(),M=p<=1&&f.length===0,[P,O]=(0,Ye.useState)(!1),[L,H]=(0,Ye.useState)(null),[z,R]=(0,Ye.useState)(!0),V=(0,Ye.useMemo)(()=>d,[h,d]),F=async j=>{if(j.actions){if(n&&!n(j))return;await S(j.actions,{isClearInput:!0,isFocusInput:!0})}};(0,Ye.useEffect)(()=>{let j=o?.current||vt(c).ref;if(j){let w=N=>{if(["ArrowUp","ArrowDown"].includes(N.key)){let Z=N.key==="ArrowUp"?-1:1,re=l.current?.querySelectorAll("[data-promptid]");if(re&&re.length>0){N.preventDefault(),O(!0);let be=Array.from(re).findIndex(we=>we.getAttribute("data-promptid")===L)+Z,Ce=null;be<0?Ce=re[re.length-1]:be>=0&&be<re.length?Ce=re[be]:Ce=re[0],H(Ce.getAttribute("data-promptid")),Ce.scrollIntoView({behavior:"instant",block:"nearest"})}}else if(N.key==="Enter"&&!s.isComposing){let Z=l.current?.querySelector(`[data-promptid="${L}"]`);Z&&(N.stopPropagation(),N.preventDefault(),Z.click())}},ne=()=>{y(j.value)},pe=()=>{setTimeout(()=>{y(j.value)},0),setTimeout(()=>{y(j.value)},200)},A=()=>{O(!1)};j.addEventListener("keydown",w,{capture:!0}),j.addEventListener("input",ne,{capture:!0}),j.addEventListener("blur",pe),y(j.value);let U=setInterval(()=>{y(j.value)},1e3);return window.addEventListener("mousemove",A),()=>{clearInterval(U),j.removeEventListener("keydown",w,{capture:!0}),j.removeEventListener("input",ne,{capture:!0}),j.removeEventListener("blur",pe),window.removeEventListener("mousemove",A)}}},[c,L]),(0,Ye.useEffect)(()=>{let j=null;for(let w of v)if(w.children.length>0){j=w.children[0],j.prompt_id===Xs&&w.children[1]&&(j=w.children[1]);break}H(j?.prompt_id||null)},[v]),wn(()=>{Ju.getService("CONTEXT_MENU_SUGGEST").setReadonlyItems(a3)});let q=(0,Ye.useRef)(!1);(0,Ye.useEffect)(()=>{if(q.current){q.current=!1;return}R(!0)},[f,_,u]);let X=v.length===0,W=f.length===0;return d?null:Ye.default.createElement(g,{ref:l,"data-testid":"maxai--chat-auto-suggestion--container",sx:{...M?{borderTop:"1px solid",borderColor:"border.main",order:"2!important"}:{borderBottom:"1px solid",borderColor:"border.main",marginTop:"0px !important",order:"0!important"},...X?{border:"none"}:{},...P?{pointerEvents:"none"}:{},...z?{}:{display:"none"},gap:"10px","&:empty":{display:"none"},...t}},Ye.default.createElement(c3,{hideToolbar:C!=="",isBottom:M,LiteContextMenuEditViewProps:{sx:{padding:"4px",maxHeight:"max(192px, 14vh)",overflowY:"auto",p:0}}},Ye.default.createElement(hi,{sx:{display:X?"none":"block",maxHeight:"max(192px, 14vh)",overflowY:"auto",padding:"4px"}},v.map((j,w)=>{let ne=j.prompt_title,pe=`package__features:context_menu__prompt__${j.prompt_id}`;return i(pe).includes(j.prompt_id)||(ne=i(pe)),Ye.default.createElement(g,{key:j.prompt_id},v.length>=1&&Ye.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between"},Ye.default.createElement(T,{fontSize:"12px",fontWeight:400,height:"32px",px:"8px",textAlign:"left",lineHeight:"32px",color:"text.secondary"},ne),Ye.default.createElement(g,{direction:"row",gap:"6px",sx:{pr:"8px"}},!x&&[Zo,kp].includes(j.prompt_id)&&Ye.default.createElement($l,null),!W&&w===0&&z&&Ye.default.createElement(p3,{onClick:()=>{m(),u!=="SUGGESTED"&&(q.current=!0),R(!1)}}))),j.children?.map(A=>{if(A.type==="group")return A.children.map(N=>{let ce=L===N.prompt_id;return Ye.default.createElement(u3,{isSelected:ce,key:A.prompt_id+A.prompt_title,contextMenuItem:N,parent:A,disabled:V,onMouseEnter:()=>{H(N.prompt_id)},onClick:async()=>{await F(N)}})});let U=L===A.prompt_id;return Ye.default.createElement(u3,{isSelected:U,key:A.prompt_id+A.prompt_title,contextMenuItem:A,disabled:V,onMouseEnter:()=>{H(A.prompt_id)},onClick:async()=>{await F(A)}})}))}))))},u3=e=>{let{contextMenuItem:t,parent:o,disabled:n,onMouseEnter:r,onMouseLeave:i,onClick:a,isSelected:s}=e,{t:l}=k(),{selectedType:p}=er(),c=t.prompt_icon||o?.prompt_icon,u=t.origin?.path||"",m=u&&u.startsWith("/rewrite"),d=u&&u.startsWith("/my_own_tools"),f=(0,Ye.useMemo)(()=>{let _=t.prompt_title,x=t.prompt_id.startsWith(Zo)?t.prompt_id.replace(Zo,""):t.prompt_id,C=`package__features:context_menu__prompt__${x}`;if(l(C).includes(x)||(_=l(C)),o?.prompt_title&&o?.prompt_id){let y=o.prompt_title,b=`package__features:context_menu__prompt__${o.prompt_id}`;l(b).includes(o.prompt_id)||(y=l(b),_=`${y} -> ${_}`)}return _},[l]),h=Ia();return Ye.default.createElement(mt,{disabled:n,onClick:async()=>{if(!await Qe({emitEvent:!0})){h.focus();return}a?.()},onMouseEnter:r,onMouseLeave:i,"data-testid":`maxai--chat-auto-suggestion--menu-item--${t.prompt_id}`,"data-promptid":t.prompt_id,key:t.prompt_id,sx:{padding:"6px 8px",height:"32px",boxSizing:"border-box",gap:"12px",alignItems:"center",borderRadius:"4px",color:"text.primary",minHeight:"unset","&:hover":{color:"text.primary"},...s?{bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.06)!important":"rgba(0, 0, 0, 0.04)!important"}:{}}},c&&Ye.default.createElement(G,{sx:{color:"text.secondary",flexShrink:0},icon:c,size:20}),Ye.default.createElement(T,{width:0,flex:1,fontSize:"14px",fontWeight:400,textAlign:"left",color:"text.primary",noWrap:!0},f),m&&s&&p==="SUGGESTED"&&Ye.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"2px 4px",fontSize:"12px",borderRadius:"4px",color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__rewrite")),d&&s&&p==="SUGGESTED"&&Ye.default.createElement(T,{component:"span",sx:{border:"1px solid",borderColor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)",padding:"1px 4px",fontSize:"12px",borderRadius:"4px",color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}},l("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools")))},qd=uk;var m3=I(pc());var Ao=I(E());var mk=e=>{let{value:t,onChange:o,onEnter:n,TextareaProps:r,error:i,sx:a,hideFooter:s=!1,onClickSuggestion:l,liteContextMenuPath:p}=e,{t:c}=k(),{chatMode:u}=Da(),m=$t(dC),d=Ao.default.useRef(null),f=(0,Ao.useCallback)(x=>{if(m==="UNKNOWN"||!p||Hp(p)!=="/compose_reply")return x;let C=y=>{let b=[];return m==="CHAT_APP_WEBSITE"&&b.push(...K1,...X1),m==="EMAIL"&&b.push(...$1,...X1),m==="SOCIAL_MEDIA"&&b.push(...$1,...K1),!b.includes(y.prompt_id.replace(Zo,""))};return Ee(x).filter(y=>C(y)?(y.children&&(y.children=y.children.filter(b=>C(b))),!0):!1)},[m,p]),[h,_]=(0,Ao.useState)(!1);return(0,Ao.useEffect)(()=>(d.current&&vt("chatBoxSetVariablesModalInputMediator").bindRef(d.current),()=>{vt("chatBoxSetVariablesModalInputMediator").unbindRef()}),[]),Ao.default.createElement(g,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${i?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...a}},Ao.default.createElement(g,{"data-testid":"maxai--chat-box--chat-input--main",spacing:1,sx:{p:"10px"}},Ao.default.createElement(Kl,{ref:d,"data-testid":"chat-input-textarea",value:t,onChangeText:x=>{o?.(x)},onEnter:n,stopPropagation:!0,...r}),!s&&Ao.default.createElement(B,{display:"flex",alignItems:"center",justifyContent:"space-between"},Ao.default.createElement(g,{direction:"row",spacing:1,sx:{display:h?"none":"flex"}},e.footerLeftNode),Ao.default.createElement(g,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end"},u==="free_chat"||t!==""?Ao.default.createElement(se,{title:c("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:x=>x.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:!t,onClick:n,styleType:"default"},Ao.default.createElement(m3.default,{sx:{fontSize:"16px",color:"inherit !important"}})):Ao.default.createElement(Gl,{value:{isVoiceInput:h,setIsVoiceInput:_}},Ao.default.createElement(jl,{onSpeechToTextSuccess:x=>{o?.(x),n?.()}}))))),p&&Ao.default.createElement(ka,{defaultContextMenuPath:Hp(p)},Ao.default.createElement(qd,{onBeforeRunSuggestion:x=>l?(l(x),!1):!0,inputElementRef:d,filterContextMenuList:f})))},d3=mk;var h3=I(Sr()),g3=I(pc());var ue=I(E());var Kd=()=>{is.send("SetVariablesModalClose",{})},dk=e=>{let{onShow:t,onClose:o,sx:n}=e,{t:r}=k(),{setChatHubLoading:i}=dt(),{askAIWithShortcutsV2:a}=ke(),{chatMode:s}=Da(),l=(0,ue.useRef)(null),[p,c]=(0,ue.useState)(!1),{conversationId:u}=ie(),[m,d]=(0,ue.useState)(!1),[f,h]=(0,ue.useState)(null),[_,x]=(0,ue.useState)(null),[C,y]=(0,ue.useState)(!1),[b,v]=(0,ue.useState)(!1),[S,M]=(0,ue.useState)(null),[P,O]=(0,ue.useState)(null),L=et(m),{control:H,trigger:z,reset:R,getValues:V,setValue:F,watch:q}=vu({defaultValues:{textVariables:[],selectVariables:[]}}),X=Ca(),{fields:W}=q1({control:H,name:"textVariables"}),{fields:j}=q1({control:H,name:"selectVariables"}),w=f!==null?q(`textVariables.${f}.default_value`):null,ne=(0,ue.useRef)(!1),pe=W.filter($=>!$.hidden).length,A=V().textVariables.filter($=>!$.hidden&&!$.default_value).length>0,U=et(_),[N,ce]=(0,ue.useState)(!1),Z=(0,ue.useMemo)(()=>s==="free_chat"?!1:C||b||N?!0:typeof f=="number"?!w:!1,[s,C,b,N,f,w]),re=(0,ue.useMemo)(()=>S?.contextMenuId&&["47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2"].includes(S.contextMenuId),[S?.contextMenuId]),bt=(0,ue.useRef)(),be=(0,ue.useRef)(null),Ce=(0,ue.useRef)(!1),we=(0,ue.useCallback)($=>{$!=="done"&&y(!1),ce(!1),be.current&&(be.current.getTracks().forEach(J=>J.stop()),be.current=null)},[]),qe=()=>{y(!0)},Ze=$=>{we($),pt(U.current)},Kt=(0,ue.useCallback)(()=>{c(!1),R({textVariables:[],selectVariables:[]}),O(null),m&&(d(!1),x(0),o?.())},[o,R,m]),Fe=et(Kt),pt=$=>{let J=Array.from(l.current?.querySelectorAll('textarea:not([aria-hidden="true"])')||[]);if(typeof $=="number"&&J[$])return J[$].focus(),J[$].setSelectionRange(J[$].value.length,J[$].value.length),!0;let D=J.find(K=>!K.value);return D?(D.focus(),D.setSelectionRange(D.value.length,D.value.length),!1):!0},ct=async()=>{!pt()||!await z()||S&&await kt([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:Ro([{MaxAIPromptActionConfig:S.MaxAIPromptActionConfig},S?.questionMeta||{}])}}}])},kt=(0,ue.useCallback)(async($,J)=>{try{i(!0);let D=Ee($),K=J?Ee(J):{};if(!J){let He=Ee(V());He.textVariables.concat(He.selectVariables).forEach(It=>{K[It.name]={key:It.name,value:It.default_value,overwrite:!0,isBuiltIn:It.hidden,label:It.hint}})}if(s==="free_chat"){let He=K.AI_RESPONSE_TONE;He&&(He.value="Default");let It=K.AI_RESPONSE_WRITING_STYLE;It&&(It.value="Default")}D.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:K}});let Q=D.some(He=>{let It=uC(He);if(It?.path){let te=Hp(It.path);return["/refine_draft","/rewrite","/compose_new","/compose_reply"].includes(te)}return!1});d(!1),o?.(),await a(D,{conversationId:u,disabledMaxAIDocumentIds:Q,keepLoadingAfterExecution:!0});let ae=Gr.getShortcutsEngine(u),oe=!0;if(ae.status!=="stop"&&P&&(oe=!1,D[D.length-1].type!=="SET_VARIABLES_MODAL")){let He=Gr.getShortcutsEngine(u),It=await Jn.getService().getMessageByType(u,"ai","latest");if(It&&He.status==="idle"){oe=!1;let te=Ee(sC);te.variables=[Oe.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION,{name:"SELECTED_TEXT",hint:"Text to rewrite",type:"text",hidden:!0,default_value:wr(It,!1)}],await is.send(`SetVariablesModal_${u}`,{task:"open",config:{title:P,contextMenuId:te.prompt_id,variables:te.variables,MaxAIPromptActionConfig:te}})}}oe&&i(!1)}catch{i(!1)}},[a,s,u,P,V,o]),Ke=(0,ue.useCallback)(async($,J)=>{try{return c(!0),await z_.usePromptAction(u,J,{chatMode:"free_chat",jsonMode:!0,taskId:$})}catch{return null}finally{c(!1)}},[u]),Dt=(0,ue.useRef)(""),ut=(0,ue.useCallback)(async $=>{let{task:J,config:D}=$||{};Dt.current&&Vn.abort(Dt.current);let K=Xo();if(Dt.current=K,J==="open"&&D){i(!0);let Q=D;Q?.contextMenuId&&["d833ef67-36fb-4228-8e04-4b6d7583a341","1cc8f601-27ac-474f-a70c-20ed1177711a","47070ec6-8700-43fd-a519-20fe3841df38","9a65c4c0-c2b8-4fe1-a85e-0e2d84682eb1","b5381aa7-5ba3-4f96-a696-c694da938ef2"].includes(Q.contextMenuId)&&O(wa(Q?.MaxAIPromptActionConfig?.prompt_id||"",Q?.title||""));let ae=await Xl.getSetVariablesModalSelectCache();Q.variables=Q.variables?.map(te=>(Object.prototype.hasOwnProperty.call(ae,te.name)&&(te.default_value=ae[te.name]),te))||[];let oe=(Q.variables||[]).filter(te=>te.type==="text"),He=(Q.variables||[]).filter(te=>te.type==="select");if(R({textVariables:oe,selectVariables:He}),Q.description?.label&&Q.extraDataByPromptAction?.prompt_id&&(Q.description.label=wa(Q.extraDataByPromptAction.prompt_id,Q.description.label)),M(Q),Q.extraDataByPromptAction&&Ke(Dt.current,Q.extraDataByPromptAction).then(te=>{!te||K!==Dt.current||M(ze=>({...ze,description:{icon:"LightBulb",label:"Intent",...ze?.description,content:te.intent}}))}),!(oe.length>0&&oe.some(te=>!te.hidden&&!te.default_value))&&!D.disableAutoExecuteWhenAllVariableHaveValue){let te=Q.variables||[],ze={};te.forEach(gt=>{ze[gt.name]={key:gt.name,value:gt.default_value,overwrite:!0,isBuiltIn:gt.hidden,label:gt.hint}}),kt([{type:"ASK_CHATGPT",parameters:{AskChatGPTActionQuestion:{text:"",meta:Ro([{MaxAIPromptActionConfig:Q?.MaxAIPromptActionConfig},Q?.questionMeta||{}])}}}],ze)}else d(!0),t?.(),setTimeout(()=>{pt()},0),i(!1);return{data:{},type:"confirm",success:!0}}},[kt,Ke,t,R,i]);(0,ue.useEffect)(()=>{let $=is.receive(`SetVariablesModal_${u}`,ut);return()=>{$()}},[u,ut]),(0,ue.useEffect)(()=>{u&&Fe.current()},[u]),(0,ue.useEffect)(()=>{let $=is.receive("SetVariablesModalClose",()=>{L.current&&Fe.current()});return()=>{$()}},[]);let Y=(0,ue.useRef)(null);return m?ue.default.createElement(g,{className:"max-ai__action__set_variables_modal",sx:{width:"100%",overflow:"hidden",pb:1,boxSizing:"border-box",...n,gap:"12px"},maxHeight:"100%",onKeyPressCapture:$=>{$.stopPropagation()},onKeyPress:$=>{$.stopPropagation()}},ue.default.createElement(g,{width:"100%",flexShrink:0},ue.default.createElement(g,{direction:"row",alignItems:"start",justifyContent:"space-between",width:"100%",sx:{bgcolor:"rgba(0, 0, 0, 0.87)",borderRadius:"8px",padding:"2px 2px 2px 12px",gap:"10px","&:has(+ .max-ai__action__set_variables_modal--description)":{borderRadius:"8px 8px 0 0"}}},ue.default.createElement(B,{width:0,flex:1,component:"div",display:"flex",alignItems:"center"},ue.default.createElement(T,{fontSize:"14px",color:"#fff",fontWeight:600,height:"32px",lineHeight:"30px",sx:{textAlign:"left",width:"100%"},noWrap:!0},wa(S?.MaxAIPromptActionConfig?.prompt_id||"",S?.title||""))),ue.default.createElement(se,{"data-testid":"close-modal-button",sx:{width:"32px",height:"32px",flexShrink:0},onMouseDown:()=>{Fe.current()}},ue.default.createElement(h3.default,{sx:{fontSize:"20px",color:"#fff!important"}}))),S?.description&&ue.default.createElement(g,{className:"max-ai__action__set_variables_modal--description",sx:{padding:"8px",border:"1px solid",borderTop:"none",borderColor:"border.main",gap:"4px",width:"100%",borderRadius:"0 0 8px 8px"}},ue.default.createElement(g,{direction:"row",alignItems:"center",gap:"8px"},ue.default.createElement(G,{icon:S.description.icon,sx:{flexShrink:0,fontSize:"20px",color:"text.primary"}}),ue.default.createElement(T,{fontSize:"14px",color:"text.primary",fontWeight:500,lineHeight:"20px",width:0,flex:1,noWrap:!0},r(`package__features:context_menu__prompt__${S.extraDataByPromptAction?.prompt_id}`)||S.description.label)),p?ue.default.createElement(g,null,ue.default.createElement(fo,{height:21,animation:"wave"})):ue.default.createElement(pi,{in:!0},ue.default.createElement(T,{fontSize:"14px",color:"text.secondary",fontWeight:400,lineHeight:"21px"},S.description.content)))),ue.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px",sx:{height:"32px",width:"100%"}},ue.default.createElement(Fa,null),s!=="free_chat"&&ue.default.createElement(Ra,null),s!=="free_chat"&&ue.default.createElement(Ha,null)),ue.default.createElement(g,{component:"div",direction:"row",flexWrap:"wrap",flex:1,height:0,sx:{marginTop:"-8px",gap:"8px",overflowY:"auto",scrollbarColor:"auto","&::-webkit-scrollbar":{width:"7px"},"&::-webkit-scrollbar-thumb":{borderRadius:"20px",backgroundColor:"text.secondary"}},ref:l},pe===1&&W.map(($,J)=>$.hidden?null:ue.default.createElement(rl,{control:H,rules:{required:!0},key:$.name,render:({field:D})=>ue.default.createElement(d3,{"data-testid":`custom-variable--${$.name}`,value:D.value||"",onChange:D.onChange,TextareaProps:{minLine:4,placeholder:($.hintI18nKey?r($.hintI18nKey):$.hint)||`Enter ${$.name}`},onEnter:ct,onClickSuggestion:async K=>{await kt(K.actions)},liteContextMenuPath:re?S?.MaxAIPromptActionConfig?.path:void 0,footerLeftNode:re?ue.default.createElement(ue.default.Fragment,null,s!=="free_chat"&&j.map((K,Q)=>K.hidden?null:ue.default.createElement(rl,{key:K.name,control:H,name:`selectVariables.${Q}.default_value`,defaultValue:K.default_value,render:({field:ae})=>ue.default.createElement(Ad,{systemVariableSelectKey:K.name,key:K.name,defaultValue:ae.value,onChange:oe=>{Xl.setVariablesModalSelectCache(K.name,oe),ae.onChange(oe)}})}))):null}),name:`textVariables.${J}.default_value`})),pe>1&&ue.default.createElement(ue.default.Fragment,null,W.map(($,J)=>{let D=(X==="lg"||X==="xl")&&W.length>1?"calc(50% - 8px)":"100%";return $.hidden?null:ue.default.createElement(rl,{control:H,rules:{required:!0},key:$.name,name:`textVariables.${J}.default_value`,render:({field:K})=>ue.default.createElement(zt,{fullWidth:!0,"data-testid":`custom-variable--${$.name}`,size:"small",key:$.name,label:$.hint||"Label",value:K.value||"",sx:{width:D,mt:"8px"},InputProps:{sx:{fontSize:"16px",minHeight:"63px"}},inputProps:{style:{fontSize:"16px",textAlign:"left"}},FormHelperTextProps:{sx:{ml:0,fontSize:"12px"}},onChange:Q=>{K.onChange(Q.target.value)},onKeyUp:Q=>{Q.stopPropagation()},onKeyDown:async Q=>{Q.key==="Enter"&&!Q.shiftKey&&!ne.current?(Q.stopPropagation(),Q.preventDefault(),ct()):Q.stopPropagation()},onCompositionStart:()=>{ne.current=!0},onCompositionEnd:()=>{ne.current=!1},onPaste:Q=>{Q.stopPropagation()},onFocus:Q=>{h(J),x(J)},onBlur:()=>{h(null)},InputLabelProps:{shrink:!0,sx:{fontSize:"16px"}},multiline:!0,placeholder:$.hint||`Enter ${$.name}`,minRows:2,maxRows:2})})}),ue.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"end",width:"100%"},Z?ue.default.createElement(jl,{onMouseDown:async()=>{try{if(Ce.current)return;Y.current&&clearTimeout(Y.current),v(!0),clearTimeout(bt.current),Ce.current=!0,be.current=await navigator.mediaDevices.getUserMedia({audio:!0}),Ce.current=!1,ce(!0),window.addEventListener("mouseup",()=>{Ce.current||(clearTimeout(bt.current),bt.current=setTimeout(()=>{v(!1)},200))},{once:!0})}catch{Ce.current=!1,Y.current=setTimeout(()=>{v(!1)},3e3)}},onStartRecording:qe,onStopRecording:Ze,onSpeechToTextSuccess:$=>{U.current!==null&&(F(`textVariables.${U.current}.default_value`,$),pt(U.current),y(!1))},onSpeechToTextFinally:()=>{we()}}):ue.default.createElement(se,{title:r("package__features:chat__inputbox__button__send_to_ai__tooltip"),description:"\u23CE",tooltipProps:{sx:{minWidth:"unset",p:1}},variant:"contained","data-testid":"sidebar_actions__send_btn",sx:{width:32,height:32,minWidth:"unset",borderRadius:1,boxSizing:"border-box","&[disabled]":{color:"background.paper"},"&:hover":{color:$=>$.palette.mode==="dark"?"rgba(0, 0, 0, 0.87)":"rgba(255, 255, 255, 1)"}},disabled:A,onClick:ct,styleType:"default"},ue.default.createElement(g3.default,{sx:{fontSize:"16px",color:"inherit !important"}})))))):null},x3=dk;var _3=()=>{let e=document.createElement("div");e.contentEditable="true",e.style.all="initial",e.style.position="absolute",e.style.top="-9999px",e.style.left="-9999px",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",document.body.appendChild(e),e.focus(),document.execCommand("paste",!1,"");let t=document.createElement("div");return e.childNodes.forEach(o=>{t.appendChild(o.cloneNode(!0))}),e.remove(),t},Zr=e=>{let t=[];return e.forEach(o=>{document.querySelectorAll(o).forEach(n=>{n instanceof HTMLElement&&t.push(n)})}),t},Xd=(e,t=!1)=>{if(e.focus(),!t)document.execCommand("selectAll",!1,"");else{let n=window.getSelection(),r=document.createRange();r.selectNodeContents(e),r.collapse(!1),n?.removeAllRanges(),n?.addRange(r)}document.execCommand("paste",!1,""),(e.lastElementChild||e).scrollIntoView({block:"center",inline:"center"})},C3={selectors:['div[id][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=C3.selectors,r=o||Zr(n)[0];if(!r){let d=Zr([".amn .ams.bkH",".amn .ams.bkI"]),f=d[d.length-1];f&&(f.click(),await W1(document.body,n[0],100,5e3),r=Zr(n)[0])}if(!r)return;let i=document.createElement("div");i.className="F0iAze";let a=_3();a.className="Znr6db";let s=document.createElement("br");a.appendChild(s),i.appendChild(a),r.scrollIntoView({block:"center",inline:"center"});let l=!1,p=Array.from(r.children);p.length===1&&(p=Array.from(p[0].children)),p.forEach(d=>{(d.tagName==="HR"||d.matches(".gmail_quote")||d.querySelector(".gmail_quote"))&&(l=!0),!l&&d.remove()}),r.focus(),r.prepend(i);let c=document.createRange();c.selectNodeContents(a),c.collapse(!1);let u=window.getSelection();u?.removeAllRanges(),u?.addRange(c),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"}),setTimeout(()=>{i.classList.remove("F0iAze")},1e3)}},$d={selectors:['div[id^=editor] div[aria-multiline][spellcheck][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=$d.selectors,r=o||Zr(n)[0];if(!r){let m=Zr(['button[role="menuitem"]:has(i[data-icon-name="ArrowReplyRegular"])','button[role="menuitem"]:has(i[data-icon-name="ArrowReplyAllRegular"])']),d=m[m.length-1];d&&(d.click(),await W1(document.body,n[0],100,5e3),r=Zr(n)[0])}if(!r)return;let i=document.createElement("div"),a=_3();a.innerHTML=a.innerHTML.replace(/\n/g,"<br />");let s=document.createElement("br");a.appendChild(s),a.querySelectorAll("li > br:first-child").forEach(m=>{m.remove()}),i.appendChild(a);let l=!1;Array.from(r.children).forEach(m=>{(m.id.includes("RplyFwdMsg")||m.matches("#divRplyFwdMsg")||m.matches("#RplyFwdMsg")||m.querySelector("#divRplyFwdMsg")||m.querySelector("#RplyFwdMsg")||m.tagName==="HR")&&(l=!0),!l&&m.remove()}),r.focus(),r.prepend(i);let p=document.createRange();p.selectNodeContents(a),p.collapse(!1);let c=window.getSelection();c?.removeAllRanges(),c?.addRange(p),(a.lastElementChild||a).scrollIntoView({block:"center",inline:"center"})}},y3={selectors:["div[id][contenteditable]","div#contents ytd-commentbox:not([hidden]) div[id][contenteditable]"],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=y3.selectors,r=o||Zr(n)[0];if(!r)return;let i=r.querySelector("a.yt-simple-endpoint[href]"),a=i?.innerHTML;Xd(r),a&&(i.innerHTML=a)}},bg=null,b3={selectors:['div.ql-editor[contenteditable="true"]','div.msg-form__contenteditable[contenteditable="true"]'],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=b3.selectors,r=o||Zr(n)[0];if(!r)return;bg&&clearTimeout(bg);let a=r.querySelector("a.ql-mention[href]")?.cloneNode(!0)?.outerHTML;Xd(r),a&&(bg=setTimeout(()=>{let s=r.querySelector("p");s&&(s.innerHTML=a+" "+s.innerHTML)},50))}},I3={selectors:['div.ql-editor[contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=I3.selectors,r=o||Zr(n)[0];r&&Xd(r)}};var S3={selectors:['[class^="channelTextArea"] [class^="textArea"] div[role="textbox"][contenteditable="true"]'],insertContent:async(e,t,o)=>{let n=S3.selectors,r=o||Zr(n)[0];r&&Xd(r)}};var v3={selectors:["textarea[id]"],needFindInstantReplyButtonIdToInput:!0,insertContent:async(e,t,o)=>{let n=v3.selectors,r=o||Zr(n)[0];if(!r)return;r.focus(),r.select(),document.execCommand("paste",!1,""),r.setSelectionRange(r.value.length,r.value.length),r.closest("div#id.style-scope.ytcp-form-input-container")?.scrollIntoView()}},T3={"outlook.live.com":$d,"outlook.office.com":$d,"outlook.office365.com":$d,"mail.google.com":C3,"youtube.com":y3,"studio.youtube.com":v3,"linkedin.com":b3,"app.slack.com":I3,"discord.com":S3};var Zt=I(E());var fk={};function Is(e,t){let o=t||fk,n=typeof o.includeImageAlt=="boolean"?o.includeImageAlt:!0,r=typeof o.includeHtml=="boolean"?o.includeHtml:!0;return M3(e,n,r)}function M3(e,t,o){if(hk(e)){if("value"in e)return e.type==="html"&&!o?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return w3(e.children,t,o)}return Array.isArray(e)?w3(e,t,o):""}function w3(e,t,o){let n=[],r=-1;for(;++r<e.length;)n[r]=M3(e[r],t,o);return n.join("")}function hk(e){return!!(e&&typeof e=="object")}function _n(e,t,o,n){let r=e.length,i=0,a;if(t<0?t=-t>r?0:r+t:t=t>r?r:t,o=o>0?o:0,n.length<1e4)a=Array.from(n),a.unshift(t,o),e.splice(...a);else for(o&&e.splice(t,o);i<n.length;)a=n.slice(i,i+1e4),a.unshift(t,0),e.splice(...a),i+=1e4,t+=1e4}function Bn(e,t){return e.length>0?(_n(e,e.length,0,t),e):t}var E3={}.hasOwnProperty;function A3(e){let t={},o=-1;for(;++o<e.length;)gk(t,e[o]);return t}function gk(e,t){let o;for(o in t){let r=(E3.call(e,o)?e[o]:void 0)||(e[o]={}),i=t[o],a;if(i)for(a in i){E3.call(r,a)||(r[a]=[]);let s=i[a];xk(r[a],Array.isArray(s)?s:s?[s]:[])}}}function xk(e,t){let o=-1,n=[];for(;++o<t.length;)(t[o].add==="after"?e:n).push(t[o]);_n(e,0,0,n)}function Yd(e,t){let o=Number.parseInt(e,t);return o<9||o===11||o>13&&o<32||o>126&&o<160||o>55295&&o<57344||o>64975&&o<65008||(o&65535)===65535||(o&65535)===65534||o>1114111?"\uFFFD":String.fromCodePoint(o)}function Zi(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var ar=Ua(/[A-Za-z]/),Dn=Ua(/[\dA-Za-z]/),P3=Ua(/[#-'*+\--9=?A-Z^-~]/);function Mc(e){return e!==null&&(e<32||e===127)}var Ec=Ua(/\d/),k3=Ua(/[\dA-Fa-f]/),L3=Ua(/[!-/:-@[-`{-~]/);function me(e){return e!==null&&e<-2}function xo(e){return e!==null&&(e<0||e===32)}function Te(e){return e===-2||e===-1||e===32}var O3=Ua(/\p{P}|\p{S}/u),B3=Ua(/\s/);function Ua(e){return t;function t(o){return o!==null&&o>-1&&e.test(String.fromCharCode(o))}}function Me(e,t,o,n){let r=n?n-1:Number.POSITIVE_INFINITY,i=0;return a;function a(l){return Te(l)?(e.enter(o),s(l)):t(l)}function s(l){return Te(l)&&i++<r?(e.consume(l),s):(e.exit(o),t(l))}}var D3={tokenize:_k};function _k(e){let t=e.attempt(this.parser.constructs.contentInitial,n,r),o;return t;function n(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),Me(e,t,"linePrefix")}function r(s){return e.enter("paragraph"),i(s)}function i(s){let l=e.enter("chunkText",{contentType:"text",previous:o});return o&&(o.next=l),o=l,a(s)}function a(s){if(s===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(s);return}return me(s)?(e.consume(s),e.exit("chunkText"),i):(e.consume(s),a)}}var H3={tokenize:Ck},F3={tokenize:yk};function Ck(e){let t=this,o=[],n=0,r,i,a;return s;function s(y){if(n<o.length){let b=o[n];return t.containerState=b[1],e.attempt(b[0].continuation,l,p)(y)}return p(y)}function l(y){if(n++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&C();let b=t.events.length,v=b,S;for(;v--;)if(t.events[v][0]==="exit"&&t.events[v][1].type==="chunkFlow"){S=t.events[v][1].end;break}x(n);let M=b;for(;M<t.events.length;)t.events[M][1].end=Object.assign({},S),M++;return _n(t.events,v+1,0,t.events.slice(b)),t.events.length=M,p(y)}return s(y)}function p(y){if(n===o.length){if(!r)return m(y);if(r.currentConstruct&&r.currentConstruct.concrete)return f(y);t.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(F3,c,u)(y)}function c(y){return r&&C(),x(n),m(y)}function u(y){return t.parser.lazy[t.now().line]=n!==o.length,a=t.now().offset,f(y)}function m(y){return t.containerState={},e.attempt(F3,d,f)(y)}function d(y){return n++,o.push([t.currentConstruct,t.containerState]),m(y)}function f(y){if(y===null){r&&C(),x(0),e.consume(y);return}return r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:r}),h(y)}function h(y){if(y===null){_(e.exit("chunkFlow"),!0),x(0),e.consume(y);return}return me(y)?(e.consume(y),_(e.exit("chunkFlow")),n=0,t.interrupt=void 0,s):(e.consume(y),h)}function _(y,b){let v=t.sliceStream(y);if(b&&v.push(null),y.previous=i,i&&(i.next=y),i=y,r.defineSkip(y.start),r.write(v),t.parser.lazy[y.start.line]){let S=r.events.length;for(;S--;)if(r.events[S][1].start.offset<a&&(!r.events[S][1].end||r.events[S][1].end.offset>a))return;let M=t.events.length,P=M,O,L;for(;P--;)if(t.events[P][0]==="exit"&&t.events[P][1].type==="chunkFlow"){if(O){L=t.events[P][1].end;break}O=!0}for(x(n),S=M;S<t.events.length;)t.events[S][1].end=Object.assign({},L),S++;_n(t.events,P+1,0,t.events.slice(M)),t.events.length=S}}function x(y){let b=o.length;for(;b-- >y;){let v=o[b];t.containerState=v[1],v[0].exit.call(t,e)}o.length=y}function C(){r.write([null]),i=void 0,r=void 0,t.containerState._closeFlow=void 0}}function yk(e,t,o){return Me(e,e.attempt(this.parser.constructs.document,t,o),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Ig(e){if(e===null||xo(e)||B3(e))return 1;if(O3(e))return 2}function ip(e,t,o){let n=[],r=-1;for(;++r<e.length;){let i=e[r].resolveAll;i&&!n.includes(i)&&(t=i(t,o),n.push(i))}return t}var Ac={name:"attention",tokenize:Ik,resolveAll:bk};function bk(e,t){let o=-1,n,r,i,a,s,l,p,c;for(;++o<e.length;)if(e[o][0]==="enter"&&e[o][1].type==="attentionSequence"&&e[o][1]._close){for(n=o;n--;)if(e[n][0]==="exit"&&e[n][1].type==="attentionSequence"&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[o][1]).charCodeAt(0)){if((e[n][1]._close||e[o][1]._open)&&(e[o][1].end.offset-e[o][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[o][1].end.offset-e[o][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[o][1].end.offset-e[o][1].start.offset>1?2:1;let u=Object.assign({},e[n][1].end),m=Object.assign({},e[o][1].start);N3(u,-l),N3(m,l),a={type:l>1?"strongSequence":"emphasisSequence",start:u,end:Object.assign({},e[n][1].end)},s={type:l>1?"strongSequence":"emphasisSequence",start:Object.assign({},e[o][1].start),end:m},i={type:l>1?"strongText":"emphasisText",start:Object.assign({},e[n][1].end),end:Object.assign({},e[o][1].start)},r={type:l>1?"strong":"emphasis",start:Object.assign({},a.start),end:Object.assign({},s.end)},e[n][1].end=Object.assign({},a.start),e[o][1].start=Object.assign({},s.end),p=[],e[n][1].end.offset-e[n][1].start.offset&&(p=Bn(p,[["enter",e[n][1],t],["exit",e[n][1],t]])),p=Bn(p,[["enter",r,t],["enter",a,t],["exit",a,t],["enter",i,t]]),p=Bn(p,ip(t.parser.constructs.insideSpan.null,e.slice(n+1,o),t)),p=Bn(p,[["exit",i,t],["enter",s,t],["exit",s,t],["exit",r,t]]),e[o][1].end.offset-e[o][1].start.offset?(c=2,p=Bn(p,[["enter",e[o][1],t],["exit",e[o][1],t]])):c=0,_n(e,n-1,o-n+3,p),o=n+p.length-c-2;break}}for(o=-1;++o<e.length;)e[o][1].type==="attentionSequence"&&(e[o][1].type="data");return e}function Ik(e,t){let o=this.parser.constructs.attentionMarkers.null,n=this.previous,r=Ig(n),i;return a;function a(l){return i=l,e.enter("attentionSequence"),s(l)}function s(l){if(l===i)return e.consume(l),s;let p=e.exit("attentionSequence"),c=Ig(l),u=!c||c===2&&r||o.includes(l),m=!r||r===2&&c||o.includes(n);return p._open=!!(i===42?u:u&&(r||!m)),p._close=!!(i===42?m:m&&(c||!u)),t(l)}}function N3(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}var Sg={name:"autolink",tokenize:Sk};function Sk(e,t,o){let n=0;return r;function r(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(d){return ar(d)?(e.consume(d),a):d===64?o(d):p(d)}function a(d){return d===43||d===45||d===46||Dn(d)?(n=1,s(d)):p(d)}function s(d){return d===58?(e.consume(d),n=0,l):(d===43||d===45||d===46||Dn(d))&&n++<32?(e.consume(d),s):(n=0,p(d))}function l(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||Mc(d)?o(d):(e.consume(d),l)}function p(d){return d===64?(e.consume(d),c):P3(d)?(e.consume(d),p):o(d)}function c(d){return Dn(d)?u(d):o(d)}function u(d){return d===46?(e.consume(d),n=0,c):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):m(d)}function m(d){if((d===45||Dn(d))&&n++<63){let f=d===45?m:u;return e.consume(d),f}return o(d)}}var Wa={tokenize:vk,partial:!0};function vk(e,t,o){return n;function n(i){return Te(i)?Me(e,r,"linePrefix")(i):r(i)}function r(i){return i===null||me(i)?t(i):o(i)}}var Zd={name:"blockQuote",tokenize:Tk,continuation:{tokenize:wk},exit:Mk};function Tk(e,t,o){let n=this;return r;function r(a){if(a===62){let s=n.containerState;return s.open||(e.enter("blockQuote",{_container:!0}),s.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),i}return o(a)}function i(a){return Te(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function wk(e,t,o){let n=this;return r;function r(a){return Te(a)?Me(e,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):i(a)}function i(a){return e.attempt(Zd,t,o)(a)}}function Mk(e){e.exit("blockQuote")}var Qd={name:"characterEscape",tokenize:Ek};function Ek(e,t,o){return n;function n(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),r}function r(i){return L3(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):o(i)}}var Jd={name:"characterReference",tokenize:Ak};function Ak(e,t,o){let n=this,r=0,i,a;return s;function s(u){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),l}function l(u){return u===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(u),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),i=31,a=Dn,c(u))}function p(u){return u===88||u===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(u),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,a=k3,c):(e.enter("characterReferenceValue"),i=7,a=Ec,c(u))}function c(u){if(u===59&&r){let m=e.exit("characterReferenceValue");return a===Dn&&!fl(n.sliceSerialize(m))?o(u):(e.enter("characterReferenceMarker"),e.consume(u),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(u)&&r++<i?(e.consume(u),c):o(u)}}var z3={tokenize:kk,partial:!0},ef={name:"codeFenced",tokenize:Pk,concrete:!0};function Pk(e,t,o){let n=this,r={tokenize:v,partial:!0},i=0,a=0,s;return l;function l(S){return p(S)}function p(S){let M=n.events[n.events.length-1];return i=M&&M[1].type==="linePrefix"?M[2].sliceSerialize(M[1],!0).length:0,s=S,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),c(S)}function c(S){return S===s?(a++,e.consume(S),c):a<3?o(S):(e.exit("codeFencedFenceSequence"),Te(S)?Me(e,u,"whitespace")(S):u(S))}function u(S){return S===null||me(S)?(e.exit("codeFencedFence"),n.interrupt?t(S):e.check(z3,h,b)(S)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(S))}function m(S){return S===null||me(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),u(S)):Te(S)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Me(e,d,"whitespace")(S)):S===96&&S===s?o(S):(e.consume(S),m)}function d(S){return S===null||me(S)?u(S):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),f(S))}function f(S){return S===null||me(S)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),u(S)):S===96&&S===s?o(S):(e.consume(S),f)}function h(S){return e.attempt(r,b,_)(S)}function _(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),x}function x(S){return i>0&&Te(S)?Me(e,C,"linePrefix",i+1)(S):C(S)}function C(S){return S===null||me(S)?e.check(z3,h,b)(S):(e.enter("codeFlowValue"),y(S))}function y(S){return S===null||me(S)?(e.exit("codeFlowValue"),C(S)):(e.consume(S),y)}function b(S){return e.exit("codeFenced"),t(S)}function v(S,M,P){let O=0;return L;function L(F){return S.enter("lineEnding"),S.consume(F),S.exit("lineEnding"),H}function H(F){return S.enter("codeFencedFence"),Te(F)?Me(S,z,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(F):z(F)}function z(F){return F===s?(S.enter("codeFencedFenceSequence"),R(F)):P(F)}function R(F){return F===s?(O++,S.consume(F),R):O>=a?(S.exit("codeFencedFenceSequence"),Te(F)?Me(S,V,"whitespace")(F):V(F)):P(F)}function V(F){return F===null||me(F)?(S.exit("codeFencedFence"),M(F)):P(F)}}}function kk(e,t,o){let n=this;return r;function r(a){return a===null?o(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i)}function i(a){return n.parser.lazy[n.now().line]?o(a):t(a)}}var Pc={name:"codeIndented",tokenize:Ok},Lk={tokenize:Bk,partial:!0};function Ok(e,t,o){let n=this;return r;function r(p){return e.enter("codeIndented"),Me(e,i,"linePrefix",5)(p)}function i(p){let c=n.events[n.events.length-1];return c&&c[1].type==="linePrefix"&&c[2].sliceSerialize(c[1],!0).length>=4?a(p):o(p)}function a(p){return p===null?l(p):me(p)?e.attempt(Lk,a,l)(p):(e.enter("codeFlowValue"),s(p))}function s(p){return p===null||me(p)?(e.exit("codeFlowValue"),a(p)):(e.consume(p),s)}function l(p){return e.exit("codeIndented"),t(p)}}function Bk(e,t,o){let n=this;return r;function r(a){return n.parser.lazy[n.now().line]?o(a):me(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),r):Me(e,i,"linePrefix",5)(a)}function i(a){let s=n.events[n.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):me(a)?r(a):o(a)}}var vg={name:"codeText",tokenize:Hk,resolve:Dk,previous:Fk};function Dk(e){let t=e.length-4,o=3,n,r;if((e[o][1].type==="lineEnding"||e[o][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(n=o;++n<t;)if(e[n][1].type==="codeTextData"){e[o][1].type="codeTextPadding",e[t][1].type="codeTextPadding",o+=2,t-=2;break}}for(n=o-1,t++;++n<=t;)r===void 0?n!==t&&e[n][1].type!=="lineEnding"&&(r=n):(n===t||e[n][1].type==="lineEnding")&&(e[r][1].type="codeTextData",n!==r+2&&(e[r][1].end=e[n-1][1].end,e.splice(r+2,n-r-2),t-=n-r-2,n=r+2),r=void 0);return e}function Fk(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Hk(e,t,o){let n=this,r=0,i,a;return s;function s(m){return e.enter("codeText"),e.enter("codeTextSequence"),l(m)}function l(m){return m===96?(e.consume(m),r++,l):(e.exit("codeTextSequence"),p(m))}function p(m){return m===null?o(m):m===32?(e.enter("space"),e.consume(m),e.exit("space"),p):m===96?(a=e.enter("codeTextSequence"),i=0,u(m)):me(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),p):(e.enter("codeTextData"),c(m))}function c(m){return m===null||m===32||m===96||me(m)?(e.exit("codeTextData"),p(m)):(e.consume(m),c)}function u(m){return m===96?(e.consume(m),i++,u):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(m)):(a.type="codeTextData",c(m))}}var tf=class{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,o){let n=o??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(t,n):t>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(t,o,n){let r=o||0;this.setCursor(Math.trunc(t));let i=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return n&&kc(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),kc(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),kc(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){let o=this.left.splice(t,Number.POSITIVE_INFINITY);kc(this.right,o.reverse())}else{let o=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);kc(this.left,o.reverse())}}};function kc(e,t){let o=0;if(t.length<1e4)e.push(...t);else for(;o<t.length;)e.push(...t.slice(o,o+1e4)),o+=1e4}function of(e){let t={},o=-1,n,r,i,a,s,l,p,c=new tf(e);for(;++o<c.length;){for(;o in t;)o=t[o];if(n=c.get(o),o&&n[1].type==="chunkFlow"&&c.get(o-1)[1].type==="listItemPrefix"&&(l=n[1]._tokenizer.events,i=0,i<l.length&&l[i][1].type==="lineEndingBlank"&&(i+=2),i<l.length&&l[i][1].type==="content"))for(;++i<l.length&&l[i][1].type!=="content";)l[i][1].type==="chunkText"&&(l[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(t,Nk(c,o)),o=t[o],p=!0);else if(n[1]._container){for(i=o,r=void 0;i--&&(a=c.get(i),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank");)a[0]==="enter"&&(r&&(c.get(r)[1].type="lineEndingBlank"),a[1].type="lineEnding",r=i);r&&(n[1].end=Object.assign({},c.get(r)[1].start),s=c.slice(r,o),s.unshift(n),c.splice(r,o-r+1,s))}}return _n(e,0,Number.POSITIVE_INFINITY,c.slice(0)),!p}function Nk(e,t){let o=e.get(t)[1],n=e.get(t)[2],r=t-1,i=[],a=o._tokenizer||n.parser[o.contentType](o.start),s=a.events,l=[],p={},c,u,m=-1,d=o,f=0,h=0,_=[h];for(;d;){for(;e.get(++r)[1]!==d;);i.push(r),d._tokenizer||(c=n.sliceStream(d),d.next||c.push(null),u&&a.defineSkip(d.start),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(c),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),u=d,d=d.next}for(d=o;++m<s.length;)s[m][0]==="exit"&&s[m-1][0]==="enter"&&s[m][1].type===s[m-1][1].type&&s[m][1].start.line!==s[m][1].end.line&&(h=m+1,_.push(h),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(a.events=[],d?(d._tokenizer=void 0,d.previous=void 0):_.pop(),m=_.length;m--;){let x=s.slice(_[m],_[m+1]),C=i.pop();l.push([C,C+x.length-1]),e.splice(C,2,x)}for(l.reverse(),m=-1;++m<l.length;)p[f+l[m][0]]=f+l[m][1],f+=l[m][1]-l[m][0]-1;return p}var Tg={tokenize:Vk,resolve:Rk},zk={tokenize:Uk,partial:!0};function Rk(e){return of(e),e}function Vk(e,t){let o;return n;function n(s){return e.enter("content"),o=e.enter("chunkContent",{contentType:"content"}),r(s)}function r(s){return s===null?i(s):me(s)?e.check(zk,a,i)(s):(e.consume(s),r)}function i(s){return e.exit("chunkContent"),e.exit("content"),t(s)}function a(s){return e.consume(s),e.exit("chunkContent"),o.next=e.enter("chunkContent",{contentType:"content",previous:o}),o=o.next,r}}function Uk(e,t,o){let n=this;return r;function r(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),Me(e,i,"linePrefix")}function i(a){if(a===null||me(a))return o(a);let s=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?t(a):e.interrupt(n.parser.constructs.flow,o,t)(a)}}function nf(e,t,o,n,r,i,a,s,l){let p=l||Number.POSITIVE_INFINITY,c=0;return u;function u(x){return x===60?(e.enter(n),e.enter(r),e.enter(i),e.consume(x),e.exit(i),m):x===null||x===32||x===41||Mc(x)?o(x):(e.enter(n),e.enter(a),e.enter(s),e.enter("chunkString",{contentType:"string"}),h(x))}function m(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(r),e.exit(n),t):(e.enter(s),e.enter("chunkString",{contentType:"string"}),d(x))}function d(x){return x===62?(e.exit("chunkString"),e.exit(s),m(x)):x===null||x===60||me(x)?o(x):(e.consume(x),x===92?f:d)}function f(x){return x===60||x===62||x===92?(e.consume(x),d):d(x)}function h(x){return!c&&(x===null||x===41||xo(x))?(e.exit("chunkString"),e.exit(s),e.exit(a),e.exit(n),t(x)):c<p&&x===40?(e.consume(x),c++,h):x===41?(e.consume(x),c--,h):x===null||x===32||x===40||Mc(x)?o(x):(e.consume(x),x===92?_:h)}function _(x){return x===40||x===41||x===92?(e.consume(x),h):h(x)}}function rf(e,t,o,n,r,i){let a=this,s=0,l;return p;function p(d){return e.enter(n),e.enter(r),e.consume(d),e.exit(r),e.enter(i),c}function c(d){return s>999||d===null||d===91||d===93&&!l||d===94&&!s&&"_hiddenFootnoteSupport"in a.parser.constructs?o(d):d===93?(e.exit(i),e.enter(r),e.consume(d),e.exit(r),e.exit(n),t):me(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(d))}function u(d){return d===null||d===91||d===93||me(d)||s++>999?(e.exit("chunkString"),c(d)):(e.consume(d),l||(l=!Te(d)),d===92?m:u)}function m(d){return d===91||d===92||d===93?(e.consume(d),s++,u):u(d)}}function af(e,t,o,n,r,i){let a;return s;function s(m){return m===34||m===39||m===40?(e.enter(n),e.enter(r),e.consume(m),e.exit(r),a=m===40?41:m,l):o(m)}function l(m){return m===a?(e.enter(r),e.consume(m),e.exit(r),e.exit(n),t):(e.enter(i),p(m))}function p(m){return m===a?(e.exit(i),l(a)):m===null?o(m):me(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),Me(e,p,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(m))}function c(m){return m===a||m===null||me(m)?(e.exit("chunkString"),p(m)):(e.consume(m),m===92?u:c)}function u(m){return m===a||m===92?(e.consume(m),c):c(m)}}function Ss(e,t){let o;return n;function n(r){return me(r)?(e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),o=!0,n):Te(r)?Me(e,n,o?"linePrefix":"lineSuffix")(r):t(r)}}var wg={name:"definition",tokenize:Gk},Wk={tokenize:jk,partial:!0};function Gk(e,t,o){let n=this,r;return i;function i(d){return e.enter("definition"),a(d)}function a(d){return rf.call(n,e,s,o,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function s(d){return r=Zi(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),l):o(d)}function l(d){return xo(d)?Ss(e,p)(d):p(d)}function p(d){return nf(e,c,o,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function c(d){return e.attempt(Wk,u,u)(d)}function u(d){return Te(d)?Me(e,m,"whitespace")(d):m(d)}function m(d){return d===null||me(d)?(e.exit("definition"),n.parser.defined.push(r),t(d)):o(d)}}function jk(e,t,o){return n;function n(s){return xo(s)?Ss(e,r)(s):o(s)}function r(s){return af(e,i,o,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function i(s){return Te(s)?Me(e,a,"whitespace")(s):a(s)}function a(s){return s===null||me(s)?t(s):o(s)}}var Mg={name:"hardBreakEscape",tokenize:qk};function qk(e,t,o){return n;function n(i){return e.enter("hardBreakEscape"),e.consume(i),r}function r(i){return me(i)?(e.exit("hardBreakEscape"),t(i)):o(i)}}var Eg={name:"headingAtx",tokenize:$k,resolve:Kk};function Kk(e,t){let o=e.length-2,n=3,r,i;return e[n][1].type==="whitespace"&&(n+=2),o-2>n&&e[o][1].type==="whitespace"&&(o-=2),e[o][1].type==="atxHeadingSequence"&&(n===o-1||o-4>n&&e[o-2][1].type==="whitespace")&&(o-=n+1===o?2:4),o>n&&(r={type:"atxHeadingText",start:e[n][1].start,end:e[o][1].end},i={type:"chunkText",start:e[n][1].start,end:e[o][1].end,contentType:"text"},_n(e,n,o-n+1,[["enter",r,t],["enter",i,t],["exit",i,t],["exit",r,t]])),e}function $k(e,t,o){let n=0;return r;function r(c){return e.enter("atxHeading"),i(c)}function i(c){return e.enter("atxHeadingSequence"),a(c)}function a(c){return c===35&&n++<6?(e.consume(c),a):c===null||xo(c)?(e.exit("atxHeadingSequence"),s(c)):o(c)}function s(c){return c===35?(e.enter("atxHeadingSequence"),l(c)):c===null||me(c)?(e.exit("atxHeading"),t(c)):Te(c)?Me(e,s,"whitespace")(c):(e.enter("atxHeadingText"),p(c))}function l(c){return c===35?(e.consume(c),l):(e.exit("atxHeadingSequence"),s(c))}function p(c){return c===null||c===35||xo(c)?(e.exit("atxHeadingText"),s(c)):(e.consume(c),p)}}var R3=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Ag=["pre","script","style","textarea"];var Pg={name:"htmlFlow",tokenize:Qk,resolveTo:Zk,concrete:!0},Xk={tokenize:eL,partial:!0},Yk={tokenize:Jk,partial:!0};function Zk(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function Qk(e,t,o){let n=this,r,i,a,s,l;return p;function p(A){return c(A)}function c(A){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(A),u}function u(A){return A===33?(e.consume(A),m):A===47?(e.consume(A),i=!0,h):A===63?(e.consume(A),r=3,n.interrupt?t:w):ar(A)?(e.consume(A),a=String.fromCharCode(A),_):o(A)}function m(A){return A===45?(e.consume(A),r=2,d):A===91?(e.consume(A),r=5,s=0,f):ar(A)?(e.consume(A),r=4,n.interrupt?t:w):o(A)}function d(A){return A===45?(e.consume(A),n.interrupt?t:w):o(A)}function f(A){let U="CDATA[";return A===U.charCodeAt(s++)?(e.consume(A),s===U.length?n.interrupt?t:z:f):o(A)}function h(A){return ar(A)?(e.consume(A),a=String.fromCharCode(A),_):o(A)}function _(A){if(A===null||A===47||A===62||xo(A)){let U=A===47,N=a.toLowerCase();return!U&&!i&&Ag.includes(N)?(r=1,n.interrupt?t(A):z(A)):R3.includes(a.toLowerCase())?(r=6,U?(e.consume(A),x):n.interrupt?t(A):z(A)):(r=7,n.interrupt&&!n.parser.lazy[n.now().line]?o(A):i?C(A):y(A))}return A===45||Dn(A)?(e.consume(A),a+=String.fromCharCode(A),_):o(A)}function x(A){return A===62?(e.consume(A),n.interrupt?t:z):o(A)}function C(A){return Te(A)?(e.consume(A),C):L(A)}function y(A){return A===47?(e.consume(A),L):A===58||A===95||ar(A)?(e.consume(A),b):Te(A)?(e.consume(A),y):L(A)}function b(A){return A===45||A===46||A===58||A===95||Dn(A)?(e.consume(A),b):v(A)}function v(A){return A===61?(e.consume(A),S):Te(A)?(e.consume(A),v):y(A)}function S(A){return A===null||A===60||A===61||A===62||A===96?o(A):A===34||A===39?(e.consume(A),l=A,M):Te(A)?(e.consume(A),S):P(A)}function M(A){return A===l?(e.consume(A),l=null,O):A===null||me(A)?o(A):(e.consume(A),M)}function P(A){return A===null||A===34||A===39||A===47||A===60||A===61||A===62||A===96||xo(A)?v(A):(e.consume(A),P)}function O(A){return A===47||A===62||Te(A)?y(A):o(A)}function L(A){return A===62?(e.consume(A),H):o(A)}function H(A){return A===null||me(A)?z(A):Te(A)?(e.consume(A),H):o(A)}function z(A){return A===45&&r===2?(e.consume(A),q):A===60&&r===1?(e.consume(A),X):A===62&&r===4?(e.consume(A),ne):A===63&&r===3?(e.consume(A),w):A===93&&r===5?(e.consume(A),j):me(A)&&(r===6||r===7)?(e.exit("htmlFlowData"),e.check(Xk,pe,R)(A)):A===null||me(A)?(e.exit("htmlFlowData"),R(A)):(e.consume(A),z)}function R(A){return e.check(Yk,V,pe)(A)}function V(A){return e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),F}function F(A){return A===null||me(A)?R(A):(e.enter("htmlFlowData"),z(A))}function q(A){return A===45?(e.consume(A),w):z(A)}function X(A){return A===47?(e.consume(A),a="",W):z(A)}function W(A){if(A===62){let U=a.toLowerCase();return Ag.includes(U)?(e.consume(A),ne):z(A)}return ar(A)&&a.length<8?(e.consume(A),a+=String.fromCharCode(A),W):z(A)}function j(A){return A===93?(e.consume(A),w):z(A)}function w(A){return A===62?(e.consume(A),ne):A===45&&r===2?(e.consume(A),w):z(A)}function ne(A){return A===null||me(A)?(e.exit("htmlFlowData"),pe(A)):(e.consume(A),ne)}function pe(A){return e.exit("htmlFlow"),t(A)}}function Jk(e,t,o){let n=this;return r;function r(a){return me(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):o(a)}function i(a){return n.parser.lazy[n.now().line]?o(a):t(a)}}function eL(e,t,o){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(Wa,t,o)}}var kg={name:"htmlText",tokenize:tL};function tL(e,t,o){let n=this,r,i,a;return s;function s(w){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(w),l}function l(w){return w===33?(e.consume(w),p):w===47?(e.consume(w),v):w===63?(e.consume(w),y):ar(w)?(e.consume(w),P):o(w)}function p(w){return w===45?(e.consume(w),c):w===91?(e.consume(w),i=0,f):ar(w)?(e.consume(w),C):o(w)}function c(w){return w===45?(e.consume(w),d):o(w)}function u(w){return w===null?o(w):w===45?(e.consume(w),m):me(w)?(a=u,X(w)):(e.consume(w),u)}function m(w){return w===45?(e.consume(w),d):u(w)}function d(w){return w===62?q(w):w===45?m(w):u(w)}function f(w){let ne="CDATA[";return w===ne.charCodeAt(i++)?(e.consume(w),i===ne.length?h:f):o(w)}function h(w){return w===null?o(w):w===93?(e.consume(w),_):me(w)?(a=h,X(w)):(e.consume(w),h)}function _(w){return w===93?(e.consume(w),x):h(w)}function x(w){return w===62?q(w):w===93?(e.consume(w),x):h(w)}function C(w){return w===null||w===62?q(w):me(w)?(a=C,X(w)):(e.consume(w),C)}function y(w){return w===null?o(w):w===63?(e.consume(w),b):me(w)?(a=y,X(w)):(e.consume(w),y)}function b(w){return w===62?q(w):y(w)}function v(w){return ar(w)?(e.consume(w),S):o(w)}function S(w){return w===45||Dn(w)?(e.consume(w),S):M(w)}function M(w){return me(w)?(a=M,X(w)):Te(w)?(e.consume(w),M):q(w)}function P(w){return w===45||Dn(w)?(e.consume(w),P):w===47||w===62||xo(w)?O(w):o(w)}function O(w){return w===47?(e.consume(w),q):w===58||w===95||ar(w)?(e.consume(w),L):me(w)?(a=O,X(w)):Te(w)?(e.consume(w),O):q(w)}function L(w){return w===45||w===46||w===58||w===95||Dn(w)?(e.consume(w),L):H(w)}function H(w){return w===61?(e.consume(w),z):me(w)?(a=H,X(w)):Te(w)?(e.consume(w),H):O(w)}function z(w){return w===null||w===60||w===61||w===62||w===96?o(w):w===34||w===39?(e.consume(w),r=w,R):me(w)?(a=z,X(w)):Te(w)?(e.consume(w),z):(e.consume(w),V)}function R(w){return w===r?(e.consume(w),r=void 0,F):w===null?o(w):me(w)?(a=R,X(w)):(e.consume(w),R)}function V(w){return w===null||w===34||w===39||w===60||w===61||w===96?o(w):w===47||w===62||xo(w)?O(w):(e.consume(w),V)}function F(w){return w===47||w===62||xo(w)?O(w):o(w)}function q(w){return w===62?(e.consume(w),e.exit("htmlTextData"),e.exit("htmlText"),t):o(w)}function X(w){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(w),e.exit("lineEnding"),W}function W(w){return Te(w)?Me(e,j,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(w):j(w)}function j(w){return e.enter("htmlTextData"),a(w)}}var vs={name:"labelEnd",tokenize:sL,resolveTo:aL,resolveAll:iL},oL={tokenize:lL},nL={tokenize:pL},rL={tokenize:cL};function iL(e){let t=-1;for(;++t<e.length;){let o=e[t][1];(o.type==="labelImage"||o.type==="labelLink"||o.type==="labelEnd")&&(e.splice(t+1,o.type==="labelImage"?4:2),o.type="data",t++)}return e}function aL(e,t){let o=e.length,n=0,r,i,a,s;for(;o--;)if(r=e[o][1],i){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;e[o][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(a){if(e[o][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(i=o,r.type!=="labelLink")){n=2;break}}else r.type==="labelEnd"&&(a=o);let l={type:e[i][1].type==="labelLink"?"link":"image",start:Object.assign({},e[i][1].start),end:Object.assign({},e[e.length-1][1].end)},p={type:"label",start:Object.assign({},e[i][1].start),end:Object.assign({},e[a][1].end)},c={type:"labelText",start:Object.assign({},e[i+n+2][1].end),end:Object.assign({},e[a-2][1].start)};return s=[["enter",l,t],["enter",p,t]],s=Bn(s,e.slice(i+1,i+n+3)),s=Bn(s,[["enter",c,t]]),s=Bn(s,ip(t.parser.constructs.insideSpan.null,e.slice(i+n+4,a-3),t)),s=Bn(s,[["exit",c,t],e[a-2],e[a-1],["exit",p,t]]),s=Bn(s,e.slice(a+1)),s=Bn(s,[["exit",l,t]]),_n(e,i,e.length,s),e}function sL(e,t,o){let n=this,r=n.events.length,i,a;for(;r--;)if((n.events[r][1].type==="labelImage"||n.events[r][1].type==="labelLink")&&!n.events[r][1]._balanced){i=n.events[r][1];break}return s;function s(m){return i?i._inactive?u(m):(a=n.parser.defined.includes(Zi(n.sliceSerialize({start:i.end,end:n.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),l):o(m)}function l(m){return m===40?e.attempt(oL,c,a?c:u)(m):m===91?e.attempt(nL,c,a?p:u)(m):a?c(m):u(m)}function p(m){return e.attempt(rL,c,u)(m)}function c(m){return t(m)}function u(m){return i._balanced=!0,o(m)}}function lL(e,t,o){return n;function n(u){return e.enter("resource"),e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),r}function r(u){return xo(u)?Ss(e,i)(u):i(u)}function i(u){return u===41?c(u):nf(e,a,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(u)}function a(u){return xo(u)?Ss(e,l)(u):c(u)}function s(u){return o(u)}function l(u){return u===34||u===39||u===40?af(e,p,o,"resourceTitle","resourceTitleMarker","resourceTitleString")(u):c(u)}function p(u){return xo(u)?Ss(e,c)(u):c(u)}function c(u){return u===41?(e.enter("resourceMarker"),e.consume(u),e.exit("resourceMarker"),e.exit("resource"),t):o(u)}}function pL(e,t,o){let n=this;return r;function r(s){return rf.call(n,e,i,a,"reference","referenceMarker","referenceString")(s)}function i(s){return n.parser.defined.includes(Zi(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?t(s):o(s)}function a(s){return o(s)}}function cL(e,t,o){return n;function n(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),r}function r(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):o(i)}}var Lg={name:"labelStartImage",tokenize:uL,resolveAll:vs.resolveAll};function uL(e,t,o){let n=this;return r;function r(s){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(s),e.exit("labelImageMarker"),i}function i(s){return s===91?(e.enter("labelMarker"),e.consume(s),e.exit("labelMarker"),e.exit("labelImage"),a):o(s)}function a(s){return s===94&&"_hiddenFootnoteSupport"in n.parser.constructs?o(s):t(s)}}var Og={name:"labelStartLink",tokenize:mL,resolveAll:vs.resolveAll};function mL(e,t,o){let n=this;return r;function r(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),i}function i(a){return a===94&&"_hiddenFootnoteSupport"in n.parser.constructs?o(a):t(a)}}var Lc={name:"lineEnding",tokenize:dL};function dL(e,t){return o;function o(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),Me(e,t,"linePrefix")}}var Ts={name:"thematicBreak",tokenize:fL};function fL(e,t,o){let n=0,r;return i;function i(p){return e.enter("thematicBreak"),a(p)}function a(p){return r=p,s(p)}function s(p){return p===r?(e.enter("thematicBreakSequence"),l(p)):n>=3&&(p===null||me(p))?(e.exit("thematicBreak"),t(p)):o(p)}function l(p){return p===r?(e.consume(p),n++,l):(e.exit("thematicBreakSequence"),Te(p)?Me(e,s,"whitespace")(p):s(p))}}var Cn={name:"list",tokenize:xL,continuation:{tokenize:_L},exit:yL},hL={tokenize:bL,partial:!0},gL={tokenize:CL,partial:!0};function xL(e,t,o){let n=this,r=n.events[n.events.length-1],i=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,a=0;return s;function s(d){let f=n.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(f==="listUnordered"?!n.containerState.marker||d===n.containerState.marker:Ec(d)){if(n.containerState.type||(n.containerState.type=f,e.enter(f,{_container:!0})),f==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(Ts,o,p)(d):p(d);if(!n.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),l(d)}return o(d)}function l(d){return Ec(d)&&++a<10?(e.consume(d),l):(!n.interrupt||a<2)&&(n.containerState.marker?d===n.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),p(d)):o(d)}function p(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||d,e.check(Wa,n.interrupt?o:c,e.attempt(hL,m,u))}function c(d){return n.containerState.initialBlankLine=!0,i++,m(d)}function u(d){return Te(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),m):o(d)}function m(d){return n.containerState.size=i+n.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function _L(e,t,o){let n=this;return n.containerState._closeFlow=void 0,e.check(Wa,r,i);function r(s){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Me(e,t,"listItemIndent",n.containerState.size+1)(s)}function i(s){return n.containerState.furtherBlankLines||!Te(s)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,a(s)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,e.attempt(gL,t,a)(s))}function a(s){return n.containerState._closeFlow=!0,n.interrupt=void 0,Me(e,e.attempt(Cn,t,o),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function CL(e,t,o){let n=this;return Me(e,r,"listItemIndent",n.containerState.size+1);function r(i){let a=n.events[n.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===n.containerState.size?t(i):o(i)}}function yL(e){e.exit(this.containerState.type)}function bL(e,t,o){let n=this;return Me(e,r,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(i){let a=n.events[n.events.length-1];return!Te(i)&&a&&a[1].type==="listItemPrefixWhitespace"?t(i):o(i)}}var sf={name:"setextUnderline",tokenize:SL,resolveTo:IL};function IL(e,t){let o=e.length,n,r,i;for(;o--;)if(e[o][0]==="enter"){if(e[o][1].type==="content"){n=o;break}e[o][1].type==="paragraph"&&(r=o)}else e[o][1].type==="content"&&e.splice(o,1),!i&&e[o][1].type==="definition"&&(i=o);let a={type:"setextHeading",start:Object.assign({},e[r][1].start),end:Object.assign({},e[e.length-1][1].end)};return e[r][1].type="setextHeadingText",i?(e.splice(r,0,["enter",a,t]),e.splice(i+1,0,["exit",e[n][1],t]),e[n][1].end=Object.assign({},e[i][1].end)):e[n][1]=a,e.push(["exit",a,t]),e}function SL(e,t,o){let n=this,r;return i;function i(p){let c=n.events.length,u;for(;c--;)if(n.events[c][1].type!=="lineEnding"&&n.events[c][1].type!=="linePrefix"&&n.events[c][1].type!=="content"){u=n.events[c][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||u)?(e.enter("setextHeadingLine"),r=p,a(p)):o(p)}function a(p){return e.enter("setextHeadingLineSequence"),s(p)}function s(p){return p===r?(e.consume(p),s):(e.exit("setextHeadingLineSequence"),Te(p)?Me(e,l,"lineSuffix")(p):l(p))}function l(p){return p===null||me(p)?(e.exit("setextHeadingLine"),t(p)):o(p)}}var V3={tokenize:vL};function vL(e){let t=this,o=e.attempt(Wa,n,e.attempt(this.parser.constructs.flowInitial,r,Me(e,e.attempt(this.parser.constructs.flow,r,e.attempt(Tg,r)),"linePrefix")));return o;function n(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,o}function r(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,o}}var U3={resolveAll:q3()},W3=j3("string"),G3=j3("text");function j3(e){return{tokenize:t,resolveAll:q3(e==="text"?TL:void 0)};function t(o){let n=this,r=this.parser.constructs[e],i=o.attempt(r,a,s);return a;function a(c){return p(c)?i(c):s(c)}function s(c){if(c===null){o.consume(c);return}return o.enter("data"),o.consume(c),l}function l(c){return p(c)?(o.exit("data"),i(c)):(o.consume(c),l)}function p(c){if(c===null)return!0;let u=r[c],m=-1;if(u)for(;++m<u.length;){let d=u[m];if(!d.previous||d.previous.call(n,n.previous))return!0}return!1}}}function q3(e){return t;function t(o,n){let r=-1,i;for(;++r<=o.length;)i===void 0?o[r]&&o[r][1].type==="data"&&(i=r,r++):(!o[r]||o[r][1].type!=="data")&&(r!==i+2&&(o[i][1].end=o[r-1][1].end,o.splice(i+2,r-i-2),r=i+2),i=void 0);return e?e(o,n):o}}function TL(e,t){let o=0;for(;++o<=e.length;)if((o===e.length||e[o][1].type==="lineEnding")&&e[o-1][1].type==="data"){let n=e[o-1][1],r=t.sliceStream(n),i=r.length,a=-1,s=0,l;for(;i--;){let p=r[i];if(typeof p=="string"){for(a=p.length;p.charCodeAt(a-1)===32;)s++,a--;if(a)break;a=-1}else if(p===-2)l=!0,s++;else if(p!==-1){i++;break}}if(s){let p={type:o===e.length||l||s<2?"lineSuffix":"hardBreakTrailing",start:{line:n.end.line,column:n.end.column-s,offset:n.end.offset-s,_index:n.start._index+i,_bufferIndex:i?a:n.start._bufferIndex+a},end:Object.assign({},n.end)};n.end=Object.assign({},p.start),n.start.offset===n.end.offset?Object.assign(n,p):(e.splice(o,0,["enter",p,t],["exit",p,t]),o+=2)}o++}return e}function K3(e,t,o){let n=Object.assign(o?Object.assign({},o):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1}),r={},i=[],a=[],s=[],l=!0,p={consume:b,enter:v,exit:S,attempt:O(M),check:O(P),interrupt:O(P,{interrupt:!0})},c={previous:null,code:null,containerState:{},events:[],parser:e,sliceStream:h,sliceSerialize:f,now:_,defineSkip:x,write:d},u=t.tokenize.call(c,p),m;return t.resolveAll&&i.push(t),c;function d(R){return a=Bn(a,R),C(),a[a.length-1]!==null?[]:(L(t,0),c.events=ip(i,c.events,c),c.events)}function f(R,V){return ML(h(R),V)}function h(R){return wL(a,R)}function _(){let{line:R,column:V,offset:F,_index:q,_bufferIndex:X}=n;return{line:R,column:V,offset:F,_index:q,_bufferIndex:X}}function x(R){r[R.line]=R.column,z()}function C(){let R;for(;n._index<a.length;){let V=a[n._index];if(typeof V=="string")for(R=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===R&&n._bufferIndex<V.length;)y(V.charCodeAt(n._bufferIndex));else y(V)}}function y(R){l=void 0,m=R,u=u(R)}function b(R){me(R)?(n.line++,n.column=1,n.offset+=R===-3?2:1,z()):R!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===a[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=R,l=!0}function v(R,V){let F=V||{};return F.type=R,F.start=_(),c.events.push(["enter",F,c]),s.push(F),F}function S(R){let V=s.pop();return V.end=_(),c.events.push(["exit",V,c]),V}function M(R,V){L(R,V.from)}function P(R,V){V.restore()}function O(R,V){return F;function F(q,X,W){let j,w,ne,pe;return Array.isArray(q)?U(q):"tokenize"in q?U([q]):A(q);function A(re){return bt;function bt(be){let Ce=be!==null&&re[be],we=be!==null&&re.null,qe=[...Array.isArray(Ce)?Ce:Ce?[Ce]:[],...Array.isArray(we)?we:we?[we]:[]];return U(qe)(be)}}function U(re){return j=re,w=0,re.length===0?W:N(re[w])}function N(re){return bt;function bt(be){return pe=H(),ne=re,re.partial||(c.currentConstruct=re),re.name&&c.parser.constructs.disable.null.includes(re.name)?Z(be):re.tokenize.call(V?Object.assign(Object.create(c),V):c,p,ce,Z)(be)}}function ce(re){return l=!0,R(ne,pe),X}function Z(re){return l=!0,pe.restore(),++w<j.length?N(j[w]):W}}}function L(R,V){R.resolveAll&&!i.includes(R)&&i.push(R),R.resolve&&_n(c.events,V,c.events.length-V,R.resolve(c.events.slice(V),c)),R.resolveTo&&(c.events=R.resolveTo(c.events,c))}function H(){let R=_(),V=c.previous,F=c.currentConstruct,q=c.events.length,X=Array.from(s);return{restore:W,from:q};function W(){n=R,c.previous=V,c.currentConstruct=F,c.events.length=q,s=X,z()}}function z(){n.line in r&&n.column<2&&(n.column=r[n.line],n.offset+=r[n.line]-1)}}function wL(e,t){let o=t.start._index,n=t.start._bufferIndex,r=t.end._index,i=t.end._bufferIndex,a;if(o===r)a=[e[o].slice(n,i)];else{if(a=e.slice(o,r),n>-1){let s=a[0];typeof s=="string"?a[0]=s.slice(n):a.shift()}i>0&&a.push(e[r].slice(0,i))}return a}function ML(e,t){let o=-1,n=[],r;for(;++o<e.length;){let i=e[o],a;if(typeof i=="string")a=i;else switch(i){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&r)continue;a=" ";break}default:a=String.fromCharCode(i)}r=i===-2,n.push(a)}return n.join("")}var Bg={};Lw(Bg,{attentionMarkers:()=>DL,contentInitial:()=>AL,disable:()=>FL,document:()=>EL,flow:()=>kL,flowInitial:()=>PL,insideSpan:()=>BL,string:()=>LL,text:()=>OL});var EL={42:Cn,43:Cn,45:Cn,48:Cn,49:Cn,50:Cn,51:Cn,52:Cn,53:Cn,54:Cn,55:Cn,56:Cn,57:Cn,62:Zd},AL={91:wg},PL={[-2]:Pc,[-1]:Pc,32:Pc},kL={35:Eg,42:Ts,45:[sf,Ts],60:Pg,61:sf,95:Ts,96:ef,126:ef},LL={38:Jd,92:Qd},OL={[-5]:Lc,[-4]:Lc,[-3]:Lc,33:Lg,38:Jd,42:Ac,60:[Sg,kg],91:Og,92:[Mg,Qd],93:vs,95:Ac,96:vg},BL={null:[Ac,U3]},DL={null:[42,95]},FL={null:[]};function Dg(e){let o=A3([Bg,...(e||{}).extensions||[]]),n={defined:[],lazy:{},constructs:o,content:r(D3),document:r(H3),flow:r(V3),string:r(W3),text:r(G3)};return n;function r(i){return a;function a(s){return K3(n,i,s)}}}function Fg(e){for(;!of(e););return e}var $3=/[\0\t\n\r]/g;function Hg(){let e=1,t="",o=!0,n;return r;function r(i,a,s){let l=[],p,c,u,m,d;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(a||void 0).decode(i)),u=0,t="",o&&(i.charCodeAt(0)===65279&&u++,o=void 0);u<i.length;){if($3.lastIndex=u,p=$3.exec(i),m=p&&p.index!==void 0?p.index:i.length,d=i.charCodeAt(m),!p){t=i.slice(u);break}if(d===10&&u===m&&n)l.push(-3),n=void 0;else switch(n&&(l.push(-5),n=void 0),u<m&&(l.push(i.slice(u,m)),e+=m-u),d){case 0:{l.push(65533),e++;break}case 9:{for(c=Math.ceil(e/4)*4,l.push(-2);e++<c;)l.push(-1);break}case 10:{l.push(-4),e=1;break}default:n=!0,e=1}u=m+1}return s&&(n&&l.push(-5),t&&l.push(t),l.push(null)),l}}var HL=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function lf(e){return e.replace(HL,NL)}function NL(e,t,o){if(t)return t;if(o.charCodeAt(0)===35){let r=o.charCodeAt(1),i=r===120||r===88;return Yd(o.slice(i?2:1),i?16:10)}return fl(o)||e}function Ga(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?X3(e.position):"start"in e||"end"in e?X3(e):"line"in e||"column"in e?Ng(e):""}function Ng(e){return Y3(e&&e.line)+":"+Y3(e&&e.column)}function X3(e){return Ng(e&&e.start)+"-"+Ng(e&&e.end)}function Y3(e){return e&&typeof e=="number"?e:1}var Q3={}.hasOwnProperty;function zg(e,t,o){return typeof t!="string"&&(o=t,t=void 0),zL(o)(Fg(Dg(o).document().write(Hg()(e,t,!0))))}function zL(e){let t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(kt),autolinkProtocol:O,autolinkEmail:O,atxHeading:i(Kt),blockQuote:i(be),characterEscape:O,characterReference:O,codeFenced:i(Ce),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(Ce,a),codeText:i(we,a),codeTextData:O,data:O,codeFlowValue:O,definition:i(qe),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i(Ze),hardBreakEscape:i(Fe),hardBreakTrailing:i(Fe),htmlFlow:i(pt,a),htmlFlowData:O,htmlText:i(pt,a),htmlTextData:O,image:i(ct),label:a,link:i(kt),listItem:i(Dt),listItemValue:m,listOrdered:i(Ke,u),listUnordered:i(Ke),paragraph:i(ut),reference:A,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(Kt),strong:i(Y),thematicBreak:i(J)},exit:{atxHeading:l(),atxHeadingSequence:v,autolink:l(),autolinkEmail:bt,autolinkProtocol:re,blockQuote:l(),characterEscapeValue:L,characterReferenceMarkerHexadecimal:N,characterReferenceMarkerNumeric:N,characterReferenceValue:ce,characterReference:Z,codeFenced:l(_),codeFencedFence:h,codeFencedFenceInfo:d,codeFencedFenceMeta:f,codeFlowValue:L,codeIndented:l(x),codeText:l(F),codeTextData:L,data:L,definition:l(),definitionDestinationString:b,definitionLabelString:C,definitionTitleString:y,emphasis:l(),hardBreakEscape:l(z),hardBreakTrailing:l(z),htmlFlow:l(R),htmlFlowData:L,htmlText:l(V),htmlTextData:L,image:l(X),label:j,labelText:W,lineEnding:H,link:l(q),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:U,resourceDestinationString:w,resourceTitleString:ne,resource:pe,setextHeading:l(P),setextHeadingLineSequence:M,setextHeadingText:S,strong:l(),thematicBreak:l()}};J3(t,(e||{}).mdastExtensions||[]);let o={};return n;function n(D){let K={type:"root",children:[]},Q={stack:[K],tokenStack:[],config:t,enter:s,exit:p,buffer:a,resume:c,data:o},ae=[],oe=-1;for(;++oe<D.length;)if(D[oe][1].type==="listOrdered"||D[oe][1].type==="listUnordered")if(D[oe][0]==="enter")ae.push(oe);else{let He=ae.pop();oe=r(D,He,oe)}for(oe=-1;++oe<D.length;){let He=t[D[oe][0]];Q3.call(He,D[oe][1].type)&&He[D[oe][1].type].call(Object.assign({sliceSerialize:D[oe][2].sliceSerialize},Q),D[oe][1])}if(Q.tokenStack.length>0){let He=Q.tokenStack[Q.tokenStack.length-1];(He[1]||Z3).call(Q,void 0,He[0])}for(K.position={start:ja(D.length>0?D[0][1].start:{line:1,column:1,offset:0}),end:ja(D.length>0?D[D.length-2][1].end:{line:1,column:1,offset:0})},oe=-1;++oe<t.transforms.length;)K=t.transforms[oe](K)||K;return K}function r(D,K,Q){let ae=K-1,oe=-1,He=!1,It,te,ze,gt;for(;++ae<=Q;){let xt=D[ae];switch(xt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{xt[0]==="enter"?oe++:oe--,gt=void 0;break}case"lineEndingBlank":{xt[0]==="enter"&&(It&&!gt&&!oe&&!ze&&(ze=ae),gt=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:gt=void 0}if(!oe&&xt[0]==="enter"&&xt[1].type==="listItemPrefix"||oe===-1&&xt[0]==="exit"&&(xt[1].type==="listUnordered"||xt[1].type==="listOrdered")){if(It){let Je=ae;for(te=void 0;Je--;){let Oo=D[Je];if(Oo[1].type==="lineEnding"||Oo[1].type==="lineEndingBlank"){if(Oo[0]==="exit")continue;te&&(D[te][1].type="lineEndingBlank",He=!0),Oo[1].type="lineEnding",te=Je}else if(!(Oo[1].type==="linePrefix"||Oo[1].type==="blockQuotePrefix"||Oo[1].type==="blockQuotePrefixWhitespace"||Oo[1].type==="blockQuoteMarker"||Oo[1].type==="listItemIndent"))break}ze&&(!te||ze<te)&&(It._spread=!0),It.end=Object.assign({},te?D[te][1].start:xt[1].end),D.splice(te||ae,0,["exit",It,xt[2]]),ae++,Q++}if(xt[1].type==="listItemPrefix"){let Je={type:"listItem",_spread:!1,start:Object.assign({},xt[1].start),end:void 0};It=Je,D.splice(ae,0,["enter",Je,xt[2]]),ae++,Q++,ze=void 0,gt=!0}}}return D[K][1]._spread=He,Q}function i(D,K){return Q;function Q(ae){s.call(this,D(ae),ae),K&&K.call(this,ae)}}function a(){this.stack.push({type:"fragment",children:[]})}function s(D,K,Q){this.stack[this.stack.length-1].children.push(D),this.stack.push(D),this.tokenStack.push([K,Q]),D.position={start:ja(K.start),end:void 0}}function l(D){return K;function K(Q){D&&D.call(this,Q),p.call(this,Q)}}function p(D,K){let Q=this.stack.pop(),ae=this.tokenStack.pop();if(ae)ae[0].type!==D.type&&(K?K.call(this,D,ae[0]):(ae[1]||Z3).call(this,D,ae[0]));else throw new Error("Cannot close `"+D.type+"` ("+Ga({start:D.start,end:D.end})+"): it\u2019s not open");Q.position.end=ja(D.end)}function c(){return Is(this.stack.pop())}function u(){this.data.expectingFirstListItemValue=!0}function m(D){if(this.data.expectingFirstListItemValue){let K=this.stack[this.stack.length-2];K.start=Number.parseInt(this.sliceSerialize(D),10),this.data.expectingFirstListItemValue=void 0}}function d(){let D=this.resume(),K=this.stack[this.stack.length-1];K.lang=D}function f(){let D=this.resume(),K=this.stack[this.stack.length-1];K.meta=D}function h(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function _(){let D=this.resume(),K=this.stack[this.stack.length-1];K.value=D.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){let D=this.resume(),K=this.stack[this.stack.length-1];K.value=D.replace(/(\r?\n|\r)$/g,"")}function C(D){let K=this.resume(),Q=this.stack[this.stack.length-1];Q.label=K,Q.identifier=Zi(this.sliceSerialize(D)).toLowerCase()}function y(){let D=this.resume(),K=this.stack[this.stack.length-1];K.title=D}function b(){let D=this.resume(),K=this.stack[this.stack.length-1];K.url=D}function v(D){let K=this.stack[this.stack.length-1];if(!K.depth){let Q=this.sliceSerialize(D).length;K.depth=Q}}function S(){this.data.setextHeadingSlurpLineEnding=!0}function M(D){let K=this.stack[this.stack.length-1];K.depth=this.sliceSerialize(D).codePointAt(0)===61?1:2}function P(){this.data.setextHeadingSlurpLineEnding=void 0}function O(D){let Q=this.stack[this.stack.length-1].children,ae=Q[Q.length-1];(!ae||ae.type!=="text")&&(ae=$(),ae.position={start:ja(D.start),end:void 0},Q.push(ae)),this.stack.push(ae)}function L(D){let K=this.stack.pop();K.value+=this.sliceSerialize(D),K.position.end=ja(D.end)}function H(D){let K=this.stack[this.stack.length-1];if(this.data.atHardBreak){let Q=K.children[K.children.length-1];Q.position.end=ja(D.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(K.type)&&(O.call(this,D),L.call(this,D))}function z(){this.data.atHardBreak=!0}function R(){let D=this.resume(),K=this.stack[this.stack.length-1];K.value=D}function V(){let D=this.resume(),K=this.stack[this.stack.length-1];K.value=D}function F(){let D=this.resume(),K=this.stack[this.stack.length-1];K.value=D}function q(){let D=this.stack[this.stack.length-1];if(this.data.inReference){let K=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=K,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function X(){let D=this.stack[this.stack.length-1];if(this.data.inReference){let K=this.data.referenceType||"shortcut";D.type+="Reference",D.referenceType=K,delete D.url,delete D.title}else delete D.identifier,delete D.label;this.data.referenceType=void 0}function W(D){let K=this.sliceSerialize(D),Q=this.stack[this.stack.length-2];Q.label=lf(K),Q.identifier=Zi(K).toLowerCase()}function j(){let D=this.stack[this.stack.length-1],K=this.resume(),Q=this.stack[this.stack.length-1];if(this.data.inReference=!0,Q.type==="link"){let ae=D.children;Q.children=ae}else Q.alt=K}function w(){let D=this.resume(),K=this.stack[this.stack.length-1];K.url=D}function ne(){let D=this.resume(),K=this.stack[this.stack.length-1];K.title=D}function pe(){this.data.inReference=void 0}function A(){this.data.referenceType="collapsed"}function U(D){let K=this.resume(),Q=this.stack[this.stack.length-1];Q.label=K,Q.identifier=Zi(this.sliceSerialize(D)).toLowerCase(),this.data.referenceType="full"}function N(D){this.data.characterReferenceType=D.type}function ce(D){let K=this.sliceSerialize(D),Q=this.data.characterReferenceType,ae;Q?(ae=Yd(K,Q==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ae=fl(K);let oe=this.stack[this.stack.length-1];oe.value+=ae}function Z(D){let K=this.stack.pop();K.position.end=ja(D.end)}function re(D){L.call(this,D);let K=this.stack[this.stack.length-1];K.url=this.sliceSerialize(D)}function bt(D){L.call(this,D);let K=this.stack[this.stack.length-1];K.url="mailto:"+this.sliceSerialize(D)}function be(){return{type:"blockquote",children:[]}}function Ce(){return{type:"code",lang:null,meta:null,value:""}}function we(){return{type:"inlineCode",value:""}}function qe(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function Ze(){return{type:"emphasis",children:[]}}function Kt(){return{type:"heading",depth:0,children:[]}}function Fe(){return{type:"break"}}function pt(){return{type:"html",value:""}}function ct(){return{type:"image",title:null,url:"",alt:null}}function kt(){return{type:"link",title:null,url:"",children:[]}}function Ke(D){return{type:"list",ordered:D.type==="listOrdered",start:null,spread:D._spread,children:[]}}function Dt(D){return{type:"listItem",spread:D._spread,checked:null,children:[]}}function ut(){return{type:"paragraph",children:[]}}function Y(){return{type:"strong",children:[]}}function $(){return{type:"text",value:""}}function J(){return{type:"thematicBreak"}}}function ja(e){return{line:e.line,column:e.column,offset:e.offset}}function J3(e,t){let o=-1;for(;++o<t.length;){let n=t[o];Array.isArray(n)?J3(e,n):RL(e,n)}}function RL(e,t){let o;for(o in t)if(Q3.call(t,o))switch(o){case"canContainEols":{let n=t[o];n&&e[o].push(...n);break}case"transforms":{let n=t[o];n&&e[o].push(...n);break}case"enter":case"exit":{let n=t[o];n&&Object.assign(e[o],n);break}}}function Z3(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Ga({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Ga({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Ga({start:t.start,end:t.end})+") is still open")}function pf(e){let t=this;t.parser=o;function o(n){return zg(n,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}var eS={}.hasOwnProperty;function tS(e,t){let o=t||{};function n(r,...i){let a=n.invalid,s=n.handlers;if(r&&eS.call(r,e)){let l=String(r[e]);a=eS.call(s,l)?s[l]:n.unknown}if(a)return a.call(this,r,...i)}return n.handlers=o.handlers||{},n.invalid=o.invalid,n.unknown=o.unknown,n}var VL={}.hasOwnProperty;function Rg(e,t){let o=-1,n;if(t.extensions)for(;++o<t.extensions.length;)Rg(e,t.extensions[o]);for(n in t)if(VL.call(t,n))switch(n){case"extensions":break;case"unsafe":{oS(e[n],t[n]);break}case"join":{oS(e[n],t[n]);break}case"handlers":{UL(e[n],t[n]);break}default:e.options[n]=t[n]}return e}function oS(e,t){t&&e.push(...t)}function UL(e,t){t&&Object.assign(e,t)}function nS(e,t,o,n){let r=o.enter("blockquote"),i=o.createTracker(n);i.move("> "),i.shift(2);let a=o.indentLines(o.containerFlow(e,i.current()),WL);return r(),a}function WL(e,t,o){return">"+(o?"":" ")+e}function cf(e,t){return rS(e,t.inConstruct,!0)&&!rS(e,t.notInConstruct,!1)}function rS(e,t,o){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return o;let n=-1;for(;++n<t.length;)if(e.includes(t[n]))return!0;return!1}function Vg(e,t,o,n){let r=-1;for(;++r<o.unsafe.length;)if(o.unsafe[r].character===`
`&&cf(o.stack,o.unsafe[r]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function Oc(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function iS(e){let t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function aS(e,t,o,n){let r=iS(o),i=e.value||"",a=r==="`"?"GraveAccent":"Tilde";if(Oc(e,o)){let u=o.enter("codeIndented"),m=o.indentLines(i,GL);return u(),m}let s=o.createTracker(n),l=r.repeat(Math.max(G_(i,r)+1,3)),p=o.enter("codeFenced"),c=s.move(l);if(e.lang){let u=o.enter(`codeFencedLang${a}`);c+=s.move(o.safe(e.lang,{before:c,after:" ",encode:["`"],...s.current()})),u()}if(e.lang&&e.meta){let u=o.enter(`codeFencedMeta${a}`);c+=s.move(" "),c+=s.move(o.safe(e.meta,{before:c,after:`
`,encode:["`"],...s.current()})),u()}return c+=s.move(`
`),i&&(c+=s.move(i+`
`)),c+=s.move(l),p(),c}function GL(e,t,o){return(o?"":"    ")+e}function ap(e){let t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function sS(e,t,o,n){let r=ap(o),i=r==='"'?"Quote":"Apostrophe",a=o.enter("definition"),s=o.enter("label"),l=o.createTracker(n),p=l.move("[");return p+=l.move(o.safe(o.associationId(e),{before:p,after:"]",...l.current()})),p+=l.move("]: "),s(),!e.url||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),p+=l.move("<"),p+=l.move(o.safe(e.url,{before:p,after:">",...l.current()})),p+=l.move(">")):(s=o.enter("destinationRaw"),p+=l.move(o.safe(e.url,{before:p,after:e.title?" ":`
`,...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),p+=l.move(" "+r),p+=l.move(o.safe(e.title,{before:p,after:r,...l.current()})),p+=l.move(r),s()),a(),p}function lS(e){let t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}Ug.peek=jL;function Ug(e,t,o,n){let r=lS(o),i=o.enter("emphasis"),a=o.createTracker(n),s=a.move(r);return s+=a.move(o.containerPhrasing(e,{before:s,after:r,...a.current()})),s+=a.move(r),i(),s}function jL(e,t,o){return o.options.emphasis||"*"}function uf(e,t){let o=!1;return K_(e,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return o=!0,q_}),!!((!e.depth||e.depth<3)&&Is(e)&&(t.options.setext||o))}function pS(e,t,o,n){let r=Math.max(Math.min(6,e.depth||1),1),i=o.createTracker(n);if(uf(e,o)){let c=o.enter("headingSetext"),u=o.enter("phrasing"),m=o.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return u(),c(),m+`
`+(r===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}let a="#".repeat(r),s=o.enter("headingAtx"),l=o.enter("phrasing");i.move(a+" ");let p=o.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(p)&&(p="&#x"+p.charCodeAt(0).toString(16).toUpperCase()+";"+p.slice(1)),p=p?a+" "+p:a,o.options.closeAtx&&(p+=" "+a),l(),s(),p}Wg.peek=qL;function Wg(e){return e.value||""}function qL(){return"<"}Gg.peek=KL;function Gg(e,t,o,n){let r=ap(o),i=r==='"'?"Quote":"Apostrophe",a=o.enter("image"),s=o.enter("label"),l=o.createTracker(n),p=l.move("![");return p+=l.move(o.safe(e.alt,{before:p,after:"]",...l.current()})),p+=l.move("]("),s(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(s=o.enter("destinationLiteral"),p+=l.move("<"),p+=l.move(o.safe(e.url,{before:p,after:">",...l.current()})),p+=l.move(">")):(s=o.enter("destinationRaw"),p+=l.move(o.safe(e.url,{before:p,after:e.title?" ":")",...l.current()}))),s(),e.title&&(s=o.enter(`title${i}`),p+=l.move(" "+r),p+=l.move(o.safe(e.title,{before:p,after:r,...l.current()})),p+=l.move(r),s()),p+=l.move(")"),a(),p}function KL(){return"!"}jg.peek=$L;function jg(e,t,o,n){let r=e.referenceType,i=o.enter("imageReference"),a=o.enter("label"),s=o.createTracker(n),l=s.move("!["),p=o.safe(e.alt,{before:l,after:"]",...s.current()});l+=s.move(p+"]["),a();let c=o.stack;o.stack=[],a=o.enter("reference");let u=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=c,i(),r==="full"||!p||p!==u?l+=s.move(u+"]"):r==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function $L(){return"!"}qg.peek=XL;function qg(e,t,o){let n=e.value||"",r="`",i=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(n);)r+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<o.unsafe.length;){let a=o.unsafe[i],s=o.compilePattern(a),l;if(a.atBreak)for(;l=s.exec(n);){let p=l.index;n.charCodeAt(p)===10&&n.charCodeAt(p-1)===13&&p--,n=n.slice(0,p)+" "+n.slice(l.index+1)}}return r+n+r}function XL(){return"`"}function Kg(e,t){let o=Is(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(o===e.url||"mailto:"+o===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}$g.peek=YL;function $g(e,t,o,n){let r=ap(o),i=r==='"'?"Quote":"Apostrophe",a=o.createTracker(n),s,l;if(Kg(e,o)){let c=o.stack;o.stack=[],s=o.enter("autolink");let u=a.move("<");return u+=a.move(o.containerPhrasing(e,{before:u,after:">",...a.current()})),u+=a.move(">"),s(),o.stack=c,u}s=o.enter("link"),l=o.enter("label");let p=a.move("[");return p+=a.move(o.containerPhrasing(e,{before:p,after:"](",...a.current()})),p+=a.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=o.enter("destinationLiteral"),p+=a.move("<"),p+=a.move(o.safe(e.url,{before:p,after:">",...a.current()})),p+=a.move(">")):(l=o.enter("destinationRaw"),p+=a.move(o.safe(e.url,{before:p,after:e.title?" ":")",...a.current()}))),l(),e.title&&(l=o.enter(`title${i}`),p+=a.move(" "+r),p+=a.move(o.safe(e.title,{before:p,after:r,...a.current()})),p+=a.move(r),l()),p+=a.move(")"),s(),p}function YL(e,t,o){return Kg(e,o)?"<":"["}Xg.peek=ZL;function Xg(e,t,o,n){let r=e.referenceType,i=o.enter("linkReference"),a=o.enter("label"),s=o.createTracker(n),l=s.move("["),p=o.containerPhrasing(e,{before:l,after:"]",...s.current()});l+=s.move(p+"]["),a();let c=o.stack;o.stack=[],a=o.enter("reference");let u=o.safe(o.associationId(e),{before:l,after:"]",...s.current()});return a(),o.stack=c,i(),r==="full"||!p||p!==u?l+=s.move(u+"]"):r==="shortcut"?l=l.slice(0,-1):l+=s.move("]"),l}function ZL(){return"["}function sp(e){let t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function cS(e){let t=sp(e),o=e.options.bulletOther;if(!o)return t==="*"?"-":"*";if(o!=="*"&&o!=="+"&&o!=="-")throw new Error("Cannot serialize items with `"+o+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(o===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+o+"`) to be different");return o}function uS(e){let t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function mf(e){let t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function mS(e,t,o,n){let r=o.enter("list"),i=o.bulletCurrent,a=e.ordered?uS(o):sp(o),s=e.ordered?a==="."?")":".":cS(o),l=t&&o.bulletLastUsed?a===o.bulletLastUsed:!1;if(!e.ordered){let c=e.children?e.children[0]:void 0;if((a==="*"||a==="-")&&c&&(!c.children||!c.children[0])&&o.stack[o.stack.length-1]==="list"&&o.stack[o.stack.length-2]==="listItem"&&o.stack[o.stack.length-3]==="list"&&o.stack[o.stack.length-4]==="listItem"&&o.indexStack[o.indexStack.length-1]===0&&o.indexStack[o.indexStack.length-2]===0&&o.indexStack[o.indexStack.length-3]===0&&(l=!0),mf(o)===a&&c){let u=-1;for(;++u<e.children.length;){let m=e.children[u];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(a=s),o.bulletCurrent=a;let p=o.containerFlow(e,n);return o.bulletLastUsed=a,o.bulletCurrent=i,r(),p}function dS(e){let t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function fS(e,t,o,n){let r=dS(o),i=o.bulletCurrent||sp(o);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(o.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let a=i.length+1;(r==="tab"||r==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(a=Math.ceil(a/4)*4);let s=o.createTracker(n);s.move(i+" ".repeat(a-i.length)),s.shift(a);let l=o.enter("listItem"),p=o.indentLines(o.containerFlow(e,s.current()),c);return l(),p;function c(u,m,d){return m?(d?"":" ".repeat(a))+u:(d?i:i+" ".repeat(a-i.length))+u}}function hS(e,t,o,n){let r=o.enter("paragraph"),i=o.enter("phrasing"),a=o.containerPhrasing(e,n);return i(),r(),a}var Yg=j_(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function gS(e,t,o,n){return(e.children.some(function(a){return Yg(a)})?o.containerPhrasing:o.containerFlow).call(o,e,n)}function xS(e){let t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}Zg.peek=QL;function Zg(e,t,o,n){let r=xS(o),i=o.enter("strong"),a=o.createTracker(n),s=a.move(r+r);return s+=a.move(o.containerPhrasing(e,{before:s,after:r,...a.current()})),s+=a.move(r+r),i(),s}function QL(e,t,o){return o.options.strong||"*"}function _S(e,t,o,n){return o.safe(e.value,n)}function CS(e){let t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function yS(e,t,o){let n=(mf(o)+(o.options.ruleSpaces?" ":"")).repeat(CS(o));return o.options.ruleSpaces?n.slice(0,-1):n}var bS={blockquote:nS,break:Vg,code:aS,definition:sS,emphasis:Ug,hardBreak:Vg,heading:pS,html:Wg,image:Gg,imageReference:jg,inlineCode:qg,link:$g,linkReference:Xg,list:mS,listItem:fS,paragraph:hS,root:gS,strong:Zg,text:_S,thematicBreak:yS};var IS=[JL];function JL(e,t,o,n){if(t.type==="code"&&Oc(t,n)&&(e.type==="list"||e.type===t.type&&Oc(e,n)))return!1;if("spread"in o&&typeof o.spread=="boolean")return e.type==="paragraph"&&(e.type===t.type||t.type==="definition"||t.type==="heading"&&uf(t,n))?void 0:o.spread?1:0}var ws=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],SS=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:ws},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:ws},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:ws},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:ws},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:ws},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:ws},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:ws},{atBreak:!0,character:"~"}];function vS(e){return e.label||!e.identifier?e.label||"":lf(e.identifier)}function TS(e){if(!e._compiled){let t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function wS(e,t,o){let n=t.indexStack,r=e.children||[],i=[],a=-1,s=o.before;n.push(-1);let l=t.createTracker(o);for(;++a<r.length;){let p=r[a],c;if(n[n.length-1]=a,a+1<r.length){let u=t.handle.handlers[r[a+1].type];u&&u.peek&&(u=u.peek),c=u?u(r[a+1],e,t,{before:"",after:"",...l.current()}).charAt(0):""}else c=o.after;i.length>0&&(s==="\r"||s===`
`)&&p.type==="html"&&(i[i.length-1]=i[i.length-1].replace(/(\r?\n|\r)$/," "),s=" ",l=t.createTracker(o),l.move(i.join(""))),i.push(l.move(t.handle(p,e,t,{...l.current(),before:s,after:c}))),s=i[i.length-1].slice(-1)}return n.pop(),i.join("")}function MS(e,t,o){let n=t.indexStack,r=e.children||[],i=t.createTracker(o),a=[],s=-1;for(n.push(-1);++s<r.length;){let l=r[s];n[n.length-1]=s,a.push(i.move(t.handle(l,e,t,{before:`
`,after:`
`,...i.current()}))),l.type!=="list"&&(t.bulletLastUsed=void 0),s<r.length-1&&a.push(i.move(eO(l,r[s+1],e,t)))}return n.pop(),a.join("")}function eO(e,t,o,n){let r=n.join.length;for(;r--;){let i=n.join[r](e,t,o,n);if(i===!0||i===1)break;if(typeof i=="number")return`
`.repeat(1+i);if(i===!1)return`

<!---->

`}return`

`}var tO=/\r?\n|\r/g;function ES(e,t){let o=[],n=0,r=0,i;for(;i=tO.exec(e);)a(e.slice(n,i.index)),o.push(i[0]),n=i.index+i[0].length,r++;return a(e.slice(n)),o.join("");function a(s){o.push(t(s,r,!s))}}function PS(e,t,o){let n=(o.before||"")+(t||"")+(o.after||""),r=[],i=[],a={},s=-1;for(;++s<e.unsafe.length;){let c=e.unsafe[s];if(!cf(e.stack,c))continue;let u=e.compilePattern(c),m;for(;m=u.exec(n);){let d="before"in c||!!c.atBreak,f="after"in c,h=m.index+(d?m[1].length:0);r.includes(h)?(a[h].before&&!d&&(a[h].before=!1),a[h].after&&!f&&(a[h].after=!1)):(r.push(h),a[h]={before:d,after:f})}}r.sort(oO);let l=o.before?o.before.length:0,p=n.length-(o.after?o.after.length:0);for(s=-1;++s<r.length;){let c=r[s];c<l||c>=p||c+1<p&&r[s+1]===c+1&&a[c].after&&!a[c+1].before&&!a[c+1].after||r[s-1]===c-1&&a[c].before&&!a[c-1].before&&!a[c-1].after||(l!==c&&i.push(AS(n.slice(l,c),"\\")),l=c,/[!-/:-@[-`{-~]/.test(n.charAt(c))&&(!o.encode||!o.encode.includes(n.charAt(c)))?i.push("\\"):(i.push("&#x"+n.charCodeAt(c).toString(16).toUpperCase()+";"),l++))}return i.push(AS(n.slice(l,p),o.after)),i.join("")}function oO(e,t){return e-t}function AS(e,t){let o=/\\(?=[!-/:-@[-`{-~])/g,n=[],r=[],i=e+t,a=-1,s=0,l;for(;l=o.exec(i);)n.push(l.index);for(;++a<n.length;)s!==n[a]&&r.push(e.slice(s,n[a])),r.push("\\"),s=n[a];return r.push(e.slice(s)),r.join("")}function kS(e){let t=e||{},o=t.now||{},n=t.lineShift||0,r=o.line||1,i=o.column||1;return{move:l,current:a,shift:s};function a(){return{now:{line:r,column:i},lineShift:n}}function s(p){n+=p}function l(p){let c=p||"",u=c.split(/\r?\n|\r/g),m=u[u.length-1];return r+=u.length-1,i=u.length===1?i+m.length:1+m.length+n,c}}function Qg(e,t={}){let o={enter:r,indentLines:ES,associationId:vS,containerPhrasing:aO,containerFlow:sO,createTracker:kS,compilePattern:TS,safe:lO,stack:[],unsafe:[...SS],join:[...IS],handlers:{...bS},options:{},indexStack:[],handle:void 0};Rg(o,t),o.options.tightDefinitions&&o.join.push(iO),o.handle=tS("type",{invalid:nO,unknown:rO,handlers:o.handlers});let n=o.handle(e,void 0,o,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return n&&n.charCodeAt(n.length-1)!==10&&n.charCodeAt(n.length-1)!==13&&(n+=`
`),n;function r(i){return o.stack.push(i),a;function a(){o.stack.pop()}}}function nO(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function rO(e){let t=e;throw new Error("Cannot handle unknown node `"+t.type+"`")}function iO(e,t){if(e.type==="definition"&&e.type===t.type)return 0}function aO(e,t){return wS(e,this,t)}function sO(e,t){return MS(e,this,t)}function lO(e,t){return PS(this,e,t)}function df(e){let t=this;t.compiler=o;function o(n){return Qg(n,{...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]})}}var hf=I(Ww(),1);var jo=class extends Error{constructor(t,o,n){super(),typeof o=="string"&&(n=o,o=void 0);let r="",i={},a=!1;if(o&&("line"in o&&"column"in o?i={place:o}:"start"in o&&"end"in o?i={place:o}:"type"in o?i={ancestors:[o],place:o.position}:i={...o}),typeof t=="string"?r=t:!i.cause&&t&&(a=!0,r=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof n=="string"){let l=n.indexOf(":");l===-1?i.ruleId=n:(i.source=n.slice(0,l),i.ruleId=n.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){let l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}let s=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=s?s.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=s?s.line:void 0,this.name=Ga(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=a&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}};jo.prototype.file="";jo.prototype.name="";jo.prototype.reason="";jo.prototype.message="";jo.prototype.stack="";jo.prototype.column=void 0;jo.prototype.line=void 0;jo.prototype.ancestors=void 0;jo.prototype.cause=void 0;jo.prototype.fatal=void 0;jo.prototype.place=void 0;jo.prototype.ruleId=void 0;jo.prototype.source=void 0;var Qr={basename:pO,dirname:cO,extname:uO,join:mO,sep:"/"};function pO(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Bc(e);let o=0,n=-1,r=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;r--;)if(e.codePointAt(r)===47){if(i){o=r+1;break}}else n<0&&(i=!0,n=r+1);return n<0?"":e.slice(o,n)}if(t===e)return"";let a=-1,s=t.length-1;for(;r--;)if(e.codePointAt(r)===47){if(i){o=r+1;break}}else a<0&&(i=!0,a=r+1),s>-1&&(e.codePointAt(r)===t.codePointAt(s--)?s<0&&(n=r):(s=-1,n=a));return o===n?n=a:n<0&&(n=e.length),e.slice(o,n)}function cO(e){if(Bc(e),e.length===0)return".";let t=-1,o=e.length,n;for(;--o;)if(e.codePointAt(o)===47){if(n){t=o;break}}else n||(n=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function uO(e){Bc(e);let t=e.length,o=-1,n=0,r=-1,i=0,a;for(;t--;){let s=e.codePointAt(t);if(s===47){if(a){n=t+1;break}continue}o<0&&(a=!0,o=t+1),s===46?r<0?r=t:i!==1&&(i=1):r>-1&&(i=-1)}return r<0||o<0||i===0||i===1&&r===o-1&&r===n+1?"":e.slice(r,o)}function mO(...e){let t=-1,o;for(;++t<e.length;)Bc(e[t]),e[t]&&(o=o===void 0?e[t]:o+"/"+e[t]);return o===void 0?".":dO(o)}function dO(e){Bc(e);let t=e.codePointAt(0)===47,o=fO(e,!t);return o.length===0&&!t&&(o="."),o.length>0&&e.codePointAt(e.length-1)===47&&(o+="/"),t?"/"+o:o}function fO(e,t){let o="",n=0,r=-1,i=0,a=-1,s,l;for(;++a<=e.length;){if(a<e.length)s=e.codePointAt(a);else{if(s===47)break;s=47}if(s===47){if(!(r===a-1||i===1))if(r!==a-1&&i===2){if(o.length<2||n!==2||o.codePointAt(o.length-1)!==46||o.codePointAt(o.length-2)!==46){if(o.length>2){if(l=o.lastIndexOf("/"),l!==o.length-1){l<0?(o="",n=0):(o=o.slice(0,l),n=o.length-1-o.lastIndexOf("/")),r=a,i=0;continue}}else if(o.length>0){o="",n=0,r=a,i=0;continue}}t&&(o=o.length>0?o+"/..":"..",n=2)}else o.length>0?o+="/"+e.slice(r+1,a):o=e.slice(r+1,a),n=a-r-1;r=a,i=0}else s===46&&i>-1?i++:i=-1}return o}function Bc(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}var LS={cwd:hO};function hO(){return"/"}function lp(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function OS(e){if(typeof e=="string")e=new URL(e);else if(!lp(e)){let t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){let t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return gO(e)}function gO(e){if(e.hostname!==""){let n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}let t=e.pathname,o=-1;for(;++o<t.length;)if(t.codePointAt(o)===37&&t.codePointAt(o+1)===50){let n=t.codePointAt(o+2);if(n===70||n===102){let r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(t)}var Jg=["history","path","basename","stem","extname","dirname"],Dc=class{constructor(t){let o;t?lp(t)?o={path:t}:typeof t=="string"||xO(t)?o={value:t}:o=t:o={},this.cwd="cwd"in o?"":LS.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Jg.length;){let i=Jg[n];i in o&&o[i]!==void 0&&o[i]!==null&&(this[i]=i==="history"?[...o[i]]:o[i])}let r;for(r in o)Jg.includes(r)||(this[r]=o[r])}get basename(){return typeof this.path=="string"?Qr.basename(this.path):void 0}set basename(t){t0(t,"basename"),e0(t,"basename"),this.path=Qr.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?Qr.dirname(this.path):void 0}set dirname(t){BS(this.basename,"dirname"),this.path=Qr.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?Qr.extname(this.path):void 0}set extname(t){if(e0(t,"extname"),BS(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Qr.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){lp(t)&&(t=OS(t)),t0(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?Qr.basename(this.path,this.extname):void 0}set stem(t){t0(t,"stem"),e0(t,"stem"),this.path=Qr.join(this.dirname||"",t+(this.extname||""))}fail(t,o,n){let r=this.message(t,o,n);throw r.fatal=!0,r}info(t,o,n){let r=this.message(t,o,n);return r.fatal=void 0,r}message(t,o,n){let r=new jo(t,o,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}};function e0(e,t){if(e&&e.includes(Qr.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Qr.sep+"`")}function t0(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function BS(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function xO(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var DS=function(e){let n=this.constructor.prototype,r=n[e],i=function(){return r.apply(i,arguments)};return Object.setPrototypeOf(i,n),i};var _O={}.hasOwnProperty,i0=class e extends DS{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=W_()}copy(){let t=new e,o=-1;for(;++o<this.attachers.length;){let n=this.attachers[o];t.use(...n)}return t.data((0,hf.default)(!0,{},this.namespace)),t}data(t,o){return typeof t=="string"?arguments.length===2?(r0("data",this.frozen),this.namespace[t]=o,this):_O.call(this.namespace,t)&&this.namespace[t]||void 0:t?(r0("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;let t=this;for(;++this.freezeIndex<this.attachers.length;){let[o,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);let r=o.call(t,...n);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();let o=ff(t),n=this.parser||this.Parser;return o0("parse",n),n(String(o),o)}process(t,o){let n=this;return this.freeze(),o0("process",this.parser||this.Parser),n0("process",this.compiler||this.Compiler),o?r(void 0,o):new Promise(r);function r(i,a){let s=ff(t),l=n.parse(s);n.run(l,s,function(c,u,m){if(c||!u||!m)return p(c);let d=u,f=n.stringify(d,m);yO(f)?m.value=f:m.result=f,p(c,m)});function p(c,u){c||!u?a(c):i?i(u):o(void 0,u)}}}processSync(t){let o=!1,n;return this.freeze(),o0("processSync",this.parser||this.Parser),n0("processSync",this.compiler||this.Compiler),this.process(t,r),HS("processSync","process",o),n;function r(i,a){o=!0,oh(i),n=a}}run(t,o,n){FS(t),this.freeze();let r=this.transformers;return!n&&typeof o=="function"&&(n=o,o=void 0),n?i(void 0,n):new Promise(i);function i(a,s){let l=ff(o);r.run(t,l,p);function p(c,u,m){let d=u||t;c?s(c):a?a(d):n(void 0,d,m)}}}runSync(t,o){let n=!1,r;return this.run(t,o,i),HS("runSync","run",n),r;function i(a,s){oh(a),r=s,n=!0}}stringify(t,o){this.freeze();let n=ff(o),r=this.compiler||this.Compiler;return n0("stringify",r),FS(t),r(t,n)}use(t,...o){let n=this.attachers,r=this.namespace;if(r0("use",this.frozen),t!=null)if(typeof t=="function")l(t,o);else if(typeof t=="object")Array.isArray(t)?s(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(p){if(typeof p=="function")l(p,[]);else if(typeof p=="object")if(Array.isArray(p)){let[c,...u]=p;l(c,u)}else a(p);else throw new TypeError("Expected usable value, not `"+p+"`")}function a(p){if(!("plugins"in p)&&!("settings"in p))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");s(p.plugins),p.settings&&(r.settings=(0,hf.default)(!0,r.settings,p.settings))}function s(p){let c=-1;if(p!=null)if(Array.isArray(p))for(;++c<p.length;){let u=p[c];i(u)}else throw new TypeError("Expected a list of plugins, not `"+p+"`")}function l(p,c){let u=-1,m=-1;for(;++u<n.length;)if(n[u][0]===p){m=u;break}if(m===-1)n.push([p,...c]);else if(c.length>0){let[d,...f]=c,h=n[m][1];em(h)&&em(d)&&(d=(0,hf.default)(!0,h,d)),n[m]=[p,d,...f]}}}},a0=new i0().freeze();function o0(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function n0(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function r0(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function FS(e){if(!em(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function HS(e,t,o){if(!o)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function ff(e){return CO(e)?e:new Dc(e)}function CO(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function yO(e){return typeof e=="string"||bO(e)}function bO(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}var gf=a0().use(pf).use(df).freeze();var IO={blockquote:qa,break:wO,code:Jr,definition:Jr,delete:qa,emphasis:qa,footnoteReference:Jr,footnoteDefinition:Jr,heading:TO,html:Jr,image:zS,imageReference:zS,inlineCode:RS,list:qa,listItem:qa,link:qa,linkReference:qa,strong:qa,table:Jr,tableCell:Jr,text:RS,thematicBreak:Jr,toml:Jr,yaml:Jr},SO={},NS=[];function pp(e){let t={...IO},o=e||SO,n=o.keep||NS,r=o.remove||NS,i=-1;for(;++i<r.length;){let p=r[i];typeof p=="string"?t[p]=Jr:t[p[0]]=p[1]}let a={};if(n.length===0)a=t;else{let p;for(p in t)n.includes(p)||(a[p]=t[p]);for(i=-1;++i<n.length;)if(p=n[i],!Object.hasOwn(t,p))throw new Error("Unknown node type `"+p+"` in `keep`, use a replace tuple with a handle instead: `remove: [['"+p+"', handle]]`")}return function(p){return s(p)};function s(p){let c=p.type,u=p;if(Object.hasOwn(a,c)){let m=a[c];m&&(u=m(u)||void 0)}return u=Array.isArray(u)?l(u):u,u&&"children"in u&&(u.children=l(u.children)),u}function l(p){let c=-1,u=[];for(;++c<p.length;){let m=s(p[c]);Array.isArray(m)?u.push(...l(m)):m&&u.push(m)}return vO(u)}}function vO(e){let t=-1,o=[],n;for(;++t<e.length;){let r=e[t];n&&r.type===n.type&&"value"in r&&"value"in n?n.value+=r.value:(o.push(r),n=r)}return o}function zS(e){let t="title"in e?e.title:"",o=e.alt||t||"";return o?{type:"text",value:o}:void 0}function RS(e){return{type:"text",value:e.value}}function TO(e){return{type:"paragraph",children:e.children}}function qa(e){return e.children}function wO(){return{type:"text",value:`
`}}function Jr(){}var VS=async(e,t,o)=>{if(o){let n=Qs('.markdown-body[data-testid="chat-ai-message--markdown"]',t);if(!n)return VS(e,t,!1);Zu(e,n,[])}else{let n=zp(e,!1,[]),r=await gf().use(pp).process(n);await navigator.clipboard.writeText(r.toString())}},MO=()=>{let{AIMessage:e}=Xe(),{t}=k(),{chatHubLoading:o}=dt(),{pageUrl:n}=i3(),[r,i]=(0,Zt.useState)(!1),a=(0,Zt.useMemo)(()=>{let m=Tx();return T3[m]||null},[n]),[s,l]=(0,Zt.useState)(void 0),p=(0,Zt.useRef)(!1),c=UC.getInstance(),u=async(m,d)=>{let f=m.currentTarget,h=null;if(a?.needFindInstantReplyButtonIdToInput&&!p.current){let x=c.getLastActiveInput();x&&(Js(x)?h=x:c.deleteLastActiveInput()),p.current=!0}let _=h||s;a&&f&&(s&&(Js(s)||(l(void 0),_=void 0)),await VS(e,f,d),await a.insertContent(e,d,_)),Kd()};return(0,Zt.useEffect)(()=>{if(a){let m=h=>{if(h.target instanceof HTMLElement&&a.selectors){let _=h.target;a.selectors.some(x=>_.matches(x))&&l(_)}},d=()=>{if(a.selectors.length){let h=!1;for(let _ of a.selectors){let x=document.querySelector(_);if(x&&Js(x)){h=!0;break}}i(h)}};d();let f=setInterval(d,1e3);return window.addEventListener("focus",m,{capture:!0}),()=>{window.removeEventListener("focus",m,{capture:!0}),clearInterval(f)}}},[a]),!a||!r?null:Zt.default.createElement(Zt.default.Fragment,null,Zt.default.createElement(mt,{disabled:o,sx:{p:0},onClick:m=>{u(m,!0)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-with-format-item"},Zt.default.createElement(g,{width:"100%"},Zt.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},Zt.default.createElement(G,{icon:"InsertBelow",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),Zt.default.createElement($i,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_with_format__title"))),Zt.default.createElement(Ct,null))),Zt.default.createElement(mt,{disabled:o,sx:{p:0},onClick:m=>{u(m,!1)},"data-testid":"maxai-client--ai-message--next-action--insert-result-to-input-without-format-item"},Zt.default.createElement(g,{width:"100%"},Zt.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},Zt.default.createElement(G,{icon:"ArrowInsert",sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),Zt.default.createElement($i,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t("package__features:chat__chat_with_any_content__next_actions__insert_content_without_format__title"))),Zt.default.createElement(Ct,null))))},US=MO;var Ei=I(E()),EO=e=>{let{nextActions:t}=e,{chatHubLoading:o}=dt(),{askAIWithShortcutsV2:n}=ke(),{AIMessage:r}=Xe(),i=async a=>{let s=xm(a);if(s.actions){let l=[],p=wr(r,!1);p=p.replace(Ys,""),l.push({type:"SET_VARIABLE_MAP",parameters:{VariableMap:{[Oe.PRESET_VARIABLE__SELECTED_TEXT.name]:p}}}),l.push(...s.actions),await n(l,{disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0})}};return Ei.default.createElement(pi,{in:!0,timeout:150},Ei.default.createElement(g,{sx:{mt:"0!important"}},t.length>0&&Ei.default.createElement(US,null),t.map((a,s)=>{let l=s===t.length-1;if(!a.input?.prompt_action)return null;let p=a.input.prompt_action;return Ei.default.createElement(mt,{key:p.prompt_id,disabled:o,sx:{p:0},onClick:async()=>{await i(p)},"data-testid":`maxai-client--ai-message--next-action--use-prompt-action-item-${s}`},Ei.default.createElement(g,{width:"100%"},Ei.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},p.prompt_icon&&Ei.default.createElement(G,{icon:p.prompt_icon,sx:{flexShrink:0,fontSize:"20px",color:"text.secondary"}}),Ei.default.createElement($i,{TooltipProps:{disableInteractive:!0},width:0,flex:1,lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},wa(p.prompt_id,p.prompt_title))),!l&&Ei.default.createElement(Ct,null)))})))},WS=EO;var sr=I(E());var xf=new Map,GS=(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:{...t,appVersion:A1,runTimeEnv:Mp}}))},jS=(e,t)=>{if(xf.get(t))return;let o=n=>{let{appVersion:r,runTimeEnv:i}=n.detail||{};r===A1&&i===Mp&&t(n)};xf.set(t,o),window.addEventListener(e,o)},qS=(e,t)=>{let o=xf.get(t);o&&(xf.delete(t),window.removeEventListener(e,o))};var KS=I(Nw());var Ai=I(E()),AO=({order:e,title:t,disabled:o,onClick:n})=>Ai.default.createElement(mt,{disabled:o,sx:{p:0},onClick:n,"data-testid":`maxai-client--ai-message--next-action--related-question-item-${e}`},Ai.default.createElement(g,{width:"100%"},Ai.default.createElement(Ct,null),Ai.default.createElement(g,{direction:"row",alignItems:"center",width:"100%",sx:{px:1},gap:1},Ai.default.createElement($i,{TooltipProps:{disableInteractive:!0},lineClamp:1,fontSize:"16px",whiteSpace:"normal",color:"text.primary",fontWeight:400,sx:{height:"40px",lineHeight:"40px"}},t),Ai.default.createElement(KS.default,{sx:{ml:"auto",mr:0,fontSize:"24px",color:"text.primary"}})))),PO=e=>{let{nextActions:t}=e,{chatHubLoading:o}=dt();return Array.isArray(t)?Ai.default.createElement(pi,{in:!0,timeout:150},Ai.default.createElement(g,null,t.map((n,r)=>n.input?.content?Ai.default.createElement(AO,{order:r+1,title:n.input.content,key:n.input.content,disabled:o,onClick:async()=>{GS("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",{value:n.input.content})}}):null))):null},$S=PO;var kO=e=>{let{nextActions:t,nextActionsStatus:o}=e,{t:n}=k(),{variant:r}=Yt(),{isLoading:i}=Xe(),{relatedQuestions:a,usePromptActionPrompts:s}=(0,sr.useMemo)(()=>{let l=[],p=[];return t.forEach(c=>{switch(c.type){case"UsePromptAction":{p.push(c);break}case"FollowUpQuery":{l.push(c);break}case"FocusedSearch":}}),{usePromptActionPrompts:p,relatedQuestions:l}},[t]);return!i&&t.length===0||r==="share"?null:sr.default.createElement(sr.default.Fragment,null,sr.default.createElement(Ct,{sx:{mt:"32px!important"}}),o&&o!=="complete"&&sr.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},sr.default.createElement(B,{sx:{display:"inline-block",width:"12px",height:"12px",margin:"0 0 0 4px !important",borderRadius:"50%",backgroundColor:l=>l.palette.mode==="dark"?"#fff":"#000"}})),o==="complete"&&a.length>0&&sr.default.createElement(sr.default.Fragment,null,sr.default.createElement(Mi,{title:{title:n("package__features:chat__chat_with_any_content__next_actions__related__title"),titleIcon:"Stacks"}})),a.length>0&&sr.default.createElement($S,{nextActions:a}),sr.default.createElement(WS,{nextActions:s}))},XS=kO;var YS=I(Sr());var Qi=I(E()),LO=e=>{let{message:t}=e,{metadata:o}=Xe(),{variant:n}=Yt(),{isPayingUser:r}=_t(),{showPricingHooksPopup:i}=ul(),{updateMessage:a}=yi(),s=o.embeddedPaywall,l=async c=>{if(!s)return;Ur("click",{conversationId:t.conversationId,paywallType:"response",paywallReason:"ProChat",buttonType:"upgrade",targetElement:c?.currentTarget});let u=await gs.sendUserAction(s.cta_action_name);u?.paywall&&i(t.conversationId,u.paywall)},p=()=>{if(!s)return;let c=Ro([{},t,{originalMessage:{metadata:{embeddedPaywall:{status:"hidden"}}}}]);a(t.conversationId,c),gs.sendUserAction(s.close_action_name)};return n==="share"||r||!s||s.status==="hidden"?null:Qi.default.createElement(g,{spacing:1,direction:"row",alignItems:"center",sx:{border:"1px solid",borderColor:"border.main",borderRadius:1,px:1.5,py:"10px"}},Qi.default.createElement(js,{sx:{color:"text.primary",fontSize:"20px"}}),Qi.default.createElement(g,{flex:1,spacing:.5},Qi.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},s.title),Qi.default.createElement(T,{fontSize:"14px",color:"text.secondary"},s.message)),Qi.default.createElement(de,{variant:"contained",onClick:l},s.cta_button_title),Qi.default.createElement(se,{onClick:p,sx:{width:36,height:36}},Qi.default.createElement(YS.default,{sx:{fontSize:20}})))},_f=LO;var bf=I(E());var Lr=I(E()),OO=e=>{let{contentType:t="text"}=e;return t==="image"?Lr.default.createElement(g,{mt:1,width:"60%",minWidth:Lp-16-16},Lr.default.createElement(g,{width:"100%",sx:{position:"relative",paddingBottom:"100%",bgcolor:"#F4F4F7",borderRadius:"8px",alignItems:"center",justifyContent:"center"}},Lr.default.createElement(B,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}}),Lr.default.createElement("img",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)"},width:64,height:64,src:Ap("/images/art/creating-image.gif"),alt:"Creating image"}))):Lr.default.createElement(g,{mt:1},Lr.default.createElement(fo,{animation:"wave",height:10}),Lr.default.createElement(fo,{animation:"wave",height:10}),Lr.default.createElement(fo,{animation:"wave",height:10}),Lr.default.createElement(fo,{animation:"wave",height:10}),Lr.default.createElement(fo,{animation:"wave",height:10}),Lr.default.createElement(fo,{animation:"wave",height:10}))},ZS=OO;var eo=I(E());var JS=I(Uu()),e8=I(QS());var Fc=I(E()),HO=e=>{let{collapsed:t,disabled:o,onClick:n,children:r}=e,i=typeof t=="boolean"&&!o;return Fc.default.createElement(g,{direction:"row",onClick:i?n:void 0,sx:{width:"max-content",alignItems:"center",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.7)","&:hover":i?{cursor:"pointer",color:a=>a.palette.mode==="dark"?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.6)"}:void 0}},Fc.default.createElement(T,{fontSize:16,fontWeight:400},r||""),i?t?Fc.default.createElement(JS.default,{sx:{fontSize:20,color:"inhert"}}):Fc.default.createElement(e8.default,{sx:{fontSize:20,color:"inhert"}}):null)},cp=HO;var NO=e=>{let{message:t}=e,{t:o}=k(),{isDarkMode:n}=Wn(),{metadata:r,content:i}=Xe(),[a,s]=(0,eo.useState)(!0),[l,p]=(0,eo.useState)(1),c=(0,eo.useMemo)(()=>Vo(void 0,r.AIModel),[r.AIModel]),u=(0,eo.useMemo)(()=>{let m=r?.AIModel,d=r?.processingText,f=r?.thinkingText,h=r?.copilot,_=Yu(t);return f?_?"reasoningText":"reasonedText":_?h?"skeleton":d?"processingText":m?k_(m)&&c?.disableStreaming?"countdown":"understandingText":"point":"empty"},[r,i.contentType,c]);return(0,eo.useEffect)(()=>{if(u==="reasoningText"&&s(!1),u==="reasonedText"&&s(!0),u==="countdown"){p(1);let m=setInterval(()=>{p(d=>d+1)},1e3);return()=>clearInterval(m)}},[u]),u==="empty"?null:eo.default.createElement(g,{spacing:1},u==="skeleton"&&eo.default.createElement(ZS,{contentType:i.contentType}),u==="processingText"&&eo.default.createElement(cp,null,t.originalMessage?.metadata?.processingText||""),u==="countdown"&&eo.default.createElement(cp,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__think_for_x_seconds",{COUNTDOWN:l})),u==="understandingText"&&eo.default.createElement(cp,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__understanding_text")),u==="reasoningText"&&eo.default.createElement(cp,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__reasoning_text")),u==="reasonedText"&&eo.default.createElement(cp,{collapsed:a,onClick:()=>s(!a),disabled:!r.thinkingText},o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:c?.title||r.AIModel||""})),r?.thinkingText&&!a&&eo.default.createElement(B,{className:`markdown-body ${n?"markdown-body-dark":""}`,sx:{borderLeft:"2px solid",borderColor:"border.main",pl:1}},eo.default.createElement(B,{sx:{fontSize:14,color:m=>m.palette.mode==="dark"?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},eo.default.createElement(eo.Suspense,{fallback:eo.default.createElement(En,{loading:!0})},eo.default.createElement(Sa,{message:t,enableTextToStreaming:r.AIModel==="deepseek-r1"},r.thinkingText)))))},t8=NO;var n8=I(E());var o8=I(E()),zO=e=>{let{loading:t,children:o,sx:n,...r}=e;return o8.default.createElement(T,{sx:t?{position:"relative","&::after":{content:'""',animation:"dots 1.5s infinite"},"@keyframes dots":{"0%":{content:'"."'},"25%":{content:'".."'},"50%":{content:'"..."'},"75%":{content:'".."'},"100%":{content:'"."'}},...n}:n,...r},o?.replace("...",""))},up=zO;var RO=e=>{let{t}=k(),{metadata:o,processingStep:n}=Xe();return n==="RESPONDING"||n==="RESPONDED"?null:n8.default.createElement(up,{fontSize:16,color:"text.tertiary",loading:!0},o.processingText||t("package__features:chat__ai_message__understanding_text"))},r8=RO;var at=I(E());var i8=I(Y1()),a8=I(Uu());var qo=I(E()),VO=Io(E2)(({theme:e})=>({position:"relative",borderRadius:e.shape.borderRadius,"&::before":{display:"none"},[`&.${al.expanded}`]:{margin:0}})),UO=Io(P2)(()=>({color:"text.secondary",minHeight:"auto",padding:0,[`&.${al.expanded}`]:{minHeight:"auto",padding:0},[`& .${al.content}`]:{margin:0},[`& .${al.content}.${al.expanded}`]:{margin:0},"&:hover":{cursor:"pointer",opacity:.8}})),WO=Io(A2)({padding:0}),GO=e=>{let{size:t}=e;return qo.default.createElement(B,{position:"relative",width:t,height:t,zIndex:1},qo.default.createElement(B,{position:"absolute",width:t,height:t,sx:{bgcolor:o=>o.palette.mode==="light"?"rgb(235,235,235)":"rgb(185,185,185)",borderRadius:"50%",animation:"anim 1.0s infinite ease-in-out","@keyframes anim":{"0%,100%":{transform:"scale(1.1)"},"50%":{transform:"scale(0.9)"}}}}),qo.default.createElement(B,{position:"absolute",width:t/2,height:t/2,sx:{left:"50%",top:"50%",transform:"translate(-50%, -50%)",bgcolor:"text.primary",borderRadius:"50%"}}))},jO=e=>{let{title:t,icon:o,loading:n,customize:r,extraNode:i,titleSx:a,iconSx:s,headerSx:l,contentSx:p,children:c,...u}=e,m=o;m||(m=qo.default.createElement(B,{display:"flex",justifyContent:"center",alignItems:"center",width:20,height:20},n?qo.default.createElement(GO,{size:16}):qo.default.createElement(i8.default,{sx:{fontSize:16,color:"text.tertiary"}})));let d=()=>r?c:c?qo.default.createElement(qo.default.Fragment,null,qo.default.createElement(B,{sx:{position:"absolute",left:"9.5px",top:"22px",bottom:"4px",width:"1px",bgcolor:"text.tertiary"}}),qo.default.createElement(g,{gap:.5,pl:"28px",pb:.5,sx:p},c)):null;return qo.default.createElement(VO,{variant:"outlined",...u},qo.default.createElement(UO,{expandIcon:qo.default.createElement(a8.default,{sx:{fontSize:"24px"}})},qo.default.createElement(g,{flex:1,height:"32px",direction:"row",alignItems:"center",justifyContent:"space-between",sx:l},qo.default.createElement(Mi,{title:{title:t,titleIcon:m},fontSx:{fontSize:16,color:"text.secondary",...a},iconSx:s}),qo.default.createElement(g,{direction:"row",alignItems:"center"},i))),qo.default.createElement(WO,null,d()))},yf=jO;var qO=e=>{let{message:t}=e,{t:o}=k(),{isDarkMode:n}=Wn(),{metadata:r,processingStep:i}=Xe(),[a,s]=(0,at.useState)(!0),[l,p]=(0,at.useState)(!1),[c,u]=(0,at.useState)(!1),[m,d]=(0,at.useState)(!1),{chatHubLoading:f}=dt(),h=et({expanded:l}),_=(0,at.useMemo)(()=>Vo(void 0,r.AIModel),[r.AIModel]),x=r.preprocessingTrackers||[],C=r.thinkingText,y=typeof C=="string"||i==="REASONING",b=(0,at.useCallback)(()=>{h.current.expanded||(s(!1),clearTimeout(h.current.timeout),h.current.timeout=setTimeout(()=>{s(!0)},100))},[]);(0,at.useEffect)(()=>(i==="ANALYZING"&&(b(),p(!0),u(!0)),i==="REASONING"&&(b(),p(!0),u(!1),d(!0)),i==="RESPONDING"&&p(!1),i==="RESPONDED"&&p(!1),()=>{clearTimeout(h.current.timeout)}),[i]);let v=()=>x.length?x.map((M,P)=>{let O=i=="ANALYZING"&&P===x.length-1,L=M.status.replace("...","");return at.default.createElement(up,{key:P,fontSize:14,color:O?"text.primary":"text.tertiary",loading:O,noWrap:!0},L)}):null,S=()=>C?at.default.createElement(B,{className:`markdown-body ${n?"markdown-body-dark":""}`},at.default.createElement(B,{sx:{fontSize:14,color:i==="REASONING"?"text.primary":"text.tertiary","& a":{color:"inherit!important",fontSize:14,textDecoration:"none!important",pointerEvents:"none"}}},at.default.createElement(at.Suspense,{fallback:at.default.createElement(En,{loading:!0})},at.default.createElement(Sa,{message:t,enableTextToStreaming:r.AIModel==="deepseek-r1"},C)))):null;return at.default.createElement(yf,{title:"Pro chat",icon:at.default.createElement(js,{sx:{color:"text.primary"}}),sx:{px:1,py:.5},titleSx:{color:"text.primary",fontWeight:500},slotProps:{transition:f?{timeout:0}:{}},expanded:l,customize:!0,onChange:()=>{let M=!l;p(M),b(),M&&(y?(u(!1),d(!0)):u(!0))},extraNode:at.default.createElement(at.default.Fragment,null,at.default.createElement(Mn,{size:16,model:r.AIModel||""}),at.default.createElement(T,{sx:{mx:.5,fontSize:12,color:M=>M.palette.mode==="dark"?"rgba(255, 255, 255, 0.87)":"rgba(0, 0, 0, 0.87)"}},Vo(void 0,r.AIModel)?.title))},at.default.createElement(g,null,at.default.createElement(yf,{title:at.default.createElement(up,{loading:i==="ANALYZING"},i==="ANALYZING"?o("package__features:chat__ai_message__analyzing_text"):o("package__features:chat__ai_message__analyzed_text")),expanded:c,loading:i==="ANALYZING",onChange:()=>u(!c),slotProps:{transition:a&&!f?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},v()),y?at.default.createElement(yf,{title:at.default.createElement(up,{loading:i==="REASONING"},i==="REASONING"?o("package__features:chat__ai_message__reasoning_text"):o("package__features:chat__ai_message__reasoned_text",{AI_MODEL:_?.title||r.AIModel||""})),expanded:m,loading:i==="REASONING",onChange:()=>d(!m),slotProps:{transition:a&&!f?{}:{timeout:0}},sx:{border:"none"},headerSx:{py:0}},S()):null))},s8=qO;var KO=e=>{let{metadata:t}=Xe();return t.chatMode==="pro_chat"?bf.default.createElement(s8,{...e}):t.chatMode==="free_chat"?bf.default.createElement(r8,{...e}):t.thinkingText||!t.isComplete?bf.default.createElement(t8,{...e}):null},s0=KO;var p8=I(l8());var so=I(E()),ZO=so.default.memo(({knowledgeSources:e})=>{let[t,o]=(0,so.useState)(!1),n=()=>{o(!t)},{t:r}=k();return so.default.createElement(Zn,{variant:"outlined",sx:{borderRadius:"8px",padding:"12px",width:"100%",overflow:"hidden",position:"relative",border:"0px",bgcolor:i=>i.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"}},so.default.createElement(B,{display:"flex",alignItems:"center",mb:2},so.default.createElement("img",{src:`https://t2.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=http://${e.title}.com&size=64`,alt:"Logo",style:{width:40,height:40,borderRadius:"8px",marginRight:"8px"}}),so.default.createElement(B,{flex:1},so.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{}},so.default.createElement(T,{sx:{fontSize:16,fontWeight:600,lineHeight:"150%"},component:"div"},e.title),so.default.createElement(de,{onClick:n,sx:{color:"text.primary",height:"25px",borderRadius:"13px",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}},so.default.createElement(p8.default,{sx:{fontSize:"16px",transition:"all 0.2s",transform:t?"rotate(0deg)":"rotate(180deg)",marginRight:"3px",marginLeft:"-3px"}}),r(t?"package__features:chat__ai_message__knowledge__hide":"package__features:chat__ai_message__knowledge__show_all"))),so.default.createElement(T,{variant:"body2",color:"textSecondary"},e.titleDescription))),so.default.createElement(Ct,null),so.default.createElement(B,{sx:{marginTop:"8px",maxHeight:t?"1000px":"140px",overflow:"hidden"}},e?.knowledgePanelList&&e?.knowledgePanelList.map(i=>so.default.createElement(B,{className:"knowledge-source-item",key:i.title,mx:1,my:1,sx:{display:"flex",alignItems:"flex-start"}},so.default.createElement(T,{variant:"body2",sx:{fontWeight:"600",fontSize:"14px",width:"130px",minWidth:"130px",maxWidth:"130px",lineHeight:1.6}},i.title),so.default.createElement(B,{flex:1},i.content&&i.content.map((a,s)=>so.default.createElement(so.default.Fragment,{key:s},a.type==="a"?so.default.createElement(fi,{target:"_blank",href:a.href,sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)",textDecorationColor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text):so.default.createElement(T,{sx:{display:"inline",fontSize:"14px",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}},a.text))))))))}),c8=ZO;var m8=I(Uw());var Or=I(E());var Po=I(E()),QO=Io("div")({display:"flex",justifyContent:"center",alignItems:"center",maxWidth:870,maxHeight:"100%",width:"100%"}),JO=Io("img")({borderRadius:8,width:"auto",height:"auto",objectFit:"cover",maxWidth:"100%",maxHeight:"98vh",minWidth:100}),eB=Io("img",{shouldForwardProp:e=>e!=="selected"})(({theme:e,selected:t})=>({boxSizing:"border-box",objectFit:"cover",width:"100%",maxHeight:"100%"})),tB=(0,Po.memo)(eB),oB=({images:e,selectedImage:t,setSelectedImage:o})=>{let[n]=(0,Po.useState)([]),r=(0,Po.useMemo)(()=>e.filter(s=>!n.includes(s.src)),[n,e]),i=()=>{o(void 0)},a=s=>{s.currentTarget.style.display="none"};return t?Po.default.createElement(Po.default.Fragment,null,Po.default.createElement(O2,{open:!!t,onClose:i,fullScreen:!0,PaperProps:{style:{backgroundColor:"transparent",boxShadow:"none"}},slotProps:{backdrop:{style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}}}},Po.default.createElement(B2,{sx:{overflowX:"hidden",display:"flex",justifyContent:"center",alignItems:"center",height:"100%",padding:0},onClick:()=>i()},Po.default.createElement(B,{display:"flex",alignItems:"center",height:"100%",width:"100%"},Po.default.createElement(B,{flexGrow:1,flexShrink:1,display:"flex",justifyContent:"center",alignItems:"center",pr:2,pl:2,height:"100%"},Po.default.createElement(QO,null,Po.default.createElement(JO,{onClick:s=>{s.stopPropagation()},src:t,onError:a}))),Po.default.createElement(B,{sx:{pt:2,pb:2},boxSizing:"border-box",height:"100%"},Po.default.createElement(B,{onClick:s=>s.stopPropagation(),sx:{flexShrink:0,gap:1,overflowY:"auto",maxHeight:"100%",boxSizing:"border-box",pt:2,pb:2,marginRight:"32px",width:"284px",alignContent:"flex-start",justifyContent:"center"}},Po.default.createElement(F2,{variant:"masonry",cols:2,gap:8},r.map(s=>Po.default.createElement(H2,{key:s.src},Po.default.createElement(tB,{src:s.src,alt:s.alt,selected:t===s.src,onClick:l=>{l.stopPropagation(),o(s.src)},onError:l=>{l.currentTarget.parentElement&&(l.currentTarget.parentElement.style.display="none"),l.currentTarget.style.display="none"},sx:{border:"2px solid",borderColor:t===s.src?"primary.main":"transparent",borderRadius:.5}})))))))))):null},mp=oB;var lr=I(E()),nB=e=>{let{message:t,images:o,loading:n,handleUpdateMessageOnImageError:r}=e,[i,a]=(0,lr.useState)([]),[s,l]=(0,lr.useState)(),p=T2(i,300,[]);(0,lr.useEffect)(()=>{if(n||p.length===0)return;let u=setTimeout(()=>{let m=Ee(t),d=m.originalMessage?.metadata?.searchResults;if(!d)return;let f=!1;d.forEach(h=>{h.images=h.images?.filter(_=>p.includes(_.src)?(f=!0,!1):!0)}),f&&r(m)},400);return()=>{clearTimeout(u)}},[n,p]);let c=(0,lr.useMemo)(()=>l2(o.filter(u=>!i.includes(u.src)),"src"),[i,o]);return lr.default.createElement(lr.default.Fragment,null,c.map(u=>lr.default.createElement(B,{component:"div",key:u.src,sx:{img:{border:m=>m.palette.mode==="dark"?"1px solid  rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}}},lr.default.createElement(xi,{width:64,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},onImageClick:()=>{l(u.src)},src:u.src,alt:u.alt||"",onError:()=>{a(m=>[...new Set([...m,u.src])])}}))),lr.default.createElement(mp,{images:c.map(u=>({src:u.src,alt:u.alt})),selectedImage:s,setSelectedImage:l}))},u8=nB;var rB=e=>{let{loading:t,message:o,images:n,videos:r,knowledgePanels:i}=e,{openVideoPopup:a}=C_(),{updateMessage:s}=yi();return Or.default.createElement(Or.default.Fragment,null,(n.length>0||r.length>0)&&Or.default.createElement(g,{className:"media_sources",spacing:1},n.length>0&&Or.default.createElement(g,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},Or.default.createElement(u8,{key:o?.conversationId,message:o,loading:t,images:n,handleUpdateMessageOnImageError:l=>{l.conversationId&&s(l.conversationId,l)}})),r.length>0&&Or.default.createElement(g,{spacing:1,direction:"row",className:"image_sources",sx:{overflowX:"scroll","&::-webkit-scrollbar":{display:"none",width:0,background:"transparent"}}},r.map(l=>Or.default.createElement(g,{sx:{position:"relative",cursor:"pointer",img:{border:p=>p.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)"}},className:"videoItem",key:l.src,onClick:()=>{a(l.src,"",!0)}},Or.default.createElement(xi,{width:114,height:64,imgStyle:{borderRadius:"8px",cursor:"pointer",objectFit:"cover",display:"block",overflow:"hidden"},src:l.imgSrc||l.poster||"",alt:""}),Or.default.createElement(B,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",height:16,width:16,color:"white",p:2,borderRadius:"50%",lineHeight:0,bgcolor:"#00000080",backdropFilter:"blur(4px)"}},Or.default.createElement(m8.default,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:16}})))))),i.length>0&&Or.default.createElement(c8,{knowledgeSources:i[0]}))},d8=rB;var jn=I(E());var pr=I(E()),iB=e=>{let{contextMenuList:t=[],onSelectActions:o,onClose:n,placement:r,query:i,onChange:a}=e,{t:s}=k(),l=(0,pr.useRef)(null),{contextMenuPath:p}=io(),c=(0,pr.useRef)(null),u=()=>{c.current?.querySelector("input")?.focus()},m=()=>{u()},d=_=>{u(),_&&_.actions&&p&&(o?.(_.actions),n?.())},[f,h]=(0,pr.useState)(null);return pr.default.createElement(g,{direction:r?.startsWith("top")?"column-reverse":"column",height:"100%",ref:h},pr.default.createElement(fa,{mouseEvent:"onClick",onClickAway:()=>{n?.()}},pr.default.createElement(zt,{value:i,onChange:_=>a(_.target.value),"aria-autocomplete":"none",ref:c,"data-testid":"context-menu-use-prompt--textfield",autoFocus:!0,sx:{width:300,bgcolor:"background.paper",borderRadius:1,"& input":{py:1,px:2,borderRadius:1,fontSize:"16px"}},onKeyDownCapture:_=>{l.current?.proxyKeyboardEvent(_.nativeEvent)&&(_.preventDefault(),_.stopPropagation()),_.key==="Escape"&&(n?.(),_.preventDefault(),_.stopPropagation());let x=l.current?.getSelectedItem();_.key==="Enter"&&x&&(d(x),n?.(),_.preventDefault(),_.stopPropagation())},onKeyDown:_=>{_.stopPropagation()},onKeyUp:_=>{_.stopPropagation()},inputProps:{autoComplete:"off"}})),f&&pr.default.createElement(wd,{ref:l,menuList:t,menuWidth:300,menuMaxHeight:"350px",defaultPlacement:r,onClickGroup:m,referenceElement:pr.default.createElement(B,{position:"relative",left:0,top:r?.startsWith("top")?"4px":"-4px"}),root:f,open:!0,onClickItem:d,zIndex:1e4,noOptionFallback:pr.default.createElement(T,{width:"100%",p:1,textAlign:"left",color:_=>_.palette.text.secondary,fontSize:"14px"},s("package__features:context_menu__button__use__prompt_no_options"))}),t.length>0&&pr.default.createElement(B,{sx:{bgcolor:_=>_.palette.background.default,height:"10px",width:"100%"}}))},f8=iB;var aB=e=>{let{className:t,sx:o,disabled:n,message:r,open:i,onOpenChange:a}=e,s="max-ai__actions__button--use-prompt",[l,p]=(0,jn.useState)(null),{t:c}=k(),{contextMenuPath:u}=io(),{askAIWithShortcutsV2:m}=ke(),{context:d,placement:f,floatingStyles:h,refs:_}=ba({open:i,strategy:"fixed",onOpenChange(L){a(L)},placement:"bottom-start",middleware:[Cu(8),bu({fallbackPlacements:["top-start","top-end","bottom-end"]}),yu()],whileElementsMounted:ol}),x=Gu(d),C=qu(d),{getReferenceProps:y,getFloatingProps:b}=ml([x,C]),[v,S]=(0,jn.useState)(""),{liteContextMenuActionsItems:M}=Sl(v,{enabledVisibilitySettings:!0,enabledFavorite:!0}),P=async L=>{let H="";r&&(typeof r=="string"?H=r:(H=wr(r,!1),H=H.replace(Ys,"")));let z=[{type:"SET_VARIABLE",parameters:{Variable:{key:"SELECTED_TEXT",value:H||" ",label:"Selected text",isBuiltIn:!0,overwrite:!0}}},{type:"SET_VARIABLE",parameters:{Variable:{key:"VARIABLE_MODAL_KEY",value:"Sidebar",overwrite:!0,isBuiltIn:!0}}}];await m(Ee(L),{beforeActions:z,disabledMaxAIDocumentIds:!0,keepLoadingAfterExecution:!0})},O=(0,jn.useMemo)(()=>M.flatMap(L=>{if(L.type==="group"){let H=`context_menu__prompt__${L.prompt_id}`,z=`package__features:${H}`,R=c(z),V=ai?R==="package__features:"+H:R===H;return(!R||R===L.prompt_id||V||H===z)&&(R=L.prompt_title),[R+"__CONTEXT_MENU_LABEL_SLOT_PLACEHOLDER__"+L.prompt_id,...L.children??[]]}return[L]}),[M,c]);return jn.default.createElement(jn.default.Fragment,null,jn.default.createElement(se,{tooltipProps:{placement:"top"},title:c("package__features:context_menu__button__use__prompt"),sx:{p:"6px",...o},"data-testid":s,className:t,onClick:L=>{p(l?null:L.currentTarget)},disabled:n,buttonRefBind:_.setReference,...y()},jn.default.createElement(G,{sx:{fontSize:"20px"},icon:"Rewrite"})),i&&jn.default.createElement(B,{ref:_.setFloating,style:h,...b(),sx:{width:300,height:400,zIndex:9999}},jn.default.createElement(f8,{placement:f,onSelectActions:P,onClose:()=>{S(""),a(!1)},query:v,onChange:L=>S(L),contextMenuList:O})))},sB=function(e){return jn.default.createElement(ka,{defaultContextMenuPath:"/rewrite"},jn.default.createElement(aB,{...e}))},h8=sB;var Fn=I(E());var x8=I(g8()),Hc=I(E()),lB=e=>{let{message:t,...o}=e,{t:n}=k(),[r,i]=(0,Hc.useState)(!1),a=F_(t),s=async()=>{i(!0),await Promise.all(a.map(async l=>{let p=l.uploadedUrl;if(!p)return;let c=D_(p);if(c){let u=c.endsWith(".webp")?c.replace(".webp",".png"):c;p=(await Ax.fetchDocument(u)).data?.s3?.doc_url||p}try{let u=await o2(Vn.fetch(p,{method:"GET",parse:"blob",headers:{"Content-Type":"image/png"}}),2e4,{success:!1}),m=!1;if(u.success&&u?.data?.contentType)try{let d=t.text;Qn(t)&&(d=t.originalMessage?.metadata?.title?.title||""),(0,x8.saveAs)(bx(u.data.base64,"image/png"),`${d}.png`),m=!0}catch{}if(!m){let d=document.createElement("a");d.href=p,d.download="download",d.click(),d.remove()}}catch{}})).then().catch().finally(()=>{i(!1)})};return a.length===0?null:Hc.default.createElement(se,{title:n("package__features:chat__ai_message__download_image"),onClick:s,disabled:r,...o,sx:{p:"6px",borderRadius:"4px",...o.sx}},Hc.default.createElement(G,{icon:r?"Loading":"FileDownload",sx:{fontSize:"20px"}}))},_8=lB;var Nc=I(E()),pB=e=>{let{message:t,...o}=e,{t:n}=k(),[r,i]=(0,Nc.useState)(!1),a=async s=>{let l=Qs(".maxai-ai-message__image__content__box img",s.currentTarget);if(l?.src){i(!0);try{let p=new Image;await new Promise(c=>{let u=async m=>{if(m){let d=new ClipboardItem({"image/png":m});navigator.clipboard.write([d]).then(function(){c(!0)}).catch(function(f){c(!1)})}else c(!1)};try{let m=new URL(l.src);p.src=m.href+"&#",p.crossOrigin="anonymous",p.onload=()=>{let d=document.createElement("canvas");d.width=p.naturalWidth,d.height=p.naturalHeight;let f=d.getContext("2d");f&&(f.drawImage(p,0,0),d.toBlob(u))},p.onerror=async()=>{let d=await el.proxyFetch(l.src,{method:"GET",parse:"blob",blobContentType:"image/png"});if(d?.data){let f=d.data;await u(f)}else c(!1)}}catch{c(!1)}})}catch{}finally{i(!1)}}};return Nc.default.createElement(se,{title:n("package__common:copy_image"),disabled:r,onClick:a,...o,sx:{p:"6px",...o.sx}},Nc.default.createElement(G,{icon:r?"Loading":"Copy",sx:{fontSize:"20px"}}))},C8=pB;var Fo=I(E()),y8=[Ox,Dx,Bx,Pp],cB=(e,t)=>t==="free_chat"?y8:y8.filter(o=>o.value!==e),uB=e=>{let{message:t}=e,{isLastMessage:o}=Xe(),{conversation:n}=_i(),[r,i]=(0,Fo.useState)(!1),a=t.originalMessage?.metadata?.AIModel||"",s=t.originalMessage?.metadata?.chatMode,l=(0,Fo.useMemo)(()=>n?.type!=="Chat"||!o||!r?null:{suggestions:cB(a,s)},[t.messageId,n?.type,o,a,s,r]);return(0,Fo.useEffect)(()=>{n?.lastMessageId&&n.id?ss(n.id).then(p=>{p.lastRunActions.length>0?i(!0):i(!1)}):i(!1)},[n?.lastMessageId,n?.id]),l?Fo.default.createElement(mB,{suggestionAIModels:l.suggestions}):null},mB=e=>{let{t}=k(),{conversationId:o,conversationType:n}=ie(),{switchConversationModel:r}=ot(),i=fe(o),{suggestionAIModels:a}=e,s=a[a.length-1],l=mn.use.setChatAIModelAndProvider(),{isPayingUser:p}=_t(),{chatMode:c,updateChatMode:u}=Da(),[m,d]=(0,Fo.useState)(!1),f=async _=>{try{if(!o||!_)return;if(c!=="pro_chat")if(p)await u("pro_chat");else{d(!0);return}let{lastRunActionsParams:x,lastRunActions:C}=await ss(o);l({AIProvider:_.AIProvider,AIModel:_.value}),await r(n,_.AIProvider,_.value);let{setShortcuts:y,runShortcuts:b}=um(o);y(C),await b(x)}catch{}finally{}},h=(0,Fo.useMemo)(()=>a.map(_=>({value:_.value,label:_.title,icon:Fo.default.createElement(Mn,{model:_.value})})),[a]);return h.length===0?null:Fo.default.createElement(Fo.default.Fragment,null,Fo.default.createElement(se,{disabled:i,placement:"top-start",options:h,testid:"maxai--chat-message--compare-answers",sx:{p:"6px"},OptionsCardProps:{sx:{width:"240px"},title:t("package__features:chat__chat_message_tools__compare_answers__title")},onSelectOption:_=>{let x=a.find(C=>C.value===_);x&&f(x)},defaultOptionValue:s.value,autoClosePopoverOnSelectDefaultOption:!0},Fo.default.createElement(Mn,{model:s.value})),Fo.default.createElement(Tt,{trigger:m,placement:"top-start",anchorElementSelectors:'[data-testid="maxai--chat-pro-chat-switch"]',onClose:()=>{d(!1)},ctaButtonText:t("package__features:onboarding__onboarding_popover__cta_button__try_it"),onCTAButtonClick:async()=>{await u("pro_chat")}},Fo.default.createElement(g,{spacing:.5},Fo.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},"Pro chat"),Fo.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},t("package__features:onboarding__onboarding_popover__pro_chat__compare_models__description",{NAME:"Pro chat"})))))},b8=uB;var Ms=I(E()),dB=e=>{let{message:t}=e,{t:o}=k(),{isLastMessage:n}=Xe(),r=t.conversationId||"",i=fe(r),{regenerate:a}=ke(),[s,l]=(0,Ms.useState)(!1);return(0,Ms.useEffect)(()=>{n&&ss(r).then(({lastRunActions:c})=>{l(c.length>0)})},[n]),n&&s?Ms.default.createElement(se,{placement:"top",disabled:i,title:o("package__features:chat__ai_message__tools__regenerate_button"),onClick:()=>a(r),testid:"sidebar_actions__regenerate",sx:{p:"6px"}},Ms.default.createElement(G,{sx:{fontSize:"20px"},icon:"Regenerate"})):null},I8=dB;var S8=I(e2()),v8=async(e,t=!1)=>{if(e&&e?.title){let o=await Qu(e,t),n=new Blob([o],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`MaxAI_Chat_${(0,S8.default)().format("YYYY_MM_DD_HH:mm")}.txt`,i.click(),URL.revokeObjectURL(r)}};var Le=I(E()),fB=e=>`${Nn}/share?id=${e}`,hB=()=>{let{t:e}=k(),{conversation:t,updateConversation:o,getConversation:n}=_i(),r=t?.share?.id,[i,a]=(0,Le.useState)(!1),[s,l]=(0,Le.useState)(!1),p=t?.share?.enable===!0,c=(0,Le.useRef)(null),[u,m]=(0,Le.useState)(!1),d=(0,Le.useMemo)(()=>[{value:"download",icon:Le.default.createElement(G,{icon:"FileDownload"}),label:e("package__features:chat__ai_message__tools__download_this_chat")},{value:"share",icon:Le.default.createElement(G,{icon:p?"IosShare":"Lock"}),label:e("package__features:chat__ai_message__tools__share_this_chat")}],[e,p]),f=(x=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{Ni.error(x,{anchorOrigin:{vertical:"top",horizontal:"center"}})},h=async()=>{if(!t?.id)return;let x="";if(r)m(!0),p||await _(!0),x=r;else try{if(!x){l(!0);let y=await n(t.id);if(!y){f();return}await Yo.getService().checkUpdate(t.id),await Jn.getService().checkUpdate(t.id);let b=(await Yo.getService().shareConversation(y.id,!0))?.share;b?.id&&b.enable&&(x=b.id,await o(y.id,{share:{enable:!0,id:b.id}}))}}catch{f()}finally{m(!0),l(!1)}let C=fB(x);navigator.clipboard.writeText(C)},_=async x=>{if(t?.id)try{a(!0);let C=(await Yo.getService().shareConversation(t.id,x))?.share;C?.id?await o(t.id,{share:{enable:C.enable,id:C.id}}):f()}catch{f()}finally{a(!1)}};return Le.default.createElement(Le.default.Fragment,null,Le.default.createElement(se,{placement:"top-start",buttonRefBind:x=>{c.current=x},loading:s,defaultOptionValue:"share",options:d,onSelectOption:async x=>{x==="download"&&await v8(t),x==="share"&&await h()},testid:"maxai--conversation--share-button",sx:{width:"max-content",height:32,p:"6px",gap:"4px"},OptionsCardProps:{sx:{width:"max-content",minWidth:200}}},Le.default.createElement(G,{icon:p?"IosShare":"Lock"}),Le.default.createElement(T,{noWrap:!0,fontSize:"14px",lineHeight:"21px",fontWeight:500,component:"div"},e("package__features:chat__navbar__conversation_share__share_button__title"))),Le.default.createElement(Su,{open:u,anchorEl:c.current,onClose:()=>{m(!1)},anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},Le.default.createElement(g,{sx:{borderBottom:"8px solid transparent"}},Le.default.createElement(zn,{sx:{py:1,px:2,width:"320px",boxSizing:"border-box",display:"flex",flexDirection:"column",gap:1,border:"1px solid",borderColor:"border.main",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03);0px 12px 16px -4px rgba(16, 24, 40, 0.08);"}},Le.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),Le.default.createElement(g,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},Le.default.createElement(de,{"data-testid":"maxai--conversation--share-private-button",disabled:i,onClick:async()=>{await _(!1)}},Le.default.createElement(g,{width:"100%"},Le.default.createElement(g,{direction:"row",alignItems:"center",gap:1},i?Le.default.createElement(Lt,{size:16}):Le.default.createElement(G,{icon:"Lock",sx:{fontSize:"16px"}}),Le.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!p&&Le.default.createElement(G,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Le.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),Le.default.createElement(de,{disabled:i,onClick:async()=>{await _(!0)}},Le.default.createElement(g,{width:"100%"},Le.default.createElement(g,{direction:"row",alignItems:"center",gap:1},i?Le.default.createElement(Lt,{size:16}):Le.default.createElement(G,{icon:"Share",sx:{fontSize:"16px"}}),Le.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),p&&Le.default.createElement(G,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Le.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),p&&Le.default.createElement(g,{direction:"row",alignItems:"center",gap:1},Le.default.createElement(G,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),Le.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip")))))))},T8=hB;var cr=I(E());var gB=e=>{let{message:t,onCopy:o}=e,{t:n}=k(),r=he(f=>f.chatDocuments),i=(0,cr.useRef)(null),[a,s]=(0,cr.useState)(""),l=async f=>{let h=i.current;if(!h)return;let _=Qs('.markdown-body[data-testid="chat-ai-message--markdown"]',h);_&&(Zu(t,_,r),m(f))},p=async f=>{let h=zp(t,!0,r),_=await gf().use(pp).process(h);navigator.clipboard.writeText(_.toString()),m(f)},c=async f=>{let h=zp(t,!0,r);navigator.clipboard.writeText(h),m(f)},u=(0,cr.useRef)(),m=f=>{clearTimeout(u.current),o?.(),s(f),u.current=setTimeout(()=>{s("")},1e3)},d=(0,cr.useMemo)(()=>[{value:"copy_with_formatting",testid:"ai-message-tools__copy-with-formatting",icon:cr.default.createElement(G,{icon:a==="copy_with_formatting"?"Check":"CopyWithFormatting",sx:{fontSize:"20px"}}),title:n(a==="copy_with_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy_with_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_without_formatting",testid:"ai-message-tools__copy-without-formatting",icon:cr.default.createElement(G,{icon:a==="copy_without_formatting"?"Check":"CopyWithoutFormatting",sx:{fontSize:"20px"}}),title:n(a==="copy_without_formatting"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy_without_formatting"),ButtonProps:{tooltipProps:{placement:"left"}}},{value:"copy_as_plain_text",testid:"ai-message-tools__copy-as-plain-text",icon:cr.default.createElement(G,{icon:a==="copy_as_plain_text"?"Check":"CopyTextOnly",sx:{fontSize:"20px"}}),title:n(a==="copy_as_plain_text"?"package__common:copied":"package__common:copy_to_clipboard"),label:n("package__common:copy"),ButtonProps:{tooltipProps:{placement:"left"}}}],[n,a]);return cr.default.createElement(se,{placement:"top-start",defaultOptionValue:"copy_as_plain_text",testid:"ai-message-tools__hover-to-copy",options:d,buttonRefBind:f=>{i.current=f},disabledOnSelectOptionAutoClosePopup:!0,onClick:()=>{c("copy_as_plain_text")},onSelectOption:f=>{f==="copy_with_formatting"&&l("copy_with_formatting"),f==="copy_without_formatting"&&p("copy_without_formatting"),f==="copy_as_plain_text"&&c("copy_as_plain_text")},sx:{p:"6px"},OptionsCardProps:{sx:{width:"max-content",minWidth:"240px"}}},cr.default.createElement(G,{icon:"CopyTextOnly",sx:{fontSize:"20px"}}))},w8=gB;var xB=e=>{let{message:t,...o}=e,{AIMessage:n}=E6(),{renderTools:r}=n||{},{conversationId:i,variant:a}=Yt(),s=fe(i),l=t.originalMessage?.content?.contentType||"text",p=Fn.default.useRef(null),c=t.originalMessage?.metadata?.navMetadata?.key==="transcript"||t.originalMessage?.metadata?.videoTranscripts?.length||t.originalMessage?.metadata?.videoTimestamped?.length,u=a==="normal"&&l==="text"&&!c,{setUsePromptOpen:m,usePromptOpen:d,isLastMessage:f}=(0,Fn.useContext)(Wd),h={shareConversationButton:f&&Fn.default.createElement(T8,null),imageCopyButton:l==="image"&&Fn.default.createElement(C8,{message:t}),textCopyButton:l==="text"&&Fn.default.createElement(w8,{message:t}),attachmentsDownloadButton:t&&Fn.default.createElement(_8,{message:t}),usePromptButton:u&&Fn.default.createElement(h8,{disabled:s,message:t,open:d,onOpenChange:m,iconButton:!0,className:"max-ai__actions__button--use-max-ai",sx:{color:x=>x.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"}}),regenerateButton:a==="normal"&&Fn.default.createElement(I8,{message:t}),modelSuggestions:a==="normal"&&Fn.default.createElement(b8,{message:t}),divider:Fn.default.createElement(Ct,{sx:{minWidth:"1px",maxWidth:"1px",minHeight:"14px",maxHeight:"14px"},orientation:"vertical"})},_=r?r(h,t,{isLastMessage:f}):Fn.default.createElement(Fn.default.Fragment,null,h.shareConversationButton,h.imageCopyButton,h.textCopyButton,h.attachmentsDownloadButton,h.usePromptButton,h.regenerateButton,h.modelSuggestions);return Fn.default.createElement(g,{direction:"row",alignItems:"center",spacing:1,ref:p,...o,sx:{position:"relative",marginTop:"8px!important",...o.sx}},_)},M8=xB;var E8=I(Uu());var Se=I(E());function _B(e){return typeof e=="string"?e.split(","):Array.isArray(e)&&typeof e[0]=="string"?e:[]}var zc={px:1,borderRadius:"8px",height:"25px",display:"flex",alignItems:"center",border:"0px",bgcolor:e=>e.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)"},CB=({copilotType:e,copilot:t,messageIsComplete:o})=>{let n=t.steps.findIndex(u=>u.status==="loading"),[r,i]=(0,Se.useState)(),a=(()=>{let u=n===-1?t.steps:t.steps.slice(0,n+1);return e==="art"&&(u=u.map(m=>m.title==="Optimizing art prompt"||m.title==="Generating art"?{...m,value:void 0}:m)),u})(),s=(0,Se.useMemo)(()=>a.some(u=>u.status==="loading"),[a]),l=typeof r>"u"?s:r,p=u=>u?m=>m.palette.mode==="dark"?"#fff":"#000":m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.38)",c=(u,m)=>!(a.length-1!==m&&u.status==="complete");return Se.default.createElement(g,{direction:"column",spacing:1,sx:{border:u=>u.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.16)":"1px solid rgba(0, 0, 0, 0.08)",padding:"8px 10px",borderRadius:"8px"}},t.title&&Se.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{userSelect:"none","&:hover":{cursor:"pointer"}},onClick:()=>i(!l)},Se.default.createElement(Mi,{title:t.title}),Se.default.createElement(E8.default,{sx:{transform:l?"rotate(180deg)":"rotate(0deg)",fontSize:"24px",transition:"all 0.2s"}})),l&&Se.default.createElement(Se.default.Fragment,null,Se.default.createElement(Ct,{sx:{borderColor:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),a.map((u,m)=>Se.default.createElement(g,{spacing:.5,key:u.title},Se.default.createElement(g,{spacing:1,direction:"row",alignItems:"center"},Se.default.createElement(g,{alignItems:"center",justifyContent:"center",width:16,height:16},!o&&u.status==="loading"?Se.default.createElement(Lt,{size:16,sx:{color:p(!0)}}):Se.default.createElement(G,{sx:{color:p(!1),fontSize:20},icon:"CheckCircle"})),Se.default.createElement(T,{fontSize:14,fontWeight:500,color:p(!o&&u.status==="loading"),noWrap:!0,sx:{p:0,pl:"6px"}},u.title)),(u.value||!c(u,m))&&Se.default.createElement(g,{direction:"row"},Se.default.createElement(B,{sx:{minHeight:"14px",marginLeft:"7px",width:"2px",borderRadius:"2px",bgcolor:d=>c(u,m)?"transparent":d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),u.value&&Se.default.createElement(g,{spacing:1,direction:"row",alignItems:"center",sx:{flex:"1!important"}},Se.default.createElement(g,{alignItems:"center",justifyContent:"center",width:16,height:16}),(u.valueType==="text"||u.valueType===void 0)&&Se.default.createElement(Zn,{variant:"outlined",sx:zc},Se.default.createElement(xe,{title:String(u.value)},Se.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,maxWidth:256},String(u.value)))),u.valueType==="tags"&&Se.default.createElement(g,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",sx:{flex:"1!important"}},_B(u.value).map((d,f)=>Se.default.createElement(Zn,{key:d+f,variant:"outlined",sx:zc},Se.default.createElement(xe,{title:d},Se.default.createElement(T,{noWrap:!0,maxWidth:160,fontSize:14,color:h=>h.palette.mode==="dark"?"rgba(255, 255, 255, 0.7)":"rgba(0, 0, 0, 0.6)"},d))))),u.valueType==="source"&&Se.default.createElement(yB,{sources:u.value})))))))},yB=({sources:e})=>{let{t}=k(),[o,n]=(0,Se.useState)(!1),r=(0,Se.useMemo)(()=>o?e:e.slice(0,3),[o]);return Se.default.createElement(g,{gap:1,direction:"row",alignItems:"center",flexWrap:"wrap",width:0,sx:{flex:"1!important"}},r.map((i,a)=>Se.default.createElement(Zn,{key:`${i.title}-${a}`,variant:"outlined",sx:{...zc,"&:hover":{background:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},Se.default.createElement(tm,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",engine:"",...i}}},Se.default.createElement(fi,{href:i.url,target:"_blank",underline:"none",maxWidth:200},Se.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Se.default.createElement(B,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},Se.default.createElement("img",{src:i.favicon||br(i.url),alt:i?.from,width:"100%",height:"100%"})),Se.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},i?.from)))))),e.length>3&&!o&&Se.default.createElement(Zn,{variant:"outlined",sx:{...zc,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>n(!0)},Se.default.createElement(g,{height:"100%",direction:"row",alignItems:"center",spacing:.5},Se.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},`+ ${e.length-3} ${t("package__features:chat__ai_message__sources__more")}`))),e.length>3&&o&&Se.default.createElement(Zn,{variant:"outlined",sx:{...zc,"&:hover":{background:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)",cursor:"pointer"}},onClick:()=>n(!1)},Se.default.createElement(g,{height:"100%",direction:"row",alignItems:"center",spacing:.5,color:"text.secondary"},Se.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},t("package__features:chat__ai_message__sources__hide")))))},A8=CB;var We=I(E());var P8=I(Sr());var Qt=I(E()),Sf=(e=1)=>({overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":String(e)}),bB=({searchResult:e,searchResultIndex:t,key:o})=>Qt.default.createElement(Zn,{key:o,sx:{marginBottom:"16px",borderRadius:"8px",border:"1px solid",backgroundColor:"initial",boxShadow:"initial",borderColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)","&:hover":{cursor:"pointer",bgcolor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}}},Qt.default.createElement(L2,null,Qt.default.createElement(fi,{href:e.url,target:"_blank",underline:"none"},Qt.default.createElement(g,{sx:{gap:"6px",p:"16px"}},Qt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{gap:"16px"}},Qt.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"500",lineHeight:"24px",height:"24px",color:"text.primary",...Sf()}},e.title)),Qt.default.createElement(g,{sx:{flexDirection:"row",alignItems:"center",gap:"4px"}},Qt.default.createElement(B,{component:"img",src:br(e.redirectedUrl||e.url),alt:e.from,sx:{width:"16px",height:"16px",borderRadius:"50%",objectFit:"cover",objectPosition:"center",border:"1px solid",borderColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}),Qt.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary",...Sf()}},e.from),Qt.default.createElement(T,{sx:{fontSize:"12px",fontWeight:"500",lineHeight:"18px",color:"text.secondary"}},"\xB7 ",t+1)),Qt.default.createElement(T,{sx:{fontSize:"14px",fontWeight:"400",lineHeight:"21px",color:"text.secondary",...Sf(4)}},e.body))))),IB=({open:e,onClose:t,searchResults:o,metadataTitle:n})=>{let r=(0,Qt.useMemo)(()=>!ui(),[]),{t:i}=k();return Qt.default.createElement(ll,{anchor:r?"right":"bottom",disableScrollLock:!0,disableEnforceFocus:!0,open:e,onClose:t,sx:{zIndex:1502,position:r?"fixed":"absolute",[`& .${sl.paper}`]:{position:"absolute",borderRadius:r?"16px 0 0 16px":"16px 16px 0 0",minHeight:"80vh",maxHeight:r?"100vh":"80vh",bgcolor:"background.paper",backgroundImage:"unset"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},Qt.default.createElement(g,{sx:{maxWidth:r?"520px":"100%",height:"100%",overflow:"hidden",borderRadius:"16px, 16px, 0px, 0px"}},Qt.default.createElement(g,{sx:{p:"16px",position:"relative"}},Qt.default.createElement(T,{sx:{fontSize:"24px",fontWeight:"700",lineHeight:"34px"}},`${o.length} ${i("package__features:chat__ai_message__sources__modal__title")}`),Qt.default.createElement(T,{sx:{fontSize:"16px",fontWeight:"400",lineHeight:"24px",color:"text.secondary",...Sf()}},n?.title),Qt.default.createElement(Re,{onClick:t,sx:{position:"absolute",top:"12px",right:"12px"}},Qt.default.createElement(P8.default,{sx:{fontSize:24}}))),Qt.default.createElement(Ct,null),Qt.default.createElement(B,{sx:{flex:1,height:"0px",p:"16px",pd:0,overflowY:"auto"}},o.map((a,s)=>Qt.default.createElement(bB,{key:s,searchResult:a,searchResultIndex:s})))))},k8=IB;var SB=e=>{let t=Ca(),{searchResults:o,loading:n}=e,[r,i]=(0,We.useState)(!1),a=(0,We.useMemo)(()=>t==="xs"||t==="sm"?6:t==="md"?4:t==="lg"||t==="xl"?3:6,[t]),s=(0,We.useMemo)(()=>12/a,[a]),l=(0,We.useMemo)(()=>o.length>s?o.slice(0,s-1):o,[r,o]),p=(0,We.useMemo)(()=>o.length>s?o.slice(s-1).map(u=>br(u.redirectedUrl||u.url)).filter(Boolean):[],[r,o,s]),{t:c}=k();return We.default.createElement(We.default.Fragment,null,We.default.createElement(Vr,{container:!0,spacing:1,sx:{ml:"-8px!important"}},n?Array(6).fill("").map((u,m)=>We.default.createElement(Vr,{item:!0,xs:a,key:m},We.default.createElement(fo,{variant:"rounded",width:"100%",height:60}))):We.default.createElement(We.default.Fragment,null,l.map((u,m)=>We.default.createElement(Vr,{item:!0,xs:a,key:m,className:"sourceGrid"},We.default.createElement(tm,{citation:{content:"",search_result_index:1,source:{doc_id:"",type:"search_results",...u,from:u?.from||"",engine:u?.engine||"",searchQuery:u?.searchQuery||""}}},We.default.createElement(Zn,{variant:"outlined",sx:{backgroundColor:d=>d.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{background:d=>d.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},We.default.createElement(fi,{href:u.url,target:"_blank",underline:"none"},We.default.createElement(g,{p:1,spacing:.5,className:"test"},We.default.createElement(T,{fontSize:14,color:"text.primary",noWrap:!0,sx:{p:0}},u.title),We.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},We.default.createElement(B,{width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},We.default.createElement("img",{src:br(u.url),alt:u?.from,width:"100%",height:"100%"})),We.default.createElement(T,{fontSize:12,color:"text.secondary",noWrap:!0},u?.from),We.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},"\xB7 ",m+1)))))))),o.length>s&&We.default.createElement(Vr,{item:!0,xs:a,onClick:()=>{i(!0)}},We.default.createElement(Zn,{variant:"outlined",sx:{backgroundColor:u=>u.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",borderRadius:"8px",border:"0px","&:hover":{cursor:"pointer",background:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.16)":"rgba(0, 0, 0, 0.08)"}}},We.default.createElement(g,{p:1,spacing:1},We.default.createElement(g,{direction:"row",spacing:1},p.map((u,m)=>We.default.createElement(B,{key:m+(u||""),width:16,height:16,borderRadius:"50%",overflow:"hidden",flexShrink:0},We.default.createElement("img",{src:u,width:"100%",height:"100%"})))),We.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},We.default.createElement(T,{fontSize:12,color:"text.secondary",flexShrink:0},c("package__features:chat__ai_message__sources__view")," ",p.length," ",c("package__features:chat__ai_message__sources__more")))))))),We.default.createElement(k8,{open:r,onClose:()=>i(!1),searchResults:o,metadataTitle:e.metadataTitle}))},L8=SB;var vB={whiteSpace:"pre-wrap",width:"100%",boxSizing:"border-box",wordBreak:"break-word",color:"text.primary"},TB=e=>{let{message:t,order:o,loading:n=!1,hasError:r}=e,{t:i}=k(),{content:a,metadata:s,isAutoHideTools:l,isLoading:p}=Xe(),[c,u]=Ne.default.useState(!1);(0,Ne.useEffect)(()=>{if(a.status==="complete"){let S=setTimeout(()=>{u(!0)},MC);return()=>clearTimeout(S)}else u(!1)},[a.status]);let m=a.status==="complete"?c:a.status===void 0?!p:!1,d=(a.status==="complete"?c:!0)&&!r&&s?.nextActions,{copilotComplete:f,searchImages:h,searchVideos:_,knowledgePanels:x}=(0,Ne.useMemo)(()=>{let S=s.copilot?s.copilot.steps.every(L=>L.status==="complete"):!0,M=[],P=[],O=[];return s.searchResults?.forEach(L=>{L.images&&M.push(...L.images),L.videos&&P.push(...L.videos),L.knowledgePanel&&O.push(L.knowledgePanel)}),{copilotComplete:S,searchImages:M,searchVideos:P,knowledgePanels:O}},[s]),C=s.includeHistory===!1,y=s.isTriggeredContentReview===!0,[b,v]=(0,Ne.useState)(!1);return Ne.default.createElement(B,{component:"div",className:"chat-message chat-message--AI",sx:{[`& .${Ud}`]:{opacity:l&&!b?0:1},"&:hover":{[`& .${Ud}`]:{opacity:1}}},onMouseEnter:()=>{v(!0)},onMouseLeave:()=>{v(!1)}},C&&!y&&o!==1&&Ne.default.createElement(jd,{message:t}),Ne.default.createElement(g,{className:"chat-message--text",sx:vB},Ne.default.createElement(g,{spacing:3},Ne.default.createElement(_f,{message:t}),!r&&s.title&&Ne.default.createElement(Mi,{title:s.title,fontSx:{fontWeight:"700",fontSize:"24px",color:"text.primary",whiteSpace:s.shareType==="search"||s.shareType==="art"?"":"nowrap",textOverflow:"ellipsis",overflow:"hidden"}}),!r&&s.copilot&&Ne.default.createElement(A8,{copilotType:s.shareType,copilot:s.copilot,messageIsComplete:!!s.isComplete}),!r&&f&&s.searchResults&&s.searchResults.length>0&&Ne.default.createElement(g,{spacing:1,marginBottom:"8px !important"},Ne.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},Ne.default.createElement(Ep,{icon:"CaptivePortal",sx:{fontSize:"18px"}}),Ne.default.createElement(T,{fontSize:"18px"},"Sources")),Ne.default.createElement(L8,{metadataTitle:s.title,searchResults:s.searchResults,loading:!1})),f&&a.title?.title!=="noneShowContent"&&Ne.default.createElement(g,{spacing:2},s.chatMode?Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement(s0,{message:t,loading:n}),Ne.default.createElement(gg,{message:t}),Ne.default.createElement(_g,{message:t,hasError:r})):Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement(gg,{message:t}),Ne.default.createElement(s0,{message:t,loading:n}),!r&&(h.length>0||_.length>0||x.length>0)&&Ne.default.createElement(d8,{message:t,images:h,videos:_,knowledgePanels:x,loading:n}),Ne.default.createElement(_g,{message:t,hasError:r}))),!p||m?Ne.default.createElement(M8,{className:Ud,message:t}):Ne.default.createElement(B,{height:"16px"}),s.nextActions&&d&&Ne.default.createElement(XS,{nextActions:s.nextActions,nextActionsStatus:s.nextActionsStatus}))),y&&s.isComplete&&o!==1&&Ne.default.createElement(Ct,{sx:{mt:2}},Ne.default.createElement(T,{color:"text.secondary",fontSize:"12px"},i("package__features:chat__ai_message__context_triggered_content_review"))))},O8=TB;var wB=e=>c0.default.createElement(Gd,{...e},c0.default.createElement(O8,{...e})),B8=Jl(wB);var At=I(E());var Rc=I(E());var Es=I(E()),MB=e=>{let{message:t}=e,{t:o}=k(),n=t.conversationId||"",r=Uo(n),i=t?.messageId===r?.lastMessageId,a=fe(n),{regenerate:s}=ke(),[l,p]=(0,Es.useState)(!1);return(0,Es.useEffect)(()=>{i&&ss(n).then(({lastRunActions:u})=>{p(u.length>0)})},[i]),i&&l?Es.default.createElement(se,{placement:"top",disabled:a,title:o("package__features:chat__ai_message__tools__regenerate_button"),onClick:()=>s(n),testid:"sidebar_actions__regenerate",sx:{p:"6px"}},Es.default.createElement(G,{sx:{fontSize:"20px"},icon:"Regenerate"})):null},D8=MB;var EB=e=>{let{message:t}=e,{conversationId:o,variant:n}=Yt(),r=un(o),i=mi(r),a=t.meta?.systemMessageType||t.extra?.systemMessageType||"normal",s=t.meta?.status||t.extra?.status||"success",l=(0,Rc.useMemo)(()=>t.type==="system"&&s==="error"&&i?.messageId===t.messageId?!0:s!=="success"&&a==="normal"&&i?.messageId===t.messageId&&t.parentMessageId,[t.type,t.parentMessageId,t.messageId,i?.messageId,s,a]);return Rc.default.createElement(g,{direction:"row",alignItems:"center",flexWrap:"wrap",gap:1,className:"chat-system--message-tools"},n==="chatHub"||!l?null:Rc.default.createElement(D8,{message:t}))},u0=EB;var AB=At.default.lazy(()=>import("./XDISRLTC.js")),PB=e=>{let{message:t,loading:o,sx:n}=e,{isDarkMode:r}=Wn(),i=St(),a=t?.extra?.systemMessageType==="needUpgrade"||t?.meta?.systemMessageType==="needUpgrade",s=t.meta.chatMode,l=t.meta.paywallData,p=t.meta?.AIModel||t.originalMessage?.metadata?.AIModel,c=(0,At.useMemo)(()=>wr(t,!1),[t]),u=(0,At.useMemo)(()=>a?{width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",gap:1,"& > div[data-permission-scene-type]":{mb:1}}:{whiteSpace:"pre-wrap",width:"100%",wordBreak:"break-word",borderRadius:"8px",bgcolor:"background.paper"},[a]),m=(0,At.useMemo)(()=>i?.id==="USE_CHAT_GPT_AI_ROOT_Context_Menu_Portal",[i]),d=()=>p?s==="free_chat"?At.default.createElement(Yi,null):At.default.createElement(tp,{AIProvider:Vo(void 0,p,{fallback:!1,checkValid:!0})?.AIProvider,AIModel:p}):At.default.createElement(Yi,null);return At.default.createElement(g,{className:"chat-message chat-message--text",gap:1,sx:{boxSizing:"border-box",...u,...n}},a&&l?At.default.createElement(At.default.Fragment,null,m?null:d(),At.default.createElement(EC,{paywallData:l}),At.default.createElement(u0,{message:t,loading:o})):At.default.createElement(At.default.Fragment,null,d(),At.default.createElement(y2,{severity:t?.meta?.status||"info",sx:{p:1,[`& .${C2.message}`]:{p:0,width:"100%"},"& > div:first-of-type":{display:"none"},"& .markdown-body":{"& > p:first-of-type":{mt:0}}},icon:At.default.createElement(At.default.Fragment,null)},At.default.createElement(B,null,At.default.createElement(g,{direction:"row",alignItems:"flex-start",spacing:1.5,mb:2},At.default.createElement("div",{className:`markdown-body ${r?"markdown-body-dark":""}`},At.default.createElement(At.Suspense,{fallback:At.default.createElement(En,{sx:{my:0},loading:!0})},At.default.createElement(AB,{message:t},c)))))),At.default.createElement(u0,{message:t,loading:o})))},vf=Jl(PB);var dp=I(E()),kB=e=>{let{chatDocument:t,size:o=20}=e,n="";return t.maxAIDocumentType==="image"?n=t.link||t.preUploadMetadata?.previewIcon||"":t.maxAIDocumentType&&["page_content__webpage","page_content__email","page_content__youtube"].includes(t.maxAIDocumentType)?n=t.link?br(t.link):t.preUploadMetadata?.previewIcon||"":n=t.preUploadMetadata?.previewIcon||"",t.status==="uploading"||t.status==="downloading"?dp.default.createElement(B,{sx:{display:"inline-flex",justifyContent:"center",alignItems:"center",padding:"3px",width:o,height:o,borderRadius:"4px",boxSizing:"border-box",overflow:"hidden",bgcolor:r=>r.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)","& > span > svg":{color:"rgba(255, 255, 255, 0.6)"}}},dp.default.createElement(Lt,{size:o-6})):n?dp.default.createElement("img",{style:{borderRadius:"4px",overflow:"hidden",objectFit:"cover",userSelect:"none"},src:n,alt:t.title,width:o,height:o,draggable:!1}):t.maxAIDocumentType==="page_content__webpage"||t.maxAIDocumentType==="page_content__email"||t.maxAIDocumentType==="page_content__youtube"?dp.default.createElement("img",{style:{borderRadius:"4px",overflow:"hidden",objectFit:"cover",userSelect:"none"},src:br(t.link||"",32),alt:t.title,width:o,height:o,draggable:!1}):dp.default.createElement($_,{size:o,documentType:t.maxAIDocumentType||"chat_file",chatDocument:t})},Tf=kB;var H8=I(E()),LB=e=>{let{variant:t="primary",size:o="medium",sx:n,...r}=e;return H8.default.createElement(Au,{size:o,sx:{borderRadius:"4px",fontSize:"12px",padding:"2px 4px","& > span":{padding:0},...o==="medium"&&{height:"22px"},...t==="third"&&{padding:"2px 8px",fontSize:"14px",fontWeight:500,lineHeight:"20px",bgcolor:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.38)"},...n},...r})},wf=LB;var m0=I(Ef());var ur=I(E()),FB=e=>{let t=()=>{n||c?.()},{mode:o="normal",disabled:n,icon:r,showClose:i,text:a,tags:s,dataTestId:l,sx:p,onClick:c,onClose:u}=e;return o==="image"?ur.default.createElement(g,{onClick:t,sx:{width:"32px",height:"32px",boxSizing:"border-box",position:"relative",borderRadius:"8px",cursor:"pointer",...n&&{pointerEvents:"none",opacity:.5},"&:hover":{"& > div:last-of-type":{display:"flex"}},...p},direction:"row",alignItems:"center","data-testid":l,"data-button-clicked-name":l},ur.default.createElement(B,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"8px",border:"1px solid",borderColor:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}}),r&&ur.default.createElement(g,{sx:{height:"32px",flexShrink:0,borderRadius:"9px",overflow:"hidden","& > svg":{width:"32px",height:"32px",fontSize:"32px",userSelect:"none"},"& > img":{width:"32px",height:"32px",userSelect:"none"}}},r),i&&ur.default.createElement(B,{component:"div",onClick:m=>{m.stopPropagation(),u&&u()},"data-button-clicked-name":l+"--close-button","data-testid":l+"--close-button",sx:{position:"absolute",right:"-8px",top:"-8px",width:"16px",height:"16px",display:"none",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"}},ur.default.createElement(m0.default,{sx:{fontSize:"16px"}}))):ur.default.createElement(g,{onClick:t,sx:{height:"32px",boxSizing:"border-box",position:"relative",borderRadius:"8px",border:"1px solid",borderColor:"border.main",maxWidth:"184px",padding:"4px",gap:"8px",cursor:"pointer","&:hover":{"& > div:last-of-type":{display:"flex"},background:m=>m.palette.mode==="dark"?"#343434":"rgba(0, 0, 0, 0.04)"},...n&&{pointerEvents:"none",opacity:.5},...p},direction:"row",alignItems:"center","data-testid":l,"data-button-clicked-name":l},r&&ur.default.createElement(g,{sx:{height:"24px",flexShrink:0,borderRadius:"5px",overflow:"hidden","& > svg":{width:"24px",height:"24px",fontSize:"24px"},"& > img":{width:"24px",height:"24px"}}},r),ur.default.createElement(T,{component:"div",fontSize:"14px",color:"text.primary",textAlign:"left",noWrap:!0},a),s&&ur.default.createElement(g,{sx:{display:"flex",flexWrap:"wrap",gap:"4px"}},s.map(m=>ur.default.createElement(wf,{key:m,sx:{color:"text.secondary"},label:m}))),i&&ur.default.createElement(B,{component:"div",onClick:m=>{m.stopPropagation(),u&&u()},"data-button-clicked-name":l+"--close-button","data-testid":l+"--close-button",sx:{position:"absolute",right:"-8px",top:"-8px",width:"16px",height:"16px",display:"none",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:m=>m.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"}},ur.default.createElement(m0.default,{sx:{fontSize:"16px"}})))},N8=FB;var ei=I(E()),HB=e=>{let{t}=k(),{dataTestId:o,chatDocument:n,onClick:r,showClose:i,onClose:a,disabled:s}=e,l=n.maxAIDocumentId,p=n.status,c=n.link===window.location.href,{downloadDocument:u,document:m}=am(l),d=!!m,f=()=>{if(r)return r();n.maxAIDocumentId&&!ls(n.maxAIDocumentId)&&!c&&((n.maxAIDocumentType==="page_content__webpage"||n.maxAIDocumentType==="page_content__email")&&n.link?eh.previewWebpage(n.link,{title:n.title||"Chat file",url:n.link}):eh.previewDocument(n.maxAIDocumentId,{title:n.title||"Chat file",url:n.link}))};(0,ei.useEffect)(()=>{l&&!ls(l)&&p==="success"&&!d&&u(l)},[l,p,d]);let h=c?[t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title")]:[],_=(0,ei.useMemo)(()=>{let x=n.maxAIDocumentType==="image",C=x?"image":"normal",y=ei.default.createElement(Tf,{size:x?32:24,chatDocument:n}),b=n.title,v=s||n.status==="downloading"||n.status==="uploading"||n.status==="error",S;if(V_(n.maxAIDocumentType)||(v=!0,S={opacity:1,cursor:"not-allowed",pointerEvents:"auto"}),m?.doc_type)switch(m.doc_type){case"search_results":try{let M=R_(m,m.doc_type),P=M?.sources?.length||0,O=(M?.sources?.map(L=>rs(L.redirectedUrl||L.url)?br(L.redirectedUrl||L.url):L.url)||[]).filter(L=>Du(L));b=t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__web_source__title",{sourcesCount:P}),P===0&&(v=!0),y=ei.default.createElement(NB,{maxCount:3,images:O})}catch{}}return{icon:y,text:b,disabled:v,mode:C,sx:S}},[n,m,s]);return ei.default.createElement(N8,{dataTestId:o,text:_.text,onClick:f,icon:_.icon,disabled:_.disabled,tags:h,showClose:i,onClose:a,mode:_.mode,sx:_.sx})},NB=e=>{let{images:t,maxCount:o=999}=e,n=-8,r=Math.min(o,t.length),i=24*r+n*(r-1);return ei.default.createElement(g,{direction:"row",sx:{width:`${i}px`,height:"24px",position:"relative"}},t.slice(0,r).map((a,s)=>ei.default.createElement(g,{key:s,sx:{position:"absolute",zIndex:1+s,width:"24px",height:"24px",flexShrink:0,border:"1.5px solid",borderColor:"border.main",borderRadius:"12px",overflow:"hidden",boxSizing:"border-box",bgcolor:"background.paper",left:`${s*(24+n)}px`,"& > img":{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}},ei.default.createElement("img",{draggable:!1,alt:"",key:s,src:a}))))},fp=HB;var Vc=I(E()),zB=({message:e})=>{let t=e?.meta?.messageChatDocuments||[];return t.length===0?null:Vc.default.createElement(g,{width:"100%",direction:"column",gap:1},Vc.default.createElement(g,{direction:"row",gap:1,width:"100%",justifyContent:"flex-end",flexWrap:"wrap"},t.map(o=>Vc.default.createElement(RB,{key:o.id||o.maxAIDocumentId,chatDocument:o}))))},RB=e=>{let{chatDocument:t}=e,o=t.maxAIDocumentId?ls(t.maxAIDocumentId):!0;return Vc.default.createElement(fp,{disabled:o,chatDocument:t})},z8=zB;var R8=(e,t)=>{let o=e.indexOf(t);if(o===-1)return"";let n=e.indexOf(`
`,o);return n===-1?"":e.substring(o,n).replace(t,"").trim()},VB=e=>{e.length;let t=e.find(i=>i.name===Oe.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name)?.default_value||"",o=[],n=e.find(i=>i.name===Oe.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name)?.default_value,r=e.find(i=>i.name===Oe.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name)?.default_value||e.find(i=>i.name===Oe.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name)?.default_value||"";if(n&&r)switch(n){case"EMAIL":{let i=R8(r,"**Subject:**");i?o.push(`Email content of "${i}".`):o.push(`Email content of "${r}"`);break}case"SOCIAL_MEDIA":{let i=r.indexOf("**Comment:**");if(i!==-1){let a=r.slice(i).replace("**Comment:**","").trim();o.push(a)}else if(t.includes("youtube.com")){let a=R8(r,"**Post title:**");a&&o.push(`Video content of "${a}".`)}else{let a=r.indexOf("**Post caption/description:**");if(a!==-1){let s=r.slice(a).replace("**Post caption/description:**","").trim();o.push(s)}}break}case"CHAT_APP_WEBSITE":{let i=r.indexOf("**Content:**");if(i!==-1){let a=r.slice(i).replace("**Content:**","").replace(`
+`,`
`).trim();o.push(a)}break}case"UNKNOWN":default:}return o.join(`
`)};function Uc(e=[],t=[]){let o,n=e.find(r=>r.key==="Selected text"||r.key==="Draft"||r.key.endsWith("draft"));return n&&(o=n.value),o||(o=VB(t)),{text:o,userVariables:e.filter(r=>r.key!=="Draft"&&r.key!=="Selected text"&&!r.key.endsWith("draft"))}}var lo=I(E());var UB=Io(({className:e,...t})=>lo.default.createElement(yr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),WB=(0,lo.forwardRef)(function({variable:t,sx:o,container:n,children:r,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:p},c){let[u,m]=(0,lo.useState)(!1),d=(0,lo.useRef)(null);(0,lo.useImperativeHandle)(c,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:n,className:"maxai-variable-tooltip",sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),lo.default.createElement(fa,{onClickAway:_=>{u&&_.target instanceof HTMLElement&&(d.current?.contains(_.target)||d.current===_.target)||m(!1)}},lo.default.createElement(g,{direction:"row",width:"100%",sx:o},lo.default.createElement(UB,{open:u,PopperProps:h,title:lo.default.createElement(g,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},lo.default.createElement(g,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},lo.default.createElement(B,{width:"2px",minWidth:"2px",bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),lo.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},lo.default.createElement(g,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},lo.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),lo.default.createElement(An,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{placement:"top",container:n},copyText:t.value})),p,lo.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},lo.default.createElement(B,{onClick:()=>{m(!u)},sx:l},typeof r=="function"?r({variable:t,open:u}):r))))}),hp=WB;var j8=I(d0());var Pt=I(E()),g0=I(E());var Wc=I(E());var KB=/(\.py|\.ipynb|\.js|\.jsx|\.html|\.css|\.java|\.cs|\.php|\.c|\.cpp|\.cxx|\.h|\.hpp|\.rs|\.R|\.Rmd|\.swift|\.go|\.rb|\.kt|\.kts|\.ts|\.tsx|\.m|\.scala|\.rs|\.dart|\.lua|\.pl|\.pm|\.t|\.sh|\.bash|\.zsh|\.csv|\.log|\.ini|\.config|\.json|\.yaml|\.yml|\.toml|\.lua|\.sql|\.bat|\.md|\.coffee|\.tex|\.latex)/,$B=({filetype:e,filename:t,sx:o})=>(e=e.toLowerCase(),e.endsWith("pdf")?Wc.default.createElement(px,{sx:o}):t.endsWith(".txt")?Wc.default.createElement(cx,{sx:o}):KB.test(t)?Wc.default.createElement(lx,{sx:o}):Wc.default.createElement(ux,{sx:o})),Pf=$B;var V8=I(f0());var st=I(E()),QB={borderRadius:e=>e.spacing(1),border:e=>`1px solid ${e.palette.border.main}`,background:e=>e.palette.background.default,display:"flex",flexDirection:"row",position:"relative",p:1.25,gap:1.5,height:"62px",boxSizing:"border-box",width:"282px",minWidth:"282px",overflow:"hidden"},JB={height:"40px",width:"40px",fontSize:"40px",cursor:"pointer"},U8={fontWeight:500,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"14px"},eD={...U8,color:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},gp=228,h0=200,tD=({message:e})=>{let[t,o]=(0,st.useState)(void 0),[n,r,i]=(0,st.useMemo)(()=>{let m=(e.meta?.attachments||[]).filter(h=>h.uploadStatus==="success"),d=m.filter(h=>h.icon==="image"),f=m.filter(h=>h.icon!=="image");return[d,f.map(h=>({...h,attachmentExtractedContent:O_(h,e)})),m]},[e,e.meta?.attachments]),[a,s]=(0,st.useState)({width:`${gp}px`,height:`${gp/1.5}px`}),l=(0,st.useMemo)(()=>n.length===1?a:n.length>3?{width:"64px",height:"64px"}:{width:"112px",height:"112px"},[n]),p=m=>{if(n.length!==1)return;let{naturalWidth:d,naturalHeight:f}=m,h=d/f;if(h>=1&&h<=1.5){let _=`${gp/1.5}px`,x=`${gp}px`;s({width:x,height:_})}else if(h>1.5){let _=`${gp/2}px`,x=`${gp}px`;s({width:x,height:_})}else if(h<1&&h>=.75){let _=`${h0}px`;s({width:"228px",height:_})}else{let _=`${h0}px`,x=`${h0*.75}px`;s({width:x,height:_})}},c=(0,st.useMemo)(()=>n.map(m=>({src:m.uploadedUrl||m.base64Data||m.blobUrl||"",alt:m.fileName})),[n]),u=(0,st.useRef)(null);if(i.length!==0)return st.default.createElement(g,{width:"100%",direction:"column",gap:1},n.length>0&&st.default.createElement(g,{gap:1,direction:"row",justifyContent:"flex-end",overflow:"auto",width:"100%"},n.map(m=>st.default.createElement(xi,{key:m.id,width:l.width,height:l.height,alt:m.fileName,onLoaded:p,SkeletonSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden"},src:m.uploadedUrl||m.base64Data||m.blobUrl||"",imageSx:{borderRadius:d=>d.spacing(1),width:l.width,height:l.height,overflow:"hidden",objectFit:"cover",cursor:"pointer",border:d=>`1px solid ${d.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0,0,0,0.08)"}`},onImageClick:()=>{o(m.uploadedUrl||m.base64Data||m.blobUrl||"")}}))),st.default.createElement(mp,{images:c,selectedImage:t,setSelectedImage:o}),r.length>0&&st.default.createElement(g,{direction:"column",gap:1,width:"100%",alignItems:"flex-end",ref:u},r.map(m=>st.default.createElement(oD,{key:m.id,file:m,getFilesContainer:()=>u.current}))))},oD=(0,st.memo)(function({file:t,container:o,getFilesContainer:n}){let{t:r}=k(),i=(0,st.useRef)(null),[a,s]=(0,st.useState)(null),[l,p]=(0,st.useState)(360);return st.default.createElement(B,{ref:i,onClick:()=>{let c=n?.()??null;if(i.current&&c){let u=c.getBoundingClientRect(),m=i.current.getBoundingClientRect(),d=m.left+20,f=u.left+u.width/2,h=Math.max(f,d);p(h===f?Math.min(u.width-40,600):Math.max((m.right-m.left-20)*2,140)),s(new DOMRect(h,m.top,1,m.height))}}},st.default.createElement(hp,{variable:{key:t.fileName,value:t.attachmentExtractedContent},anchorElSx:QB,virtualRect:a,sx:{width:"fit-content",cursor:"pointer"},container:o,popperSx:{width:l},descriptionEl:st.default.createElement(g,{direction:"column"},st.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.secondary",noWrap:!0,flexShrink:0},`${Ex(t.fileSize||0)} \u2022 ${t.fileType}`),st.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary",noWrap:!0,flexShrink:0,display:"flex",alignItems:"center",gap:1},st.default.createElement(V8.default,{sx:{fontSize:"12px",color:"inherit"}}),r("package__features:chat__user_message__contexts__file__preview__tips")))},st.default.createElement(Pf,{filename:t.fileName,filetype:t.fileType,sx:JB}),st.default.createElement(g,{direction:"column",overflow:"hidden",flexGrow:1},st.default.createElement(T,{sx:U8},t.fileName),st.default.createElement(T,{sx:eD},t.fileType.toUpperCase()))))}),W8=tD;var mr=I(E()),nD=["www.linkedin.com"],rD=({variable:e,container:t,getMessageContainer:o,zIndex:n})=>{let r=(0,mr.useRef)(null),[i,a]=(0,mr.useState)(null),[s,l]=(0,mr.useState)(360);return mr.default.createElement(g,{direction:"row",width:"100%",gap:"4px",sx:{"& .maxai-user-message-variable-copy-icon":{transition:"opacity 0.2s ease-in-out",opacity:0},"&:hover .maxai-user-message-variable-copy-icon":{opacity:1}}},mr.default.createElement(B,null,mr.default.createElement(An,{tooltipPlacement:"top",tabIndex:-1,sx:{padding:"6px",fontSize:"20px",borderRadius:"8px",color:"text.secondary"},defaultIconSx:{},className:"maxai-user-message-variable-copy-icon",PopperProps:{container:t,sx:{zIndex:n}},copyText:e.value,onCopy:()=>{nD.includes(window.location.host)&&Mp.includes("extension")&&setTimeout(()=>{el.hideSidebar()},1)}})),mr.default.createElement(hp,{variable:e,container:t,sx:{flexGrow:1,overflow:"hidden"},virtualRect:i,popperSx:{width:s,boxSizing:"border-box",zIndex:n},anchorElSx:{width:"100%"}},mr.default.createElement(g,{direction:"column",gap:1,ref:r,sx:{width:"100%",p:1,borderRadius:p=>p.spacing(.5),background:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, 0.04)":"rgba(0, 0, 0, 0.04)",boxSizing:"border-box"},onClick:()=>{let p=o?.()??null;if(r.current&&p){let c=p.getBoundingClientRect(),u=r.current.getBoundingClientRect(),m=u.left+20,d=c.left+c.width/2,f=Math.max(d,m);if(f===d){let h=Math.min(c.width-40,600);l(h)}else l(Math.max((u.right-u.left-20)*2,140));a(new DOMRect(f,u.top,1,u.height))}}},mr.default.createElement(T,{color:p=>p.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",fontSize:"14px"},e.key),mr.default.createElement(T,{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontSize:"14px",color:"text.primary"},e.value))))},Lf=rD;var Ka=I(E()),iD=({iconSx:e,message:t,formatMessageContent:o,...n})=>{let{t:r}=k(),{inputMediator:i}=ie(),a=St(),{askAIWithShortcutsV2:s}=ke(),{chatHubLoading:l}=dt(),p=t.meta?.MaxAIPromptActionConfig?.prompt_id,c=(0,Ka.useMemo)(()=>t.meta?.MaxAIPromptActionConfig===void 0,[t.meta?.MaxAIPromptActionConfig]),u=(0,Ka.useMemo)(()=>t.meta?.MaxAIPromptActionConfig&&xm(t.meta?.MaxAIPromptActionConfig),[t.meta?.MaxAIPromptActionConfig]),m=(0,Ka.useMemo)(()=>["AI_RESPONSE_LANGUAGE",Oe.PRESET_VARIABLE__INTERFACE_LANGUAGE.name,Oe.PRESET_VARIABLE__SYSTEM_CURRENT_DATE.name,Oe.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__WEBSITE_TYPE.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__DRAFT_CONTEXT.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__TARGET_CONTEXT.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__FULL_CONTEXT.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__SOCIAL_MEDIA__POST_DRAFT.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__EMAIL__DRAFT.name,Oe.PRESET_VARIABLE__INSTANT_REPLY__CHAT_APP__MESSAGE_DRAFT.name,Oe.PRESET_VARIABLE__CURRENT_WEBSITE_DOMAIN.name,Oe.PRESET_VARIABLE__CURRENT_WEBPAGE_URL.name,Oe.PRESET_VARIABLE__AI_RESPONSE_WRITING_STYLE.name,Oe.PRESET_VARIABLE__AI_RESPONSE_TONE.name,Oe.OUTPUT_PRESET_VARIABLE__CHAT_COMPLETE.name],[]),d=(0,Ka.useMemo)(()=>{if(t.meta?.disableEditQuestion)return!1;if(c)return!0;let h=u?.origin?.variables;return h&&h?.some(x=>x.name==="KEY_POINTS")?!0:p&&o_.includes(p)?!1:!!h?.filter(x=>x.name&&!m.includes(x.name))?.length},[c,u?.origin?.variables,m,t.meta?.disableEditQuestion,p]),f=async()=>{if(c){Kd(),i.updateInputValue(o);let h=i.ref;h&&(h.focus(),h.setSelectionRange(h.value.length,h.value.length));return}else if(u){let h=u.actions;if(h.length>0){let _=u?.origin?.variables;if(_){let C=_.reduce((y,b)=>(y&&!m.includes(b.name)?y[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}:y&&p==="47070ec6-8700-43fd-a519-20fe3841df38"&&(b.name==="MAXAI__INSTANT_REPLY__TARGET_CONTEXT"||b.name==="MAXAI__INSTANT_REPLY__FULL_CONTEXT")&&(y[b.name]={key:b.name,value:b.default_value,overwrite:!0,isBuiltIn:!0,label:b.label||b.hint||b.name}),y??{}),{});h.unshift({type:"SET_VARIABLE_MAP",parameters:{VariableMap:C}})}let x=h.find(C=>C.type==="SET_VARIABLES_MODAL");if(x){if(x.parameters.SetVariablesModalConfig={...x.parameters.SetVariablesModalConfig,disableAutoExecuteWhenAllVariableHaveValue:!0},p==="47070ec6-8700-43fd-a519-20fe3841df38"){let b=lC[0].parameters.SetVariablesModalConfig;b&&(x.parameters.SetVariablesModalConfig={...x.parameters.SetVariablesModalConfig,...b})}let C=x.parameters?.MaxAIPromptActionConfig?.variables.find(b=>b.name==="SELECTED_TEXT"),y="8c0c38d4-1dfe-498e-8229-05e758b2dc03"===p;C&&(C.hidden=!1,y&&(C.hidden=!0))}await s(h,{isClearInput:!0,isFocusInput:!0}),aD(a)}}};return d?Ka.default.createElement(mm,{title:r("package__features:chat__user_message__action__edit"),...n,onClick:f,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary",...n.sx},disabled:l},Ka.default.createElement(G,{icon:"DefaultIcon",sx:{fontSize:"20px",...e}})):null},G8=iD;function aD(e){if(e){let t=e.querySelector('*[data-testid="maxai--chat-box--chat-input--main"] textarea');if(t&&t?.focus){t.focus(),t.setSelectionRange(t.value.length,t.value.length);return}let o=e.querySelector("*[data-testid^=custom-variable--] textarea");if(o&&o?.focus){o.focus(),o.setSelectionRange(o.value.length,o.value.length);return}}}var Of="maxai-client--user-message--action-icon--visible-on-hover",sD={whiteSpace:"pre-wrap",wordBreak:"break-word",p:e=>e.spacing(1.5),bgcolor:e=>e.palette.secondary.main,borderRadius:e=>e.spacing(1),color:"text.primary",maxWidth:"100%",width:"auto",flexWrap:"wrap",overflow:"hidden"},lD={width:"auto",maxWidth:"100%",flexDirection:"row",justifyContent:"flex-end",gap:"2px",[`& .${Of}`]:{width:"32px",height:"32px",transition:"opacity 0.2s ease-in-out",opacity:0},[`&:hover .${Of}`]:{opacity:1}},pD=e=>{let{message:t,order:o,container:n}=e,{t:r}=k(),{inputMediator:i}=ie(),a=t.meta?.MaxAIPromptActionConfig===void 0,s=(0,g0.useMemo)(()=>!t.meta?.includeHistory&&o!==1,[t,o]),{quote:l,userVariables:p,formatMessageContent:c}=(0,g0.useMemo)(()=>{let C=wr(t,!1),y=[],b=Uc(t.meta?.contexts,t.meta?.MaxAIPromptActionConfig?.variables),v=b?.text??"";return v||t.meta?.MaxAIPromptActionConfig?.variables?.find(S=>S.name==="SELECTED_TEXT")&&(v=" "),b?.userVariables.forEach(S=>{S.key===Oe.PRESET_VARIABLE__COMPOSE_KEY_POINTS.hint||S.key===Oe.PRESET_VARIABLE__REPLY_KEY_POINTS.hint||S.key===Oe.PRESET_VARIABLE__REFINE_DRAFT__FOLLOW_UP_INSTRUCTION.hint?C=S.value:y.push(S)}),{formatMessageContent:C,userVariables:y,quote:v}},[t]),[u,m]=(0,Pt.useState)(null),[d,f]=(0,Pt.useState)(360),h=(0,Pt.useRef)(null),_=(0,Pt.useRef)(null),x=()=>{i.updateInputValue(c);let C=i.ref;C&&(C.focus(),C.setSelectionRange(C.value.length,C.value.length))};return Pt.default.createElement(g,{className:"chat-message chat-message--user",direction:"column",gap:1,ref:h,width:"100%"},s&&Pt.default.createElement(jd,{message:t}),!!l&&Pt.default.createElement(Pt.default.Fragment,null,Pt.default.createElement(B,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},Pt.default.createElement(hp,{variable:{key:"Quote",value:l},sx:{maxWidth:"100%",width:"auto"},virtualRect:u,popperSx:{width:d,boxSizing:"border-box"},container:n},Pt.default.createElement(g,{gap:1,direction:"row",color:C=>C.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%",ref:_,onClick:()=>{if(_.current&&h.current){let C=h.current.getBoundingClientRect(),y=_.current.getBoundingClientRect(),b=y.left+40,v=C.left+C.width/2,S=Math.max(v,b);if(S===v){let M=Math.min(C.width-40,600);f(M)}else f(Math.min(Math.max((y.width-20)*2,140),C.width-40,600));m(new DOMRect(S,y.top,1,y.height))}}},Pt.default.createElement(j8.default,{sx:{fontSize:"18px"}}),Pt.default.createElement(X_,{maxLine:2,fontSize:"14px",flex:1},l))))),Pt.default.createElement(z8,{message:t}),Pt.default.createElement(W8,{message:t}),Pt.default.createElement(g,{direction:"row",justifyContent:"flex-end",width:"100%",paddingLeft:C=>C.spacing(6)},Pt.default.createElement(g,{sx:lD},Pt.default.createElement(B,null,Pt.default.createElement(G8,{message:t,formatMessageContent:c,tabIndex:-1,className:Of,PopperProps:{disablePortal:!0}})),Pt.default.createElement(B,null,Pt.default.createElement(An,{tabIndex:-1,sx:{mr:.5,p:"6px",borderRadius:1,color:"text.secondary"},className:Of,PopperProps:{disablePortal:!0},copyText:c})),Pt.default.createElement(B,{className:"chat-message--text",sx:sD},Pt.default.createElement(T,{fontSize:"16px"},c),Pt.default.createElement(g,{width:"100%",direction:"column",gap:1},p.map((C,y)=>Pt.default.createElement(Lf,{variable:C,key:`${C.key}-${y}`,getMessageContainer:()=>h.current,container:n})))))))},q8=Jl(pD);var $8=I(Sr()),X8=I(K8());var Ut=I(E()),dD=({message:e,sx:t})=>{let[o,n]=(0,Ut.useState)(!1),[r,i]=(0,Ut.useState)(new Set),[a,s]=(0,Ut.useState)(""),l=(0,Ut.useMemo)(()=>JSON.stringify(e,null,2),[e]);return Ut.default.createElement(Ut.default.Fragment,null,Ut.default.createElement(B,{position:"absolute",top:16,right:16,zIndex:1,sx:t},Ut.default.createElement(yr,{open:o,title:Ut.default.createElement(g,null,e&&Ut.default.createElement(g,{sx:{gap:1,flexDirection:"row"}},Ut.default.createElement(Pu,{size:"small",sx:{width:"auto",flex:1,color:"#fff"},options:Object.keys(e),onChange:(p,c)=>{s(c??"")},renderInput:p=>Ut.default.createElement(zt,{...p,variant:"outlined"})}),Ut.default.createElement(de,{size:"small",variant:"contained",onClick:()=>{a&&i(p=>{let c=new Set(p);return c.add(a),c})}},"\u6DFB\u52A0\u76D1\u89C6\u5B57\u6BB5")),Ut.default.createElement(g,{sx:{flexDirection:"row",gap:1,justifyContent:"space-between",alignItems:"center"}},Ut.default.createElement(An,{copyText:l,sx:{color:"#fff"}}),Ut.default.createElement(Re,{onClick:()=>n(!1)},Ut.default.createElement($8.default,{sx:{color:"#fff"}}))),Ut.default.createElement("pre",{style:{fontSize:"12px",maxHeight:"500px",overflowY:"auto"}},l))},Ut.default.createElement(Re,{onClick:()=>n(p=>!p),sx:{fontSize:24}},Ut.default.createElement(X8.default,null)))),r?.size>0&&Ut.default.createElement(B,{sx:{borderRadius:1,border:"1px solid #ccc",p:1,background:"#f0f0f0"}},Array.from(r)?.map(p=>Ut.default.createElement("div",{key:p},p,":"," ",JSON.stringify(p.split(".").reduce((c,u)=>c?.[u],e))))))},fD=e=>Vs?Ut.default.createElement(dD,{...e}):null,Df=fD;var hD=e=>{let{message:t,sx:o,order:n,loading:r,onChangeHeight:i,...a}=e,s=(0,dr.useRef)(null),l=(0,dr.useRef)(0);return fC(t),(0,dr.useEffect)(()=>{if(s.current){let p=s.current,c=()=>{if(!p)return;let m=p.offsetHeight;m&&m!==l.current&&Math.abs(m-l.current)>10&&(l.current=m,i?.(m,t.messageId))},u=new ResizeObserver(()=>{c()});return u.observe(p),()=>{u.disconnect()}}},[i]),dr.default.createElement(B,{"data-message-id":t.messageId,"data-scroll-position":t.type==="system"?"bottom":"top",ref:s,sx:{padding:p=>`${p.spacing(2.25)} ${p.spacing(1.5)}`,position:"relative",boxSizing:"border-box",maxWidth:"var(--max-width)",width:"100%",mx:"auto",color:"text.primary",userSelect:"text","& .chat-message--text":{textAlign:"left",fontSize:"16px",lineHeight:1.4,fontWeight:400},...o},...a},dr.default.createElement(Df,{message:t}),zi(t)&&dr.default.createElement(vf,{message:t}),Qn(t)&&dr.default.createElement(B8,{order:n,loading:r??!1,message:t}),Xu(t)&&dr.default.createElement(q8,{order:n,message:t}))},Y8=(0,dr.memo)(hD);var De=I(E());var Z8=I(jw());var Ff=I(E()),gD=e=>{let{onClick:t,container:o}=e,{t:n}=k();return Ff.default.createElement(Re,{onClick:()=>t(),sx:{position:"absolute",bottom:"16px",left:"50%",transform:"translateX(-50%)",bgcolor:"background.paper",padding:0,border:"1px solid",width:"32px",height:"32px",borderColor:r=>r.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)",boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)","&:hover":{bgcolor:r=>r.palette.mode==="dark"?"rgb(64,64,64)":"rgb(234,234,234)"}}},Ff.default.createElement(xe,{PopperProps:{container:o},title:n("package__features:chat__message_list__scroll_to_bottom__title"),placement:"top"},Ff.default.createElement(Z8.default,{sx:{boxSizing:"border-box",padding:"8px",fontSize:"32px"}})))},Hf=gD;var xD="message-list-scroll-container",x0=4*24+2*16,Q8=e=>{let t=e.scrollTop,o=e.scrollHeight,n=e.clientHeight;return Math.abs(n+t-o)>10},_D=(e,t,o,n)=>{if(!e)return;let r=e.querySelectorAll("[data-message-id]"),i=Array.from(r).findIndex(s=>s.getAttribute("data-message-id")===t),a=r[i];if(a){let s=a.getAttribute("data-scroll-position")||"bottom";e.scrollTo(0,s==="bottom"?e?.scrollHeight:a.offsetTop-x0),o?.()}n?.()},CD=e=>{let{conversationId:t}=ie(),{conversationId:o=t,sx:n,emptyNode:r,children:i}=e,a=iC(o),s=Uo(o),l=(0,De.useRef)(null),[p,c]=(0,De.useState)(0),u=(0,De.useRef)(Wr(_D,50,{leading:!1,trailing:!0})),m=(0,De.useRef)(null),d=(0,De.useRef)(null),{messages:f,isLoading:h,isFetchingNextPage:_,hasNextPage:x,fetchNextPage:C,lastMessageId:y,previousPageLastMessageId:b}=nC(o),[v,S]=(0,De.useState)(!1),M=(0,De.useRef)(!1);(0,De.useEffect)(()=>{M.current=!1},[o]);let[P,O]=(0,De.useState)(!1);(0,De.useLayoutEffect)(()=>{O(!1)},[o]);let L=h||!P,H=(0,De.useRef)(!1),z=(0,De.useCallback)(()=>{_||!x||H.current||(H.current=!0,C().then().catch())},[_,x,C]),R=et(z),V=()=>{let A=l.current;A&&(A.scrollTo(0,A.scrollHeight),S(!1))},F=(0,De.useCallback)(()=>{if(!m.current){O(!0);return}let A=l.current;if(A&&S(Q8(A)),d.current===m.current){O(!0);return}let U=m.current;u.current(l.current,m.current,()=>{d.current=U,M.current=!0,H.current&&(H.current=!1)},()=>{setTimeout(()=>{O(!0)},100)})},[]);(0,De.useEffect)(()=>{let A=l.current;if(!A)return;let U=re=>{if(S(Q8(A)),re.deltaY<0){A.scrollTop<=A.offsetHeight/10&&R.current();return}},N=new ResizeObserver(()=>{let re=A.clientHeight;c(re)});N.observe(A);let ce=Wr(U,100),Z=Tn(U,300);return A.addEventListener("wheel",ce),A.addEventListener("wheel",Z),A.addEventListener("scroll",ce),A.addEventListener("scroll",Z),()=>{A.removeEventListener("wheel",ce),A.removeEventListener("wheel",Z),A.removeEventListener("scroll",ce),A.removeEventListener("scroll",Z),N.disconnect()}},[l.current,o]);let q=(0,De.useRef)(null);wu(()=>{q.current=m.current}),(0,De.useEffect)(()=>{q.current&&(mi(f)?.messageId!==q.current&&V(),q.current=null)},[f]),(0,De.useEffect)(()=>{let A=a?.messageId||"";if(A&&y!==A)m.current=A;else if(y&&y!==m.current){if(s?.type==="Summary"&&M.current)return;m.current=y}},[a?.messageId,y]),(0,De.useEffect)(()=>{b&&H.current&&(m.current=b)},[b]),(0,De.useEffect)(()=>{d.current=null},[o]);let X=(0,De.useRef)({}),W=(0,De.useMemo)(()=>{a&&(X.current[o]=a);let A=Ee(f),U=X.current[o],N=U?.messageId;if(!N)return{writingMessageId:"",currentMessages:A};let ce=f.findIndex(Z=>Z.messageId===N);if(ce>-1){let Z=!1;if(a&&a.updated_at&&A[ce].updated_at){if(new Date(a.updated_at).getTime()<new Date(A[ce].updated_at).getTime())return{writingMessageId:N,currentMessages:A};Z=!0}return!a&&!Z?(delete X.current[o],{writingMessageId:"",currentMessages:A}):(A[ce]=Ro([A[ce],a]),{writingMessageId:N,currentMessages:A})}else if(U){let Z=mi(f);Z&&zi(Z)?delete X.current[o]:A=[...f,U]}return{writingMessageId:N,currentMessages:A}},[o,a,f]),j=(0,De.useMemo)(()=>!(h||_||x||W.currentMessages.length||W.writingMessageId||s?.lastMessageId),[h,_,x,W.currentMessages.length,W.writingMessageId,s?.lastMessageId]),w=mi(f)?.type,ne=(0,De.useMemo)(()=>({flex:1,height:"0",overflowY:"auto",display:j?"none":"block","&:focus":{outline:"none"},"& .maxai__message-item":{"&:last-of-type":{minHeight:w==="system"?"unset":p===0?`calc(100vh - ${x0+200}px)`:`calc(${p}px - ${x0}px)`}},...n}),[p,w,n,j]),pe=De.default.createElement(g,{"data-testid":"maxai--chat-panel--message-list",key:o,sx:{height:0,flex:1,width:"100%",position:"relative",display:j?"none":"flex","& *":{boxSizing:"border-box"},...n}},De.default.createElement(Df,{message:s,sx:{left:0,right:"inherit"}}),j&&r,L&&De.default.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2}},De.default.createElement(En,{loading:!0,sx:{backgroundColor:"background.default"}})),De.default.createElement(B,{ref:l,id:xD,tabIndex:-1,sx:ne},_&&De.default.createElement(g,{width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},De.default.createElement(Lt,{size:16,sx:{m:"0 auto"}})),W.currentMessages.map((A,U)=>De.default.createElement(Y8,{key:`${A.messageId}_${U}`,className:`maxai__message-item maxai__message-item--${A.type}`,"data-testid":`maxai__message-item-${U+1}`,message:A,order:U+1,onChangeHeight:F,loading:W.writingMessageId===A.messageId}))),v&&!j&&De.default.createElement(Hf,{onClick:()=>V()}));return i?i({isShowHomeView:j,isLoading:h,isFetchingNextPage:_,hasNextPage:x,messages:W.currentMessages,listNode:pe}):pe},xp=CD;var Nr=I(E());var Hr=I(E());var ti=I(E()),yD=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=tt(),n=t.sidebarSettings?.search?.copilot,{conversationId:r}=ie(),i=fe(r);return ti.default.createElement(xe,{title:ti.default.createElement(g,null,ti.default.createElement(g,{gap:.5,direction:"row"},ti.default.createElement(T,{fontSize:"16px",color:"rgba(255, 255, 255, .87)",fontWeight:500},"Pro"),ti.default.createElement(T,{fontSize:"16px",color:"#d9a7ff",fontWeight:500},"search")),ti.default.createElement(T,{fontSize:"14px",color:"rgba(255, 255, 255, .87)"},e("package__features:chat__app__search_advanced__copilot__description")))},ti.default.createElement(g,{onClick:()=>{i||o({sidebarSettings:{search:{copilot:!n}}})},direction:"row",alignItems:"center",gap:.5,sx:{py:.5,px:1,cursor:i?"not-allowed":"pointer"}},ti.default.createElement(g,{alignItems:"center",justifyContent:"center",p:"2px"},ti.default.createElement(xl,{disabled:i,checked:n,height:16,color:"primary"})),ti.default.createElement(T,{fontSize:"14px",color:n?"primary.main":"text.primary"},"Pro")))},J8=yD;var i9=I(pa());var ko=I(E());var o9=I(Sr());var yn=I(E());var qn=I(E());var e9=I(E()),Nf=[{betaFeature:"appearance_v2",optionTitle:"package__features:beta_features__modal__option__appearance_v2__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__appearance_v2__title",betaFeatureCardImages:[Ap("/images/beta-features/appearance/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__appearance_v2__description",onButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__on",offButtonText:"package__features:beta_features__modal__feature_card__appearance_v2__off"},{betaFeature:"enabled_artifacts",optionTitle:"package__features:beta_features__modal__option__artifacts__title",betaFeatureCardTitle:"package__features:beta_features__modal__feature_card__artifacts__title",betaFeatureCardImages:[Ap("/images/beta-features/artifacts/1.png")],betaFeatureCardDescription:"package__features:beta_features__modal__feature_card__artifacts__description",onButtonText:"package__features:beta_features__modal__feature_card__common__on",offButtonText:"package__features:beta_features__modal__feature_card__common__off"}],$a=(0,e9.createContext)({mode:"full",selectedBetaFeature:Nf[0].betaFeature,betaFeatureOptions:Nf,openBetaFeature:()=>{},handleSelectBetaFeature:()=>{},closeBetaFeature:()=>{},open:!1});var bD=e=>{let{betaFeature:t,onChange:o}=e,{t:n}=k(),{selectedBetaFeature:r,betaFeatureOptions:i}=(0,qn.useContext)($a),a=i.find(s=>s.betaFeature===r);return!a||a.betaFeature!==t?null:qn.default.createElement(g,{gap:1.5,width:"100%"},a.betaFeatureCardImages[0]&&qn.default.createElement("img",{alt:n(a.betaFeatureCardTitle),width:"100%",src:a.betaFeatureCardImages[0]}),qn.default.createElement(g,{gap:1},qn.default.createElement(g,{direction:"row",alignItems:"center",gap:1},qn.default.createElement(T,{width:0,flex:1,noWrap:!0,fontSize:"16px",fontWeight:"400",color:"text.primary",textAlign:"left"},n(a.betaFeatureCardTitle)),qn.default.createElement(g,{onClick:async()=>{let s=!a?.enabled;a?.setEnabled?.(s),o?.(s)},direction:"row",alignItems:"center",gap:.5,sx:{flexShrink:0,py:.5,px:1,cursor:"pointer"}},qn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},n(a.offButtonText)),qn.default.createElement(g,{alignItems:"center",justifyContent:"center",p:"2px"},qn.default.createElement(xl,{checked:a.enabled,height:16})),qn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.primary"},n(a.onButtonText)))),qn.default.createElement(T,{fontSize:"14px",fontWeight:"400",color:"text.secondary"},n(a.betaFeatureCardDescription))))},_0=bD;var _p=I(E());var ID=()=>{let{t:e}=k(),{selectedBetaFeature:t,betaFeatureOptions:o,handleSelectBetaFeature:n}=(0,_p.useContext)($a);return _p.default.createElement(Iu,{sx:{width:"100%"}},o.map(r=>_p.default.createElement(Lu,{sx:{p:"8px 12px"},key:r.betaFeature,selected:t===r.betaFeature,onClick:()=>n(r.betaFeature)},_p.default.createElement(T,{fontSize:"14px",fontWeight:500,color:"text.primary"},e(r.optionTitle)))))},t9=ID;var SD=()=>{let{t:e}=k(),{mode:t,open:o,closeBetaFeature:n}=(0,yn.useContext)($a),{appSettings:r,setAppSettings:i}=Un(),a=St(),{betaSettings:s,updateBetaSettings:l}=Wo();return yn.default.createElement(ci,{container:a,open:o,onClose:p=>{p.stopPropagation(),n()},sx:{position:t==="full"?"fixed":"absolute"},slotProps:{root:{onClick:p=>{p.stopPropagation()}},backdrop:{sx:{position:t==="full"?"fixed":"absolute"}}}},yn.default.createElement(ku,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",borderRadius:1,bgcolor:p=>p.palette.mode==="dark"?"#3d3d3d":"#fff",maxWidth:"768px!important",width:t==="full"?"100%":"448px",p:"0!important"}},yn.default.createElement(g,null,yn.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{p:"8px 16px",borderBottom:"1px solid",borderColor:"border.main",boxSizing:"border-box"}},yn.default.createElement(T,{fontSize:"16px",fontWeight:600,lineHeight:"20px",color:"text.primary"},e("package__features:beta_features__modal__title")),yn.default.createElement(Re,{"aria-label":"close",sx:{width:30,height:30},onClick:()=>{n()}},yn.default.createElement(o9.default,{sx:{width:20,height:20}}))),yn.default.createElement(g,{sx:{flexDirection:t==="lite"?"column":"row"}},yn.default.createElement(g,{sx:{p:"12px 16px",width:t==="lite"?"100%":"208px",boxSizing:"border-box"}},yn.default.createElement(t9,null)),yn.default.createElement(g,{sx:{p:"12px 16px",width:t==="lite"?"100%":"0",flex:1,boxSizing:"border-box"}},yn.default.createElement(_0,{betaFeature:"enabled_artifacts",onChange:async()=>{await i({userSettings:{features:{artifacts:{enabled:!r.userSettings?.features?.artifacts?.enabled}}}})}}),yn.default.createElement(_0,{betaFeature:"appearance_v2",onChange:async()=>{await l({appearance_v2_enabled:!s?.appearance_v2_enabled})}}))))))},n9=SD;var r9=e=>{let{sx:t}=e;return ko.default.createElement(i9.default,{sx:{...t}},ko.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ko.default.createElement("g",null,ko.default.createElement("path",{d:"M3.74989 15.75C3.11239 15.75 2.65927 15.4656 2.39052 14.8969C2.12177 14.3281 2.18739 13.8 2.58739 13.3125L6.74989 8.25V3.75H5.99989C5.78739 3.75 5.60927 3.67813 5.46552 3.53437C5.32177 3.39062 5.24989 3.2125 5.24989 3C5.24989 2.7875 5.32177 2.60938 5.46552 2.46562C5.60927 2.32187 5.78739 2.25 5.99989 2.25H11.9999C12.2124 2.25 12.3905 2.32187 12.5343 2.46562C12.678 2.60938 12.7499 2.7875 12.7499 3C12.7499 3.2125 12.678 3.39062 12.5343 3.53437C12.3905 3.67813 12.2124 3.75 11.9999 3.75H11.2499V8.25L15.4124 13.3125C15.8124 13.8 15.878 14.3281 15.6093 14.8969C15.3405 15.4656 14.8874 15.75 14.2499 15.75H3.74989ZM5.24989 13.5H12.7499L10.1999 10.5H7.79989L5.24989 13.5ZM3.74989 14.25H14.2499L9.74989 8.775V3.75H8.24989V8.775L3.74989 14.25Z",fill:"currentColor"}))))},vD=e=>{let{mode:t,buttonSize:o="small",sx:n,...r}=e,{t:i}=k(),{userSettings:a}=Un(),{betaSettings:s}=Wo(),{loaded:l,features:p}=Q_(),[c,u]=(0,ko.useState)(!1),[m,d]=(0,ko.useState)(void 0),f=(0,ko.useMemo)(()=>t||(ui()?"lite":"full"),[t]),h=(0,ko.useMemo)(()=>Ee(Nf).map(v=>(v.enabled=!1,v.hasBetaFeatureAccess=!1,l&&p[v.betaFeature]&&v.betaFeature==="enabled_artifacts"&&(v.enabled=a?.features?.artifacts?.enabled,v.hasBetaFeatureAccess=!0),v)).filter(v=>v.hasBetaFeatureAccess),[p,l,a,s?.appearance_v2_enabled]),_=h.find(v=>v.enabled),x=v=>{let S=h.find(P=>P.hasBetaFeatureAccess),M=v||S?.betaFeature;M&&(d(M),u(!0))},b={mode:f,open:c,selectedBetaFeature:m,handleSelectBetaFeature:v=>{d(v)},betaFeatureOptions:h,openBetaFeature:x,closeBetaFeature:()=>{d(void 0),u(!1)}};return h.find(v=>v.hasBetaFeatureAccess)?ko.default.createElement($a.Provider,{value:b},o==="small"?ko.default.createElement(ps,{"data-testid":"maxai--chat--beta-features-button",title:i("package__features:beta_features__toggle_button__title"),color:"primary",sx:{position:"relative",...n},onClick:()=>{x()},...r},ko.default.createElement(B,{component:"svg",sx:{position:"absolute",opacity:_?1:0,top:"4px",right:"4px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),ko.default.createElement(r9,{sx:{fontSize:"20px"}})):ko.default.createElement(ps,{"data-testid":"maxai--chat--beta-features-button",onClick:()=>{x()},color:"primary",sx:{position:"relative",width:"100%",justifyContent:"flex-start",padding:"8px 10px",height:"unset",gap:"12px",display:"flex",alignItems:"center","& > :not(div)":{flexShrink:0}},...r},ko.default.createElement(B,{component:"svg",sx:{position:"absolute",opacity:_?1:0,top:"4px",left:"28px",width:"6px",height:"6px",borderRadius:"50%",bgcolor:"currentColor",color:"inherit"}}),ko.default.createElement(r9,{sx:{fontSize:"20px"}}),ko.default.createElement(T,{component:"div",flex:1,width:0,fontSize:"14px",color:"inherit",fontWeight:400,textAlign:"left"},i("package__features:beta_features__toggle_button__title"))),ko.default.createElement(n9,null)):null},a9=vD;var s9=I(E());var TD=()=>{let e="feedback",{userInfo:t,subscriptionType:o}=_t(),{syncSurveyStatus:n}=tl(!1),r=$t(f2),i=$t(h2),a=(0,s9.useMemo)(()=>!(!i||t===null||o!=="yearly"&&o!=="oneTimePayment"||r[e]),[t,o,i,e,r]);return nl(n),{loaded:i,canShowSurvey:a}},l9=TD;var p9=I(pa());var fr=I(E()),wD=({sx:e})=>{let t="feedback",o=`${Nn}/survey/feedback/`,{isLogin:n}=pn(),{t:r}=k(),{canShowSurvey:i}=l9(),{syncSurveyStatus:a}=tl(!1),[s,l]=(0,fr.useState)(!1),p=()=>{l(!0),window.open(o),d2("survey_card_clicked",{survey_type:t})};return nl(()=>{s&&(a(void 0,!0),l(!1))}),!n||!i?null:fr.default.createElement(fr.default.Fragment,null,fr.default.createElement(xe,{placement:"top",title:r("package__features:chat__chat_input__feedback_button__description")},fr.default.createElement("div",null,fr.default.createElement(Yn,{"data-testid":"maxai--chat--feedback-button",sx:{borderRadius:1,p:"6px",bgcolor:c=>c.palette.mode==="dark"?"rgba(178, 115, 255, 0.16)":"rgba(118, 1, 211, 0.08)","&:hover":{bgcolor:c=>c.palette.mode==="dark"?"rgba(178, 115, 255, 0.24)":"rgba(118, 1, 211, 0.12)"},...e},onClick:p},fr.default.createElement(MD,{sx:{fontSize:20}}),fr.default.createElement(T,{ml:.5,my:0,fontSize:12,fontWeight:400,lineHeight:1.5,color:"text.primary",sx:{userSelect:"none",opacity:1}},r("package__features:chat__chat_input__feedback_button"))))))},c9=wD,MD=({sx:e})=>fr.default.createElement(p9.default,{viewBox:"0 0 20 20",sx:e},fr.default.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},fr.default.createElement("path",{d:"M4.8127 6.80792H15.1877M4.8127 10.0007H15.1877M4.46686 14.0898V16.9173L8.15621 14.0898H16.5724C17.5269 14.0898 18.3002 13.3151 18.3002 12.3606V4.81315C18.3002 3.85865 17.5255 3.08398 16.571 3.08398H3.42936C2.47486 3.08398 1.7002 3.85865 1.7002 4.81315V12.3606C1.7002 13.3151 2.47486 14.0898 3.42936 14.0898H4.46686Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.60645"})));var hr=I(E()),ED=()=>{let{t:e}=k(),{inputMediator:t}=ie(),{selectedType:o,changeMyOwnToolsType:n,resetMyOwnToolsType:r}=er(),{chatHubLoading:i}=dt(),a={SUGGESTED:"PromptMyOwnTools",MY_OWN_TOOLS:"PromptMyOwnTools",REWRITE:"Rewrite"},{changeContextMenuPath:s,changeMode:l}=io(),{rewriteDisabled:p}=xC(),c=(0,hr.useMemo)(()=>o!=="SUGGESTED",[o]),u=(0,hr.useMemo)(()=>[{value:"REWRITE",testid:"maxai--chat-my-own-tools-button--rewrite",label:e("package__features:chat__inputbox__button__my_own_tools__menu__rewrite"),title:p?e("package__features:home_view__chat_with_any_content__tab__rewrite__disabled_title"):null,disabled:p,ButtonProps:{key:`REWRITE-${p}`,tooltipProps:{placement:"right",disabled:!1}},icon:hr.default.createElement(G,{icon:"Rewrite"})},{value:"MY_OWN_TOOLS",testid:"maxai--chat-my-own-tools-button--my-own-tools",label:e("package__features:chat__inputbox__button__my_own_tools__menu__my_own_tools"),icon:hr.default.createElement(G,{icon:"PromptMyOwnTools"})}],[e,p]),m=(0,hr.useMemo)(()=>u.find(f=>f.value===o),[o,u]),d=f=>{let h=f;o===h?r():n(h),t.updateInputValue(""),t.focus()};return(0,hr.useEffect)(()=>{let f=gC(o);s(f||null),l("list")},[o]),hr.default.createElement(hr.default.Fragment,null,hr.default.createElement(ps,{disabled:i,testid:"maxai--chat-my-own-tools-button",defaultOptionValue:"MY_OWN_TOOLS",options:c?void 0:u,placement:"top-start",onClick:()=>{c&&r()},onMouseUp:()=>{t.focus()},onSelectOption:f=>{d(f)},OptionsCardProps:{sx:{width:"144px",marginLeft:"-12px"}},sx:{height:"32px",lineHeight:1.5,...c?{borderRadius:"16px",padding:"0 6px",gap:"6px",bgcolor:f=>f.palette.mode==="dark"?"rgba(32, 59, 88, 1)!important":"rgba(213, 239, 255, 1)!important",color:f=>f.palette.mode==="dark"?"rgba(0, 173, 255, 1)!important":"rgba(48, 123, 201, 1)!important",fontSize:"12px","&:hover":{bgcolor:f=>f.palette.mode==="dark"?"rgba(29, 54, 80, 1)!important":"rgba(181, 221, 247, 1)!important",color:f=>f.palette.mode==="dark"?"rgba(0, 173, 255, 1)!important":"rgba(48, 123, 201, 1)!important"}}:{}}},hr.default.createElement(G,{icon:a[o]||a.SUGGESTED,sx:{...c?{color:"inherit !important"}:{}}}),c&&m&&m.label))},u9=ED;Ow();Bw();var Ji=I(E()),m9=I(Gs()),AD=e=>{let{rootContainer:t,customElementName:o,children:n,style:r,checkVisibility:i=!0,onSetContainer:a}=e,[s,l]=(0,Ji.useState)(null),p=(0,Ji.useRef)(null);return(0,Ji.useEffect)(()=>{if(t&&!s){if(i&&!Js(t))return;let c="customElements"in window,u=document.createElement(c?o:"div");r&&(u.style.cssText=r),t.insertBefore(u,t.firstChild);let m=u.attachShadow({mode:"open"}),d=document.createElement("style"),f=document.createElement("div");m.appendChild(d),m.appendChild(f);let h=String(o).toLowerCase().replace(/_/g,"-");p.current=nx({key:`${h}-emotion-cache`,prepend:!0,container:d}),l(_=>(_&&_.getRootNode()?.host?.remove(),f))}else s&&!t&&l(null);return()=>{}},[t,s,o,i,r]),(0,Ji.useEffect)(()=>{a&&s&&a(s)},[s,a]),!s||!p.current?null:(0,m9.createPortal)(Ji.default.createElement(rx,{value:p.current},n),s)},d9=AD;var h9=I(qw());var bn=I(E());var zf=I(E()),As=I(E()),PD=e=>{let{onChange:t}=e,[o,n]=(0,As.useState)(!1),r=(0,As.useRef)([0,0]),[i,a]=(0,As.useState)([0,0,0,0]),s=u=>{r.current=[u.clientX,u.clientY],n(!0)},l=u=>{if(o){let[m,d]=r.current,[f,h]=[u.clientX,u.clientY],[_,x,C,y]=[Math.min(m,f),Math.min(d,h),Math.abs(m-f),Math.abs(d-h)];a([_,x,C,y])}},p=async u=>{n(!1);let m=await e.getScreenshot();if(m){let d=document.createElement("canvas"),f=d.getContext("2d"),h=new Image;h.src=m,h.onload=()=>{let _=window.innerWidth,x=h.naturalWidth/_,[C,y,b,v]=i.map(M=>M*x);d.width=b,d.height=v,f?.drawImage(h,C,y,b,v,0,0,b,v);let S=d.toDataURL("image/png");d.toBlob(async M=>{if(M)t?.({image:S,rect:i,imageFile:new File([M],"screenshot.png",{type:"image/png"})});else{let P=await yx(S,"screenshot.png");t?.({image:S,rect:i,imageFile:P})}})}}},c=(0,As.useMemo)(()=>{let[,,u,m]=[0,0,window.innerWidth,window.innerHeight],[d=0,f=0,h=0,_=0]=i;return[[0,0,h+d,f],[d+h,0,u-d-h,f+_],[0,f,d,m-f],[d,f+_,u-d,m-f-_]]},[i]);return zf.default.createElement(B,{onMouseDown:s,onMouseMove:l,onMouseUp:p,position:"fixed",sx:{width:"100vw",height:"100vh",top:0,left:0,zIndex:2147483647,cursor:"crosshair"}},zf.default.createElement(B,{sx:{position:"absolute",top:`${i[1]}px`,left:`${i[0]}px`,width:`${i[2]}px`,height:`${i[3]}px`,outline:"3px dashed",outlineColor:"#9065B0"}}),c.map((u,m)=>zf.default.createElement(B,{key:u.join(","),sx:{position:"absolute",top:u[1],left:u[0],width:u[2],height:u[3],backgroundColor:"rgba(0,0,0,0.3)"}})))},f9=PD;var kD=e=>{let{getScreenshot:t,disabled:o,tooltip:n,sx:r}=e,i=bn.default.useRef(null),{t:a}=k(),[s,l]=(0,bn.useState)(null),{uploadFiles:p}=pm(),{setChatDocuments:c,handleUploadFilesToChatDocuments:u}=sm(),{betaSettings:m}=Wo(),{chatHubLoading:d}=dt(),{isUnavailableUploadSource:f}=er(),h=o??(d||f);(0,bn.useEffect)(()=>{function C(y){if(y.key==="Escape"){s?.remove(),l(null),e.onCropEnd?.();return}}return s&&window.addEventListener("keydown",C,!0),()=>{window.removeEventListener("keydown",C,!0)}},[s]);let _=(0,bn.useMemo)(()=>n||(f?a("package__features:chat__inputbox__button__ai_screenshot__rewrite_disabled_tooltip"):h?"":a("package__features:chat__inputbox__button__ai_screenshot__tooltip")),[n,a,f,h]);return bn.default.createElement(bn.default.Fragment,null,bn.default.createElement(xe,{placement:"bottom",title:_,disableInteractive:!0},bn.default.createElement(B,null,bn.default.createElement(se,{buttonRefBind:C=>i.current=C,disabled:h,"data-testid":"maxai-take-screenshot",onClick:async()=>{if(!await Qe({emitEvent:!0})||!t2("7.4.1"))return;e.onCropStart?.();let C=document.createElement("div");C.style.width="100vw",C.style.height="100vh",C.style.position="fixed",C.style.zIndex="2147483647",document.body.appendChild(C),l(C)},sx:r},bn.default.createElement(h9.default,{sx:{transform:"rotate(-90deg)",fontSize:"20px"}})))),s&&!h&&bn.default.createElement(d9,{customElementName:"max-ai-screenshot",rootContainer:s},bn.default.createElement(f9,{getScreenshot:t||(()=>el.getCurrentTabScreenshot()),onChange:async({imageFile:C})=>{if(s?.remove(),l(null),e.onCropEnd?.(),e.onFile){e.onFile(C);return}m?.appearance_v2_enabled?(i.current&&i.current?.getAttribute("data-keep-context")?i.current?.removeAttribute("data-keep-context"):c(y=>y.map(b=>({...b,selected:!1}))),await u([C])):await p([C])}})))},g9=kD;var ea=I(E()),LD=({sx:e})=>{let{loaded:t,subscriptionType:o}=_t(),{isLogin:n}=pn(),{t:r}=k(),{getPlansInfoByType:i}=zu(),{showPricingUpgradeContentPopup:a}=__(),s=i("elite_yearly"),l=!1,p=l_(),c=m=>{Ur("click",{conversationId:"",paywallType:"proactive",paywallReason:"proactive",buttonType:"upgrade",targetElement:m.currentTarget}),a()},u=(0,ea.useMemo)(()=>(o==="monthly"||o==="quarterly")&&s.discount_title?r("package__features:pricing__save_to",{NUM:s.discount_title}):r("package__common:upgrade"),[r,o,s.discount_title]);return!t||!n||o==="yearly"||o==="oneTimePayment"?null:ea.default.createElement(ea.default.Fragment,null,ea.default.createElement(xe,{title:p},ea.default.createElement(Yn,{"data-testid":"maxai--chat--upgrade-plan-button",variant:"contained",sx:{borderRadius:1,p:"6px",pr:"8px",...e},loading:l,onClick:c},ea.default.createElement(lu,{sx:{fontSize:20,color:"inherit"}}),ea.default.createElement(T,{ml:.5,my:0,fontSize:14,fontWeight:500,lineHeight:"20px",color:"text.primary",sx:{userSelect:"none",opacity:l?0:1,color:"inherit"}},u))))},x9=LD;var oi=I(E()),OD=e=>{let{...t}=e,{conversationId:o}=ie(),{t:n}=k(),r=Uo(o),i=fe(o),{files:a,uploadFiles:s}=cm(),l=(0,oi.useRef)(null),p=(0,oi.useMemo)(()=>Vo(r?.meta.AIProvider,r?.meta.AIModel),[r?.meta.AIProvider,r?.meta.AIModel]),{maxCount:c=1,accept:u="",acceptTooltip:m}=p?.uploadFileConfig||{},d=a.some(h=>h.uploadStatus==="uploading"),f=async h=>{let _=h.target.files;!_||!r||await s(Array.from(_)).catch()};return oi.default.createElement(oi.default.Fragment,null,oi.default.createElement(se,{title:m?.(n)||n("package__features:chat__inputbox__button__upload__tooltip"),"data-testid":"chat-file-upload-button",onClick:async()=>{await Qe({emitEvent:!0})&&(d||l.current&&(l.current.value="",l.current.click()))},loading:d,disabled:i,loadingNode:oi.default.createElement(Lt,{size:16,sx:{fontSize:"16px"}}),...t},oi.default.createElement(G,{icon:"Attachment",sx:{transform:"rotate(-45deg)",fontSize:"20px"}})),oi.default.createElement("input",{multiple:c>1,onChange:f,ref:l,accept:u,hidden:!0,style:{display:"none"},type:"file"}))},_9=OD;var to=I(E());var BD=e=>{let{headerNode:t,headerLeftNode:o,headerRightNode:n,footerNode:r,footerLeftNode:i,footerRightNode:a,minLine:s=3,error:l,textareaProps:p,sx:c,defaultValue:u,sendButtonProps:m}=e,{t:d}=k(),{conversationType:f,conversationId:h}=ie(),{askAIQuestionV2:_,askAIQuestion:x}=ke(),{getConversationLoading:C}=ot(),{uploadFiles:y}=pm(),{handleUploadFilesToChatDocuments:b}=sm(),{betaSettings:v}=Wo(),S=Ia(),M=(0,to.useMemo)(()=>{if(f==="Summary")switch(n2()){case"PAGE_SUMMARY":return d("package__features:chat__input__summary_page__placeholder");case"YOUTUBE_VIDEO_SUMMARY":return d("package__features:chat__input__summary_video__placeholder");case"DEFAULT_EMAIL_SUMMARY":return d("package__features:chat__input__summary_email__placeholder");case"PDF_CRX_SUMMARY":return d("package__features:chat__input__summary_pdf__placeholder");default:return d("package__features:chat__input__summary_page__placeholder")}return d(f==="Search"?"package__features:chat__input__search__placeholder":f==="Art"?"package__features:chat__input__art__placeholder":"package__features:chat__input__chat__placeholder")},[f,d]),P=S.getInputValue();(0,to.useEffect)(()=>{let W=j=>{let w=j.detail?.value;w&&(v?.appearance_v2_enabled?_({type:"user",text:w,meta:{includeHistory:!0}}):x({type:"user",text:w,meta:{includeHistory:!0}}))};return jS("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",W),()=>{qS("MAXAI_CLIENT__CHAT_INPUT__SEND_MESSAGE",W)}},[_,x]);let O=async()=>{if(!S.isComposing){if(!await Qe({emitEvent:!0})){S.focus();return}await C(h)||P&&(v?.appearance_v2_enabled?_({type:"user",text:P,meta:{includeHistory:!0}}):x({type:"user",text:P,meta:{includeHistory:!0}}))}};(0,to.useEffect)(()=>{if(S.ref){let W=S.getInputValue();S.focus(),S.ref?.setSelectionRange(W.length,W.length)}},[h,S]),(0,to.useEffect)(()=>{u&&S.updateInputValue(u)},[u]);let[L,H]=(0,to.useState)(!1),[z,R]=(0,to.useState)(!1),V=to.default.createElement(to.default.Fragment,null,a,to.default.createElement(Gl,{value:{isVoiceInput:L,setIsVoiceInput:H}},to.default.createElement(ql,{voiceButtonProps:{onStartRecording:()=>{R(!0)},onStopRecording:W=>{W!=="done"&&R(!1)},onSpeechToTextFinally:()=>{R(!1)}},...m}))),{disabled:F,...q}=p||{},X=F||z;return to.default.createElement(g,{direction:"column",width:"100%",borderRadius:1,border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",boxSizing:"border-box",sx:{"& > *":{order:1},...c}},t,to.default.createElement(g,{"data-testid":"maxai--chat-box--chat-input--main",spacing:1,sx:{p:"10px"}},o||n?to.default.createElement(B,{display:"flex",alignItems:"center",justifyContent:"space-between"},to.default.createElement(g,{direction:"row",spacing:.5},o),to.default.createElement(g,{direction:"row",spacing:.5},n)):null,to.default.createElement(Kl,{ref:W=>S.bindRef(W),"data-testid":"chat-input-textarea","data-disabled-button-clicked":!0,value:P,placeholder:M,minLine:s,onChangeText:W=>S.updateInputValue(W),onPasteFiles:W=>{W.length>0&&(v?.appearance_v2_enabled?b(W):y(W))},onPaste:W=>S.emit("onPaste",W),onEnter:O,onCompositionStart:()=>S.setIsComposing(!0),onCompositionEnd:()=>S.setIsComposing(!1),stopPropagation:!0,disabled:X,...q}),i||V?to.default.createElement(B,{display:"flex",alignItems:"center",justifyContent:"space-between"},!L&&to.default.createElement(g,{direction:"row",spacing:1},i),to.default.createElement(g,{direction:"row",spacing:1,flex:1,justifyContent:"flex-end",overflow:"hidden"},V)):null),r)},C9=BD;var E9=I(E());var S9=I(y9()),v9=I(b9()),y0=I(Ef());var Pe=I(E()),T9={borderRadius:1,border:e=>`1px solid ${e.palette.border.main}`,background:e=>e.palette.background.default,flexDirection:"row",position:"relative",mt:1,p:1,gap:1.5,height:"62px",boxSizing:"border-box",width:"282px",minWidth:"282px",overflowY:"visible","& > .chat-file-list-cancel-icon":{opacity:0,transition:"opacity 0.1s ease-in-out",position:"absolute",top:0,right:0,transform:"translate3d(50%, -50%, 0)",fontSize:"14px",zIndex:10,overflow:"visible",cursor:"pointer",color:"text.primary",fill:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.6)"},"& > .chat-file-list-cancel-icon:hover":{opacity:1},"&:hover > .chat-file-list-cancel-icon":{opacity:1}},VD={...T9,p:0,width:"62px",minWidth:"62px",border:"1px solid rgba(0, 0, 0, 0.08)",borderRadius:e=>e.spacing(.5),position:"relative"},I9={height:"40px",width:"40px",fontSize:"40px",cursor:"pointer",color:"text.primary"},w9={fontWeight:500,color:"text.primary",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:"14px",width:"100%"},UD={...w9,color:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},C0=Io(de)(({theme:e})=>({background:e.palette.mode==="dark"?"rgba(144, 101, 176, 0.2)":"#F9F5FF",color:"#9065B0",borderRadius:"8px",padding:"4px 8px"})),WD=e=>{let{files:t,onRemoveFiles:o,loading:n,onSendMessage:r,sx:i}=e,[a,s]=(0,Pe.useState)(!1),[l,p]=(0,Pe.useState)(!1),[c,u]=(0,Pe.useState)(!1),m=(0,Pe.useRef)(null),{t:d}=k(),{inputMediator:f}=ie(),h=()=>{if(!m.current)return;let L=m.current;s(L.scrollWidth!==L.offsetWidth),p(L.scrollLeft-24<=0),u(L.scrollLeft+L.offsetWidth+24>=L.scrollWidth)},_=L=>{r?.(L),f.focus()},x=()=>{if(!m.current)return;let L=Array.from(m.current.children);for(let H of L){if(!(H instanceof HTMLElement))continue;let z=H.offsetLeft-10;if(z>m.current.scrollLeft){m.current.scrollTo({left:z,behavior:"smooth"});break}}},C=()=>{if(!m.current)return;let L=Array.from(m.current.children).reverse();for(let H of L){if(!(H instanceof HTMLElement))continue;let z=H.offsetLeft-10;if(z<m.current.scrollLeft){m.current.scrollTo({left:z,behavior:"smooth"});break}}},y=(0,Pe.useRef)([]),b=async L=>{if(!y.current.includes(L.id)){y.current.push(L.id);try{await o?.([L])}catch{}finally{y.current=y.current.filter(H=>H!==L.id)}}},[v,S]=(0,Pe.useState)(void 0),M=(0,Pe.useMemo)(()=>t.filter(L=>L.icon==="image").map(L=>({src:L.uploadedUrl||L.base64Data||L.blobUrl||"",alt:L.fileName})),[t]);if((0,Pe.useEffect)(()=>{t.length>0&&h()},[t]),(0,Pe.useEffect)(()=>{if(!m.current)return;let L=m.current,H=new ResizeObserver(()=>h());return H.observe(L),()=>{H.unobserve(L),H.disconnect()}},[t.length===0]),t.length===0)return null;let P=!!t.find(L=>L.icon!=="image"),O=!!t.find(L=>L.uploadStatus==="uploading");return Pe.default.createElement(g,{spacing:1,sx:{mt:"-8px",...i}},Pe.default.createElement(B,{width:"100%",position:"relative",sx:{boxSizing:"border-box",overflow:"visible","& .chat-file-list-overflow-icon":{opacity:0,transition:"opacity 0.1s ease-in-out"},"&:hover .chat-file-list-overflow-icon":{opacity:1}}},Pe.default.createElement(g,{direction:"row",onScroll:h,ref:m,tabIndex:-1,sx:{gap:1,overflowX:"auto",boxSizing:"border-box",width:"100%",height:"100%",overflowY:"hidden",scrollbarColor:"auto","&::-webkit-scrollbar":{height:0,width:0,background:"transparent",display:"none"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}},t.map((L,H)=>L.icon==="image"?Pe.default.createElement(B,{key:`${L.id}-${H}`,sx:VD},Pe.default.createElement(xi,{width:"60px",height:"100%",alt:L.fileName,src:L.uploadedUrl||L.base64Data||L.blobUrl||"",SkeletonSx:{borderRadius:z=>z.spacing(.5)},imageSx:{borderRadius:z=>z.spacing(.5),height:"60px",width:"60px",objectFit:"cover",cursor:"pointer"},onImageClick:()=>{S(L.uploadedUrl||L.base64Data||L.blobUrl||"")}}),Pe.default.createElement(y0.default,{className:"chat-file-list-cancel-icon",onClick:()=>b(L)}),L.uploadStatus==="uploading"&&Pe.default.createElement(B,{sx:{position:"absolute",zIndex:1,top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",bgcolor:"transparent",backdropFilter:"blur(2px)",borderRadius:z=>z.spacing(.5)}},Pe.default.createElement(Lt,{size:40,thickness:4}))):Pe.default.createElement(g,{sx:T9,key:`${L.id}-${H}`},L.uploadStatus==="uploading"?Pe.default.createElement(B,{sx:I9},Pe.default.createElement(Lt,{size:40,thickness:4})):Pe.default.createElement(Pf,{filename:L.fileName,filetype:L.fileType,sx:I9}),Pe.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},Pe.default.createElement(T,{sx:w9},L.fileName),Pe.default.createElement(T,{sx:UD},L.fileType)),Pe.default.createElement(y0.default,{className:"chat-file-list-cancel-icon",onClick:()=>b(L)})))),a&&!l&&Pe.default.createElement(B,{className:"chat-file-list-overflow-icon",onClick:C,sx:{backdropFilter:"blur(1px)",background:"rgba(0, 0, 0, 0.60)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",position:"absolute",left:"0",top:"50%",transform:"translate3d(50%, -50%, 0)",borderRadius:"8px",cursor:"pointer",padding:"4px 0",height:"24px",width:"16px"}},Pe.default.createElement(S9.default,{sx:{fontSize:L=>L.spacing(2),color:"white"}})),Pe.default.createElement(mp,{images:M,selectedImage:v,setSelectedImage:S}),a&&!c&&Pe.default.createElement(B,{className:"chat-file-list-overflow-icon",onClick:x,sx:{backdropFilter:"blur(1px)",background:"rgba(0, 0, 0, 0.60)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.05)",position:"absolute",right:"0",top:"50%",transform:"translate3d(-50%, -50%, 0)",borderRadius:"8px",cursor:"pointer",padding:"4px 0",height:"24px",width:"16px"}},Pe.default.createElement(v9.default,{sx:{fontSize:L=>L.spacing(2),color:"white"}}))),Pe.default.createElement(g,{direction:"row",gap:1},P?Pe.default.createElement(C0,{disabled:n||O,onClick:()=>{_("Summarize")},"data-testid":"chat-input--file-prompt--summarize"},d("package__features:chat__input__file_prompt__summarize__title")):Pe.default.createElement(Pe.default.Fragment,null,Pe.default.createElement(C0,{disabled:n||O,onClick:()=>{_("Extract text")},"data-testid":"chat-input--file-prompt--extract-text"},d("package__features:chat__input__file_prompt__extract_text__title")),Pe.default.createElement(C0,{disabled:n||O,onClick:()=>{_?.("Explain content")},"data-testid":"chat-input--file-prompt--explain-content"},d("package__features:chat__input__file_prompt__explain_content__title")))))},M9=WD;var GD=e=>{let{conversationId:t}=ie(),o=fe(t),{files:n,removeFiles:r}=cm(),{askAIQuestion:i}=ke();return E9.default.createElement(M9,{files:n,loading:o,onRemoveFiles:r,onSendMessage:a=>{i({type:"user",text:a,conversationId:t,meta:{includeHistory:!1}})},...e})},A9=GD;var P9=I(Rw());var en=I(E()),Uf=[{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title",icon:en.default.createElement(Ri,{sx:{fontSize:"20px"},icon:"File"}),addContextType:"files",testid:"maxai--chat-document-selector--modal--preset-button--files"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title",icon:en.default.createElement(Ri,{sx:{fontSize:"20px"},icon:"Text"}),addContextType:"text",testid:"maxai--chat-document-selector--modal--preset-button--text"},{title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__urls__title",icon:en.default.createElement(Ri,{sx:{fontSize:"20px"},icon:"URLs"}),addContextType:"urls",testid:"maxai--chat-document-selector--modal--preset-button--urls"}],k9=[{chatDocumentId:Lx,title:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__search__title",icon:en.default.createElement(Ri,{sx:{fontSize:"20px"},icon:"Search"}),addContextType:"search",testid:"maxai--chat-document-selector--modal--preset-button--search"}],jD=e=>{let{t}=k(),{chatDocuments:o}=Ci(),{dataList:n,activeIndex:r,onSelect:i,showEnterIcon:a=!1}=e;return en.default.createElement(hi,{sx:{p:0,overflowY:"auto",position:"relative",width:"100%",gap:"2px"}},n.map((s,l)=>{let p=r===l,c=o.find(d=>d.id===s.chatDocumentId),u=c?.selected,m=location.href===c?.link?[t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__current__title")]:[];return en.default.createElement(mt,{disabled:s.disabled,key:l,selected:p,onClick:()=>i&&i(s,l,n),sx:{p:"1px 0",width:"calc(100% - 12px)",left:"6px",borderRadius:"6px",minHeight:"unset"},"data-testid":s.testid||`maxai--chat-document-selector--modal--existing-document-button--${c?.maxAIDocumentType||"chat_file"}`},en.default.createElement(xe,{zIndex:2147483621,title:s.tooltip||"",placement:"left",PopperProps:{modifiers:[{name:"flip",enabled:!0,options:{fallbackPlacements:["top","right"]}}],sx:{[`&.${vn.popper}[data-popper-placement*="left"] > .${vn.tooltip}`]:{mr:"20px"}}}},en.default.createElement(g,{direction:"row",sx:{alignItems:"center",p:1,borderRadius:"8px",gap:"12px",position:"relative",width:"100%","& > button:last-of-type":{display:"none"},"&:hover":{"& > button:last-of-type":{display:"block"}}}},u&&en.default.createElement(B,{sx:{position:"absolute",width:"3px",height:"100%",left:"-6px",top:0,backgroundColor:"primary.main"}}),en.default.createElement(Dp,{sx:{width:"20x",height:"20px",minWidth:"20px!important",flexShrink:0}},c?en.default.createElement(Tf,{size:20,chatDocument:c}):s.icon),en.default.createElement(g,{direction:"row",gap:"4px",width:0,flex:1},en.default.createElement(T,{width:0,flex:1,noWrap:!0,sx:{textAlign:"left",fontSize:"14px",color:"text.primary"}},t(s.title)," ",s.disabled?" (TODO)":""),en.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center",component:"div",flexShrink:0},m.map(d=>en.default.createElement(wf,{key:d,sx:{color:"text.secondary"},label:d})))),p&&a&&en.default.createElement(P9.default,{sx:{flexShrink:0,fontSize:"16px",color:"text.secondary"}}),s.suffix)))}))},L9=jD;var Ps=I(E()),qD=e=>{let{onAddContextClick:t,disabled:o}=e,{t:n}=k(),{selectedChatDocuments:r,toggleSelectedChatDocument:i,setChatDocuments:a}=hl(),{chatHubLoading:s}=dt(),l=(0,Ps.useMemo)(()=>Zs(r,["createdAt"],["desc"]).sort((c,u)=>c.link===window.location.href?-1:u.link===window.location.href?1:0),[r]),p=c=>{c.status==="uploading"?a(u=>u.filter(m=>m.id!==c.id)):i(c.id)};return l.length>0?Ps.default.createElement(Ps.default.Fragment,null,l.map(c=>Ps.default.createElement(fp,{disabled:s,dataTestId:"maxai--chat-document-selector--selected-document-button",key:c.id,onClose:()=>{p(c)},showClose:!0,chatDocument:c}))):Ps.default.createElement(T,{fontSize:"14px",sx:{color:o?"action.disabled":"text.secondary",userSelect:"none"},onClick:t},n("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title"))},O9=qD;var D9=I(B9()),F9=I(Sr());var Bt=I(E()),YD=e=>{let{t}=k(),o=Ks(),{controlsRef:n,show:r,onClose:i,onConfirm:a,onBack:s,children:l,title:p,confirmBtnText:c,confirmBtnTextId:u,confirmBtnSx:m,cancelBtnText:d,cancelBtnSx:f,confirmBtnDisabled:h,modalSx:_,wrapSx:x,footerVariant:C,BackdropTransparent:y,disableScrollLock:b=!0,variant:v="default",isFixed:S,footerSlot:M}=e,[P,O]=Bt.default.useState(null),[L,H]=(0,Bt.useState)(C),[z,R]=(0,Bt.useState)(!1),V=(0,Bt.useCallback)(W=>{i(W)},[i]);(0,Bt.useEffect)(()=>{!L&&r&&P&&(P.clientWidth<=680?H("vertical"):H("horizontal"))},[r,P]);let F=(0,Bt.useCallback)(async()=>{R(!0),await a?.()!==!1&&V(),R(!1)},[a,V,R]);(0,Bt.useImperativeHandle)(n,()=>({clickConfirm:F}));let q=(0,Bt.useMemo)(()=>{let W={danger:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}},default:{}};return W[v]||W.default},[v]),X=S===void 0?o:S;return Bt.default.createElement(ci,{sx:{position:X?"fixed":"absolute",..._},disableScrollLock:b,open:r,onClose:(W,j)=>V(j),slotProps:{root:{onClick:W=>{W.stopPropagation()}},backdrop:{sx:{position:X?"fixed":"absolute",...y?{backgroundColor:"transparent"}:{}}}}},Bt.default.createElement(B,{ref:O,sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"calc(100% - 32px)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",...x}},Bt.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"}},Bt.default.createElement(T,{sx:{fontSize:"24px",fontWeight:700,lineHeight:"34px",textAlign:"left",color:"text.primary",margin:"24px",display:"flex",alignItems:"center",gap:"4px"}},s&&Bt.default.createElement(Re,{sx:{color:"text.secondary"},onClick:()=>{s(),V("backButton")}},Bt.default.createElement(D9.default,null)),p),Bt.default.createElement(Re,{sx:{margin:"8px"},onClick:()=>V()},Bt.default.createElement(F9.default,{sx:{color:"text.secondary"}}))),l,Bt.default.createElement(g,{sx:{padding:"24px",alignItems:"center",flexDirection:L==="vertical"?"column":"row",justifyContent:"end",gap:"8px"}},M||Bt.default.createElement(Bt.default.Fragment,null,Bt.default.createElement(de,{variant:"text",color:"secondary",sx:{color:"text.secondary",padding:"10px 16px",lineHeight:"20px",width:L==="vertical"?"100%":"auto",order:L==="vertical"?1:0,"&:hover":{bgcolor:W=>W.palette.mode==="light"?"rgba(0, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"},...f},onClick:()=>V()},d||t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__cancel__title")),Bt.default.createElement(Yn,{"data-testid":u,disabled:h,variant:"contained",onClick:F,loading:z,sx:{padding:"10px 16px",lineHeight:"20px",width:L==="vertical"?"100%":"auto",order:L==="vertical"?0:1,...q,...m}},c||t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__done__title"))))))},Pi=YD;var Br=I(E()),ZD=Io(b2)(({theme:e})=>({fontFamily:e.typography.fontFamily,width:"100%",display:"block",padding:"16px",boxSizing:"border-box",fontSize:"16px",backgroundColor:"transparent",border:"none",outline:"none",resize:"none",lineHeight:"1.5",color:e.palette.text.primary,scrollbarColor:e.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"})),H9=(0,Br.forwardRef)(({minHeight:e,maxHeight:t,style:o,...n},r)=>{let i=(0,Br.useRef)(null),[a,s]=(0,Br.useState)(null);(0,Br.useEffect)(()=>{if(i.current){let c=window.getComputedStyle(i.current),u=parseInt(c.lineHeight,10)||parseInt(c.height,10),m=parseInt(c.paddingTop,10),d=parseInt(c.paddingBottom,10);s({lineHeight:u,paddingY:m+d})}},[]);let{minRows:l,maxRows:p}=(0,Br.useMemo)(()=>{if(!a||!e)return{minRows:void 0,maxRows:void 0};let{lineHeight:c,paddingY:u}=a,m=Math.max(Math.ceil((e-u)/c),1),d=t?Math.max(Math.ceil((t-u)/c),m):void 0;return{minRows:m,maxRows:d}},[a,e,t]);return Br.default.createElement(ZD,{ref:c=>{typeof r=="function"?r(c):r&&(r.current=c),i.current=c},minRows:l,maxRows:p,style:o,...n})});H9.displayName="MaxAITextareaAutosize";var N9=H9;var gr=I(E()),QD=e=>{let{t}=k(),o=gr.default.useRef(null),[n,r]=(0,gr.useState)(""),{show:i,BackdropTransparent:a,onClose:s,onConfirm:l,onBack:p}=e,c=f=>{r(""),s(f)};(0,gr.useEffect)(()=>{i&&(setTimeout(()=>{o.current?.focus()},0),setTimeout(()=>{o.current?.focus()},100))},[i]);let u=(0,gr.useCallback)(f=>{r(f.target.value)},[]),m=(0,gr.useCallback)(()=>{l?.(n),c()},[l,n,c]),d=(0,gr.useCallback)(f=>{f.key!=="Escape"&&f.stopPropagation()},[]);return gr.default.createElement(Pi,{confirmBtnTextId:"maxai--project--paste-text-modal--confirm-button",show:i,BackdropTransparent:a,onClose:c,title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__title"),confirmBtnDisabled:n.trim()==="",onConfirm:m,onBack:p},gr.default.createElement(g,{sx:{borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},gr.default.createElement(N9,{ref:o,value:n,onChange:u,onKeyDown:d,placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_text__placeholder"),minHeight:269,maxHeight:511})))},z9=QD;var R9=I(f0());var Gf=I(E()),JD=e=>{let{errorText:t,showIcon:o,icon:n,iconSize:r,sx:i}=e;return Gf.default.createElement(B,{sx:{display:"inline-flex",alignItems:"center",gap:"4px",fontSize:"12px",textAlign:"left",fontWeight:400,color:"error.main",...i}},o&&n?n:Gf.default.createElement(R9.default,{sx:{color:"inherit",fontSize:r||16}}),Gf.default.createElement(T,{color:"inherit",fontSize:"inherit",fontWeight:"inherit"},t))},V9=JD;var _o=I(E()),eF={INVALID_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__invalid_url",EXISTS_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__exists_url",TOO_MUCH_URL:"package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__error__too_much_url"},U9=()=>({INVALID_URL:!1,EXISTS_URL:!1,TOO_MUCH_URL:!1}),tF=e=>{let{t}=k(),{show:o,BackdropTransparent:n,onClose:r,onChange:i,onBack:a}=e,[s,l]=(0,_o.useState)(""),[p,c]=(0,_o.useState)(U9),{chatDocuments:u}=Ci(),[m,d]=(0,_o.useState)([]),f=(0,_o.useRef)(null),h=(0,_o.useRef)(!1),_=(0,_o.useMemo)(()=>{let b=Object.keys(p).find(v=>p[v]);return b?t(eF[b]):""},[p,t]),x=(0,_o.useMemo)(()=>m.length===0||_!=="",[m,_]),C=b=>{let v=u.map(P=>P.link).concat(m.map(P=>P.link)),S=b.map(P=>P.startsWith("http")?P:`https://${P}`).filter(P=>!v.includes(P));if(S.length===0){c(P=>({...P,EXISTS_URL:!0}));return}c(P=>({...P,EXISTS_URL:!1}));let M=S.map(P=>({id:Xo(),status:"idle",title:P,link:P,maxAIDocumentType:"page_content__webpage"}));d(P=>P.concat(M))};return(0,_o.useEffect)(()=>{o&&(setTimeout(()=>{f.current?.focus()},0),setTimeout(()=>{f.current?.focus()},100))},[o]),(0,_o.useEffect)(()=>{m.length>Px?c(b=>({...b,TOO_MUCH_URL:!0})):c(b=>({...b,TOO_MUCH_URL:!1}))},[m]),_o.default.createElement(Pi,{confirmBtnTextId:"maxai--project--paste-url-modal--confirm-button",show:o,BackdropTransparent:n,onClose:b=>{l(""),d([]),r(b),c(U9)},title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__modal__title"),confirmBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__done__title"),cancelBtnText:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__modal__cancel__title"),confirmBtnDisabled:x,onConfirm:()=>(i?.(m.map(b=>b.link)),!0),onBack:a},_o.default.createElement(g,{sx:{padding:"24px",gap:"8px",maxHeight:"264px",boxSizing:"border-box",borderTop:"1px solid",borderBottom:"1px solid",borderColor:"border.main"}},m.length>0&&_o.default.createElement(g,{direction:"row",gap:"8px",flexWrap:"wrap"},m.map(b=>_o.default.createElement(fp,{showClose:!0,key:b.id,onClose:()=>{d(v=>v.filter(S=>S.id!==b.id))},chatDocument:b}))),_o.default.createElement(B,{component:"textarea",ref:f,value:s,onCompositionStart:b=>{h.current=!0},onCompositionEnd:b=>{h.current=!1,l(b.currentTarget.value)},onKeyDown:b=>{if(b.key!=="Escape"&&b.stopPropagation(),b.key==="Enter"||b.code==="Space"){if(h.current)return;let v=s.trim();rs(v)&&(C([v]),c(S=>({...S,INVALID_URL:!1})),l(""),b.preventDefault())}},onChange:b=>{l(b.target.value)},onPaste:b=>{let M=b.clipboardData.getData("text").trim().split(`
`).filter(P=>rs(P));M.length>0?(C(M),c(P=>({...P,INVALID_URL:!1}))):c(P=>({...P,INVALID_URL:!0})),l(""),b.preventDefault()},placeholder:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__paste_url__placeholder"),sx:{fontFamily:b=>b.typography.fontFamily,display:"block",width:"100%",height:"232px",padding:"0",fontSize:"16px",boxSizing:"border-box",border:"none",outline:"none",backgroundColor:"transparent",resize:"none",color:"text.primary",lineHeight:"1.5",scrollbarColor:b=>b.palette.mode==="dark"?"rgba(255, 255, 255, 0.6) transparent":"rgba(0, 0, 0, 0.6) transparent"}})),_&&_o.default.createElement(g,{sx:{gap:"4px",padding:"16px"}},_o.default.createElement(V9,{errorText:_})))},W9=tF;var b0=I(E()),oF=e=>{let{chatDocuments:t}=Ci(),o=(0,b0.useMemo)(()=>{let n=Ee(k9);return Zs(t,["createdAt"],["asc"]).forEach(i=>{if(i.hidden)return;let a={title:i.title,tooltip:i.title,addContextType:"document",link:i.link,chatDocumentId:i.id};a.link===window.location.href?n.unshift(a):n.push(a)}),n},[t]);return(0,b0.useMemo)(()=>{if(!e)return{showTitle:!0,chatDocumentsMenuList:o,filteredMenuList:Uf,matchCount:Uf.length};let n=Uf.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));if(n.length)return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:n,matchCount:n.length};let r=o.filter(i=>i.title.toLowerCase().includes(e.toLowerCase()));return{showTitle:!1,chatDocumentsMenuList:[],filteredMenuList:r,matchCount:r.length}},[e,o])},G9=oF;var K9=I(pa());var ge=I(E());var Jt=I(E()),j9=I(Sr());var nF=[{value:"prompt",testId:"input--big-text-paste-selector--prompt",labelI18nKey:"package__features:chat__big_text_paste__options__prompt"},{value:"source",testId:"input--big-text-paste-selector--source",labelI18nKey:"package__features:chat__big_text_paste__options__source"}],rF=(0,Jt.forwardRef)((e,t)=>{let{t:o}=k(),[n,r]=(0,Jt.useState)(!1),[i,a]=(0,Jt.useState)(""),s=(0,Jt.useRef)(),l=(0,Jt.useCallback)(()=>{r(!1),s.current?.resolve(!1)},[]),p=(0,Jt.useCallback)(u=>{r(!1),s.current?.resolve(u)},[]),c=(0,Jt.useCallback)(async u=>(r(!0),a(u),new Promise((m,d)=>{s.current={resolve:m,reject:d}})),[]);return(0,Jt.useImperativeHandle)(t,()=>({confirmSelect:c})),Jt.default.createElement(ci,{open:n,onClose:l,sx:{position:"absolute"},slotProps:{backdrop:{sx:{position:"absolute"}}}},Jt.default.createElement(B,{sx:{outline:"none",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"min(448px, calc(100% - 32px))",maxWidth:"min(calc(1168px - 32px), calc(100% - 32px))",maxHeight:"calc(100% - 32px)",overflow:"auto",backgroundColor:"background.paper",boxSizing:"border-box",borderRadius:"16px",width:"448px",padding:"24px"}},Jt.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",position:"relative",height:"24px"}},Jt.default.createElement(sx,{sx:{color:"text.primary"}}),Jt.default.createElement(Re,{sx:{position:"absolute",right:0,top:0,width:"24px",height:"24px"},onClick:l},Jt.default.createElement(j9.default,{sx:{color:"text.secondary"}}))),i&&Jt.default.createElement(B,{sx:{boxSizing:"border-box",padding:"12px",border:u=>`1px solid ${u.palette.border.main}`,borderRadius:"8px",marginTop:"16px"}},Jt.default.createElement(T,{sx:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontWeight:400,fontSize:"16px",lineHeight:"150%",color:"text.tertiary"}},i)),Jt.default.createElement(g,{sx:{gap:1,marginTop:"24px"}},nF.map(u=>Jt.default.createElement(de,{variant:"contained",onClick:()=>p(u.value),"data-testid":u.testId,sx:{padding:"10px 16px",lineHeight:"20px"}},o(u.labelI18nKey))))))}),q9=rF;var iF=e=>{let{t}=k(),{hideFileList:o=!1}=e,n=ge.default.useRef(null),r=(0,ge.useRef)(null),{createNewPrompt:i}=bi(),{setTemplate:a}=Ta(),[s,l]=(0,ge.useState)(!1),[p,c]=(0,ge.useState)(!1),[u,m]=(0,ge.useState)(!1),[d,f]=(0,ge.useState)(0),[h,_]=(0,ge.useState)(""),x=he(Z=>Z.conversationType),{chatHubLoading:C}=dt(),{isWaitingSelectFile:y,setIsWaitingSelectFile:b,chatDocuments:v,toggleSelectedChatDocument:S,handleUploadFilesToChatDocuments:M,handleUploadLinksToChatDocuments:P,toggleMaxAISearchFeature:O}=hl(),L=(0,ge.useMemo)(()=>v.map(Z=>Z.link),[v]),H=(0,ge.useRef)(L);(0,ge.useEffect)(()=>{H.current=L},[L]);let{isUnavailableUploadSource:z,changeMyOwnToolsType:R}=er(),V=(0,ge.useMemo)(()=>C||z,[z,C]),{showTitle:F,chatDocumentsMenuList:q,filteredMenuList:X,matchCount:W}=G9(h),j=(0,ge.useCallback)(Z=>{let re=Z.key==="ArrowUp",bt=Z.key==="ArrowDown",be=0,Ce=W-1;return W&&(re||bt)?(Z.preventDefault(),Z.stopPropagation(),f(we=>re?we-1<0?Ce:we-1:we+1>Ce?be:we+1),!0):!1},[W]),w=(0,ge.useRef)(j);(0,ge.useEffect)(()=>{w.current=j},[W]);let ne=(0,ge.useRef)(s);(0,ge.useEffect)(()=>{f(0),ne.current=s},[X,s]),(0,ge.useEffect)(()=>{let Z=vt(x).ref;if(Z&&!1){let Ce=qe=>{if(qe.key==="@"){l(!0);return}if(qe.key==="Escape"){l(!1);return}ne.current&&w.current(qe)},we=qe=>{let Ze=qe.key==="ArrowUp",Kt=qe.key==="ArrowDown";if((Ze||Kt)&&ne.current&&W>0)return;let Fe=Z.selectionStart,pt=Z.value;if(Fe){let ct=pt.slice(0,Fe),kt=[],Ke=ct.indexOf("@");for(;Ke!==-1;)kt.push(Ke),Ke=ct.indexOf("@",Ke+1);let Dt=kt.reverse().find(ut=>ut<Fe);if(Dt!==void 0){let ut=ct.slice(Dt+1);l(!0),_(ut);return}}_(""),l(!1)};return Z.addEventListener("keydown",Ce,{capture:!0}),Z.addEventListener("keyup",we,{capture:!0}),()=>{Z.removeEventListener("keydown",Ce,{capture:!0}),Z.removeEventListener("keyup",we,{capture:!0})}}let bt=async Ce=>{if(V)return;let we=Ce.clipboardData?.getData("text").trim();if(we){if(we.length>=8e3){if(Ce.preventDefault(),Ce.stopPropagation(),!await Qe({emitEvent:!0}))return;let qe=vt(x);switch(await r.current?.confirmSelect(we)){case"prompt":{R("MY_OWN_TOOLS"),i(),a(qe.getInputValue()+we);return}break;case"source":{Ce.preventDefault(),Ce.stopPropagation();let Ze=new File([we],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await M([Ze]);return}default:break}}if(rs(we,!0)&&!H.current.includes(we)){Ce.preventDefault(),Ce.stopPropagation(),await P([we]);return}}},be=Ce=>{Ce===""&&b(!1)};return vt(x).addListener("onPaste",bt),vt(x).subscribe(be),()=>{vt(x).removeListener("onPaste",bt),vt(x).unsubscribe(be)}},[x,V]);let pe=()=>{if(V)return;b(!1),l(!s);let Z=vt(x).ref;Z&&Z.focus()},A=async()=>{let Z=await Ix({accept:kx});Z.length>0&&(await M(Z),l(!1))},U=async()=>{c(!0)},N=async()=>{m(!0)},ce=async Z=>{if(await Qe({emitEvent:!0}))switch(Z){case"file":await A();break;case"text":await U();break;case"url":await N();break}};return ge.default.createElement(B,{sx:{position:"relative"}},ge.default.createElement(g,{direction:"row",alignItems:"center",gap:"8px",flexWrap:"wrap"},ge.default.createElement(xe,{placement:"top",title:z?t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button__unavailable__tooltip"):void 0,disableInteractive:!0},ge.default.createElement(g,null,ge.default.createElement(se,{disabled:V,key:y.toString(),"data-testid":"maxai--chat-document-selector--button",title:t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__button_title"),onClick:pe,buttonRefBind:Z=>{n.current=Z},actived:y,sx:{color:Z=>Z.palette.mode==="dark"?"#ffffff":"rgba(0, 0, 0, 0.87)"},tooltipProps:y?{disableInteractive:!1,open:!0,placement:"top"}:{disableInteractive:!0}},ge.default.createElement(K9.default,null,ge.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ge.default.createElement("path",{d:"M13.1002 3.8002C13.1002 3.19268 12.6077 2.7002 12.0002 2.7002C11.3927 2.7002 10.9002 3.19268 10.9002 3.8002V10.9002H3.8002C3.19268 10.9002 2.7002 11.3927 2.7002 12.0002C2.7002 12.6077 3.19268 13.1002 3.8002 13.1002H10.9002V20.2002C10.9002 20.8077 11.3927 21.3002 12.0002 21.3002C12.6077 21.3002 13.1002 20.8077 13.1002 20.2002V13.1002H20.2002C20.8077 13.1002 21.3002 12.6077 21.3002 12.0002C21.3002 11.3927 20.8077 10.9002 20.2002 10.9002H13.1002V3.8002Z",fill:"currentColor"})))))),!o&&ge.default.createElement(O9,{disabled:V,onAddContextClick:pe})),ge.default.createElement(dl,{placement:"bottom-start",fallbackPlacements:["top-start"],disableScrollLock:!0,onClose:()=>{l(!1)},open:s&&W>0,anchorEl:n.current,PaperProps:{sx:{border:"none"}}},ge.default.createElement(g,{"data-testid":"maxai--chat-document-selector--card",sx:{borderRadius:1,maxWidth:"360px",minWidth:"240px",width:"fit-content",maxHeight:"264px",boxSizing:"border-box",border:"1px solid",borderColor:"border.main",py:"4px",bgcolor:Z=>Z.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",alignItems:"center",justifyContent:"center","& > div":{boxSizing:"border-box",width:"100%"}}},ge.default.createElement(g,{sx:{flexShrink:0}},F&&ge.default.createElement(T,{px:"8px",textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__title")),ge.default.createElement(g,{direction:"row",alignItems:"center",px:1},ge.default.createElement(se,{sx:{height:"36px"},onClick:()=>ce("url")},ge.default.createElement(Ri,{icon:"URLs"}),ge.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__url__title"))),ge.default.createElement(se,{sx:{height:"36px"},onClick:()=>ce("text")},ge.default.createElement(Ri,{icon:"Text"}),ge.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__text__title"))),ge.default.createElement(se,{sx:{height:"36px"},onClick:()=>ce("file")},ge.default.createElement(Ri,{icon:"File"}),ge.default.createElement("span",null,t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__add_sources__file__title"))))),ge.default.createElement(Ct,{sx:{my:"4px",width:"100%",flexShrink:0}}),q.length>0&&ge.default.createElement(g,{width:"100%",sx:{flex:1,height:0}},ge.default.createElement(T,{sx:{flexShrink:0},textAlign:"left",fontSize:"12px",lineHeight:"32px",height:"32px",color:"text.secondary",flexShrink:0,noWrap:!0,px:"8px"},t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__choose_sources__title")),ge.default.createElement(L9,{onSelect:Z=>{if(Z.addContextType==="search"){O();return}Z.chatDocumentId&&S(Z.chatDocumentId)},dataList:q})))),ge.default.createElement(z9,{show:p,onClose:()=>{c(!1)},onConfirm:async Z=>{let re=new File([Z],t("package__features:home_view__chat_with_any_content__chat__chat_document_selector__chip__pasted__title",{fileName:"text.txt"}),{type:"text/plain"});await M([re])}}),ge.default.createElement(W9,{show:u,onClose:()=>{m(!1)},onChange:async Z=>{await P(Z)}}),ge.default.createElement(q9,{ref:r}))},$9=iF;var oo=I(E()),aF=e=>{let{renderHeaderNode:t,renderFooterLeftNode:o,renderFooterRightNode:n,renderFooterNode:r,...i}=e,{conversationType:a}=ie(),s={screenshotButton:a==="Chat"&&oo.default.createElement(g9,null),uploadFileButton:a==="Chat"&&oo.default.createElement(_9,null),betaFeaturesButton:a==="Chat"&&oo.default.createElement(a9,null),upgradePlanButton:oo.default.createElement(x9,null),feedbackButton:oo.default.createElement(c9,null),myOwnToolsButton:oo.default.createElement(u9,null)},l={searchProToggle:a==="Search"&&oo.default.createElement(J8,null),artProToggle:null},p={documentSelector:oo.default.createElement($9,null),uploadFileList:oo.default.createElement(A9,null)},c={autoSuggestion:oo.default.createElement(qd,null)},u=o?o(s):oo.default.createElement(oo.default.Fragment,null,s.screenshotButton,s.uploadFileButton,s.betaFeaturesButton,s.upgradePlanButton),m=n?n(l):oo.default.createElement(oo.default.Fragment,null,l.searchProToggle,l.artProToggle),d=t?t(p):oo.default.createElement(oo.default.Fragment,null,p.documentSelector,p.uploadFileList),f=r?r(c):oo.default.createElement(oo.default.Fragment,null,c.autoSuggestion),[h,_]=(0,oo.useState)(!1);return oo.default.createElement(C9,{minLine:3,headerNode:oo.default.createElement(g,{sx:{p:"10px 10px 0 10px",...d?{mb:"-2px"}:{},"&:empty":{p:0}}},d),footerLeftNode:u,footerRightNode:m,footerNode:f,...i,sx:{boxShadow:x=>h?x.palette.mode==="dark"?"0px 0px 0px 1px rgba(255, 255, 255, 0.12)":"0px 0px 0px 1px rgba(0, 0, 0, 0.12)":void 0,...i.sx},textareaProps:{onFocus:()=>_(!0),onBlur:()=>_(!1),...i.textareaProps}})},X9=aF;var ks=I(E());var tv=I(Y9()),ov=I(Z9()),nv=I(Q9()),rv=I(J9()),iv=I(ev());var Kn=I(E()),IF=(e,t=24)=>{try{let[o,n]=e.split(":").map(Number),r=!1;n>o&&(e=`${n}:${o}`,r=!0);let i={"1:1":Kn.default.createElement(iv.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"3:2":Kn.default.createElement(tv.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"5:4":Kn.default.createElement(ov.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"7:5":Kn.default.createElement(nv.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}}),"16:9":Kn.default.createElement(rv.default,{sx:{fontSize:t,transform:r?"rotate(90deg)":"none"}})};return i[e]||i["1:1"]}catch{return null}},SF=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=tt(),n=t.thirdProviderSettings?.MAXAI_DALLE,[r,i]=(0,Kn.useState)(!1),a=$s.aspectRatios.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return Kn.default.createElement(ga,{"data-testid":"maxai-chat--advanced--settings--art--aspect-ratio"},Kn.default.createElement(ha,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__aspect_ratio__title")),Kn.default.createElement(_a,{sx:{fontSize:"16px",[`& .${xa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__aspect_ratio__title"),value:n?.aspectRatio||"1:1",onChange:async(s,l)=>{let p=a.find(c=>c.value===s.target.value);p&&o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:n?.generateCount||1,contentType:n?.contentType||"image",aspectRatio:p.value,resolution:p.origin.resolution||[1024,1024]}}})}},a.map((s,l)=>Kn.default.createElement(mt,{key:l,"data-value":s.value,value:s.value},Kn.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},IF(s.value),Kn.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label,` (${s.value})`))))))},av=SF;var ki=I(E()),vF=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=tt(),n=t.thirdProviderSettings?.MAXAI_DALLE,[r,i]=(0,ki.useState)(!1),a=$s.contentTypes.map(s=>({label:s.label(e),value:s.value,origin:s}))||[];return ki.default.createElement(ga,{"data-testid":"maxai-chat--advanced--settings--art--content-type"},ki.default.createElement(ha,{sx:{fontSize:16,color:"text.primary"}},e("package__features:art__text_to_image__advanced__content_type__title")),ki.default.createElement(_a,{sx:{fontSize:"16px",[`& .${xa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:e("package__features:art__text_to_image__advanced__content_type__title"),value:n?.contentType||"vivid",onChange:(s,l)=>{l.props.disabled||o({thirdProviderSettings:{MAXAI_DALLE:{generateCount:n?.generateCount||1,aspectRatio:n?.aspectRatio||"1:1",resolution:n?.resolution||[1024,1024],contentType:s.target.value}}})}},a.map((s,l)=>ki.default.createElement(mt,{key:l,"data-value":s.value,value:s.value},ki.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},s.origin?.exampleImage?ki.default.createElement("img",{width:24,height:24,alt:`${s.value} example`,src:s.origin?.exampleImage}):null,ki.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},s.label))))))},sv=vF;var TF=()=>{let{t:e}=k();return ks.default.createElement(g,{spacing:1},ks.default.createElement(g,{direction:"row",mb:1},ks.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__art__text_to_image__advanced__title"))),ks.default.createElement(g,{spacing:2},ks.default.createElement(av,null),ks.default.createElement(sv,null)))},lv=TF;var Ls=I(E());var Xa=I(E()),wF=[{value:"sogou",label:"Sogou Search"},{value:"brave",label:"Brave Search"},{value:"yandex",label:"Yandex Search"},{value:"naver",label:"Naver Search"},{value:"bing",label:"Bing Search"},{value:"yahoo",label:"Yahoo Search"},{value:"baidu",label:"Baidu Search"},{value:"google",label:"Google Search"}],MF=e=>{let{t}=k(),{localSettings:o,setLocalSettings:n}=tt(),[r,i]=(0,Xa.useState)(!1);return Xa.default.createElement(ga,null,Xa.default.createElement(ha,{sx:{fontSize:16,color:"text.primary"}},t("package__features:chat__app__search_advanced__search_engine__title")),Xa.default.createElement(_a,{sx:{fontSize:"16px",[`& .${xa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--engine-selector",size:"small",open:r,onClose:()=>i(!1),onOpen:()=>i(!0),label:t("package__features:chat__app__search_advanced__search_engine__title"),value:o.sidebarSettings?.search?.searchEngine||"google",onChange:(a,s)=>{s.props.disabled||n({sidebarSettings:{search:{searchEngine:a.target.value}}})},...e},wF.map((a,s)=>Xa.default.createElement(mt,{key:s,"data-value":a.value,value:a.value},Xa.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},a.label)))))},pv=MF;var Ya=I(E()),EF=Array.from({length:10},(e,t)=>t+1).map(e=>({value:e,label:`${e} result${e===1?"":"s"}`})),AF=()=>{let{t:e}=k(),{localSettings:t,setLocalSettings:o}=tt(),[n,r]=(0,Ya.useState)(!1);return Ya.default.createElement(ga,null,Ya.default.createElement(ha,{sx:{fontSize:16,color:"text.primary"}},e("package__features:chat__app__search_advanced__search_results__title")),Ya.default.createElement(_a,{sx:{fontSize:"16px",[`& .${xa.icon}`]:{fontSize:24}},MenuProps:{elevation:1,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"}},"data-testid":"chat-search--results-count-selector",size:"small",open:n,onClose:()=>r(!1),onOpen:()=>r(!0),label:e("package__features:chat__app__search_advanced__search_results__title"),value:t.sidebarSettings?.search?.maxResultsCount||6,onChange:(i,a)=>{a.props.disabled||o({sidebarSettings:{search:{maxResultsCount:Ru(i.target.value)?i.target.value:6}}})}},EF.map((i,a)=>Ya.default.createElement(mt,{key:a,"data-value":i.value,value:i.value},Ya.default.createElement(T,{component:"span",fontSize:14,color:"text.primary",textAlign:"left",noWrap:!0},i.label)))))},cv=AF;var PF=()=>{let{t:e}=k();return Ls.default.createElement(g,{spacing:1},Ls.default.createElement(g,{direction:"row",mb:1},Ls.default.createElement(T,{fontSize:"16px",fontWeight:600,color:"text.primary"},e("package__features:chat__app__search_advanced__title"))),Ls.default.createElement(g,{spacing:2},Ls.default.createElement(pv,null),Ls.default.createElement(cv,null)))},uv=PF;var tn=I(E()),kF=e=>{let{conversationType:t,conversationId:o}=ie(),{conversationType:n=t,children:r,...i}=e,{t:a}=k(),s=fe(o),[l,p]=(0,tn.useState)(null),c=f=>{p(f.currentTarget)},u=()=>{p(null)},m=!!l,d=(0,tn.useRef)(null);return["Search","Art"].includes(n)?tn.default.createElement(tn.default.Fragment,null,tn.default.createElement(ps,{title:a("package__features:chat__inputbox__button__advanced_options__tooltip"),id:"MaxAIAIAdvanced","data-button-clicked-name":"maxai-advanced-button","aria-owns":m?"mouse-over-popover":void 0,"aria-haspopup":"true",disabled:s,onClick:c,...i,sx:{position:"relative",...i.sx},testid:`maxai-chat--advanced--settings-button--${n.toLowerCase()}`},tn.default.createElement(G,{icon:"Tune",sx:{color:"text.primary",fontSize:"20px"}})),tn.default.createElement(Su,{open:m,anchorEl:l,id:"mouse-over-popover",elevation:2,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"},onClose:u,disableScrollLock:!0},tn.default.createElement(B,{ref:d,sx:{borderRadius:1,border:"1px solid #EBEBEB",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)",width:402,display:"flex",alignItems:"stretch",justifyContent:"center",flexDirection:"row"}},tn.default.createElement(g,{spacing:1,p:1,width:"100%"},n==="Search"&&tn.default.createElement(uv,null),n==="Art"&&tn.default.createElement(lv,null),r,tn.default.createElement(g,{sx:{minHeight:"28px"},width:"100%",spacing:1,alignItems:"center",direction:"row",justifyContent:"end",flexDirection:"row"},tn.default.createElement(Re,{onClick:f=>{f.stopPropagation(),u()}},tn.default.createElement(G,{icon:"Close",sx:{fontSize:"24px"}}))))))):null},mv=kF;var Dr=I(E()),LF=e=>{let{anchorElementSelectors:t='[data-testid="maxai-chat-history-button"]',placement:o="left-end",...n}=e,{t:r}=k(),[i,a]=Dr.default.useState(!1),[s,l]=Dr.default.useState(!0),p=he(d=>d.conversationIds),c=un(p[0]),u=fe(p[0]),m=(0,Dr.useCallback)(async()=>{let d=await Ue.getOnboardingDataByKey(dc),f=await Yo.cachedChatConversationService.getCacheConversationsByType("Chat");d&&c.length<=0&&u===!1&&f.length>0&&setTimeout(()=>{a(!0)},1e3)},[c,u]);return(0,Dr.useEffect)(()=>{Ue.getOnboardingDataByKey(ag).then(d=>l(!!d))},[]),(0,Dr.useEffect)(()=>{s||m()},[s,m]),s?null:Dr.default.createElement(Tt,{placement:o,trigger:i,anchorElementSelectors:t,keepPollingCheckAnchorEl:!0,onShow:()=>{Ue.setOnboardingData(ag,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Chat history > Got it"},...n},Dr.default.createElement(g,{spacing:.5},Dr.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__chat_history__title")),Dr.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__chat_history__description"))))},dv=LF;var Gt=I(E());var Zf=I(E());var Cp=I(E());var Wt=I(E());var I0=I(E()),OF=e=>{let{open:t,displaysText:o,onDelete:n,...r}=e,{t:i}=k(),a=i("package__features:chat__conversation_item__delete_chat__dialog__title");return I0.default.createElement(Pi,{show:t,onClose:s=>{r.onClose?.({},s)},title:a,onConfirm:()=>n?.(),confirmBtnText:i("package__common:delete"),wrapSx:{width:"448px"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},I0.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},i("package__features:chat__conversation_item__delete_chat__description")))},Yf=OF;var po=I(E()),BF=e=>{let{conversation:t,displaysText:o,disabled:n,onClose:r,onClickRename:i,onClickDelete:a,sx:s}=e,{deleteConversation:l}=ot(),{t:p}=k(),[c,u]=(0,po.useState)(null),m=!!c,[d,f]=(0,po.useState)(!1),h=x=>{x.preventDefault(),x.stopPropagation(),u(null),r?.()},_=async()=>{a?a():await l(t.id)&&f(!1)};return po.default.createElement(po.default.Fragment,null,po.default.createElement(xe,{placement:"top",title:p("package__common:more")},po.default.createElement(B,{sx:s},po.default.createElement(Re,{disabled:n,onClick:x=>{x.preventDefault(),x.stopPropagation(),u(x.currentTarget)},sx:{p:.5},"data-testid":"chat-conversation--more-actions-button"},po.default.createElement(G,{icon:"More",size:16})))),po.default.createElement(gi,{anchorEl:c,id:`${t.id}_MORE_ACTIONS_MENU`,open:m,onClose:h,onClick:h,slotProps:{paper:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1}}},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},po.default.createElement(mt,{"data-testid":"chat-conversation--rename-chat-button",onClick:x=>{i?.(),h(x)}},po.default.createElement(Dp,null,po.default.createElement(G,{icon:"DefaultIcon",size:16})),po.default.createElement(Fp,{sx:{fontSize:"14px",color:"text.primary"}},po.default.createElement(T,{sx:{fontSize:"14px",color:"text.primary"},component:"span"},p("package__common:rename")))),po.default.createElement(mt,{"data-testid":"chat-conversation--delete-chat-button",onClick:x=>{f(!0),h(x)},sx:{color:"#f44336"}},po.default.createElement(Dp,null,po.default.createElement(G,{icon:"Delete",size:16,sx:{color:"#f44336"}})),po.default.createElement(Fp,{sx:{fontSize:"14px"}},po.default.createElement(T,{sx:{fontSize:"14px"},component:"span"},p("package__features:chat__conversation_item__delete_chat__button__title"))))),po.default.createElement(Yf,{displaysText:o,open:d,onClose:x=>{x?.stopPropagation?.(),f(!1)},onDelete:()=>_()}))},fv=BF;var Os=I(E()),DF=e=>{let{keyword:t,sx:o,children:n}=e,r=(0,Os.useRef)(null),i=(0,Os.useMemo)(()=>{if(!t||!n)return[];let a=[],s=new RegExp(t,"gi"),l=0,p=s.exec(n);for(;p!==null;){let m=n.slice(l,p.index);m&&a.push({match:!1,content:m}),a.push({match:!0,content:t}),l=p.index+t.length,p=s.exec(n)}let c=n.slice(l,n.length);c&&a.push({match:!1,content:c});let u=a[0];if(!u.match&&a.length>1&&u.content.length>15){let f=u.content.length-15;a.some(_=>(_!==u&&(f+=_.content.length),f>15))&&(u.content=`...${u.content.slice(-4)}`)}return a},[t,n]);return Os.default.createElement(T,{ref:r,color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left",sx:o},i.length?i.map(a=>Os.default.createElement("span",{style:a.match?{background:"rgba(215, 164, 253, 0.4)"}:void 0},a.content)):n)},hv=DF;var FF=e=>{let{conversation:t,keyword:o,selected:n,onClick:r,sx:i,style:a,icon:s,label:l,order:p}=e,[c,u]=(0,Wt.useState)(!1),{editingNameRef:m,editing:d,setEditing:f,updateConversationName:h}=im(),{displaysText:_,displaysTime:x}=rm({...t,name:m.current||t.name}),C=(0,Wt.useMemo)(()=>{let v=t.meta?.AIProvider||"USE_CHAT_GPT_PLUS",S=t.meta?.AIModel||"";return Vo(v,S)?.title||S},[]),y=()=>{if(s)return s;let v=t.last_msg||t.match_message;if(v?.originalMessage?.metadata?.chatMode==="free_chat"||v?.meta?.chatMode==="free_chat")return Wt.default.createElement(Ir,{sx:{fontSize:22}});let S=v?.originalMessage?.metadata?.AIModel||v?.meta?.AIModel;return S?Wt.default.createElement(Mn,{size:24,provider:t.meta.AIProvider,model:S}):Wt.default.createElement(Ir,{sx:{fontSize:22}})},b=()=>l||Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement(Au,{sx:{flexShrink:0,width:"unset",fontSize:"12px",padding:"0!important",height:"16px!important","& > span":{padding:"0 6px"}},label:t.type==="ContextMenu"?"Rewrite":t.type,size:"small"}),Wt.default.createElement(T,{noWrap:!0,flex:1,textAlign:"left",width:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},C));return Wt.default.createElement(g,{id:`conversation-item-${t.id}`,"data-testid":p?`conversation-item-${p}`:"conversation-item",spacing:1,style:a,sx:i},Wt.default.createElement(g,{direction:"row",alignItems:"center",px:"12px",py:"8px",onMouseOver:()=>{u(!0)},onMouseOut:()=>{u(!1)},onClick:()=>r?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...n||d?{bgcolor:v=>v.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:v=>v.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}},"&:hover .conversation-list-row-more-action-button":{opacity:1}},spacing:2},Wt.default.createElement(g,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},y()),Wt.default.createElement(g,{width:0,flex:1},Wt.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1},Wt.default.createElement(g,{direction:"row",gap:1,alignItems:"center",flex:1,width:0},b()),Wt.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px"},x)),Wt.default.createElement(g,{position:"relative",direction:"row",alignItems:"center"},d?Wt.default.createElement(fa,{mouseEvent:"onMouseDown",onClickAway:()=>h(t)},Wt.default.createElement(zt,{onClick:v=>{v.stopPropagation()},"data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:v=>{v&&setTimeout(()=>{v.querySelector("input")?.focus()},0)},defaultValue:t.name,onChange:v=>{v.stopPropagation(),m.current=v.target.value.trim()},onKeyDownCapture:v=>{v.stopPropagation(),v.key==="Enter"&&h(t)},onPaste:v=>{v.stopPropagation()},sx:{width:"100%",mt:"1.5px",mb:"-5.625px","& input":{p:"2px 2px 2px 4px",fontSize:"14px"}}})):Wt.default.createElement(hv,{keyword:o},_),Wt.default.createElement(fv,{conversation:t,displaysText:_,onClose:()=>u(!1),onClickRename:()=>f(!0),sx:n||c?null:{position:"absolute",right:0,opacity:0}})))))},gv=(0,Wt.memo)(FF,_m);var xr=I(E());var _v=I(E());function HF(e){var t=e.lastRenderedStartIndex,o=e.lastRenderedStopIndex,n=e.startIndex,r=e.stopIndex;return!(n>o||r<t)}function NF(e){for(var t=e.isItemLoaded,o=e.itemCount,n=e.minimumBatchSize,r=e.startIndex,i=e.stopIndex,a=[],s=null,l=null,p=r;p<=i;p++){var c=t(p);c?l!==null&&(a.push(s,l),s=l=null):(l=p,s===null&&(s=p))}if(l!==null){for(var u=Math.min(Math.max(l,s+n-1),o-1),m=l+1;m<=u&&!t(m);m++)l=m;a.push(s,l)}if(a.length)for(;a[1]-a[0]+1<n&&a[0]>0;){var d=a[0]-1;if(!t(d))a[0]=d;else break}return a}var zF=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},RF=function(){function e(t,o){for(var n=0;n<o.length;n++){var r=o[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),VF=function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},xv=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e},UF=function(e){VF(t,e);function t(){var o,n,r,i;zF(this,t);for(var a=arguments.length,s=Array(a),l=0;l<a;l++)s[l]=arguments[l];return i=(n=(r=xv(this,(o=t.__proto__||Object.getPrototypeOf(t)).call.apply(o,[this].concat(s))),r),r._lastRenderedStartIndex=-1,r._lastRenderedStopIndex=-1,r._memoizedUnloadedRanges=[],r._onItemsRendered=function(p){var c=p.visibleStartIndex,u=p.visibleStopIndex;r._lastRenderedStartIndex=c,r._lastRenderedStopIndex=u,r._ensureRowsLoaded(c,u)},r._setRef=function(p){r._listRef=p},n),xv(r,i)}return RF(t,[{key:"resetloadMoreItemsCache",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this._memoizedUnloadedRanges=[],n&&this._ensureRowsLoaded(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var n=this.props.children;return n({onItemsRendered:this._onItemsRendered,ref:this._setRef})}},{key:"_ensureRowsLoaded",value:function(n,r){var i=this.props,a=i.isItemLoaded,s=i.itemCount,l=i.minimumBatchSize,p=l===void 0?10:l,c=i.threshold,u=c===void 0?15:c,m=NF({isItemLoaded:a,itemCount:s,minimumBatchSize:p,startIndex:Math.max(0,n-u),stopIndex:Math.min(s-1,r+u)});(this._memoizedUnloadedRanges.length!==m.length||this._memoizedUnloadedRanges.some(function(d,f){return m[f]!==d}))&&(this._memoizedUnloadedRanges=m,this._loadUnloadedRanges(m))}},{key:"_loadUnloadedRanges",value:function(n){for(var r=this,i=this.props.loadMoreItems||this.props.loadMoreRows,a=function(p){var c=n[p],u=n[p+1],m=i(c,u);m?.then(function(){if(HF({lastRenderedStartIndex:r._lastRenderedStartIndex,lastRenderedStopIndex:r._lastRenderedStopIndex,startIndex:c,stopIndex:u})){if(r._listRef==null)return;typeof r._listRef.resetAfterIndex=="function"?r._listRef.resetAfterIndex(c,!0):(typeof r._listRef._getItemStyleCache=="function"&&r._listRef._getItemStyleCache(-1),r._listRef.forceUpdate())}})},s=0;s<n.length;s+=2)a(s)}}]),t}(_v.PureComponent),Cv=UF;var S0=e=>{let{keyword:t,conversations:o,isLoading:n,isNextPageLoading:r,hasNextPage:i,loadNextPage:a,selectedIds:s,itemSize:l=60,onSelectItem:p,onRenderItem:c,emptyNode:u,sx:m}=e,d=i?o.length+1:o.length,f=!n&&!r&&o.length===0,h=(0,xr.useCallback)(()=>{r||a()},[r,a]),_=C=>!i||C<o.length,x=(0,xr.useCallback)(C=>{C?p?.(C):h()},[h,p]);return xr.default.createElement(g,{flex:1,height:0,spacing:1,p:1,boxSizing:"border-box",className:"conversation-list",sx:m},xr.default.createElement(En,{loading:n},xr.default.createElement(Cv,{isItemLoaded:_,itemCount:d,loadMoreItems:h},({onItemsRendered:C,ref:y})=>xr.default.createElement(iy,null,({height:b,width:v})=>xr.default.createElement(ry,{height:b,width:v,style:{flex:1},itemData:o,itemSize:l,itemCount:d,onItemsRendered:C,ref:y,className:"maxai--conversation-list",...e},S=>{let M=S.data[S.index];return M&&c?c(M,{conversation:M,keyword:t,selected:s?.includes(M.id),onClick:x,style:S.style,order:S.index+1}):M?xr.default.createElement(gv,{conversation:M,keyword:t,selected:s?.includes(M.id),onClick:x,style:S.style,order:S.index+1}):(n||r)&&xr.default.createElement(g,{style:S.style,width:"100%",alignItems:"center",justifyContent:"center",sx:{my:"16px"}},xr.default.createElement(Lt,{size:16,sx:{m:"0 auto"}}))})))),f?u:null)},vSe=xr.default.memo(S0);var WF=e=>{let{conversationIds:t,conversationType:o}=he(C=>({conversationIds:C.conversationIds.slice(0,C.layout),conversationType:C.conversationType})),{switchConversation:n,asyncUpdateConversation:r}=ot(),{conversationType:i=o,selectedIds:a=t,onSelectItem:s,queryOptions:l,onClose:p,onChangeConversations:c,...u}=e,{conversations:m,isLoading:d,isFetchingNextPage:f,fetchNextPage:h,hasNextPage:_}=rC(i,l),x=(0,Cp.useCallback)(async C=>{if(a.includes(C.id)){p?.();return}C.id&&(await Yo.getService().addOrUpdateConversation(C.id,C,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!0}),C.updated_at=new Date().toISOString(),await n(C.id,C),s?.(C),r(C.id))},[a,s,p]);return(0,Cp.useEffect)(()=>{c&&c(m)},[m,c]),Cp.default.createElement(S0,{conversations:m,keyword:l?.keyword,isLoading:d,isNextPageLoading:f,hasNextPage:_,loadNextPage:h,selectedIds:a,onSelectItem:x,...u})},yv=WF;var v0=I(E()),GF=e=>{let{sx:t}=e,{t:o}=k();return v0.default.createElement(g,{"data-testid":"conversation-empty-view",alignItems:"center",justifyContent:"center",height:"40px",sx:t},v0.default.createElement(T,{fontSize:14,lineHeight:1.5,textAlign:"center",color:"text.tertiary"},o("package__features:chat__history_view__empty__title")))},bv=GF;var Ko=I(E());var _r=I(E()),jF=e=>{let{conversation:t,displaysText:o,onClose:n,onClickRename:r,onClickDelete:i,sx:a}=e,{deleteConversation:s}=ot(),{t:l}=k(),[p,c]=(0,_r.useState)(null),[u,m]=(0,_r.useState)(!1),d=h=>{h.preventDefault(),h.stopPropagation(),c(null),n?.()},f=async()=>{i?i():await s(t.id)&&m(!1)};return _r.default.createElement(_r.default.Fragment,null,_r.default.createElement(se,{title:l("package__common:more"),placement:"top",tooltipProps:{disableInteractive:!0},onClick:h=>{h.stopPropagation(),c(h.currentTarget)},sx:{...a}},_r.default.createElement(G,{icon:"More",size:16})),_r.default.createElement(gi,{anchorEl:p,open:!!p,onClose:d,onClick:d,slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},_r.default.createElement(Cl,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"rename",testid:"chat-conversation--rename-chat-button",icon:_r.default.createElement(G,{icon:"DefaultIcon"}),label:l("package__common:rename")},{value:"delete",testid:"chat-conversation--delete-chat-button",icon:_r.default.createElement(G,{icon:"Delete",sx:{color:"rgba(255, 14, 39, 1)!important"}}),label:l("package__common:delete"),labelSx:{color:"rgba(255, 14, 39, 1)!important"}}],sx:{width:200},onSelectOption:h=>{h==="rename"?r?.():h==="delete"&&m(!0),c(null)}})),_r.default.createElement(Yf,{displaysText:o,open:u,onClose:h=>{h?.stopPropagation?.(),m(!1)},onDelete:()=>f()}))},Iv=jF;var qF=e=>{let{conversation:t,selected:o,onClick:n,sx:r,style:i,order:a}=e,[s,l]=(0,Ko.useState)(!1),{editingNameRef:p,editing:c,setEditing:u,updateConversationName:m}=im(),{displaysText:d,displaysTime:f}=rm({...t,name:p.current||t.name}),h=()=>{let _=t.last_msg||t.match_message;if((_?.meta?.chatMode||_?.originalMessage?.metadata?.chatMode)==="free_chat")return Ko.default.createElement(Ir,{sx:{fontSize:22}});let C=_?.originalMessage?.metadata?.AIModel||_?.meta?.AIModel||t.meta.AIModel;return C?Ko.default.createElement(Mn,{size:24,provider:t.meta.AIProvider,model:C}):Ko.default.createElement(Ir,{sx:{fontSize:22}})};return Ko.default.createElement(g,{id:`conversation-item-${t.id}`,"data-testid":a?`conversation-item-${a}`:"conversation-item",spacing:1,style:i,sx:r},Ko.default.createElement(g,{direction:"row",alignItems:"center",pl:1.5,pr:1,height:40,onMouseOver:()=>{l(!0)},onMouseOut:()=>{l(!1)},onClick:()=>n?.(t),sx:{cursor:"pointer",borderRadius:"6px",userSelect:"none",...o||c?{bgcolor:_=>_.palette.mode==="dark"?"#383838":"#F0F0F0"}:{"&:hover":{bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"}}},spacing:2},Ko.default.createElement(g,{width:"24px",height:"24px",alignItems:"center",justifyContent:"center"},h()),Ko.default.createElement(g,{width:0,flex:1,position:"relative",direction:"row",alignItems:"center",gap:"2px"},c?Ko.default.createElement(fa,{mouseEvent:"onMouseDown",onClickAway:()=>m(t)},Ko.default.createElement(zt,{onClick:_=>{_.stopPropagation()},variant:"standard","data-testid":"maxai--conversation--rename-chat--input",size:"small",ref:_=>{_&&setTimeout(()=>{_.querySelector("input")?.focus()},0)},defaultValue:d,onChange:_=>{_.stopPropagation(),p.current=_.target.value.trim()},onKeyDownCapture:_=>{_.stopPropagation(),_.key==="Enter"&&m(t),_.key==="Escape"&&u(!1)},onPaste:_=>{_.stopPropagation()},sx:{flex:1,"& input":{fontSize:"14px"}}})):Ko.default.createElement(T,{color:"text.primary",fontSize:"14px",lineHeight:"24px",noWrap:!0,width:0,flex:1,textAlign:"left"},d),Ko.default.createElement(T,{flexShrink:0,color:"text.secondary",fontSize:"12px",lineHeight:"16px",sx:{display:o||s?"none":"block",textAlign:"right",width:"40px"}},f),Ko.default.createElement(g,{flexDirection:"row",sx:{width:"40px",justifyContent:"flex-end",...o||s?null:{position:"absolute",right:0,opacity:0}}},Ko.default.createElement(Iv,{conversation:t,displaysText:d,onClose:()=>l(!1),onClickRename:()=>u(!0)})))))},Sv=(0,Ko.memo)(qF,_m);var T0=I(E()),KF=e=>{let{open:t,onClose:o,onConfirm:n}=e,{t:r}=k(),i=r("package__features:chat__conversation_list__delete_all_chat__dialog__title"),a=r("package__features:chat__conversation_list__delete_all_chat__dialog__description");return T0.default.createElement(Pi,{show:t,onClose:o,title:i,onConfirm:n,confirmBtnText:r("package__common:delete"),wrapSx:{width:"auto"},confirmBtnSx:{backgroundColor:"rgba(237, 80, 80, 1)",color:"rgba(255, 255, 255, 1)","&:hover":{backgroundColor:"rgba(237, 99, 99, 1)",color:"rgba(255, 255, 255, 1)"}}},T0.default.createElement(T,{fontSize:"16px",color:"text.primary",px:"24px"},a))},vv=KF;var Fr=I(E()),$F=e=>{let{onDeleted:t,deleteOption:o,...n}=e,{t:r}=k(),{layout:i,conversationType:a,setConversationIds:s}=he(h=>({layout:h.layout,conversationType:h.conversationType,setConversationIds:h.setConversationIds})),{createConversation:l,deleteConversationsByType:p}=ot(),[c,u]=(0,Fr.useState)(null),[m,d]=(0,Fr.useState)(!1),f=async()=>{try{await p(a);let _=(await l(a,{reason:"initCreate"})).filter((x,C)=>C<i).map(x=>x.id);s(_),t?.()}catch{}finally{d(!1)}};return Fr.default.createElement(Fr.default.Fragment,null,Fr.default.createElement(se,{title:r("package__common:more"),placement:"left",onClick:h=>{u(h.currentTarget)},...n},Fr.default.createElement(G,{icon:"More",size:20})),Fr.default.createElement(gi,{anchorEl:c,open:!!c,onClose:()=>{u(null)},slotProps:{paper:{elevation:0,sx:{overflow:"unset",background:"transparent"}}}},Fr.default.createElement(Cl,{offset:{top:0,right:0,bottom:0,left:0},options:[{value:"delete",icon:Fr.default.createElement(G,{icon:"Delete",sx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"}}),label:r("package__features:chat__conversation_list__delete_all_chat__button__title"),labelSx:o?.disabled?null:{color:"rgba(255, 14, 39, 1)!important"},testid:"maxai-clear-all-chat-button",...o}],sx:{width:200},onSelectOption:h=>{h==="delete"&&d(!0),u(null)}})),Fr.default.createElement(vv,{open:m,onClose:()=>d(!1),onConfirm:f}))},Tv=$F;var wv=I(Ef()),Mv=I(Z1());var Bs=I(E()),XF=e=>{let{value:t,onChangeValue:o,InputProps:n,...r}=e,{t:i}=k();return Bs.default.createElement(zt,{size:"small",id:"filter-conversations",value:t,placeholder:i("package__common:search"),InputProps:{startAdornment:Bs.default.createElement(vr,{position:"start",sx:{mr:"4px"}},Bs.default.createElement(Mv.default,{sx:{fontSize:"24px"}})),endAdornment:t?Bs.default.createElement(vr,{position:"end"},Bs.default.createElement(Re,{onClick:()=>o?.(""),sx:{p:.5,mr:-.5},edge:"end"},Bs.default.createElement(wv.default,{sx:{fontSize:"18px"}}))):null,...n,sx:{fontSize:16,pl:"6px",pr:1,"& input":{padding:0,height:36},...n?.sx}},inputProps:{autoComplete:"off"},sx:{width:"100%"},autoFocus:!0,onChange:a=>{let s=a.target.value.replaceAll(/\<|\>|\*/g,"");o?.(s)},onKeyUp:a=>{a.stopPropagation()},onKeyDown:a=>{a.stopPropagation()},...r})},Ev=XF;var Av=I(Sr()),Pv=I(Z1());var co=I(E()),YF=e=>{let{onClose:t}=e,{t:o}=k(),n=he(u=>u.conversationType),[r,i]=(0,co.useState)([]),[a,s]=(0,co.useState)(""),[l,p]=(0,co.useState)(""),c=(0,co.useMemo)(()=>Tn(p,500),[]);return co.default.createElement(g,{height:"100%"},co.default.createElement(g,{direction:"row",spacing:1,alignItems:"center",px:2,pt:2,position:"relative"},co.default.createElement(se,{sx:{"& svg":{fontSize:"22px"}},onClick:t},co.default.createElement(Av.default,null)),co.default.createElement(T,{fontSize:16,fontWeight:500,lineHeight:2,flex:1,textAlign:"center"},o("package__features:chat__inputbox__button__chat_history__tooltip")),co.default.createElement(Tv,{deleteOption:{disabled:r.length===0},onDeleted:()=>{t()},placement:"top",sx:{"& svg":{fontSize:"22px"}}})),co.default.createElement(g,{direction:"column",spacing:1,alignItems:"center",px:2,pt:2,pb:2,position:"relative"},co.default.createElement(Ev,{value:a,InputProps:{startAdornment:co.default.createElement(vr,{position:"start"},co.default.createElement(Pv.default,null)),sx:{pl:1}},onChangeValue:u=>{s(u),c(u)}})),co.default.createElement(Ct,null),co.default.createElement(B,{flex:1,overflow:"hidden"},co.default.createElement(yv,{key:n,conversationType:n,queryOptions:{keyword:l},itemSize:48,emptyNode:co.default.createElement(bv,null),onRenderItem:(u,m)=>co.default.createElement(Sv,{...m}),onChangeConversations:i,onSelectItem:t,onClose:t,sx:{p:2,height:"100%"}})))},kv=YF;var ZF=e=>{let{open:t,onClose:o,paperRef:n}=e;return Zf.default.createElement(ll,{open:t,onClose:o,anchor:"bottom",sx:{zIndex:1502,position:"absolute",[`& .${sl.paper}`]:{position:"absolute",borderTopRightRadius:16,borderTopLeftRadius:16,height:"90vh",bgcolor:"background.paper"}},slotProps:{backdrop:{sx:{position:"absolute"}}}},Zf.default.createElement(zn,{tabIndex:-1,onKeyDown:r=>{t&&r.key==="Escape"&&o()},ref:n,elevation:0,sx:{boxSizing:"border-box",width:"100%",height:"100%",borderRadius:0}},t&&Zf.default.createElement(kv,{onClose:o})))},Lv=ZF;var QF=e=>{let{placement:t="top",sx:o,iconSx:n,onHistoryModalToggle:r}=e,{betaSettings:i}=Wo(),{t:a}=k(),{loaded:s,isLogin:l}=pn(),[p,c]=Gt.default.useState(!1),u=(0,Gt.useRef)(null),{conversationId:m}=he(F=>({conversationId:F.conversationIds[0]})),d=un(m),{conversationType:f}=ie(),{switchConversation:h,asyncUpdateConversation:_}=ot(),{chatHubLoading:x}=dt(),C=(0,Gt.useCallback)(()=>{c(!1)},[]);(0,Gt.useEffect)(()=>{V.current&&(C(),V.current=!1)},[f,C]);let y=a("package__features:chat__inputbox__button__chat_history__tooltip"),[b,v]=(0,Gt.useState)(!1),S=d.length===0,[M,P]=(0,Gt.useState)(!1),O=(0,Gt.useMemo)(()=>l&&i?.appearance_v2_enabled&&S&&ii?[{testid:"maxai--chat-history-button--options--clear-history",value:"continue-last-chat",label:a("package__features:chat__chat_history_button__continue_last_chat"),icon:M?Gt.default.createElement(G,{sx:{width:"20px",fontSize:"16px"},icon:"Loading"}):Gt.default.createElement(G,{sx:{fontSize:"20px"},icon:"HistoryOne"}),sx:{paddingLeft:M?"14px":"10px"}},{testid:"maxai--chat-history-button--options--chat-history",value:"chat-history",label:a("package__features:chat__inputbox__button__chat_history__tooltip"),icon:Gt.default.createElement(G,{icon:"History"})}]:[],[i?.appearance_v2_enabled,S,M,l,a]),L=(0,Gt.useCallback)(async F=>{await Yo.getService().addOrUpdateConversation(F.id,F,{syncToRemote:!1,isPartialUpdate:!1,updateUpdatedAt:!0}),F.updated_at=new Date().toISOString(),await h(F.id,F),await _(F.id)},[_,h]),H=et(r),z=!b&&M,R=(0,Gt.useCallback)(async()=>{let F=null;P(!0);let q=await Yo.getService().getPaginationConversationsByType(f,{page:0,pageSize:10,sortKey:"updated_at"}),X=q.data.filter(W=>W.lastMessageId);if(q.success&&X.length>0&&(F=X[0]),!F){Ni.info(a("package__features:chat__conversation_list__no_conversation__title"),{autoHideDuration:1500,disableWindowBlurListener:!0}),P(!1);return}await L(F),P(!1)},[f,L,a]);(0,Gt.useEffect)(()=>{p&&setTimeout(()=>{u.current?.focus()},100),H.current&&H.current(p)},[p]);let V=(0,Gt.useRef)(!1);return Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement(se,{placement:"left-end",title:O.length<1?y:null,"data-testid":"maxai-chat-history-button",disabled:x,tooltipProps:{placement:t},sx:o,OptionsCardProps:{sx:{width:"188px"}},options:O,onPopupStateChange:F=>{v(F)},defaultOptionValue:"chat-history",onClick:async()=>{if(O.length>0||!s)return;let F=l;F||(F=await Qe({emitEvent:!0})),F&&c(!0)},onSelectOption:async F=>{F==="chat-history"?(setTimeout(()=>{u.current?.focus()},100),c(!0)):F==="continue-last-chat"&&await R()}},Gt.default.createElement(G,{icon:z?"Loading":"History",sx:{fontSize:"20px",scale:z?"0.8":"1",...n}})),Gt.default.createElement(Lv,{open:p,onClose:C,paperRef:u}),Gt.default.createElement(dv,null))},Ov=QF;var on=I(E()),JF=e=>{let{anchorElementSelectors:t='[data-testid="sidebar-nav--new-chat-button"]',placement:o="left-end",...n}=e,{t:r}=k(),[i,a]=on.default.useState(!1),[s,l]=on.default.useState(!0),p=he(f=>f.conversationIds),c=un(p[0]),u=fe(p[0]),m=(0,on.useRef)(!1),d=(0,on.useCallback)(async()=>{let f=await Ue.getOnboardingDataByKey(mc),h=await Ue.getOnboardingDataByKey(vd),_=f&&h,x=c.find(y=>y.type==="ai"),C=x&&x.originalMessage?.metadata?.chatMode==="pro_chat";(_||C)&&c.length>0&&u===!1&&m.current===!0&&a(!0)},[c,u]);return(0,on.useEffect)(()=>{Ue.getOnboardingDataByKey(dc).then(f=>l(!!f))},[]),(0,on.useEffect)(()=>{s||d()},[s,d]),(0,on.useEffect)(()=>{u&&(m.current=!0)},[u]),s?null:on.default.createElement(on.default.Fragment,null,on.default.createElement(Tt,{trigger:i,placement:o,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData(dc,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > New chat > Got it"},...n},on.default.createElement(g,{spacing:.5},on.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__new_chat__title")),on.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__new_chat__description")))))},w0=JF;var $n=I(E()),eH=e=>{let{variant:t="text",sx:o,title:n,tooltipProps:r,...i}=e,{t:a}=k(),{createConversation:s}=ot(),{chatHubLoading:l}=dt(),{resetMyOwnToolsType:p}=er(),{layout:c,conversationType:u,setConversationIds:m}=he(f=>({layout:f.layout,conversationType:f.conversationType,setConversationIds:f.setConversationIds})),d=async()=>{if(!await Qe({emitEvent:!0}))return;let _=(await s(u,{reason:"manualClick"})).filter((x,C)=>C<c).map(x=>x.id);m(_),p()};return t==="text"?$n.default.createElement(de,{"data-testid":"sidebar-nav--new-chat-button",startIcon:$n.default.createElement(G,{icon:"NewChat",sx:{fontSize:"24px"}}),sx:{height:"32px",padding:"8px 12px!important",borderRadius:"8px",border:"1px solid",borderColor:f=>f.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)!important":"rgba(0, 0, 0, 0.12)!important",color:f=>f.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)",fontSize:"16px",lineHeight:"20px",...o},onClick:d,...i},a("package__features:chat__create_button__chat_action__title")):t==="outlined"?$n.default.createElement($n.default.Fragment,null,$n.default.createElement(de,{"data-testid":"sidebar-nav--new-chat-button",variant:"outlined",color:"primary",startIcon:$n.default.createElement(G,{icon:"NewChat",sx:{fontSize:14}}),onClick:d,disabled:l,sx:{borderRadius:"6px",borderWidth:"1px",borderColor:f=>f.palette.text.primary,[`.${ua.startIcon}`]:{marginRight:"10px"},...o},...i},$n.default.createElement(T,{component:"h2",sx:{fontSize:"inherit",fontWeight:"inherit"}},a("package__features:chat__create_button__chat_action__title"))),$n.default.createElement(w0,null)):$n.default.createElement($n.default.Fragment,null,$n.default.createElement(se,{tooltipProps:{placement:"left",...r},title:n||a("package__features:chat__navbar__button__new_chat"),testid:"sidebar-nav--new-chat-button",onClick:d,disabled:l,sx:o,...i},$n.default.createElement(G,{icon:"NewChat"})),$n.default.createElement(w0,null))},Gc=eH;var bp=I(pa()),uo=I(E()),tH=e=>uo.default.createElement(bp.default,{...e},uo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uo.default.createElement("path",{d:"M10.8004 2.00012H5.20037C4.08026 2.00012 3.52021 2.00012 3.09239 2.21811C2.71606 2.40986 2.4101 2.71582 2.21835 3.09214C2.00037 3.51996 2.00037 4.08002 2.00037 5.20012V10.8001C2.00037 11.9202 2.00037 12.4803 2.21835 12.9081C2.4101 13.2844 2.71606 13.5904 3.09239 13.7821C3.52021 14.0001 4.08026 14.0001 5.20037 14.0001H10.8004C11.9205 14.0001 12.4805 14.0001 12.9083 13.7821C13.2847 13.5904 13.5906 13.2844 13.7824 12.9081C14.0004 12.4803 14.0004 11.9202 14.0004 10.8001V5.20012C14.0004 4.08002 14.0004 3.51996 13.7824 3.09214C13.5906 2.71582 13.2847 2.40986 12.9083 2.21811C12.4805 2.00012 11.9205 2.00012 10.8004 2.00012Z",stroke:"currentColor",strokeOpacity:"0.87",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),Bv=e=>uo.default.createElement(bp.default,{...e},uo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uo.default.createElement("path",{d:"M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),oH=e=>uo.default.createElement(bp.default,{...e},uo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uo.default.createElement("path",{d:"M6 2V14M10 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),nH=e=>uo.default.createElement(bp.default,{...e},uo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uo.default.createElement("path",{d:"M2 8H14M8 2V14M5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.0799 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8V5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),rH=e=>uo.default.createElement(bp.default,{...e},uo.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},uo.default.createElement("path",{d:"M6 14L6 2M10 14V2M2 8H14M2 10.8L2 5.2C2 4.07989 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2H10.8C11.9201 2 12.4802 2 12.908 2.21799C13.2843 2.40973 13.5903 2.71569 13.782 3.09202C14 3.51984 14 4.07989 14 5.2V10.8C14 11.9201 14 12.4802 13.782 12.908C13.5903 13.2843 13.2843 13.5903 12.908 13.782C12.4802 14 11.9201 14 10.8 14H5.2C4.07989 14 3.51984 14 3.09202 13.782C2.71569 13.5903 2.40973 13.2843 2.21799 12.908C2 12.4802 2 11.9201 2 10.8Z",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}))),iH=e=>{let{layout:t,...o}=e;switch(t){case 1:return uo.default.createElement(tH,{...o});case 2:return uo.default.createElement(Bv,{...o});case 3:return uo.default.createElement(oH,{...o});case 4:return uo.default.createElement(nH,{...o});case 6:return uo.default.createElement(rH,{...o});default:return uo.default.createElement(Bv,{...o})}},Qf=iH;var Hn=I(E()),aH=e=>{let{anchorElementSelectors:t='[data-testid="maxai--chat-hub--layout-selector--item--1"]',placement:o="top-start",...n}=e,{t:r}=k(),[i,a]=Hn.default.useState(!1),[s,l]=Hn.default.useState(!0),p=he(f=>f.conversationIds),c=un(p[0]),u=fe(p[0]),m=(0,Hn.useRef)(!1),d=(0,Hn.useCallback)(async()=>{let f=await Ue.getOnboardingDataByKey(fc),h=await Ue.getOnboardingDataByKey("ON_BOARDING__RECORD_FIRST_SELECTOR_AI_MODEL");f&&c.length>0&&u===!1&&h&&m.current===!0&&a(!0)},[c,u]);return(0,Hn.useEffect)(()=>{Ue.getOnboardingDataByKey(sg).then(f=>l(!!f))},[]),(0,Hn.useEffect)(()=>{s||d()},[s,d]),(0,Hn.useEffect)(()=>{u&&(m.current=!0)},[u]),s?null:Hn.default.createElement(Tt,{placement:o,trigger:i,anchorElementSelectors:t,onShow:()=>{Ue.setOnboardingData(sg,!0)},CtaButtonProps:{"data-button-clicked-name":"Onboarding > Compare answers side by side > Got it"},...n},Hn.default.createElement(g,{spacing:.5},Hn.default.createElement(T,{fontSize:20,lineHeight:1.4,color:"text.primary",fontWeight:700,textAlign:"left"},r("package__features:onboarding__onboarding_popover__cha_hub_selector__title")),Hn.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},r("package__features:onboarding__onboarding_popover__cha_hub_selector__description"))))},Dv=aH;var jt=I(E()),E0=[{layout:1,tooltip:"package__features:chat__provider__chat_hub__layout__one__tooltip"},{layout:2,tooltip:"package__features:chat__provider__chat_hub__layout__two__tooltip"},{layout:3,tooltip:"package__features:chat__provider__chat_hub__layout__three__tooltip"},{layout:4,tooltip:"package__features:chat__provider__chat_hub__layout__four__tooltip"},{layout:6,tooltip:"package__features:chat__provider__chat_hub__layout__six__tooltip"}],sH=e=>{let{disabled:t,mode:o,size:n="medium",sx:r}=e,{conversationIds:i,conversationType:a,layout:s,setConversationIds:l,setLayout:p}=he(M=>({conversationIds:M.conversationIds,conversationType:M.conversationType,layout:M.layout,setConversationIds:M.setConversationIds,setLayout:M.setLayout})),{t:c}=k(),{createConversation:u}=ot(),{chatHubLoading:m}=dt(),d=t||m,f=async M=>{let P=await nm(a);if(await oC(M),i.length<M){let O=await u(a,{reason:"createChatHub",triggerChange:!1,syncToRemote:!1}),L=[...i,...O.slice(i.length).map(H=>H.id)];l(L)}p(M),e.onChange?.(M,P)},h=(0,jt.useMemo)(()=>({p:"2px 5px",borderRadius:"8px",bgcolor:M=>M.palette.mode==="dark"?"#3B3D3E":"#E9E9EB",transition:"background-color 250ms cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{bgcolor:d?M=>M.palette.mode==="dark"?"#3B3D3E":"#E9E9EB":M=>M.palette.mode==="dark"?"rgba(255, 255, 255, 0.18)":"rgba(0, 0, 0, 0.12)"},gap:n==="small"?"2px":"4px","& > button":{minWidth:"unset",color:"text.secondary",padding:n==="small"?"2px":"4px","&:hover,&.selected":{color:"text.primary",bgcolor:"background.paper"}}}),[n,r,d]),[_,x]=(0,jt.useState)(!1),[C,y]=(0,jt.useState)(!1),b=(0,jt.useRef)(null),v=(0,jt.useCallback)(M=>{y(M),M||x(!1)},[y]),S=(0,jt.useCallback)(()=>{v(!1),b.current?.matches(":hover")&&x(!0)},[v]);if(o==="mini"){let M=E0.find(P=>s===P.layout);return jt.default.createElement(Na,{width:220,sx:{zIndex:2147483621},open:C,onOpenChange:v,placement:"bottom-start",isMirror:!0,modifiers:[{name:"RTLSupport",enabled:typeof document<"u"&&document.querySelector("body")?.getAttribute("dir")==="rtl",phase:"main",fn({state:P}){if(P.modifiersData.popperOffsets){let L=P.rects.reference.x+P.rects.reference.width-P.rects.popper.width;L>0&&(P.modifiersData.popperOffsets.x=L)}}},{name:"offset",options:{offset:[0,5]}},{name:"flip",options:{fallbackPlacements:["top-start"]}}],referenceElement:jt.default.createElement(xe,{title:M?c(M.tooltip):null,open:_&&!C},jt.default.createElement(de,{disableRipple:!0,disabled:d,ref:b,"data-testid":"maxai--chat-hub--layout-selector--button","aria-controls":C?"composition-menu":void 0,"aria-expanded":C?"true":void 0,"aria-haspopup":"true",onClick:()=>y(!C),sx:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",p:.5,pl:"6px",height:32,minWidth:"auto"},onMouseEnter:()=>{C||x(!0)},onMouseLeave:()=>{C||x(!1)}},jt.default.createElement(Qf,{sx:{fontSize:18},layout:M?.layout||1}),jt.default.createElement(G,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"16px",transform:C?"rotate(180deg)":"rotate(0)"}})))},jt.default.createElement(hi,{disableListWrap:!0,"data-testid":"maxai--chat-hub--layout-selector--group",sx:{overflowY:"auto",overflowX:"hidden",flexShrink:0,py:"6px",boxSizing:"border-box",bgcolor:P=>P.palette.mode==="dark"?"rgba(61, 61, 61, 1)":"#fff",...r}},E0.map(P=>jt.default.createElement(mt,{"data-testid":`maxai--chat--layout-selector--item--${P.layout}`,key:P.layout,selected:P.layout===s,onClick:()=>{f(P.layout),S()},sx:{borderRadius:"6px",mx:"6px",minHeight:"unset",p:"6px 10px 6px 8px","&:hover":{backgroundColor:O=>O.palette.mode==="dark"?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, 0.04)"},...P.layout===s&&{backgroundColor:O=>O.palette.mode==="dark"?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.04)"}}},jt.default.createElement(g,{alignItems:"center",direction:"row",spacing:1,sx:{flex:1,height:24}},jt.default.createElement(Qf,{sx:{fontSize:18,color:"text.primary"},layout:P.layout}),jt.default.createElement(Ql,{fontSize:"14px",lineHeight:"21px"},c(P.tooltip)))))))}return jt.default.createElement(g,{"data-testid":"maxai--chat-hub--layout-selector--group",direction:"row",alignItems:"center",sx:h},E0.map(M=>jt.default.createElement(xe,{title:c(M.tooltip),key:M.layout,disableInteractive:!0},jt.default.createElement(de,{"data-testid":`maxai--chat-hub--layout-selector--item--${M.layout}`,className:s===M.layout?"selected":"",disabled:d,key:M.layout,onClick:()=>f(M.layout)},jt.default.createElement(Qf,{sx:{fontSize:"16px"},layout:M.layout})))),jt.default.createElement(Dv,null))},Fv=sH;var Ho=I(E());var lH=()=>{let{conversationType:e}=ie();return e==="Art"?Ho.default.createElement(BI,null):Ho.default.createElement(Ra,null)},pH=e=>{let{renderLeftNode:t,renderRightNode:o}=e,{variant:n}=Yt(),r={newChatButton:Ho.default.createElement(Gc,{variant:"icon"}),aiModelSelector:n!=="chatHubInput"&&Ho.default.createElement(lH,null),chatHubLayoutSelector:Ho.default.createElement(Fv,null),aiLanguageSelector:Ho.default.createElement(Ha,null),proChatSwitch:Ho.default.createElement(Fa,null),portalRoot:Ho.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{"&:empty":{display:"none"}}})},i={advancedButton:Ho.default.createElement(mv,null),historyButton:Ho.default.createElement(Ov,null),newChatButton:Ho.default.createElement(Gc,{variant:"icon"})},a=t?t(r):Ho.default.createElement(Ho.default.Fragment,null,r.proChatSwitch,r.aiModelSelector,r.chatHubLayoutSelector,r.aiLanguageSelector,r.portalRoot),s=o?o(i):Ho.default.createElement(Ho.default.Fragment,null,i.advancedButton,i.historyButton);return Ho.default.createElement(g,{direction:"row",justifyContent:"space-between",sx:{mb:1,gap:"8px"}},Ho.default.createElement(g,{direction:"row",alignItems:"center","data-testid":"maxai--chat-box--tools--left-container",sx:{flexWrap:"wrap",gap:"4px","&:empty":{display:"none"}}},a),Ho.default.createElement(g,{direction:"row",spacing:.5,alignItems:"start","data-testid":"maxai--chat-box--tools--right-container",sx:{"&:empty":{display:"none"}}},s))},Hv=pH;var cH=e=>{let{toolsProps:t,inputProps:o,footerPrefix:n,sx:r,isShowHomeView:i,updateChatBoxHeight:a}=e,{conversationId:s}=ie(),l=Uo(s),[p,c]=(0,Hr.useState)(!1),[u,m]=(0,Hr.useState)(null),{rect:d}=g_({target:u,windowScroll:!0,observeOptions:{childList:!0,subtree:!0}}),f=477,[h,_]=(0,Hr.useState)(f);return(0,Hr.useEffect)(()=>{d?.height&&(a?.(d.height),_(Math.max(d.height,p?h:f)))},[d,p]),l?.meta.AIProvider&&Vu(l?.meta.AIProvider)?null:Hr.default.createElement(B,{"data-testid":"maxai--chat-panel--footer",sx:{width:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-start",overflow:"hidden",alignItems:"center",flex:i?`1 1 ${h}px`:"reset",transition:"flex-basis 0.15s",zIndex:1501,backgroundColor:x=>x.palette.background.default,...r}},Hr.default.createElement(g,{ref:m,sx:{width:"100%",maxWidth:"var(--max-width)",margin:"0 auto",overflow:"hidden",p:1.5}},n,Hr.default.createElement(x3,{onShow:()=>c(!0),onClose:()=>c(!1)}),!p&&Hr.default.createElement(Hv,{...t}),!p&&Hr.default.createElement(X9,{...o})))},Jf=cH;var Nv=I(e2()),A0=I(E()),uH=e=>{let{needSystemOrThirdMessage:t=!1}=e,{t:o}=k(),{conversationId:n,conversationMessages:r,getConversation:i}=_i();return r.filter(s=>t?!0:s.type!=="system"&&s.type!=="third").length===0||!n?null:A0.default.createElement(mm,{title:o("package__features:chat__navbar__conversation_share__download_button__tooltip"),"data-testid":"history-text-download-button",sx:{border:s=>s.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",padding:"6px"},onClick:async()=>{let s=await i(n);if(s?.title){let l=await Qu(s,t),p=new Blob([l],{type:"text/plain;charset=utf-8"}),c=URL.createObjectURL(p),u=document.createElement("a");u.href=c,u.download=`MaxAI_Chat_${(0,Nv.default)().format("YYYY_MM_DD_HH:mm")}.txt`,u.click(),URL.revokeObjectURL(c)}}},A0.default.createElement(G,{icon:"FileDownload",sx:{fontSize:"18px",color:"text.secondary"}}))},zv=uH;var Ge=I(E()),Rv=e=>`${Nn}/share/?id=${e}`,mH=()=>{let{t:e}=k(),{features:t,loaded:o}=J_(),{conversation:n,conversationMessages:r,updateConversation:i,getConversation:a}=_i(),[s,l]=(0,Ge.useState)(!1),[p,c]=(0,Ge.useState)(!1),[u,m]=(0,Ge.useState)(null),d=n?.share?.enable===!0,f=n?.share?.id,h=b=>{m(b.currentTarget)},_=()=>{m(null)},x=(b=e("package__features:chat__navbar__conversation_share__share_panel__error_tip"))=>{Ni.error(b,{anchorOrigin:{vertical:"top",horizontal:"center"}})},C=async b=>{if(n?.id)try{c(!0);let v=(await Yo.getService().shareConversation(n.id,b))?.share;v?.id?await i(n.id,{share:{enable:v.enable,id:v.id}}):x()}catch{x()}finally{c(!1)}},y=async b=>{if(!n?.id)return;let v=b.currentTarget.parentElement,S="";if(f)d||await C(!0),S=f;else try{if(!S){l(!0);let O=await a(n.id);if(!O){x();return}await Yo.getService().checkUpdate(n.id),await Jn.getService().checkUpdate(n.id);let L=(await Yo.getService().shareConversation(O.id,!0))?.share;L?.id&&L.enable&&(S=L.id,await i(O.id,{share:{enable:!0,id:L.id}}))}}catch{x()}finally{l(!1)}let M=Rv(S);navigator.clipboard.writeText(M);let P=v?.querySelector('button[data-testid="maxai--conversation--share-button"]');h({currentTarget:b.currentTarget||P})};return o&&!t.chat_sync||r.length<=0?null:Ge.default.createElement(g,{direction:"row",alignItems:"center",gap:1},d&&f&&Ge.default.createElement(An,{copyText:Rv(f),copyToClipboardTooltip:e("package__features:chat__navbar__conversation_share__copy_button__copy_link"),icon:Ge.default.createElement(G,{icon:"Link"}),sx:{display:"flex",alignItems:"center",justifyContent:"center",border:b=>b.palette.mode==="dark"?"1px solid rgba(255, 255, 255, 0.12)":"1px solid rgba(0, 0, 0, 0.12)",borderRadius:"8px",minWidth:"unset",height:"32px",width:"32px"}}),Ge.default.createElement(Yn,{"data-testid":"maxai--conversation--share-button",variant:"contained",sx:{display:"flex",alignItems:"center",height:"32px",gap:.5,borderRadius:"8px",padding:"8px"},loading:s,onClick:y},d?Ge.default.createElement(G,{sx:{fontSize:"18px"},icon:"IosShare"}):Ge.default.createElement(G,{sx:{fontSize:"18px"},icon:"Lock"}),Ge.default.createElement(T,{component:"span",fontSize:"12px"},e("package__features:chat__navbar__conversation_share__share_button__title"))),Ge.default.createElement(gi,{PaperProps:{sx:{mt:1,boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.16)"}},elevation:1,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},open:!!u,anchorEl:u,onClose:_},Ge.default.createElement(g,{py:1,px:2,width:320,gap:1},Ge.default.createElement(T,{fontSize:16,fontWeight:500},e("package__features:chat__navbar__conversation_share__share_panel__title")),Ge.default.createElement(g,{sx:{"& > button":{border:"1px solid",width:"100%",p:1,borderColor:"border.main",borderRadius:"0 0 8px 8px",alignItems:"center",justifyContent:"start","&:not(:last-child)":{borderBottom:"none",borderRadius:"8px 8px 0 0"}}}},Ge.default.createElement(de,{"data-testid":"maxai--conversation--share-private-button",disabled:p,onClick:async()=>{await C(!1)}},Ge.default.createElement(g,{width:"100%"},Ge.default.createElement(g,{direction:"row",alignItems:"center",gap:1},p?Ge.default.createElement(Lt,{size:16}):Ge.default.createElement(G,{icon:"Lock",sx:{fontSize:"16px"}}),Ge.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__title")),!d&&Ge.default.createElement(G,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Ge.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__private_button__description")))),Ge.default.createElement(de,{disabled:p,onClick:async()=>{await C(!0)}},Ge.default.createElement(g,{width:"100%"},Ge.default.createElement(g,{direction:"row",alignItems:"center",gap:1},p?Ge.default.createElement(Lt,{size:16}):Ge.default.createElement(G,{icon:"Share",sx:{fontSize:"16px"}}),Ge.default.createElement(T,{textAlign:"left",fontSize:"14px",color:"text.primary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__title")),d&&Ge.default.createElement(G,{icon:"GreenCircleCheck",sx:{ml:"auto",mr:0,fontSize:"20px"}})),Ge.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"text.secondary"},e("package__features:chat__navbar__conversation_share__share_panel__public_button__description"))))),d&&Ge.default.createElement(g,{direction:"row",alignItems:"center",gap:1},Ge.default.createElement(G,{icon:"GreenCircleCheck",sx:{fontSize:"16px"}}),Ge.default.createElement(T,{textAlign:"left",fontSize:"12px",color:"#379837"},e("package__features:chat__navbar__conversation_share__share_panel__copied_tip"))))))},Vv=mH;var ni=I(E());var Uv=I(E()),dH=()=>{let e=qs(),t=mx(e.breakpoints.down("md")),o=Ca();return{isMiniScreen:(0,Uv.useMemo)(()=>Ks()?t:o==="xs"||o==="sm",[o,t])}},e1=dH;var jc=I(E());var P0="MAXAI_CLIENT__FEATURES__LAYOUT__WEBSITE_STATE";var Wv="MAXAI_CLIENT__UI__HOME_NAVBAR_STATE",fH="MAXAI_SIDEBAR_FOLD_STATUS",k0=()=>({chatHistoryOpen:!0,toolbarCollapsed:!1,miniScreenToolbarOpen:!1,rightToolbarCollapsed:!1,rightMiniScreenToolbarOpen:!1}),L0=()=>{let e=k0();try{let t=window.localStorage.getItem(P0);if(t){let o=JSON.parse(t);Object.assign(e,o)}}catch{}try{let t=window.localStorage.getItem(Wv);if(t){let o=JSON.parse(t);Object.assign(e,{chatHistoryOpen:o.conversationListPanelOpen??e.chatHistoryOpen})}}catch{}return window.localStorage.removeItem(Wv),window.localStorage.removeItem(fH),{...e,miniScreenToolbarOpen:!1,rightMiniScreenToolbarOpen:!1}},Gv=e=>{let t=L0(),o=Ro([t,e]);window.localStorage.setItem(P0,JSON.stringify(o))};var O0=la({key:"AppWebsiteLayoutState",default:k0(),effects:[({onSet:e})=>{e(t=>{Gv(t)})}]}),hH=la({key:"AppWebsiteLayoutToolbarWidgetState",default:{disableExtensionAdCard:!1}});var gH=()=>{let e=$t(O0),{isLogin:t}=pn(),{hasExtension:o}=ih(),{isMiniScreen:n}=e1(),r=!t||!o||n;return{...e,isMiniScreen:n,disabledCollapse:r,toolbarCollapsed:r?!1:e.toolbarCollapsed,rightToolbarCollapsed:n?!1:e.rightToolbarCollapsed}},xH=()=>{let e=bo(O0),t=()=>{e(L0())},o=(c,u)=>{e(m=>m[c]===u?m:{...m,[c]:u})};return{syncLocalState:t,setChatHistoryOpen:c=>{o("chatHistoryOpen",c)},setToolbarCollapsed:c=>{o("toolbarCollapsed",c)},setToolbarWidth:c=>{o("toolbarWidth",c)},setMiniScreenToolbarOpen:c=>{o("miniScreenToolbarOpen",c)},setRightToolbarCollapsed:c=>{o("rightToolbarCollapsed",c)},setRightToolbarWidth:c=>{o("rightToolbarWidth",c)},setRightMiniScreenToolbarOpen:c=>{o("rightMiniScreenToolbarOpen",c)}}},t1=()=>{let e=gH(),t=xH();return{...e,...t}};var o1=I(E()),_H=e=>{let{...t}=e,{chatHistoryOpen:o,setChatHistoryOpen:n}=t1(),{t:r}=k();return o1.default.createElement(xe,{placement:"bottom",title:r(o?"package__features:chat__navbar__button__hide_chat_history":"package__features:chat__navbar__button__show_chat_history")},o1.default.createElement(Re,{"data-testid":"sidebar-nav-topbar-show-or-hide-chat-history-button",onClick:()=>n(!o),...t},o1.default.createElement(G,{icon:"LayoutLeftIcon",sx:{fontSize:"24px",color:i=>i.palette.mode==="dark"?"rgba(255, 255, 255)":"rgba(0, 0, 0, 0.6)"}})))},jv=_H;var CH=e=>{let{newChatProps:t,switchVisibilityProps:o,sx:n}=e,{isMiniScreen:r}=e1();return jc.default.createElement(g,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:n},r?jc.default.createElement(B,{sx:{height:"40px"}}):jc.default.createElement(jv,{...o}),jc.default.createElement(Gc,{...t,tooltipProps:{placement:"bottom",...t?.tooltipProps},sx:{p:1,height:"auto",minWidth:"auto","& svg":{fontSize:24},...t?.sx}}))},qv=CH;var Kv=I(E()),yH=e=>{let{topBarProps:t}=e,{isMiniScreen:o,chatHistoryOpen:n}=t1(),{chatHubOrder:r,variant:i}=ie();return i==="chatHub"&&r>0||o||n?null:Kv.default.createElement(qv,{...t,sx:{pl:1,...t?.sx},newChatProps:{variant:"icon",...t?.newChatProps}})},$v=yH;var bH=e=>{let{leftNode:t,rightNode:o,renderLeftNode:n,renderRightNode:r,sx:i}=e,a={actionsGroup:ni.default.createElement($v,null)},s={downloadButton:ni.default.createElement(zv,null),shareButton:ni.default.createElement(Vv,null)},l=n?n(a):ni.default.createElement(ni.default.Fragment,null,a.actionsGroup,t),p=r?r(s):ni.default.createElement(ni.default.Fragment,null,o,s.downloadButton,s.shareButton);return ni.default.createElement(g,{sx:{flexDirection:"row",minHeight:"72px",marginBottom:"-16px",...i}},ni.default.createElement(g,{direction:"row",alignItems:"center",gap:1,pl:1},l),ni.default.createElement(g,{direction:"row",flex:1,width:0,justifyContent:"end",alignItems:"center",gap:1,pr:1},p))},n1=bH;var IH=e=>{let{headerProps:t,messageProps:o,toolsProps:n,inputProps:r,footerPrefix:i,footerProps:a,emptyNode:s,sx:l}=e,p=he(C=>C.conversationType),{betaSettings:c}=Wo(),u=p==="ContextMenu",{conversationId:m}=Yt(),d=fe(m),[f,h]=(0,Nr.useState)(0),_=C=>Nr.default.createElement(Jf,{isShowHomeView:C,...a,inputProps:{...r,textareaProps:{...r?.textareaProps,disabled:r?.textareaProps?.disabled||d}},toolsProps:n,footerPrefix:i,updateChatBoxHeight:h}),x=(C,y)=>u?C?null:_:c?.appearance_v2_enabled&&y&&!C?null:_;return Nr.default.createElement(g,{className:"maxai--chat-box",sx:{flex:1,height:0,width:"100%","& *":{boxSizing:"border-box"},...d?{}:{[`.${_l}`]:{display:"none"}},...l}},Nr.default.createElement(n1,{...t}),Nr.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},Nr.default.createElement(Qh.Provider,{value:o||M6},Nr.default.createElement(xp,{emptyNode:s},({isShowHomeView:C,isLoading:y,listNode:b})=>Nr.default.createElement(g,{className:"maxai--chat-box--content","data-message-empty":C,"data-message-loading":y,sx:{flex:1,width:"100%",alignItems:"center"}},Nr.default.createElement($I,{isMessageEmpty:C,chatBoxHeight:f,sx:{display:C?"flex":"none"}}),b,x(C,y)?.(C)))),Nr.default.createElement(fd,null)))},Xv=IH;var Xn=I(E()),SH=({isFullscreen:e,children:t,onClose:o})=>{let{t:n}=k(),r=(0,Xn.useCallback)(l=>{l.key==="Escape"&&o()},[o]);(0,Xn.useEffect)(()=>(e&&document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}),[e,r]);let i=(0,Xn.useMemo)(()=>({width:"100%!important",height:"100%!important",maxWidth:"100%!important",maxHeight:"100%!important",position:"fixed",top:0,left:0,zIndex:1502,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center"}),[]),a=(0,Xn.useMemo)(()=>({backgroundColor:"background.default",height:"95vh",padding:"24px",boxSizing:"border-box",maxHeight:"calc(100vh - 32px)",maxWidth:"768px!important",position:"relative",borderRadius:"8px",width:"calc(100vw - 32px)"}),[]),s=(0,Xn.useMemo)(()=>({border:"1px solid",borderColor:"border.main",borderRadius:"8px",flex:1,height:"0"}),[]);return Xn.default.createElement(B,{sx:{width:"100%",height:"100%",position:"relative",...e?i:{}},onClick:()=>o()},Xn.default.createElement(g,{sx:{width:"100%",height:"100%",gap:"24px",...e?a:{}},onClick:l=>l.stopPropagation()},Xn.default.createElement(g,{"data-testid":"chat-hub-chat-box-wrapper",sx:{width:"100%",height:"100%",...e?s:{}}},t),e&&Xn.default.createElement(g,{sx:{flexDirection:"row",justifyContent:"flex-end"}},Xn.default.createElement(de,{variant:"contained",onClick:()=>o()},n("package__features:chat__chat_hub_box__exit_full_screen")))))},Yv=SH;var $o=I(E());var vH=e=>{let{headerProps:t,emptyNode:o,sx:n}=e,{t:r}=k(),i=he(c=>c.layout),[a,s]=(0,$o.useState)(!1),{chatHubOrder:l}=Yt(),{chatHubLoading:p}=dt();return $o.default.createElement(g,{component:"div",position:"relative",sx:{width:"100%","& *":{boxSizing:"border-box"},...p?{}:{[`.${_l}`]:{display:"none"}},...n}},$o.default.createElement(Yv,{isFullscreen:a,onClose:()=>s(!1)},$o.default.createElement(n1,{...t}),$o.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},$o.default.createElement(g,{sx:{flex:1,width:"100%"}},$o.default.createElement(xp,{emptyNode:o},({isShowHomeView:c,listNode:u})=>$o.default.createElement($o.default.Fragment,null,c&&$o.default.createElement("div",{style:{flex:1}}),u)),a?null:$o.default.createElement(g,{sx:{p:"12px",flexDirection:"row",justifyContent:"space-between"}},$o.default.createElement(bd,null,c=>c==="pro_chat"?$o.default.createElement(DI,{order:l}):$o.default.createElement("div",null)),i>1&&$o.default.createElement(se,{placement:"top",title:r("package__features:chat__chat_hub_box__full_screen"),onClick:()=>s(!a)},$o.default.createElement(ax,{sx:{color:"text.secondary"}})))))))},Zv=vH;var r1=I(E()),TH=e=>{let{sx:t,footerProps:o,inputProps:n,footerPrefix:r,toolsProps:i}=e;return r1.default.createElement(g,{component:"div",position:"relative",sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...t}},r1.default.createElement(g,{sx:{flex:1,width:"100%"}},r1.default.createElement(Jf,{...o,inputProps:n,toolsProps:i,footerPrefix:r})))},Qv=TH;var Za=I(E());var wH=e=>{let{emptyNode:t,sx:o}=e,{conversationId:n}=Yt(),r=fe(n);return Za.default.createElement(g,{sx:{flex:1,width:"100%","& *":{boxSizing:"border-box"},...r?{}:{[`.${_l}`]:{display:"none"}},...o}},Za.default.createElement(g,{sx:{flex:1,justifyContent:"center",flexDirection:"row",height:0,width:"100%"}},Za.default.createElement(g,{sx:{flex:1,width:"100%"}},Za.default.createElement(xp,{emptyNode:t},({listNode:i})=>Za.default.createElement(Za.default.Fragment,null,i))),Za.default.createElement(fd,null)))},Jv=wH;var Qa=I(E()),MH=e=>{let{children:t,variant:o,conversationId:n,chatHubOrder:r,inputMediator:i=vt("Chat"),...a}=e,s=(0,Qa.useMemo)(()=>({variant:o,conversationId:n,chatHubOrder:r,inputMediator:i}),[o,n,r,i]);return Qa.default.createElement(eC.Provider,{value:s},o==="normal"&&Qa.default.createElement(Xv,{...a}),o==="chatHub"&&Qa.default.createElement(Zv,{...a}),o==="chatHubInput"&&Qa.default.createElement(Qv,{...a}),o==="share"&&Qa.default.createElement(Jv,{...a}),o==="custom"&&t)},i1=MH;var eT=I(pa());var no=I(E()),EH=()=>{let{t:e}=k(),{isChatBoxDragOver:t}=lm();return no.default.createElement(pi,{in:t},no.default.createElement(g,{id:"chat-files-drop-box",sx:()=>({position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",p:1,backdropFilter:"blur(10px)",zIndex:2147483620,display:t?"flex":"none"})},no.default.createElement(g,{spacing:1,justifyContent:"center",alignItems:"center",sx:o=>{let n=o.palette.mode==="dark";return{height:"100%",border:"4px dashed",borderColor:"primary.main",bgcolor:"rgba(144, 101, 176, 0.16)",borderRadius:1}}},no.default.createElement(g,{direction:"row",spacing:.5,color:"primary.main",fontSize:32},no.default.createElement(AH,null)),no.default.createElement(T,{fontSize:24,fontWeight:600,color:"text.primary"},e("package__features:chat__files__drop_box__add_anything")),no.default.createElement(T,{fontSize:16,fontWeight:400,lineHeight:1.5,color:"text.primary"},e("package__features:chat__files__drop_box__drop_file_or_image_here")))))},AH=()=>no.default.createElement(eT.default,{sx:{width:156,height:118,objectFit:"contain"}},no.default.createElement("svg",{width:"156",height:"118",viewBox:"0 0 156 118",fill:"none",xmlns:"http://www.w3.org/2000/svg"},no.default.createElement("rect",{x:"107.421",y:"36.9053",width:"47.0533",height:"41.9333",rx:"8",transform:"rotate(24.35 107.421 36.9053)",fill:"#8D6FD1"}),no.default.createElement("path",{d:"M122.98 73.0592L130.332 70.2885L127.562 62.9365",fill:"#8D6FD1"}),no.default.createElement("path",{d:"M117.439 58.3553L110.087 61.1261L112.858 68.478",fill:"#8D6FD1"}),no.default.createElement("path",{d:"M122.98 73.0592L130.332 70.2885L127.562 62.9365M117.439 58.3553L110.087 61.1261L112.858 68.478M126.357 57.5131L114.062 73.9015",stroke:"white",strokeWidth:"2.29129",strokeLinecap:"round",strokeLinejoin:"round"}),no.default.createElement("rect",{x:"8.01111",y:"55.0576",width:"47.0533",height:"41.9333",rx:"8",transform:"rotate(-24.35 8.01111 55.0576)",fill:"#AE97E1"}),no.default.createElement("g",{clipPath:"url(#clip0_5257_157892)"},no.default.createElement("path",{d:"M48.0226 69.7675L48.9249 69.3592C49.7921 68.9667 50.2257 68.7705 50.3819 68.4792C50.518 68.2255 50.5365 67.9235 50.4327 67.6526C50.3135 67.3416 49.9077 67.0853 49.096 66.5725L44.5605 63.7073C43.8898 63.2836 43.5545 63.0717 43.2564 63.08C42.9958 63.0871 42.7497 63.1985 42.5723 63.3896C42.3693 63.6081 42.3072 63.9998 42.1828 64.7833L41.975 66.0931M48.0226 69.7675L36.6195 62.8393C35.9637 62.4409 35.6358 62.2416 35.3434 62.2518C35.0876 62.2606 34.8463 62.3698 34.6708 62.5561C34.4703 62.7691 34.4035 63.1469 34.27 63.9026L32.4739 74.0699C32.3038 75.0326 32.2188 75.514 32.3714 75.8132C32.5044 76.0738 32.7441 76.263 33.0265 76.3303C33.3508 76.4075 33.7925 76.2076 34.6758 75.8079L48.0226 69.7675ZM43.672 55.3998C44.3499 56.8976 43.6999 58.6545 42.2204 59.3241C40.7408 59.9937 38.9919 59.3224 38.3141 57.8246C37.6363 56.3269 38.2862 54.57 39.7658 53.9004C41.2453 53.2308 42.9942 53.9021 43.672 55.3998Z",stroke:"white",strokeWidth:"1.86158",strokeLinecap:"round",strokeLinejoin:"round"})),no.default.createElement("path",{d:"M55.2098 27.3109C55.2098 24.5692 57.4324 22.3467 60.174 22.3467H86.2361L104.852 40.9624V79.435C104.852 82.1766 102.629 84.3992 99.8876 84.3992H60.174C57.4324 84.3992 55.2098 82.1766 55.2098 79.435V27.3109Z",fill:"#7A51D5"}),no.default.createElement("path",{opacity:"0.3",d:"M86.2361 22.3467L104.852 40.9624H91.2003C88.4586 40.9624 86.2361 38.7399 86.2361 35.9982V22.3467Z",fill:"white"}),no.default.createElement("path",{d:"M70.0908 52.9502H89.9708M70.0908 57.368H89.9708M70.0908 61.7858H89.9708M70.0908 66.2035H85.553",stroke:"white",strokeWidth:"2.07083",strokeLinecap:"round",strokeLinejoin:"round"}),no.default.createElement("defs",null,no.default.createElement("clipPath",{id:"clip0_5257_157892"},no.default.createElement("rect",{width:"23.5243",height:"23.8134",fill:"white",transform:"translate(22.4647 58.4609) rotate(-24.35)"}))))),tT=EH;var a1=I(E()),PH=e=>{let{sx:t,disabled:o,className:n,containerRef:r,children:i}=e,{handleDragEnter:a,handleDragOver:s,handleDragLeave:l,handleDrop:p}=lm(),c=he(d=>d.layout),u=(0,a1.useMemo)(()=>ui(),[]),m=c>1||u?"100%":"768px";return a1.default.createElement(g,{ref:r,component:"div",position:o?void 0:"relative",onDragEnter:o?void 0:a,onDragOver:o?void 0:s,onDragLeave:o?void 0:l,onDrop:o?void 0:p,className:n,sx:{"--max-width":m,...t}},i)},oT=PH;var ta=I(E());var Ds=I(E());var In=I(E());var kH=()=>{let e=he(o=>o.conversationIds);return aC(e)>0?null:In.default.createElement(xd,{sx:{position:"relative",bottom:0,mb:1,mt:-.5,zIndex:1501}})},LH=e=>{let{footerProps:t,inputProps:o,toolsProps:n,footerPrefix:r}=e,i=he(z=>z),{conversationIds:a,conversationType:s,layout:l}=i,{askAIWithShortcuts:p,askAIWithShortcutsV2:c,stopGenerate:u}=ke(),m=et({askAIWithShortcuts:p,askAIWithShortcutsV2:c,stopGenerate:u}),d=a.slice(0,l),f=d[0],{updateConversation:h,getConversation:_}=ot(),{getDefaultValueModel:x,getChatHubDefaultValueModel:C}=gl(),y=(0,In.useCallback)(async z=>z===0?await x():await C(z),[x,C]),b=mn.use.chatHub(),v=mn.use.chat(),S=(0,In.useCallback)(async(z,R)=>{if(!await _(z))return;let F=R===0?v:b[R],X=ah(F)?await y(R):F,W=Vo(X.AIProvider,X.AIModel);W&&await h(z,{meta:{AIProvider:W.AIProvider,AIModel:W.value,maxTokens:W.maxTokens}})},[h,_,y,v,b]),M=(0,In.useCallback)(async(z,R,V)=>{let F=i.layout;R[R.length-1].type==="SET_VARIABLES_MODAL"&&(F=1);let[q,X]=await Promise.all([G2.getLocalSettings(),N_.getBetaSettings()]);return q.chatMode!=="pro_chat"&&(F=1,i.setLayout(1)),await Promise.all(d.slice(0,F).map(async(W,j)=>{let w=j===0?v:b[j],pe=ah(w)?await y(j):w,A=Ee(R).map(U=>(U.parameters.ActionChatMessageOperationType==="add"&&U.parameters.ActionChatMessageConfig&&(U.parameters.ActionChatMessageConfig.conversationId=W,U.parameters.ActionChatMessageType==="system"&&(U.parameters.ActionChatMessageConfig.originalMessage={...U.parameters.ActionChatMessageConfig.originalMessage,metadata:{...U.parameters.ActionChatMessageConfig.originalMessage?.metadata,AIModel:pe.AIModel}})),U.parameters.AskChatGPTActionQuestion&&(U.parameters.AskChatGPTActionQuestion.conversationId=W),U));return X.appearance_v2_enabled?m.current.askAIWithShortcutsV2(A,{...V,conversationId:W,disabledMaxAIDocumentIds:!0,onBeforeRun:async()=>{await S(W,j)}}):m.current.askAIWithShortcuts(A,{...V,conversationId:W,onBeforeRun:async()=>{await S(W,j)}})})),null},[d,v,b,y,S]),P=(0,In.useCallback)(()=>(d.forEach(z=>{m.current.stopGenerate(z)}),!0),[d]),O=(0,In.useMemo)(()=>S2(z=>({...i,onRunShortcutsActions:M,onStopShortcutsActions:P})),[]);(0,In.useEffect)(()=>{O.setState({...i,onRunShortcutsActions:M,onStopShortcutsActions:P})},[i,M,P]);let{chatHubLoading:L}=dt(),H=(0,In.useMemo)(()=>{let z=o?.(f,0,{conversationId:f});return{...z,textareaProps:{...z?.textareaProps,disabled:z?.textareaProps?.disabled||L},sendButtonProps:{...z?.sendButtonProps,loading:z?.sendButtonProps?.loading||L}}},[o,f,L]);return In.default.createElement(n_.Provider,{value:O},In.default.createElement(g,{sx:{flexShrink:0,"--max-width":"768px"}},In.default.createElement(i1,{chatHubOrder:0,inputMediator:vt(s),variant:"chatHubInput",conversationId:f,toolsProps:n?.(f,0,{conversationId:f}),inputProps:H,footerProps:t?.(f,0,{conversationId:f}),footerPrefix:r?.(f,0,{conversationId:f})}),In.default.createElement(kH,null)))},nT=LH;var OH=e=>{let{chatHubSlot:t,children:o,...n}=e,r=he(a=>({conversationIds:a.conversationIds,layout:a.layout,conversationType:a.conversationType})),i=(0,Ds.useMemo)(()=>{let a={flex:1,height:0,display:"flex",flexDirection:"row",flexWrap:"wrap"};return r.layout===1?{...a,"& > div":{width:"100%",maxWidth:"100%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+1)":{display:"flex!important"}}}:r.layout===2?{...a,"& > div":{width:"50%",maxWidth:"50%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+2)":{display:"flex!important"},"&:nth-of-type(2n)":{borderRight:"none"}}}:r.layout===3?{...a,"& > div":{width:"33.33%",maxWidth:"33.33%",height:"100%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+3)":{display:"flex!important"},"&:nth-of-type(3n)":{borderRight:"none"}}}:r.layout===4?{...a,"& > div":{maxWidth:"50%",width:"50%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+4)":{display:"flex!important"},"&:nth-of-type(2n),&:nth-of-type(4n)":{borderRight:"none"}}}:r.layout===6?{...a,"& > div":{maxWidth:"33.33%",width:"33.33%",height:"50%",borderBottom:"1px solid",borderRight:"1px solid",borderColor:"border.main",display:"none!important","&:nth-of-type(-n+6)":{display:"flex!important"},"&:nth-of-type(3n),&:nth-of-type(6n)":{borderRight:"none"}}}:a},[r.layout]);return r.conversationIds.length<=1||r.layout===1?Ds.default.createElement(g,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{backgroundColor:"background.default"}},vx(o)?o.slice(0,1):o):Ds.default.createElement(g,{className:"maxai-client--chat-hub--container",flex:1,width:"100%",height:"100%",sx:{flexDirection:"column",backgroundColor:"background.default"}},t,Ds.default.createElement(g,{sx:i},o),Ds.default.createElement(nT,{...n}))},rT=OH;var BH=e=>{let{variant:t,leftPanelSide:o="flexbox",leftPanelContent:n,rightPanelSide:r="flexbox",rightPanelContent:i,chatHubSlot:a,chatHubSx:s,disableFileDrag:l=!1,children:p,onPanelClose:c,headerProps:u,footerProps:m,inputProps:d,toolsProps:f,footerPrefix:h,messageProps:_,sx:x}=e,{conversationIds:C,conversationType:y,layout:b}=he(M=>({conversationIds:M.conversationIds,conversationType:M.conversationType,layout:M.layout})),v=ta.default.useRef(null),S=(M,P)=>{if(!P)return null;if(M==="separateWindow"&&v.current)return ta.default.createElement(dd,{reference:v.current,sx:{top:0}},P);if(M==="flexbox")return ta.default.createElement(g,{flex:1,sx:{"&:empty":{display:"none"}}},P);if(M==="custom")return P;if(M==="drawer"&&v.current)return ta.default.createElement(md,{onClose:c},P)};return ta.default.createElement(oT,{className:"maxai--chat-hub",containerRef:v,disabled:l,sx:{width:"100%",height:"100%",flex:1,flexDirection:"row","& *":{boxSizing:"border-box"},...s}},!l&&ta.default.createElement(tT,null),S(o,n),ta.default.createElement(rT,{chatHubSlot:a,...e},C.map((M,P)=>ta.default.createElement(i1,{inputMediator:vt(y),chatHubOrder:P,variant:t||(b>1?"chatHub":"normal"),conversationId:M,key:C.length===1?P:M,headerProps:u?.(M,P,{conversationId:M}),footerProps:m?.(M,P,{conversationId:M}),inputProps:d?.(M,P,{conversationId:M}),toolsProps:f?.(M,P,{conversationId:M}),footerPrefix:h?.(M,P,{conversationId:M}),messageProps:_?.(M,P,{conversationId:M}),sx:x?.(M,P,{conversationId:M})},p))),S(r,i))},iT=BH;var Sn=I(E());var Ja=I(E());var DH=()=>{let[{stack:e},t]=li(uy),o=mi(e),n=!!o,{t:r}=k(["client","common"]),i=(0,Ja.useCallback)(async c=>{o&&(await ay.send("DiscardModalClose",{discardId:o.discardId,confirm:c==="confirm",cancel:c==="cancel"}),t(u=>({...u,stack:u.stack.slice(0,u.stack.length-1)})))},[o,t]),a=(0,Ja.useCallback)(()=>i("confirm"),[i]),s=(0,Ja.useCallback)(()=>i("cancel"),[i]),l=et(s),p=et(n);return(0,Ja.useEffect)(()=>{let c=u=>{p.current&&u.key==="Escape"&&(u.stopPropagation(),u.preventDefault(),l.current?.())};return window.addEventListener("keydown",c,!0),()=>{window.removeEventListener("keydown",c)}},[p,l]),Ja.default.createElement(Pi,{show:n,title:o?.content||"",onConfirm:a,onClose:s,modalSx:{zIndex:2147483621},wrapSx:{width:"288px"},variant:"danger",confirmBtnText:r("common:discard"),cancelBtnText:r("common:cancel"),isFixed:!0})},aT=DH;var le=I(E());var je=I(E());var Ip=24,sT=8,FH=(e=window.innerHeight*.5)=>Math.max(Math.floor(e/24)||5),Fs=(e,t=0,o=0,n=0,r)=>{let i=e?.parentElement?.parentElement;if(e&&i){let a=window.getComputedStyle(e),s=Number(e.getAttribute("data-min-line"))||1,l=parseInt(a.paddingTop??sT,10)+parseInt(a.paddingBottom??sT,10);e.style.cssText="height:0px";let p=e.value?e.scrollHeight:Ip*s+l,c=Math.min(Ip*FH(r),p);n===0&&(n=e?.previousElementSibling?.offsetHeight||0);let u=Math.max(Ip*s+l,n||0);c=Math.max(u,c),e.style.cssText=`height: ${c}px`;let m=c+t+o;i.style.cssText=`height: ${m}px`}},HH=(e,t=0,o=0,n=0,r)=>{Fs(e,t,o,n,r),setTimeout(()=>{Fs(e,t,n,r);let i=e.value;e.focus(),e.setSelectionRange(i.length,i.length)},100)},s1=(e,t=0,o=0,n=0)=>{if(!e)return;let r="",i=document.querySelector('div[data-testid=sentinelStart][tabindex="0"]');if(i?.nextElementSibling&&i.nextElementSibling.getAttribute("tabindex")==="-1"&&(r="mui",i.nextElementSibling.removeAttribute("tabindex")),window.location.host==="www.linkedin.com"){let a=document.querySelector('div[tabindex="-1"][role="dialog"]');a&&(r="linkedin",a.removeAttribute("tabindex"),document.activeElement?.blur(),setTimeout(()=>{a.setAttribute("tabindex","-1")},100))}e.isSameNode($2())||e.isSameNode(X2())||HH(e,t,o,n)},NH=e=>{let{defaultValue:t,onChange:o,onEnter:n,onKeydown:r,onKeydownCapture:i,loading:a,children:s,error:l=!1,InputId:p=Us,stopPropagation:c=!0,placeholder:u="Ask AI...",expandNode:m,sx:d,minLine:f=1,maxHeight:h,autoFocus:_,prefixNode:x,onControlledValueChange:C}=e,y=$t(qx),{currentSidebarConversationId:b,currentSidebarConversationType:v}=Ml(),S=$t(vl),M=(0,je.useRef)(null),P=(0,je.useRef)(!1),O=(0,je.useRef)(!1),[L,H]=(0,je.useState)(t||""),z=(0,je.useRef)(0),R=(0,je.useRef)(0),V=(0,je.useRef)(0),F=(0,je.useRef)(null),q=(0,je.useRef)(null),X=(0,je.useRef)(null),W=(0,je.useMemo)(()=>Wr(Fs,200),[]),j=(0,je.useRef)(Rp()),w=U=>[z.current,V.current,R.current,h],ne=(0,je.useCallback)(U=>{let N=U.target.value;p===Us?vt("chatBoxInputMediator").updateInputValue(N):p===si&&vt("floatingMenuInputMediator").updateInputValue(N),H(N),o&&o(N,{includeHistory:!O.current})},[o]),pe=(0,je.useRef)({});(0,je.useEffect)(()=>{if(p===Us){let U=(N,ce)=>{ce&&(pe.current=ce),N.startsWith("``NO_HISTORY_&#``\n")&&(N=N.replace("``NO_HISTORY_&#``\n",""),O.current=!0),H(N)};return vt("chatBoxInputMediator").subscribe(U),()=>{vt("chatBoxInputMediator").unsubscribe(U)}}else if(p===si){let U=(N,ce)=>{N.startsWith("``NO_HISTORY_&#``\n")&&(N=N.replace("``NO_HISTORY_&#``\n",""),O.current=!0),H(N),ce?.selectAll&&setTimeout(()=>{M.current?.focus(),M.current?.setSelectionRange(0,N.length)},50)};return vt("floatingMenuInputMediator").subscribe(U),()=>{vt("floatingMenuInputMediator").unsubscribe(U)}}},[p]),(0,je.useEffect)(()=>{O.current=!1,pe.current={}},[a]),(0,je.useEffect)(()=>{W(M.current,...w("inputValue1")),setTimeout(()=>{M.current&&Fs(M.current,...w("inputValue2"))},0)},[L]),(0,je.useEffect)(()=>{let U=new ResizeObserver(Z=>{for(let re of Z)setTimeout(()=>{z.current=re.target?.offsetHeight||0,M.current&&Fs(M.current,...w("children"))},30)}),N=new ResizeObserver(()=>{setTimeout(()=>{(X.current?.offsetHeight??0)!==V.current&&(V.current=X.current?.offsetHeight||0,M.current&&Fs(M.current,...w()))},0)}),ce=new ResizeObserver(Z=>{for(let re of Z)setTimeout(()=>{R.current=re.target?.offsetHeight||0,M.current&&Fs(M.current,...w("expand"))},100)});return q.current&&ce.observe(q.current),F.current&&U.observe(F.current),X.current&&N.observe(X.current),()=>{U.disconnect(),ce.disconnect(),N.disconnect()}},[]),(0,je.useEffect)(()=>{S&&M.current&&p===si&&s1(M.current,...w("floatingDropdownMenu"))},[S]),(0,je.useEffect)(()=>{(y.open||j.current)&&M.current&&p===Us&&!fm()&&s1(M.current,...w("appState"))},[y.open,a,v,b]),wn(()=>{if(p===Us&&j.current){let U=setTimeout(()=>{s1(M.current,...w("appState"))},100);return()=>clearTimeout(U)}});let A=Sm(C);return(0,je.useEffect)(()=>{A.current?.(L,p)},[p,L,A]),je.default.createElement(B,{component:"div",className:a?"chat-box__input--loading":"",borderRadius:"8px",border:"1px solid",borderColor:`${l?"rgb(239, 83, 80)":"border.main"}`,width:"100%",minHeight:34,sx:{display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"wrap",overflow:"hidden","& .chat-box__input-skeleton":{opacity:0,zIndex:-1,position:"absolute",top:0,padding:"8px",left:0,width:"100%",display:"none"},"&.chat-box__input--loading":{maxHeight:"106.5px",overflow:"hidden",position:"relative","& textarea":{opacity:0},"& .chat-box__input-skeleton":{opacity:1,zIndex:1,display:"block"}},...d}},je.default.createElement(B,{component:"div",className:"chat-box__input-skeleton"},je.default.createElement(fo,{height:Ip})),je.default.createElement(B,{ref:X,className:"chat-box__input\u2014prefix",sx:{width:"100%"}},x),je.default.createElement(g,{alignItems:"start",width:"100%",direction:"row",sx:{"& > textarea":{p:1,maxHeight:a?Ip*f+16:"unset",color:U=>U.palette.mode==="dark"?"#fff":"rgba(0,0,0,.87)!important",my:1.5,fontSize:"16px",lineHeight:Ip+"px",background:"transparent!important",borderColor:"transparent!important",margin:"0!important",border:"0!important",outline:"0!important",boxShadow:"none!important",width:"100%",resize:"none",overflow:"hidden",overflowY:"auto",fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important',"&::-webkit-scrollbar":{width:0,background:"transparent"},"&::-webkit-scrollbar-thumb":{background:"transparent"}}}},je.default.createElement(g,{ref:q,className:"max-ai-user-input__expand",sx:{"&:has(> div)":{py:1,pl:1},alignSelf:"start"}},m),je.default.createElement("textarea",{id:p,placeholder:u,disabled:a,ref:M,value:L,rows:1,"data-min-line":f,onCopy:U=>{U.stopPropagation()},onCut:U=>{U.stopPropagation()},onKeyUp:U=>{c&&U.stopPropagation()},onKeyPress:U=>{c&&U.stopPropagation()},onKeyDown:U=>{if(!(i&&i(U))){if(c){if((U.key==="ArrowUp"||U.key==="ArrowDown"||U.key==="ArrowLeft"||U.key==="ArrowRight"||U.key==="Escape")&&p===si)return;U.stopPropagation()}if(!P.current){if(!(U.key==="Enter"&&U.shiftKey)){if(U.key==="Enter"){U.preventDefault();let N=U.currentTarget.value;n&&n(N,{includeHistory:!O.current,meta:pe.current}),O.current=!1,pe.current={}}else if(U.code==="Space"){U.stopPropagation();return}}r&&r(U)}}},onClick:U=>{s1(U.currentTarget,...w("click"))},onCompositionUpdate:U=>{c&&U.stopPropagation()},onCompositionStart:U=>{c&&U.stopPropagation(),P.current=!0},onCompositionEnd:U=>{c&&U.stopPropagation(),P.current=!1,ne(U)},onInput:U=>{c&&U.stopPropagation(),P.current?H(U.currentTarget.value):ne(U)},onBlur:U=>{W(U.currentTarget,...w("blur"))},autoFocus:_})),je.default.createElement(g,{ref:F,width:"100%"},s))},lT=NH;var qc=I(E());var B0=()=>{let{t:e}=k(["client"]),{setUserSettings:t,userSettings:o}=Un(),{conversationId:n="",conversationMessages:r}=ie(),{getConversation:i}=ot(),{continueConversationInSidebar:a}=Ml(),{floatingDropdownMenuOpen:s}=Aa(),l=o?.alwaysContinueInSidebar,p=async()=>{let c=!l,u=await i(n);u?.lastMessageId&&c&&a(u.id),await t({...o,alwaysContinueInSidebar:c})};return!s||r.length?null:qc.default.createElement(Tr,{title:e(l?"floating_menu__always_unpin_to_sidebar":"floating_menu__always_pin_to_sidebar"),onClick:p,floatingMenuTooltip:!0,placement:"top"},qc.default.createElement("span",null,qc.default.createElement(se,{"data-testid":l?"maxai--context-window--always-responses-in-contextmenu--button":"maxai--context-window--always-responses-in-sidebar--button",sx:{width:32,height:32}},qc.default.createElement(G,{icon:l?"AlwaysResponsesInContextMenu":"AlwaysResponsesInSidebar"}))))};var l1=I(E());var D0=e=>{let{sx:t,TooltipProps:o}=e,{t:n}=k(["client"]),{hideFloatingContextMenu:r}=Aa(),{betaSettings:i}=Wo();if(i?.appearance_v2_enabled)return null;let a=async()=>{let s=Fu();if(s){r(),Vi();let l=await mh(s,'button[data-testid="maxai--sidebar--contextmenu_tab"]',50,5e3);if(!l)return;l?.click(),await new Promise(c=>setTimeout(c,1e3)),(await mh(s,'button[data-testid="maxai-chat-history-button"]',50,5e3))?.click()}};return l1.default.createElement(Tr,{title:n("client:sidebar__speed_dial__chat_history__button"),placement:"bottom",...o},l1.default.createElement(Re,{onClick:a,"data-testid":"maxai-context-window-history-button",sx:{width:"28px",height:"28px",color:"text.primary",minWidth:"unset",borderRadius:"8px",border:"1px solid",borderColor:"border.main",...t},TouchRippleProps:{center:!1}},l1.default.createElement(G,{icon:"History",sx:{fontSize:"20px"}})))};var Li=I(E());var p1={ChatInSidebar:{value:"chat-in-sidebar",label:"client:context_menu__button__chat_in_sidebar__title",icon:Li.default.createElement(G,{icon:"ChatInSidebar"})},AlwaysChatInSidebar:{value:"always-chat-in-sidebar",label:"client:context_menu__button__always_chat_in_sidebar__title",icon:Li.default.createElement(G,{icon:"AlwaysResponsesInSidebar"})}},F0=()=>{let{t:e}=k(),{setUserSettings:t,userSettings:o}=Un(),{conversationId:n,conversationMessages:r}=ie(),{continueConversationInSidebar:i}=Ml(),a=(0,Li.useMemo)(()=>Object.values(p1).map(p=>({...p,label:e(p.label)})),[e]),s=(0,Li.useMemo)(()=>o?.alwaysContinueInSidebar?p1.AlwaysChatInSidebar:p1.ChatInSidebar,[o]),l=async p=>{n&&(i(n),p===p1.AlwaysChatInSidebar.value&&await t({...o,alwaysContinueInSidebar:!0}))};return r.length?Li.default.createElement(Na,{isMirror:!0,hoverOpen:!0,placement:"bottom-start",headless:!0,referenceElement:Li.default.createElement(se,{"data-testid":"maxai-context-window-continue-chat-button",onClick:p=>{p.stopPropagation(),l(s.value)}},s.icon,Li.default.createElement(T,{sx:{fontSize:"14px"}},e(s.label))),sx:{zIndex:2147483602},modifiers:[{name:"offset",options:{offset:[0,6]}}]},Li.default.createElement(Cl,{sx:{width:"240px"},defaultValue:s.value,options:a,onSelectOption:l})):null};var H0=I(E());var RH=I(E());var pT=I(pa()),es=I(E());var DEe=e=>es.default.createElement(pT.default,{...e},es.default.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},es.default.createElement("path",{d:"M6.38095 14.8256L5.71627 11.8449H6.39567L6.78114 13.8211L7.24333 11.8449H7.82387L8.2904 13.8233L8.67364 11.8449H9.35093L8.68626 14.8256H7.98793L7.53225 12.9908L7.08348 14.8256H6.38095Z",fill:"currentColor"}),es.default.createElement("path",{d:"M10.9345 14.8256L10.2699 11.8449H10.9493L11.3347 13.8211L11.7969 11.8449H12.3775L12.844 13.8233L13.2272 11.8449H13.9045L13.2398 14.8256H12.5415L12.0858 12.9908L11.6371 14.8256H10.9345Z",fill:"currentColor"}),es.default.createElement("path",{d:"M15.4881 14.8256H16.1906L16.6394 12.9908L17.0951 14.8256H17.7934L18.4581 11.8449H17.7808L17.3976 13.8233L16.931 11.8449H16.3505L15.8883 13.8211L15.5028 11.8449H14.8234L15.4881 14.8256Z",fill:"currentColor"}),es.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.6308 10.0915H19.7672C20.2492 10.0915 20.6399 10.484 20.6399 10.9682V15.3516C20.6399 15.8358 20.2492 16.2283 19.7672 16.2283H17.7263C16.6592 18.2615 14.5343 19.6474 12.0872 19.6474C9.64007 19.6474 7.5152 18.2615 6.44802 16.2283H4.40718C3.92519 16.2283 3.53446 15.8358 3.53446 15.3516V10.9682C3.53446 10.484 3.92519 10.0915 4.40718 10.0915H6.54358C7.63879 8.15442 9.71108 6.84773 12.0872 6.84773C14.4633 6.84773 16.5356 8.15442 17.6308 10.0915ZM10.4088 7.6193C9.05129 8.02721 7.90098 8.91722 7.15483 10.0915H9.04299C9.18875 9.61479 9.36687 9.17588 9.5724 8.78527C9.81055 8.33266 10.0917 7.93482 10.4088 7.6193ZM9.59245 10.0915H11.8254V7.39749C11.1699 7.51643 10.5359 8.07982 10.0353 9.03108C9.86806 9.349 9.71911 9.70472 9.59245 10.0915ZM12.349 10.0915H14.5819C14.4553 9.70472 14.3063 9.349 14.139 9.03108C13.6385 8.07982 13.0045 7.51643 12.349 7.39749V10.0915ZM15.1314 10.0915H17.0195C16.2734 8.91722 15.1231 8.02721 13.7655 7.6193C14.0826 7.93482 14.3638 8.33266 14.602 8.78527C14.8075 9.17588 14.9856 9.61479 15.1314 10.0915ZM7.04767 16.2283C7.78831 17.4892 8.98451 18.4479 10.4088 18.8759C10.0917 18.5603 9.81055 18.1625 9.5724 17.7099C9.34191 17.2718 9.14588 16.773 8.99133 16.2283H7.04767ZM9.5372 16.2283C9.67503 16.6833 9.84308 17.0987 10.0353 17.4641C10.5359 18.4153 11.1699 18.9787 11.8254 19.0977V16.2283H9.5372ZM12.349 16.2283V19.0977C13.0045 18.9787 13.6385 18.4153 14.139 17.4641C14.3313 17.0987 14.4993 16.6833 14.6372 16.2283H12.349ZM15.183 16.2283C15.0285 16.773 14.8325 17.2718 14.602 17.7099C14.3638 18.1625 14.0826 18.5603 13.7655 18.8759C15.1899 18.4479 16.3861 17.4892 17.1267 16.2283H15.183ZM4.05809 10.9682C4.05809 10.7745 4.21439 10.6175 4.40718 10.6175H19.7672C19.96 10.6175 20.1163 10.7745 20.1163 10.9682V15.3516C20.1163 15.5453 19.96 15.7023 19.7672 15.7023H4.40718C4.21439 15.7023 4.05809 15.5453 4.05809 15.3516V10.9682Z",fill:"currentColor"}),es.default.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.96355 2.72728C1.48159 2.72728 1.09082 3.11978 1.09082 3.60397V20.0858C1.09082 20.7636 1.63785 21.3131 2.31264 21.3131H21.6872C22.362 21.3131 22.909 20.7636 22.909 20.0858V3.60397C22.909 3.11978 22.5182 2.72728 22.0363 2.72728H1.96355ZM1.789 20.0858V5.88337H22.2108V20.0858C22.2108 20.3763 21.9764 20.6118 21.6872 20.6118H2.31264C2.02344 20.6118 1.789 20.3763 1.789 20.0858ZM3.18537 4.30532C3.18537 4.59584 2.95091 4.83134 2.66173 4.83134C2.37255 4.83134 2.13809 4.59584 2.13809 4.30532C2.13809 4.01481 2.37255 3.77931 2.66173 3.77931C2.95091 3.77931 3.18537 4.01481 3.18537 4.30532ZM4.58173 4.30532C4.58173 4.59584 4.34727 4.83134 4.05809 4.83134C3.76892 4.83134 3.53446 4.59584 3.53446 4.30532C3.53446 4.01481 3.76892 3.77931 4.05809 3.77931C4.34727 3.77931 4.58173 4.01481 4.58173 4.30532ZM5.45446 4.83134C5.74363 4.83134 5.97809 4.59584 5.97809 4.30532C5.97809 4.01481 5.74363 3.77931 5.45446 3.77931C5.16528 3.77931 4.93082 4.01481 4.93082 4.30532C4.93082 4.59584 5.16528 4.83134 5.45446 4.83134ZM20.1163 4.30532C20.1163 4.20849 20.1944 4.12999 20.2908 4.12999H21.6872C21.7836 4.12999 21.8617 4.20849 21.8617 4.30532C21.8617 4.40215 21.7836 4.48066 21.6872 4.48066H20.2908C20.1944 4.48066 20.1163 4.40215 20.1163 4.30532Z",fill:"currentColor"})));var N0=I(E());var Lo=I(E());var z0=({onRegenerate:e})=>{let{conversationId:t}=ie(),o=fe(t),n=(0,Lo.useRef)(!1),{currentFloatingContextMenuDraft:r}=Pn(),i=(0,Lo.useMemo)(()=>!!(o&&r),[o,r]),{stopGenerate:a,regenerate:s}=ke(),l=(0,Lo.useRef)(s),p=(0,Lo.useRef)(a);l.current=s,p.current=a;let c=(0,Lo.useCallback)(async u=>{u==="s"&&(n.current=!1,await p.current()),u==="r"&&(n.current=!0,await p.current(),e?.(),await l.current(t))},[t]);return(0,Lo.useEffect)(()=>{if(!i)return;let u=async m=>{let d=m.key;fm()&&["r","s","o","c"].includes(d)&&(m.preventDefault(),m.stopPropagation(),await c(d))};return window.addEventListener("keydown",u),()=>{window.removeEventListener("keydown",u)}},[i,c]),i?Lo.default.createElement(g,{direction:"row",spacing:1,sx:{ml:"auto!important","& .usechatgpt-floating-menu__button__shortcut":{fontSize:"12px",opacity:.7,ml:"4px"}}},Lo.default.createElement(de,{sx:{height:"24px"},variant:"text",onClick:async()=>{await c("r")}},Lo.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Try again",Lo.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"R"))),Lo.default.createElement(de,{sx:{height:"24px"},variant:"text",onClick:async()=>{await c("s")}},Lo.default.createElement(T,{component:"span",fontSize:"14px",color:"primary.main"},"Stop",Lo.default.createElement("span",{className:"usechatgpt-floating-menu__button__shortcut"},"S")))):Lo.default.createElement(Lo.default.Fragment,null)};var nt=I(E());var cT=(0,nt.forwardRef)((e,t)=>{let{t:o}=k(["prompt","client"]),{draftUserMessage:n}=Pn(),r=(0,nt.useMemo)(()=>{let i=n?.meta?.MaxAIPromptActionConfig?.prompt_id;if(i)return nt.default.createElement(g,{fontSize:"14px",direction:"column",alignItems:"flex-start"},nt.default.createElement(B,null,o(`prompt:${i}`)),nt.default.createElement(B,null,o("client:floating_menu__contextmenu__click_to_retry")));let a=n?.text?.replace(/^(.*?)\s*:\s*""".*?"""/s,"$1");return a?nt.default.createElement(g,{fontSize:"14px",direction:"column",alignItems:"flex-start"},nt.default.createElement(B,null,a),nt.default.createElement(B,null,o("client:floating_menu__contextmenu__click_edit_prompt_and_retry"))):""},[n]);return nt.default.createElement(Tr,{title:r,placement:"right",floatingMenuTooltip:!0,slotProps:{popper:{modifiers:[{name:"offset",options:{offset:[0,3]}}]}}},nt.default.createElement(wm,{...e,label:o("package__features:context_menu__prompt__6b9f9cb4-b1b1-4897-9156-903dbc52b2a1"),menuItem:e.menuItem,ref:t}))});cT.displayName="TryAgainItem";var Kc=(0,nt.forwardRef)((e,t)=>{let{menuItem:o,root:n,referenceElement:r,referenceElementOpen:i,rootMenu:a,customOpen:s,onClickContextMenu:l,menuWidth:p,...c}=e,{t:u}=k(),m=(0,nt.useCallback)(f=>{let h=`context_menu__prompt__${f.prompt_id.replace(Zo,"")}`,_=`package__features:${h}`,x=u(_);return x!==_&&x!==h?x:f.prompt_title},[u]),d=(0,nt.useMemo)(()=>m(o),[o.prompt_title,m]);return o.type==="group"?nt.default.createElement(Wp,{zIndex:e.zIndex,ref:t,root:n,label:d,menuWidth:p,onClickContextMenu:l,referenceElement:nt.default.createElement(wm,{...c,label:d,menuItem:o}),needAutoUpdate:c.needAutoUpdate},(o.children??[]).map(f=>nt.default.createElement(Kc,{...c,root:n,key:f.prompt_id,menuItem:f}))):o.prompt_id===yl.TRY_AGAIN?nt.default.createElement(cT,{...c,menuItem:o,ref:t}):nt.default.createElement(wm,{...c,label:d,menuItem:o,ref:t})});Kc.displayName="RenderDropdownItem";var c1=e=>nt.default.createElement(B,{"data-testid":"max-ai-context-menu-divider","aria-disabled":!0,key:`${e}_group_spector`,onClick:t=>{t.stopPropagation(),t.preventDefault()},component:"div",sx:{pointerEvents:"none",borderTop:"1px solid",borderColor:"border.main",my:.5}}),VH=e=>{let{root:t,referenceElement:o,referenceElementOpen:n,referenceElementRef:r,menuList:i,customOpen:a,needAutoUpdate:s,defaultPlacement:l,defaultFallbackPlacements:p,onClickContextMenu:c,menuWidth:u,onClickReferenceElement:m,hoverOpen:d,hoverIcon:f,isFirstLevelFlatten:h=!0,..._}=e,{t:x}=k(),C=(0,nt.useMemo)(()=>{let y=[];return i.forEach((b,v)=>{let S=`context_menu__prompt__${b.prompt_id.replace(Zo,"")}`,M=`package__features:${S}`,P=x(M);P=P!==M&&P!==S?P:b.prompt_title,b.type==="group"&&h?(v>0&&y.push(c1(b.prompt_id)),y.push(nt.default.createElement(B,{key:b.prompt_id+"_group_name",component:"div","aria-disabled":!0,"data-testid":`max-ai-context-menu-group-label__${b.prompt_id}`,sx:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",boxSizing:"border-box",direction:"row",pl:"8px"},onMouseDownCapture:O=>{O.stopPropagation(),O.preventDefault()}},nt.default.createElement(B,{sx:{p:"6px 0 8px 0",pointerEvents:"none"}},nt.default.createElement(T,{textAlign:"left",fontSize:12,color:"text.secondary"},P)),b.prompt_id===Zo&&nt.default.createElement($l,null))),(b.children??[]).forEach((O,L)=>{lh.includes(O.prompt_id)&&y.push(c1(b.prompt_id)),y.push(nt.default.createElement(Kc,{menuWidth:u,hoverIcon:f,onClickContextMenu:c,zIndex:2147483602,needAutoUpdate:s,..._,key:O.prompt_id,menuItem:O,root:t}))})):b.type==="chat_complete"?(v>0&&y.push(c1(b.prompt_id)),y.push(nt.default.createElement(Kc,{menuWidth:u,hoverIcon:f,onClickContextMenu:c,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602}))):(lh.includes(b.prompt_id)&&y.push(c1(b.prompt_id)),y.push(nt.default.createElement(Kc,{menuWidth:u,hoverIcon:f,onClickContextMenu:c,needAutoUpdate:s,key:b.prompt_id,menuItem:b,root:t,zIndex:2147483602})))}),y},[i,x,h]);return nt.default.createElement(Wp,{zIndex:2147483601,label:"",root:t,customOpen:a,needAutoUpdate:s,referenceElement:o,referenceElementOpen:n,referenceElementRef:r,defaultPlacement:l,defaultFallbackPlacements:p,onClickContextMenu:c,onClickReferenceElement:m,hoverOpen:d,menuWidth:u,hoverIcon:f},n===!1?null:C)},uT=VH;var zr=I(E());var mT="context-menu-dom-event-manager";var hT=I(Sr()),gT=I(dT()),xT=I(fT());var Oi=I(E());var $H=({loading:e})=>{let{t}=k(["common","client"]),{hideFloatingContextMenu:o}=vm(),{floatingDropdownMenuPin:n,setFloatingDropdownMenuPin:r}=my(),i=()=>{r(!n)};return Oi.default.createElement(Oi.default.Fragment,null,Oi.default.createElement(Tr,{title:t(n?"client:floating_menu__pin_button__pinned__title":"client:floating_menu__pin_button__unpinned__title"),placement:"top",floatingMenuTooltip:!0},Oi.default.createElement(Re,{"data-testid":"maxai-context-window-pin-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"0 3px"},onClick:i},n?Oi.default.createElement(gT.default,{sx:{fontSize:16,transform:"rotate(45deg)"},color:"primary"}):Oi.default.createElement(xT.default,{sx:{fontSize:16,transform:"rotate(45deg)"}}))),Oi.default.createElement(Tr,{title:t("client:floating_menu__close_button__title"),description:"Esc",placement:"top",floatingMenuTooltip:!0},Oi.default.createElement(Re,{"data-testid":"maxai-context-window-close-button",size:"small",sx:{width:28,height:28,color:"text.secondary","&:hover":{color:"text.primary"},padding:"3px",marginRight:"-3px"},disabled:e,onClick:()=>o(!0)},Oi.default.createElement(hT.default,{sx:{fontSize:17}}))))},d1=$H;var yT=I(_T()),bT=I(CT());var Hs=I(E());var tN=()=>{let{activeResponseMessageIndex:e,goToNextMessage:t,goToPreviousMessage:o,totalResponseCount:n}=Pn(),{conversationId:r}=ie(),i=fe(r),a=e===0,s=e===n-1;return n===0?null:Hs.default.createElement(g,{flexShrink:0,direction:"row",gap:.5,height:"32px",lineHeight:"32px",alignItems:"center"},Hs.default.createElement(Re,{sx:{width:"24px",height:"24px"},disabled:i||a,onClick:o},Hs.default.createElement(yT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:a?.4:1}})),Hs.default.createElement(T,{fontSize:"12px",color:"text.secondary",fontWeight:400,lineHeight:"24px"},`${e+1} of ${n}`),Hs.default.createElement(Re,{sx:{width:"24px",height:"24px"},disabled:i||s,onClick:t},Hs.default.createElement(bT.default,{sx:{fontSize:"20px",p:"2px",color:"text.secondary",cursor:"pointer",opacity:s?.4:1}})))},IT=tN;var oN=({showModelSelector:e,showUsageButton:t,loading:o})=>{let{conversationMessages:n}=ie(),{localSettings:r}=tt(),i=r?.chatMode==="pro_chat",a=()=>{let p=cn()?.querySelector(`#${si}`);p&&p?.focus()},s=()=>{a()},l=()=>{a()};return zr.default.createElement(g,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{wordBreak:"break-word",color:p=>p.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)",paddingBottom:n.length?"0":"4px",paddingTop:n.length?"10px":"0"},component:"div"},zr.default.createElement(g,{direction:"row",gap:"4px",alignItems:"center",flexWrap:"wrap"},zr.default.createElement(Fa,{hideOnboarding:!0,disabled:o}),e&&i&&zr.default.createElement(Ra,{onChanged:s,disabled:!e||o,size:"small",tooltipProps:{placement:"top"},domEventManagerId:mT}),i&&zr.default.createElement(Ha,{onChanged:l,tooltipProps:{placement:"top"},disabled:o}),zr.default.createElement(g,{direction:"row",alignItems:"center",gap:"4px","data-testid":"maxai--chat-box--tools--left-container--portal-root",sx:{display:i?"flex":"none","&:empty":{display:"none"}}})),zr.default.createElement(g,{direction:"row",justifyContent:"end",alignItems:"center",sx:{alignSelf:"flex-start",height:32,gap:.5}},zr.default.createElement(g,{direction:"row",alignItems:"center"},zr.default.createElement(D0,{TooltipProps:{placement:"top",floatingMenuTooltip:!0},sx:{mr:1}}),!o&&!n.length&&zr.default.createElement(d1,{loading:o}),zr.default.createElement(IT,null))))},ST=oN;var ht=I(E());var g1=3*24,x1=e=>{let t=e.scrollTop,o=e.scrollHeight,n=e.clientHeight;return Math.abs(n+t-o)>8},nN=({onChange:e,contextMenuDefaultHeight:t})=>{let o=qs(),n=$t(vl),r=bo(py),{conversationId:i}=ie(),a=fe(i),{currentFloatingContextMenuDraft:s,activeResponseMessage:l}=Pn(),p=(0,ht.useRef)(null),c=(0,ht.useRef)(null),u=(0,ht.useRef)(),[m,d]=(0,ht.useState)(!1),f=()=>{let C=c.current;C&&(C.scrollTo(0,C.scrollHeight),d(!1))},h=(0,ht.useMemo)(()=>s.replace(/^\s+/,""),[s]);(0,ht.useEffect)(()=>{a||(r(C=>({...C,lastOutput:s})),e?.(s))},[s,n,a]),(0,ht.useEffect)(()=>{let C=y=>{if((y.metaKey||y.ctrlKey)&&(y.stopPropagation(),y.key==="C"||y.key==="c"||y.key==="x"||y.key==="X")){let b=window.getSelection();if(b&&b.rangeCount>0){let S=b.getRangeAt(0).toString()||b.toString();S&&(y.preventDefault(),navigator.clipboard.writeText(S))}}};c.current?.addEventListener("keydown",C,!0)},[]),(0,ht.useEffect)(()=>{let C=c.current;if(!C)return;let y=new ResizeObserver(()=>{d(x1(C))});y.observe(C);let b=Wr(()=>{d(x1(C))},100);return C.addEventListener("wheel",b),()=>{y.disconnect(),C.removeEventListener("wheel",b)}},[]);let _=(0,ht.useRef)(a);(0,ht.useEffect)(()=>{_.current=a},[a]),(0,ht.useEffect)(()=>{if(l?.messageId&&u.current!==l.messageId){u.current=l.messageId;let C=c.current,y=C?.clientHeight||0,b=C?.querySelector(".markdown-body")||null;if(C){if(_.current)if(b&&C.clientHeight>g1){let v=A_(Array.from(b.childNodes).map(S=>{let M=S;return M.clientHeight?M.clientHeight:0}));if(v>=g1){let S=v+y-g1;b.style.minHeight=`${S}px`,C&&C.scrollTo({top:v-g1})}else b.style.minHeight=`${y}px`,C&&C.scrollTo({top:0})}else C.scrollTo({top:C.scrollHeight});else C.scrollTo({top:0});d(x1(C))}}else if(!l){let y=c.current?.querySelector(".markdown-body")||null;y&&(y.style.minHeight="unset")}},[l?.messageId]),(0,ht.useEffect)(()=>{let C=c.current;C&&d(x1(C))},[h]);let x=l&&zi(l);return ht.default.createElement(g,{ref:p,className:"chat-message--text max-ai__writing-message-box",whiteSpace:"pre-wrap",width:"100%",sx:{position:"relative",wordBreak:"break-word",borderBottomLeftRadius:0,flex:1,overflowY:"auto",color:C=>C.palette.mode==="dark"?"#FFFFFFDE":"rgba(0,0,0,0.87)","& .markdown-body":{userSelect:"text",overflowY:"auto","*":{fontFamily:'"Roboto","Helvetica","Arial",sans-serif!important'}}},component:"div"},x&&ht.default.createElement(vf,{message:l,sx:{boxSizing:"border-box",my:1}}),ht.default.createElement(g,{"data-testid":"maxai--contextmenu--writing-message-box",tabIndex:-1,ref:c,sx:{flex:1,height:0,width:"100%",overflowY:"auto"}},l&&Qn(l)&&ht.default.createElement(Gd,{message:l},ht.default.createElement(_f,{message:l})),!x&&ht.default.createElement("div",{style:{textAlign:"left",overflowY:"unset",padding:h?"16px 0":"0"},className:`markdown-body ${o.palette.mode==="dark"?"markdown-body-dark":""}`},h?ht.default.createElement(Sa,{message:l||void 0},h):t?ht.default.createElement(ht.default.Fragment,null,ht.default.createElement(fo,{variant:"text",sx:{fontSize:"1.5rem"}}),ht.default.createElement(fo,{variant:"text",sx:{fontSize:"1.5rem"},width:"70%"}),t>218&&ht.default.createElement(fo,{variant:"text",sx:{fontSize:"1.5rem"},width:"50%"})):null),m&&ht.default.createElement(Hf,{onClick:()=>f()})))},vT=nN;var ts=I(E());var $c={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},rN=e=>{let{showStateTrigger:t,...o}=e,{t:n}=k(),[r,i]=(0,ts.useState)(!1);return(0,ts.useEffect)(()=>{t?El(500).then(async()=>{if(!await tr($c.sceneType)){let s=cn();if(Gp("FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",s)||Gp("FLOATING_CONTEXT_MENU_LIST_BOX",s))return;Ar($c.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),ts.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],offset:[0,8],trigger:r,anchorElementSelectors:$c.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":$c.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:$c.id,...o},ts.default.createElement(g,null,ts.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX_AFTER_AI_RESPONSE__text1"))))},TT=rN;var os=I(E());var Xc={sceneType:"FLOATING_CONTEXT_MENU_INPUT_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX",anchorElementSelectors:"div#ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},iN=e=>{let{showStateTrigger:t,...o}=e,{t:n}=k(),[r,i]=(0,os.useState)(!1);return(0,os.useEffect)(()=>{t?Promise.all([tr(Xc.sceneType),tr("FLOATING_CONTEXT_MENU_LIST_BOX")]).then(async([a,s])=>{if(!a){await El(50);let l=cn(),p=!!Gp("FLOATING_CONTEXT_MENU_LIST_BOX",l);if(!s||p)return;Ar(Xc.sceneType).then(()=>{i(!0)})}}):i(!1)},[t]),os.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["bottom-start","top-start"],trigger:r,anchorElementSelectors:Xc.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Xc.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"10px"}},id:Xc.id,...o},os.default.createElement(g,null,os.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_INPUT_BOX__text2"))))},wT=iN;var oa=I(E());var Yc={sceneType:"FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM",anchorElementSelectors:`div[data-id="${yl.REPLACE_SELECTION}"].floating-context-menu-item`,CtaButtonClickedName:"Onboarding > ContextMenu > ReplaceSelection > Got it"},aN=e=>{let{showStateTrigger:t,...o}=e,{t:n}=k(),[r,i]=(0,oa.useState)(!1);(0,oa.useEffect)(()=>{t?tr(Yc.sceneType).then(s=>{s||Ar(Yc.sceneType).then(()=>{i(!0)})}):i(!1)},[t]);let a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return oa.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"right-start",fallbackPlacements:["right-end","left-start","left-end"],offset:[0,8],trigger:r,anchorElementSelectors:Yc.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Yc.CtaButtonClickedName},arrowSx:{'&[data-custom-popover-placement*="bottom"]':{marginLeft:"15px"}},id:Yc.id,...o},oa.default.createElement(g,{gap:1},oa.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_REPLACE_SELECTION_MENUITEM__text1")),oa.default.createElement(da,{sx:a},"Enter")))},MT=aN;var ET=I(Kw()),AT=I($w());var Co=I(E());var Zc={sceneType:"FLOATING_CONTEXT_MENU_LIST_BOX",id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_LIST_BOX",anchorElementSelectors:"div[role=menu].dropdown-menu",CtaButtonClickedName:"Onboarding > ContextMenu > RewriteMenu > Got it"},sN=e=>{let{showStateTrigger:t,...o}=e,{t:n}=k(),[r,i]=(0,Co.useState)(!1),a={bgcolor:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:s=>s.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return(0,Co.useEffect)(()=>{t?El(500).then(()=>{tr(Zc.sceneType).then(s=>{s||Ar(Zc.sceneType).then(()=>{i(!0)})})}):i(!1)},[t]),Co.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"left",fallbackPlacements:["right","bottom","top"],trigger:r,anchorElementSelectors:Zc.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Zc.CtaButtonClickedName},id:Zc.id,...o},Co.default.createElement(g,{spacing:"4px"},Co.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part1")),Co.default.createElement(da,{sx:a},Co.default.createElement(ET.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text1__part2"))),Co.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part1")),Co.default.createElement(da,{sx:a},Co.default.createElement(AT.default,{sx:{fontSize:"12px",transform:"scale(1.6)"}})),Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text2__part2"))),Co.default.createElement(g,{direction:"row",alignItems:"center",spacing:.5},Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part1")),Co.default.createElement(da,{sx:a},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part2")),Co.default.createElement(T,{fontSize:14,lineHeight:1.5},n("onboarding:onboarding_tooltip__FLOATING_CONTEXT_MENU_LIST_BOX__text3__part3")))))},PT=sN;var Cr=I(E());var HT=I(Uu()),NT=I(d0());var qt=I(E());var na=I(E()),LT=I(Hw());var Qc=I(E());var lN=e=>{let{title:t,placement:o,TooltipProps:n,loading:r=!1,children:i,PopperProps:a,...s}=e;return Qc.default.createElement(Tr,{placement:o||"top",title:t,PopperProps:{sx:{},...a},...n},Qc.default.createElement("span",{className:"TextOnlyTooltip_IconButton_wrapper"},Qc.default.createElement(Re,{...s},r?Qc.default.createElement(Lt,{size:16,sx:{m:"0 auto"}}):i)))},kT=lN;var pN=e=>{let{copyText:t,onCopy:o,sx:n,defaultIconSx:r,icon:i,copyToClipboardTooltip:a,copiedTooltip:s,TooltipProps:l,PopperProps:p,tooltipPlacement:c,...u}=e,{t:m}=k(["common"]),[d,f]=(0,na.useState)(!1),h=(0,na.useMemo)(()=>m(d?s||"common:copied":a||"common:copy_to_clipboard"),[m,d,a,s]);return na.default.createElement(LT.CopyToClipboard,{text:t,options:{message:"Copied!",format:"text/plain"},onCopy:()=>{o?.(),f(!0),setTimeout(()=>{f(!1)},1e3)}},na.default.createElement(kT,{title:h,sx:n,className:e.className,TooltipProps:l,PopperProps:p,placement:c,...u},d?na.default.createElement(G,{icon:"Check",sx:{fontSize:"20px",...r}}):i||na.default.createElement(G,{icon:"CopyTextOnly",sx:{fontSize:"20px",...r}}),e.children))},_1=pN;var mo=I(E());var nn=I(E()),BT=I(E());function OT(e){return e.substring(2).toLowerCase()}function cN(e,t){return t.documentElement.clientWidth<e.clientX||t.documentElement.clientHeight<e.clientY}function uN(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function mN(...e){return nn.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(o=>{uN(o,t)})},e)}var R0=e=>{if(e){let t=Fu();if(t&&t.contains(e))return t;if(t=cn(),t){let o=t.querySelector(`#${Ws}`);return o instanceof HTMLElement?o:t}}return document.documentElement};function dN(e){let{children:t,disableReactTree:o=!1,mouseEvent:n="onClick",onClickAway:r,touchEvent:i="onTouchEnd"}=e,a=nn.useRef(!1),s=nn.useRef(null),l=nn.useRef(!1),p=nn.useRef(!1);nn.useEffect(()=>(setTimeout(()=>{l.current=!0},0),()=>{l.current=!1}),[]);let c=mN(t.ref,s),u=(0,BT.useCallback)(f=>{let h=p.current;p.current=!1;let _=R0(s.current);if(!l.current||!s.current||"clientX"in f&&cN(f,_.ownerDocument))return;if(a.current){a.current=!1;return}let x;f.composedPath?x=f.composedPath().indexOf(s.current)>-1:x=!_.ownerDocument.documentElement.contains(f.target)||s.current.contains(f.target),!x&&(o||!h)&&r(f)},[]),m=f=>h=>{p.current=!0;let _=t.props[f];_&&_(h)},d={ref:c};return i!==!1&&(d[i]=m(i)),nn.useEffect(()=>{if(i!==!1){let f=OT(i),h=R0(s.current),_=()=>{a.current=!0};return h.addEventListener(f,u),h.addEventListener("touchmove",_),()=>{h.removeEventListener(f,u),h.removeEventListener("touchmove",_)}}},[u,i]),n!==!1&&(d[n]=m(n)),nn.useEffect(()=>{if(n!==!1){let f=OT(n),h=R0(s.current);return h.addEventListener(f,u),()=>{h.removeEventListener(f,u)}}},[u,n]),nn.createElement(nn.Fragment,null,nn.cloneElement(t,d))}var DT=dN;var fN=Io(({className:e,...t})=>mo.default.createElement(yr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),border:`1px solid ${e.palette.border.main}`,backgroundClip:"padding-box"},[`& .${vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),hN=(0,mo.forwardRef)(function({variable:t,sx:o,container:n,children:r,virtualRect:i,popperSx:a,suffix:s,anchorElSx:l,descriptionEl:p},c){let[u,m]=(0,mo.useState)(!1),d=(0,mo.useRef)(null);(0,mo.useImperativeHandle)(c,()=>({close:()=>m(!1)}));let f=t.key==="Selected Text"||t.key==="Draft"?"Context":t.key,h={container:n,sx:{zIndex:2147483619,...a},transition:!0};return i&&(h.anchorEl={getBoundingClientRect(){return i}}),mo.default.createElement(DT,{onClickAway:_=>{u&&_.target instanceof HTMLElement&&(d.current?.contains(_.target)||d.current===_.target)||m(!1)}},mo.default.createElement(g,{direction:"row",width:"100%",sx:o},mo.default.createElement(fN,{open:u,PopperProps:h,title:mo.default.createElement(g,{direction:"column",maxHeight:"min(500px, 40vh)",overflow:"hidden",height:"max-content"},mo.default.createElement(g,{direction:"row",width:"100%",gap:1.25,p:1.25,ref:d,boxSizing:"border-box",flexGrow:1,overflow:"hidden"},mo.default.createElement(B,{width:"2px",minWidth:"2px",bgcolor:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.12)":"rgba(0, 0, 0, 0.12)"}),mo.default.createElement(g,{direction:"column",flexGrow:1,overflow:"hidden"},mo.default.createElement(g,{direction:"row",gap:1.25,alignItems:"center",maxWidth:"100%"},mo.default.createElement(T,{fontSize:"14px",overflow:"hidden",textOverflow:"ellipsis",noWrap:!0,color:_=>_.palette.mode==="dark"?"rgba(255, 255, 255, 0.50)":"rgba(0, 0, 0, 0.38)"},f),mo.default.createElement(_1,{sx:{padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},PopperProps:{container:n,placement:"top"},copyText:t.value})),p,mo.default.createElement(T,{width:"100%",whiteSpace:"pre-wrap",color:"text.primary",textAlign:"left",lineHeight:"24px",fontSize:"16px",flexGrow:1,overflow:"auto"},t.value))),s),placement:"top",arrow:!0,disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0},mo.default.createElement(B,{onClick:()=>{m(!u)},sx:l},typeof r=="function"?r({variable:t,open:u}):r))))}),FT=hN;var gN=Io(({className:e,...t})=>qt.default.createElement(yr,{...t,classes:{popper:e}}))(({theme:e})=>({[`& > .${vn.tooltip}`]:{background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",color:"rgba(0, 0, 0, 0.87)",fontSize:12,boxShadow:"0px 12px 16px -4px rgba(0, 0, 0, 0.08), 0px 4px 6px -2px rgba(0, 0, 0, 0.03)",maxWidth:"none",borderRadius:e.spacing(1),backgroundClip:"padding-box",border:`1px solid ${e.palette.border.main}`},[`& .${vn.arrow}`]:{color:e.palette.mode==="dark"?"#2C2C2C":"#ffffff","&::before":{border:`1px solid ${e.palette.border.main}`,background:e.palette.mode==="dark"?"#2C2C2C":"#ffffff",backgroundClip:"padding-box"}}})),xN=({quoteText:e,variables:t,container:o,title:n})=>{let{t:r}=k(["client"]),[i,a]=(0,qt.useState)(!1),s=(0,qt.useRef)(null),l=2147483617,p=2147483618;(0,qt.useEffect)(()=>{let u=cn()?.querySelector(`#${Ws}`);if(u instanceof HTMLElement){let m=()=>{a(!1)};return u?.addEventListener("click",m),document.body.addEventListener("click",m),()=>{u?.removeEventListener("click",m),document.body.removeEventListener("click",m)}}},[]);let c=(0,qt.useMemo)(()=>e?qt.default.createElement(B,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",width:"100%"}},qt.default.createElement(FT,{variable:{key:"Quote",value:e},sx:{width:"auto"},popperSx:{boxSizing:"border-box",zIndex:p,maxWidth:s.current?.clientWidth??"500px"},container:o},qt.default.createElement(g,{gap:1,direction:"row",color:u=>u.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"},qt.default.createElement(NT.default,{sx:{fontSize:"18px"}}),qt.default.createElement(PC,{maxLine:2,fontSize:"14px",flex:1},e.trim())))):null,[e,p,o]);return qt.default.createElement(gN,{open:i,PopperProps:{container:o,sx:{zIndex:l}},disableFocusListener:!0,disableHoverListener:!0,disableTouchListener:!0,placement:"top",arrow:!0,title:qt.default.createElement(g,{component:"div",direction:"column",maxWidth:"500px",maxHeight:"min(50vh, 500px)",ref:s,padding:"10px",boxSizing:"border-box",onClick:u=>u.stopPropagation(),sx:{boxSizing:"border-box",background:u=>u.palette.mode==="dark"?"#2C2C2C":"#ffffff"}},c,qt.default.createElement(g,{maxWidth:"100%",width:"auto",direction:"row",sx:{"& .maxai-user-message-copy-icon":{opacity:0,transition:"opacity 0.2s ease-in-out"},"&:hover .maxai-user-message-copy-icon":{opacity:1}}},qt.default.createElement(B,null,qt.default.createElement(_1,{tabIndex:-1,tooltipPlacement:"top",sx:{marginRight:"5px",padding:"5px",fontSize:"20px",borderRadius:"4px",color:"text.secondary"},defaultIconSx:{fontSize:"15px"},className:"maxai-user-message-copy-icon",PopperProps:{container:o,sx:{zIndex:p}},copyText:n})),qt.default.createElement(g,{direction:"column",gap:1,sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",p:u=>u.spacing(1.5),bgcolor:u=>u.palette.background.secondary,borderRadius:u=>u.spacing(1),color:"text.primary",flexWrap:"wrap",flexGrow:1,overflow:"hidden"}},qt.default.createElement(T,{fontSize:"16px"},n),t.map(u=>qt.default.createElement(Lf,{key:u.key,variable:u,getMessageContainer:()=>s.current,container:o,zIndex:p})))))},qt.default.createElement(de,{variant:"text",sx:{gap:"4px",padding:"6px"},onClick:u=>{a(!i),u.stopPropagation()}},qt.default.createElement(T,{color:"text.primary",fontSize:"14px",noWrap:!0},r("floating_menu__button__show_detail")),qt.default.createElement(HT.default,{sx:{color:"#D9D9D9",height:"16px",width:"16px",transition:"all 0.2s",transform:`rotate(${i?.5:0}turn)`}})))},zT=xN;var _N=({loading:e=!1})=>{let t=(0,Cr.useRef)(cn()),{draftUserMessage:o}=Pn(),{conversationMessages:n}=ie(),r=(0,Cr.useMemo)(()=>{if(!o)return"";let a=L_(o),s=a.indexOf(`:
"""
`);return s===-1?a:a.slice(0,s)},[o]),i=(0,Cr.useMemo)(()=>Uc(o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables),[o?.meta?.contexts,o?.meta?.MaxAIPromptActionConfig?.variables]);return Cr.default.createElement(Eu,{in:!!o},Cr.default.createElement(g,{direction:"row",gap:"8px",alignItems:"center",height:"auto",width:"100%",paddingBottom:"4px"},Cr.default.createElement(g,{direction:"row",flex:1,alignItems:"center",overflow:"hidden",gap:"8px"},Cr.default.createElement(T,{color:"text.primary",fontSize:"18px",fontWeight:600,lineHeight:"150%"},r),Cr.default.createElement(T,{overflow:"hidden",textOverflow:"ellipsis",color:a=>a.palette.mode==="dark"?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.38)",flex:1,fontSize:"14px",sx:{whiteSpace:"nowrap",userSelect:"none",cursor:"default"}},i?.text)),Cr.default.createElement(zT,{quoteText:i?.text,variables:i?.userVariables??[],container:t.current,title:r}),n.length&&Cr.default.createElement(d1,{loading:e})))},RT=_N;var ra=I(E()),VT=I(E());var CN=()=>{let{currentSelection:e}=Ui(),{draftUserMessage:t}=Pn(),{conversation:o,conversationId:n}=ie(),r=fe(n),i=(0,VT.useMemo)(()=>(e?.selectionElement?.editableElementSelectionText||e?.selectionElement?.selectionText||"").trim().replace(/\u200B/g,""),[e]),[a,s]=(0,ra.useState)(!1);return(0,ra.useEffect)(()=>{let l=!!(!i||r||o?.lastMessageId&&t);s(l)},[i,r,o?.lastMessageId,t]),{showDraftTextPanel:!a,draftText:i}},yN=()=>{let{showDraftTextPanel:e,draftText:t}=CN(),{conversationMessages:o}=ie();return o.length?null:ra.default.createElement(Eu,{in:e},ra.default.createElement(B,{sx:{display:"flex",flexDirection:"row",boxSizing:"border-box",padding:"8px",margin:"10px 0 0 0",borderRadius:"8px",alignItems:"center",gap:"8px",bgcolor:n=>n.palette.mode==="dark"?"rgba(59, 61, 62, 1)":"rgba(244, 244, 244, 1)",color:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)",width:"100%"}},ra.default.createElement(RC,{sx:{fontSize:"16px"}}),ra.default.createElement(T,{sx:{flex:1,whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"400",overflow:"hidden",textAlign:"left",cursor:"default",userSelect:"none"}},t)))},UT=yN;var No=I(E());var bN=e=>{let{anchorSize:t="10px",onStart:o,onResize:n,onStop:r,disabledResizeHeight:i}=e,a=(0,No.useRef)(),s=(0,No.useRef)({onStart:o,onResize:n,onStop:r});s.current.onStart=o,s.current.onResize=n,s.current.onStop=r;let l=(0,No.useRef)(1);function p(C,y){l.current=Hu(),a.current=y,document.body.style.cursor="se-resize",o?.(y),C.stopPropagation(),C.preventDefault()}(0,No.useEffect)(()=>{function C(b){a.current&&(s.current.onResize?.(b.movementX/l.current,b.movementY/l.current,a.current),b.stopPropagation())}function y(){a.current&&(s.current.onStop?.(),a.current=void 0,document.body.style.cursor="inherit")}return window.addEventListener("mousemove",C),window.addEventListener("mouseup",y),window.addEventListener("contextmenu",y),()=>{window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",y),window.removeEventListener("contextmenu",y)}},[]);let{top:c,bottom:u,left:m,right:d,topLeft:f,topRight:h,bottomLeft:_,bottomRight:x}=(0,No.useMemo)(()=>{let C={position:"absolute",height:t,width:t,background:"none",backgroundColor:"none",zIndex:1};return{top:{...C,cursor:"n-resize",width:"100%",top:0,left:0},bottom:{...C,cursor:"s-resize",width:"100%",bottom:0,left:0},left:{...C,cursor:"w-resize",height:"100%",top:0,left:0},right:{...C,cursor:"e-resize",height:"100%",top:0,right:0},topLeft:{...C,cursor:"nw-resize",top:0,left:0},topRight:{...C,cursor:"ne-resize",top:0,right:0},bottomLeft:{...C,cursor:"sw-resize",bottom:0,left:0},bottomRight:{...C,cursor:"se-resize",bottom:0,right:0}}},[t]);return No.default.createElement(No.default.Fragment,null,!i&&No.default.createElement(B,{sx:c,onMouseDown:C=>p(C,"top")}),!i&&No.default.createElement(B,{sx:u,onMouseDown:C=>p(C,"bottom")}),No.default.createElement(B,{sx:m,onMouseDown:C=>p(C,"left")}),No.default.createElement(B,{sx:d,onMouseDown:C=>p(C,"right")}),!i&&No.default.createElement(B,{sx:f,onMouseDown:C=>p(C,"top-left")}),!i&&No.default.createElement(B,{sx:h,onMouseDown:C=>p(C,"top-right")}),!i&&No.default.createElement(B,{sx:_,onMouseDown:C=>p(C,"bottom-left")}),!i&&No.default.createElement(B,{sx:x,onMouseDown:C=>p(C,"bottom-right")}))},WT=bN;var IN=!0,SN={x:0,y:0,top:0,left:0,right:0,bottom:0,width:0,height:0},GT=e=>{let{root:t}=e,{t:o}=k(["common","client"]),{loading:n,askAIWithContextWindow:r,inputValue:i,contextWindowList:a,isSettingCustomVariables:s,setIsSettingCustomVariables:l,setIsEditedCustomVariables:p}=dy(),{open:c}=Ou(),{mode:u,changeMode:m}=io(),{refetch:d}=Er(),{closeContextMenu:f,hideFloatingContextMenu:h}=vm(),{currentFloatingContextMenuDraft:_,activeResponseMessage:x}=Pn(),{floatingDropdownMenuPin:C}=Aa(),y=$t(qr),b=Sm(y),[v,S]=(0,le.useState)(!1),M=x||n,{defaultWidth:P,defaultHeight:O,updateLayout:L}=hy(y.rootRect),H=M&&O?Math.max(O,200):0,z=M?200:142,R=(0,le.useMemo)(()=>{let Y="bottom-start",$="bottom-start";if(y.rootRect&&P){let J=["bottom","top","left","right"];if(y.miniMenuPlacement)switch(y.miniMenuPlacement){case"bottom-end":{J=["bottom","right","top","left"];break}case"top-start":{J=["top","left","bottom","right"];break}case"top-end":{J=["top","right","bottom","left"];break}}let D=GC(y.rootRect,P,(H||z)+400,{offset:8,directions:J});D.y>y.rootRect.top?(Y="bottom-start",$="bottom-start"):D.y<y.rootRect.top&&(Y="top-start",$="top-start"),D.x>y.rootRect.left+300?Y="right-start":D.x<y.rootRect.left-300&&(Y="left-start")}return{inputPlacement:Y,contextMenuPlacement:$}},[y.rootRect,y.miniMenuPlacement,P]),V=(0,le.useRef)(null),F=(0,le.useRef)({x:0,y:0,dragged:!1}),q=(0,le.useRef)({dx:0,dy:0,width:0,height:0,minWidth:550,maxWidth:0,minHeight:200,maxHeight:620,resized:!1,resizeDir:"",startWidth:0,startHeight:0,startLeft:0,startRight:0,startTop:0,startBottom:0});q.current.width=P,q.current.height=H,q.current.minHeight=z,M||(q.current.height=0);let X=(0,le.useCallback)((Y,$,J)=>ol(Y,$,J,{animationFrame:!0}),[]),W=(0,le.useRef)(!1),{x:j,y:w,strategy:ne,refs:pe,context:A,update:U}=ba({open:y.open,strategy:"fixed",onOpenChange:async(Y,$,J)=>{if(!(Y||!y.open||W.current||v)&&!(!Y&&$?.target instanceof Element&&Y2()?.contains($.target))&&!J1("#MAX_AI_PRICING_MODAL")&&!(J!=="escape-key"&&C)&&(J==="outside-press"||J==="escape-key")){if(J1(`#${b_}`)?.getAttribute("data-status")==="open"){y_();return}if(J==="outside-press"){let K=cn();if(K){let Q=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});K.dispatchEvent(Q)}}if(c||n||s&&J==="outside-press")return;if(J==="escape-key"){h(!0);return}W.current=!0,f().catch(()=>{}).finally(()=>{W.current=!1});return}},placement:R.inputPlacement,middleware:YC(F,V,q),whileElementsMounted:X}),N=Gu(A),ce=ju(A,{capture:{escapeKey:!0,outsidePress:!0},outsidePressEvent:"pointerdown"}),{getFloatingProps:Z}=ml([ce,N]),re=le.default.useRef(!1),bt=(0,le.useRef)(1),be=Y=>{Y.preventDefault(),re.current=!0,bt.current=Hu()},{floatingPosition:Ce,startResize:we,handleResize:qe,stopResize:Ze}=gy({x:j,y:w,refs:pe,update:U,dragOffsetRef:F,floatingSizeOffsetRef:q,rootRect:y.rootRect}),{refreshChatAIModelSelector:Kt}=gl();(0,le.useEffect)(()=>{y.open?(Kt(),d()):(F.current={x:0,y:0,dragged:!1},q.current.dx=0,q.current.dy=0,q.current.resized=!1,q.current.resizeDir="",U(),m("list"))},[y.open,Kt]),(0,le.useEffect)(()=>{let Y=J=>{re.current&&(J.preventDefault(),re.current=!1)},$=J=>{if(!re.current)return;let D=J.movementX/bt.current,K=J.movementY/bt.current;F.current={x:F.current.x+D,y:F.current.y+K,dragged:!0},V.current&&(V.current.style.marginLeft?V.current.style.marginLeft="":V.current.style.marginLeft="0.5px"),U(),J.preventDefault()};return document.addEventListener("mousemove",$),document.addEventListener("mouseup",Y),()=>{document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",Y)}},[U,y.open]),(0,le.useEffect)(()=>{if(y.rootRect){let Y=jC(y.rootRect);if(!IN){document.querySelector("#rangeBorderBox")?.remove();let $=document.createElement("div");$.id="rangeBorderBox",Object.assign($.style,{position:"absolute",left:Y.left+"px",top:Y.top+window.scrollY+"px",width:Y.width+"px",height:Y.height+"px",border:"1px solid green",zIndex:"9999",pointerEvents:"none"}),document.body.appendChild($)}}},[y.rootRect]),(0,le.useEffect)(()=>{pe.setPositionReference({getBoundingClientRect(){return Ee(b.current.rootRect)||SN}})},[b]);let Fe=(0,le.useMemo)(()=>y.open?o(x?"client:floating_menu__input__placeholder__after_ai_response":"client:floating_menu__input__placeholder"):"",[o,y.open,x]);(0,le.useEffect)(()=>{},[P,H]),(0,le.useEffect)(()=>{M||(q.current.dx=0,q.current.dy=0,q.current.resized=!1,q.current.resizeDir=""),U()},[M]);let{draftUserMessage:pt}=Pn(),ct=vt("floatingMenuInputMediator"),kt=async()=>{await Qe({emitEvent:!0})&&await r()},[Ke,Dt]=(0,le.useState)(!0),ut=(0,le.useCallback)(()=>{Dt(!1),setTimeout(()=>{Dt(!0)},50)},[]);return le.default.createElement(Wu,{root:t},le.default.createElement("div",{ref:pe.setFloating,id:Ws,"data-testid":"maxai--floating-context-menu-reference-element","data-disabled-button-clicked":!0,onKeyUp:Y=>Y.stopPropagation(),onKeyDown:Y=>{Y.key!=="Escape"&&Y.stopPropagation()},style:{position:ne,zIndex:y.open?2147483601:-1,opacity:y.open?1:0,visibility:y.open?"visible":"hidden",...Ce,width:P,height:H},"aria-hidden":y.open?"false":"true",...Z()},M?le.default.createElement(WT,{onStart:we,onResize:qe,onStop:()=>{Ze(),L(M?{width:q.current.width,height:q.current.height}:{width:q.current.width})}}):null,le.default.createElement(uT,{customOpen:!0,defaultPlacement:R.contextMenuPlacement,needAutoUpdate:!0,hoverOpen:!1,menuList:a,isFirstLevelFlatten:!_||!!_&&i.length!==0,referenceElementOpen:y.open,referenceElementRef:V,referenceElement:le.default.createElement(B,{ref:V,component:"div",sx:{boxSizing:"border-box",background:Y=>Y.palette.background.paper,borderRadius:"8px",border:Y=>Y.palette.mode==="dark"?"1px solid rgba(255,255,255,0.08)":"1px solid rgba(0,0,0,0.08)",boxShadow:"0px 4px 6px -2px rgba(16, 24, 40, 0.03), 0px 12px 16px -4px rgba(16, 24, 40, 0.08)",overflow:"hidden",isolation:"isolate",display:"flex",flexDirection:"column",width:"100%",padding:"10px"},onKeyDown:Y=>{Y.stopPropagation()}},y.open&&le.default.createElement(le.default.Fragment,null,n||s?null:le.default.createElement(B,{id:"ONBOARDING_TOOLTIP__FLOATING_CONTEXT_MENU_INPUT_BOX__REFERENCE_ELEMENT",sx:{width:10,height:10,position:"absolute",left:0,bottom:"20px",pointerEvents:"none",zIndex:-1}})),le.default.createElement(B,{sx:{position:"absolute",width:"100%",left:0,top:0,cursor:"grab",height:"28px"},onMouseDown:be}),s?le.default.createElement(B,{sx:{flex:1}}):y.open&&le.default.createElement(le.default.Fragment,null,le.default.createElement(RT,{loading:n}),le.default.createElement(vT,{contextMenuDefaultHeight:H})),y.open&&le.default.createElement(le.default.Fragment,null,le.default.createElement(ST,{showModelSelector:y.showModelSelector,showUsageButton:!0,loading:n})),le.default.createElement(UT,null),y.open&&le.default.createElement(Pd,{showCloseButton:!1,onInputCustomVariable:({data:Y,variables:$})=>{let J=$?.some(D=>D.name?!1:Y[D.name]);p(D=>D||!!J)},onBeforeRunShortcuts:()=>l(!1),onClose:Y=>{l(!1)},onShow:()=>{l(!0)},modelKey:"FloatingContextMenu",autoFocusAfterBlur:!0}),(!s||n)&&le.default.createElement(g,{width:"100%",gap:.5,sx:{marginTop:"8px"}},le.default.createElement(g,{direction:"row",justifyContent:"flex-end",alignItems:"end",gap:1},le.default.createElement(g,{direction:"row",width:0,flex:1,alignItems:"center",spacing:1,justifyContent:"left",marginBottom:"4px",sx:{display:v?"none":"flex"}},n?le.default.createElement(le.default.Fragment,null,le.default.createElement(T,{fontSize:"16px",color:Y=>Y.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"},o(pt?"client:floating_menu__input__running_placeholder":"client:floating_menu__input__reading_placeholder")),le.default.createElement(Lt,{size:"16px",sx:{color:Y=>Y.palette.mode==="dark"?"rgba(255, 255, 255, 0.38)":"rgba(0, 0, 0, 0.38)"}})):le.default.createElement(le.default.Fragment,null,le.default.createElement(lT,{minLine:1,maxHeight:q.current.height?q.current.height/2:void 0,stopPropagation:!0,autoFocus:y.open,onKeydownCapture:Y=>y.open&&a.length?!1:Y.key==="ArrowUp"||Y.key==="ArrowDown"?(Y.stopPropagation(),!0):!1,placeholder:Fe,InputId:si,sx:{border:"none","& > div":{"& > div":{p:0},"& > textarea":{p:0},"& > .max-ai-user-input__expand":{"&:has(> div)":{pr:1}}},borderRadius:0,minHeight:s?0:"24px",height:s?"0!important":"unset",visibility:s?"hidden":"visible"},onEnter:async()=>{a.length>0&&u==="list"||(m("list"),await kt())},onControlledValueChange:(Y,$)=>{$===si&&Y.length<1&&ct.resetInputValue()}})),le.default.createElement(z0,null)),!n&&le.default.createElement(le.default.Fragment,null,!v&&le.default.createElement(le.default.Fragment,null,y.open&&le.default.createElement(F0,null),le.default.createElement(B0,null)),le.default.createElement(Gl,{value:{isVoiceInput:v,setIsVoiceInput:S,isUseInternalState:!1}},le.default.createElement(ql,{inputMediator:ct,onClick:kt,onSpeechToTextSuccess:Y=>{ct.updateInputValue(ct.getInputValue()+Y)},tooltipProps:{placement:"bottom"},disabled:i.length===0})))))),root:t})),a.length>0&&le.default.createElement(PT,{showStateTrigger:y.open&&a.length>0,onClose:()=>{ut()}}),le.default.createElement(MT,{showStateTrigger:y.open&&a.length>0&&a.some(Y=>Y.prompt_id===yl.REPLACE_SELECTION)}),!n&&!s?le.default.createElement(le.default.Fragment,null,le.default.createElement(wT,{showStateTrigger:y.open&&!x&&!s&&a.length>0&&a.some(Y=>Y.prompt_id==="30f27496-1faf-4a00-87cf-b53926d35bfd")&&(_===""||i.length>0)&&Ke})):null,n?null:le.default.createElement(le.default.Fragment,null,le.default.createElement(TT,{showStateTrigger:y.open&&!!x&&x.type==="ai"})))};var U0=I(E());var zo=I(E());var jT=I(E()),vN=e=>{let{sx:t,...o}=e;return jT.default.createElement(de,{sx:w_({transition:"all 0.15s",height:"32px",padding:"0px",minWidth:"initial",color:n=>n.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.6)","&:hover":{backgroundColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)",color:n=>n.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)"}},t),...o},e.children)},ns=vN;var ri=I(E());var V0=I(E());var TN=e=>{let{sx:t,...o}=e,{t:n}=k(["client","common"]),{hideMenu:r}=wl(),{updateAppSettings:i}=xy(),a=p=>{p.stopPropagation(),ya({key:"options",query:"?id=floating-image-mini-menu#/appearance"})},s=async p=>{p.stopPropagation();let c=await Op.getAppSettings();await Op.setAppSettings({floatingImageMiniMenu:{visibility:{...c.floatingImageMiniMenu.visibility,blacklist:[...c.floatingImageMiniMenu.visibility.blacklist,va()]}}}),i(),r()},l=async p=>{p.stopPropagation();let c=await Op.getAppSettings();await Op.setAppSettings({floatingImageMiniMenu:{visibility:{...c.floatingImageMiniMenu.visibility,isWhitelistMode:!0}}}),i(),r()};return V0.default.createElement(B,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:"0px",...t},...o},V0.default.createElement(Mm,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__this_site",hideThisSiteItemText:n("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardTitle:n("client:floating_menu__mini_menu__image__confirm_card__hide_this_site__title"),hideThisSiteConfirmCardOkText:n("client:floating_menu__mini_menu__image__close_item__hide_on_this_site"),hideThisSiteConfirmCardCancelText:n("common:cancel"),onHideThisSiteConfirmCardClickOk:s,onHideThisSiteConfirmCardClickCancel:()=>{},hideAllSitesItemDataButtonClickedName:"max_ai__floating_image_menu__hide_menu__all_sites",hideAllSitesItemText:n("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardTitle:n("client:floating_menu__mini_menu__image__confirm_card__hide_all_sites__title"),hideAllSitesConfirmCardOkText:n("client:floating_menu__mini_menu__image__close_item__hide_always"),hideAllSitesConfirmCardCancelText:n("common:cancel"),onHideAllSitesConfirmCardClickOk:l,onHideAllSitesConfirmCardClickCancel:()=>{},openSettingsItemTextI18nKey:"client:floating_menu__mini_menu__image__close_item__settings_tips",onClickSettings:a}))},qT=TN;var wN=()=>{let{floatingImageMiniMenuKey:e}=(0,ri.useContext)(Ma),{t}=k(["client"]),{hideMenu:o}=wl(),n=r=>{r.stopPropagation(),Im(e).disable=!0,o()};return ri.default.createElement(g,{sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},ri.default.createElement(xe,{placement:"top",title:t("client:floating_menu__mini_menu__image__close_item__hide_until_next_visit")},ri.default.createElement("span",null,ri.default.createElement(ns,{onClick:n,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:r=>r.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},ri.default.createElement(G,{size:18,icon:"Close"})))),ri.default.createElement(ns,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:r=>r.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_image_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},ri.default.createElement(G,{icon:"Power"}),ri.default.createElement(qT,{className:"maxai__floating_image_menu__close_menu",sx:{zIndex:"1",transform:"scale(0)",transformOrigin:"left top"}})))},KT=wN;var MN=zo.default.forwardRef(function({sx:t,className:o},n){let{t:r}=k(["client"]);return zo.default.createElement(B,{sx:{overflow:"hidden",transition:"width 0.2s",marginLeft:"0px!important",...t||{}},ref:n,className:o},zo.default.createElement(B,{sx:{height:"100%",fontSize:"12px",fontWeight:"initial",color:i=>i.palette.mode==="dark"?"#fff":"rgba(0, 0, 0, 0.87)",lineHeight:"16px",overflow:"hidden",marginLeft:"0px!important",whiteSpace:"nowrap"}},r("client:floating_menu__mini_menu__image__menu_item__chat_with_image")))}),C1=e=>{let{filterImage:t,dataTestId:o}=e,{floatingImageMiniMenuKey:n}=(0,zo.useContext)(Ma),r=$t(bm(n)),{showMenu:i,hideMenu:a}=wl(),s=(0,zo.useRef)(null),l=Im(n),{hover:p,onMouseEnter:c,onMouseLeave:u}=Tm(100);_y({filterImage:t}),(0,zo.useEffect)(()=>{p?(s.current&&clearTimeout(s.current),l.mouseInMenu=!0,i()):(l.mouseInMenu=!1,s.current=setTimeout(()=>{l.mouseInImage||a()},50))},[p]);let m=async()=>{a(),Ea()||Vi(),$u("ContextMenuChatWithImage",{image:l.currentHoverImage,imageSrc:l.currentHoverImageSrc})};return zo.default.createElement(g,{className:"MAX_AI_FLOATING_IMAGE_MINI_MENU","data-testid":o,onMouseEnter:c,onMouseLeave:u,alignItems:"center",justifyContent:"center",sx:{boxSizing:"border-box",zIndex:2147483601,display:r.show?"flex":"none",cursor:"pointer",position:"fixed",top:`calc(${r.position.top} + 15px)`,left:`calc(${r.position.left} + 15px)`,...p&&{".max_ai_floating_image_dot_button":{opacity:"0",transform:"scale(5)"},".max_ai_floating_image_text_button":{opacity:"1",transform:"scale(1)"}}}},zo.default.createElement(g,{sx:{transition:"all 0.15s",justifyContent:"center",alignItems:"center",width:"16px",height:"16px",boxSizing:"border-box"}},zo.default.createElement(B,{className:"max_ai_floating_image_dot_button",sx:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"rgba(144, 101, 176, 1)",border:"1px solid rgba(255, 255, 255, 0.08)",boxSizing:"border-box"}})),zo.default.createElement(g,{direction:"row",className:"max_ai_floating_image_text_button",sx:{opacity:"0",transform:"scale(0)",transformOrigin:"15px 15px",transition:"all 0.15s",position:"absolute",top:"0px",left:"0px",boxSizing:"border-box",alignItems:"center",padding:"2px",height:"36px",borderRadius:"18px",bgcolor:d=>d.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)"}},zo.default.createElement(ns,{onClick:()=>m(),sx:{borderRadius:"16px 4px 4px 16px",padding:"0px 8px",[`.${ua.startIcon}`]:{margin:"0px",marginRight:"8px"}},startIcon:zo.default.createElement(Ir,{sx:{boxSizing:"border-box",fontSize:"16px!important"}})},zo.default.createElement(MN,null)),zo.default.createElement(Ct,{orientation:"vertical",sx:{height:"18px",mx:"4px"}}),zo.default.createElement(KT,null)))};var AN=()=>U0.default.createElement(Ma.Provider,{value:{floatingImageMiniMenuKey:"ALL_IMAGE"}},U0.default.createElement(C1,{filterImage:e=>Tl.commonFirstEnterImage!==e})),$T=AN;var Bi=I(E());var ia=I(E());var Jc={sceneType:"FLOATING_IMAGE_MENU_BUTTON",id:"ONBOARDING_TOOLTIP__FLOATING_IMAGE_MENU_BUTTON",anchorElementSelectors:'[data-testid="maxai__floating_image_mini_menu__first_enter_image"]',CtaButtonClickedName:"Onboarding > ChatWithImage > Got it"},PN=e=>{let{showStateTrigger:t,onClosed:o,onOpened:n,...r}=e,{t:i}=k(),[a,s]=(0,ia.useState)(!1);return(0,ia.useEffect)(()=>{t?tr(Jc.sceneType).then(l=>{l||Ar(Jc.sceneType).then(()=>{s(!0),n?.()})}):s(!1)},[n,t]),ia.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:a,anchorElementSelectors:Jc.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":Jc.CtaButtonClickedName},id:Jc.id,footerLeft:ia.default.createElement(Em,null),onClose:o,...r},ia.default.createElement(g,{spacing:.5},ia.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},i("onboarding:onboarding_tooltip__FLOATING_IMAGE_MENU_BUTTON__text"))))},XT=PN;var kN=()=>{let[e,t]=(0,Bi.useState)(!1),o=$t(bm("ON_BOARDING"));(0,Bi.useEffect)(()=>{o.show&&t(!0)},[o.show]);let n=()=>{Tl.onboardingTooltipShowing=!1},r=()=>{Tl.onboardingTooltipShowing=!0};return Bi.default.createElement(Bi.default.Fragment,null,Bi.default.createElement(Ma.Provider,{value:{floatingImageMiniMenuKey:"ON_BOARDING"}},Bi.default.createElement(C1,{dataTestId:"maxai__floating_image_mini_menu__first_enter_image",filterImage:i=>Tl.commonFirstEnterImage===i})),o.show&&Bi.default.createElement(XT,{showStateTrigger:e,onClosed:n,onOpened:r}))},YT=kN;var lt=I(E());var Di=I(E());var eu={sceneType:"CONTEXT_MENU_CTA_MINI_ICON_BUTTON",id:"ONBOARDING_TOOLTIP__CONTEXT_MENU_CTA_MINI_ICON_BUTTON",anchorElementSelectors:"#max_ai__floating_context_menu__mini_hide_button",CtaButtonClickedName:"Onboarding > ContextMenu > MiniIconButton > Got it"},LN=e=>{let{showStateTrigger:t,...o}=e,{t:n}=k(),{chatBoxShortCutKey:r}=Up(),[i,a]=(0,Di.useState)(!1);(0,Di.useEffect)(()=>{t?tr(eu.sceneType).then(l=>{l||Ar(eu.sceneType).then(()=>{a(!0)})}):a(!1)},[t]);let s={bgcolor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.16) !important":"rgba(0, 0, 0, 0.08) !important",color:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.7) !important":"rgba(0, 0, 0, 0.7) !important"};return Di.default.createElement(Tt,{hideBackdrop:!0,sx:{visibility:"hidden"},placement:"bottom-start",fallbackPlacements:["top-start"],trigger:i,anchorElementSelectors:eu.anchorElementSelectors,CtaButtonProps:{"data-button-clicked-name":eu.CtaButtonClickedName},id:eu.id,footerLeft:Di.default.createElement(Em,null),...o},Di.default.createElement(g,{spacing:.5},Di.default.createElement(T,{fontSize:14,lineHeight:1.4,color:"text.primary",fontWeight:400,textAlign:"left"},n("client:floating_menu__button__cta__tooltip")),r&&Di.default.createElement(da,{sx:s},r)))},ZT=LN;var ON={"top-start":[-3,0],"top-end":[-3,0],"bottom-start":[-3,0],"bottom-end":[-3,0]},QT=e=>ON[e]||[0,0];var aa=I(E());var W0=I(E()),BN=({showDivider:e=!0,boxSx:t,dividerProps:o})=>{let{orientation:n="vertical"}=o||{};return e?W0.default.createElement(g,{flex:1,sx:{p:"7px 4px",...t}},W0.default.createElement(Ct,{orientation:n,...o})):null},tu=BN;var DN=e=>{let{placement:t,onClick:o,btnGroupSx:n}=e,{t:r}=k(["common","client","prompt"]),{contextMenuPath:i}=io(),{contextMenuSuggestions:a}=jr(i||"",3),s=a.sort((l,p)=>+!!p.prompt_icon-+!!l.prompt_icon);return aa.default.createElement(aa.default.Fragment,null,aa.default.createElement(g,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box","data-button-clicked-name":"max_ai__floating_context_menu__favorite_menu_group",sx:n},s?.map(l=>{let p=l.prompt_title,c=l.prompt_id.replace(Zo,""),u=`prompt:${c}`;r(u)!==c&&(p=r(u));let m=String(p[0]||"").toUpperCase();return aa.default.createElement(Al,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom"},title:p,key:l.prompt_id,sx:{minWidth:"unset",p:l.prompt_icon?"8px!important":"6px!important"},onMouseUp:d=>{d.stopPropagation(),d.preventDefault()},onMouseDown:d=>{d.stopPropagation(),d.preventDefault()},onClick:async d=>{d.stopPropagation(),d.preventDefault(),await Qe({emitEvent:!0})&&o?.(l)}},l.prompt_icon?aa.default.createElement(G,{icon:l.prompt_icon,sx:{fontSize:"18px",color:"primary.main"}}):aa.default.createElement(g,{className:"max-ai__click-menu-button--box__text-icon",alignItems:"center",justifyContent:"center",sx:{width:"16px",height:"16px",boxSizing:"border-box",borderRadius:"4px",bgcolor:d=>d.palette.mode==="dark"?"#4f4f4f":"#F5F6F7",color:d=>d.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}},aa.default.createElement(T,{component:"span",fontSize:"13px",color:"inherit"},m)))})),s?.length>0&&aa.default.createElement(tu,null))},JT=DN;var sa=I(E());var G0=I(E());var FN=e=>{let{parentX:t,parentY:o,sx:n,...r}=e,{t:i}=k(["common","client"]),{hideRangy:a}=Ui(),{updateButtonSettingsWithDomain:s,toggleButtonSettings:l}=gm(),p=d=>{d.stopPropagation(),ya({key:"options",query:"#/mini-menu"})},c=async()=>{await s("textSelectPopupButton")},u=async()=>{await l("textSelectPopupButton",!1)},m=t&&o&&t+WC+240>window.innerWidth;return G0.default.createElement(B,{sx:{marginLeft:"0px!important",color:"#fff",position:"absolute",top:"calc(100% - 6px)",left:m?"auto":0,right:m?0:"auto",zIndex:2147483611,...n},...r},G0.default.createElement(Mm,{sx:{marginTop:"10px"},hideThisSiteItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__this_site",hideThisSiteItemText:i("client:floating_menu__button__hide_menu__this_site"),hideThisSiteConfirmCardTitle:i("client:floating_menu__button__hide_menu__this_site__tooltip__title"),hideThisSiteConfirmCardOkText:i("client:floating_menu__button__hide_menu__this_site__tooltip__confirm"),hideThisSiteConfirmCardCancelText:i("common:cancel"),onHideThisSiteConfirmCardClickOk:c,onHideThisSiteConfirmCardClickCancel:()=>a(),hideAllSitesItemDataButtonClickedName:"max_ai__floating_context_menu__hide_menu__all_sites",hideAllSitesItemText:i("client:floating_menu__button__hide_menu__all_sites"),hideAllSitesConfirmCardTitle:i("client:floating_menu__button__hide_menu__all_sites__tooltip__title"),hideAllSitesConfirmCardOkText:i("client:floating_menu__button__hide_menu__all_sites__tooltip__confirm"),hideAllSitesConfirmCardCancelText:i("common:cancel"),onHideAllSitesConfirmCardClickOk:u,onHideAllSitesConfirmCardClickCancel:()=>a(),openSettingsItemTextI18nKey:"client:floating_menu__button__menu_settings",onClickSettings:p}))},ew=FN;var HN=({parentX:e,parentY:t})=>{let{t:o}=k(["client"]),n=bo(Cm),r=bo(qr),i=async()=>{r({open:!1,rootRect:null,showModelSelector:!1,miniMenuPlacement:null}),n(a=>({...a,closeBeforeRefresh:!0}))};return sa.default.createElement(g,{component:"div",sx:{flexDirection:"row",alignItems:"center","&:hover":{".maxai_close_button":{borderRadius:"6px"},".maxai_more_close_options":{margin:"0px",opacity:"1"}}}},sa.default.createElement(xe,{placement:"top",title:o("client:floating_menu__button__hide_menu__until_next_visit")},sa.default.createElement("span",null,sa.default.createElement(ns,{onClick:i,className:"maxai_close_button",sx:{width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff",zIndex:"1"}},sa.default.createElement(G,{size:18,icon:"Close"})))),sa.default.createElement(ns,{className:"maxai_more_close_options",sx:{marginLeft:"-32px",opacity:"0",width:"32px",fontSize:"16px",borderRadius:"4px 16px 16px 4px",backgroundColor:a=>a.palette.mode==="dark"?"transparent":"#fff","&:hover":{".maxai__floating_mini_menu__close_menu":{transform:"scale(1)"}}},disableRipple:!0},sa.default.createElement(G,{icon:"Power"}),sa.default.createElement(ew,{parentX:e,parentY:t,className:"maxai__floating_mini_menu__close_menu",sx:{transform:"scale(0)",transformOrigin:"left top"}})))},tw=HN;var y1=I(E());var NN=e=>{let{placement:t,TooltipProps:o,selectionText:n,btnGroupSx:r}=e,{t:i}=k(["common","client"]),{hideRangy:a}=Ui();return y1.default.createElement(g,{direction:"row",alignItems:"center",className:"max-ai__click-menu-button--box",sx:r},y1.default.createElement(Al,{TooltipProps:{floatingMenuTooltip:!0,placement:t||"bottom",...o},id:"max_ai__floating_context_menu__ai_search_button",title:i("client:floating_menu__mini_menu__ai_search__button__tooltip"),sx:{minWidth:"unset",p:"8px!important"},onMouseUp:s=>{s.stopPropagation(),s.preventDefault()},onMouseDown:s=>{s.stopPropagation(),s.preventDefault()},onClick:async s=>{if(s.stopPropagation(),s.preventDefault(),!await Qe({emitEvent:!0}))return;let l=window.getSelection()?.toString();a(),Vi();for(let p=0;p<30&&(await Sx(200),!Ea());p++);(l||n)&&$u("ContextMenuQuickSearchSelectedText",{question:l||n})}},y1.default.createElement(G,{icon:"Search",sx:{fontSize:"18px",color:s=>s.palette.mode==="dark"?"rgba(255,255,255,.87)":"rgba(0,0,0,.6)"}})))},ow=NN;var j0={div:{display:"flex"},position:"relative",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"transparent","&:hover":{"&:has(button)&::after":{display:"none"}},"& button":{minWidth:"unset",padding:"7px 8px!important",boxSizing:"border-box",borderRadius:"6px","&:hover":{bgcolor:e=>e.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.06)"},"&:has(.max-ai__click-menu-button--box__text-icon)":{height:"32px",width:"34px"}}},zN=()=>{let{t:e}=k(["common","client"]),{tempSelection:t,lastMousePosition:o,show:n,hideRangy:r}=Ui(),{chatBoxShortCutKey:i}=Up(),{buttonSettings:a}=gm(),s=(0,lt.useMemo)(()=>a?.textSelectPopupButton.visibility?a2(a.textSelectPopupButton.visibility):!0,[a?.textSelectPopupButton.visibility]),l=bo(cy),{conversationId:p}=ie(),c=fe(p),u=bo(ym),{closeBeforeRefresh:m}=$t(Cm),{showFloatingContextMenu:d}=Aa(),[f,h]=li(qr),_=(0,lt.useMemo)(()=>n&&s&&!m&&!f.open,[n,s,m,f.open]),{hover:x,onMouseEnter:C,onMouseLeave:y}=Tm(100);(0,lt.useEffect)(()=>{y()},[s,y]),(0,lt.useEffect)(()=>{_||y()},[_,y]);let{scrollState:b,inParentScrollView:v}=V2(t?.activeElement??null,t,-1),S=N=>({name:"miniMiniMiddleware",fn:ce=>{let{rects:Z}=ce,re=Z.reference,be=[{placement:"top-start",x:re.x,y:re.y},{placement:"top-end",x:re.x+re.width,y:re.y},{placement:"bottom-start",x:re.x,y:re.y+re.height},{placement:"bottom-end",x:re.x+re.width,y:re.y+re.height}].filter(({x:ut,y:Y})=>!(ut>window.innerWidth+window.scrollX||ut<0||Y>window.innerHeight+window.scrollY||Y<0)).map(ut=>({...ut,distance:Math.pow(ut.x-N.x,2)+Math.pow(ut.y-N.y,2)})),Ce=M_(be,ut=>ut.distance);if(!Ce)return{x:re.x-dn,y:re.y+re.height};let{placement:we,x:qe,y:Ze}=Ce,Kt=qe-dn<0,Fe=qe+dn>window.innerWidth+window.scrollX,pt=Ze-dn<0,ct=Ze+dn>window.innerHeight+window.scrollY,kt=()=>{let ut={"top-start":{x:Kt?qe+12:qe-dn*.5,y:pt?Ze+12:Ze-dn*.5},"top-end":{x:Fe?qe-dn:qe,y:pt?Ze+12:Ze-dn*.5},"bottom-start":{x:Kt?qe+12:qe-dn*.5,y:ct?Ze-dn:Ze},"bottom-end":{x:Fe?qe-dn:qe,y:ct?Ze-dn:Ze}};return ut[we]||ut["bottom-start"]},{x:Ke,y:Dt}=kt();return{x:Ke,y:Dt,reset:{placement:we}}}}),{x:M,y:P,strategy:O,refs:L,placement:H}=ba({placement:"bottom-start",middleware:o?[S(o)]:[]});(0,lt.useEffect)(()=>{_&&h(N=>({...N,miniMenuPlacement:H}))},[H,_]);let z=(0,lt.useRef)(null);(0,lt.useEffect)(()=>{if(!t?.selectionRect||!_){z.current?.remove(),z.current=null;return}let N=qC(t.selectionRect);Hi||(z.current||(z.current=document.createElement("div"),z.current.style.position="absolute",z.current.style.zIndex="9999",z.current.style.pointerEvents="none",document.body.appendChild(z.current)),z.current.style.display=v?"block":"none",z.current.style.left=N.left+b.x+"px",z.current.style.top=N.top+window.scrollY+b.y+"px",z.current.style.width=N.width+"px",z.current.style.height=N.height+"px",z.current.style.border="2px solid red",z.current.style.zIndex="9999",z.current.style.pointerEvents="none"),L.setPositionReference({getBoundingClientRect(){return{...N,x:N.left,y:N.top}}})},[_,t,b,v]);let R=()=>{if(L.floating.current){if(getComputedStyle(L.floating.current).opacity==="0")return;r(),fy()}};(0,lt.useEffect)(()=>{let N=ce=>{ce.key==="Escape"&&R()};return document.addEventListener("keydown",N,!0),()=>{document.removeEventListener("keydown",N,!0)}},[]),(0,lt.useEffect)(()=>{c&&setTimeout(()=>{R()},1e3)},[c]),(0,lt.useEffect)(()=>{let N=()=>{y()};return window.addEventListener("blur",N),window.removeEventListener("blur",N)},[]);let V=N=>({popper:{modifiers:[{name:"offset",options:{offset:({placement:Z})=>QT(Z)}},{name:"flip",enabled:!0,options:{fallbackPlacements:N?["top","bottom-start","bottom"]:["top","bottom","bottom-start"]}}]}}),{contextMenuPath:F}=io(),{contextMenuSuggestions:q}=jr(F||"",3),X=4*dn+2*ph,W=X+q.length*dn+ph,j=M+X>window.innerWidth+window.scrollX,w=M+W>window.innerWidth+window.scrollX,ne=(0,lt.useRef)(null),pe=M+b.x,A=P+b.y,{open:U}=Ou();return lt.default.createElement(B,{component:"div",ref:N=>{ne.current=N,L.setFloating(N)},className:`max-ai__click-context-menu ${_?"open":"close"}`,sx:{zIndex:_?2147483600:-1,position:O,top:A||0,left:pe||0,cursor:"pointer"}},lt.default.createElement(B,{onMouseEnter:C,onMouseLeave:()=>{U||y()},sx:{position:"relative",overflow:"visible","&:hover":{".mini-icon-button":{visibility:"hidden",userSelect:"none",zIndex:-1}}}},_&&x&&lt.default.createElement(g,{className:"max_ai_floating_mini_menu_content",direction:"row",alignItems:"center",sx:{display:"flex",transformOrigin:"15px 15px",borderRadius:"18px",position:"absolute",left:0,top:0,margin:"-8px",boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.12), 0px 0px 1px 0px rgba(0, 0, 0, 0.08)",bgcolor:N=>N.palette.mode==="dark"?"rgba(44,44,44,0.95)":"#fff",backdropFilter:"blur(4px)",alignItems:"stretch",p:"2px"}},lt.default.createElement(B,{component:"div",sx:{...j0,"&:first-of-type":{"& button":{borderRadius:j?"16px":"16px 4px 4px 16px"}}}},lt.default.createElement(Al,{TooltipProps:{floatingMenuTooltip:!0,placement:"top-start",description:i,sx:{maxWidth:340},slotProps:V(!0)},title:e("client:floating_menu__button__cta__tooltip"),className:"usechatgpt-ai__context-menu--handle-button",id:"max_ai__floating_context_menu__cta_button","data-testid":"max_ai__floating_context_menu__cta_button",size:"small",variant:"text",onMouseUp:N=>{N.stopPropagation(),N.preventDefault()},onMouseDown:N=>{N.stopPropagation(),N.preventDefault()},onClick:N=>{N.stopPropagation(),N.preventDefault();let ce=window.getSelection()?.rangeCount;if(ce&&ce>0){let Z=window.getSelection()?.getRangeAt(0)?.cloneRange();u({range:Z||null,selectionText:window?.getSelection()?.toString()||""})}t&&d()}},lt.default.createElement(Ir,{sx:{fontSize:"18px"}}))),!j&&lt.default.createElement(lt.default.Fragment,null,lt.default.createElement(tu,null),!w&&lt.default.createElement(JT,{btnGroupSx:j0,placement:"top",onClick:N=>{l(ce=>({...ce,selectedContextMenuId:N.prompt_id})),t&&d({openAutoExecute:!0})}}),lt.default.createElement(ow,{btnGroupSx:j0,placement:"top",selectionText:t?.selectionText,TooltipProps:{slotProps:V(!1)}}),lt.default.createElement(tu,null),lt.default.createElement(tw,{parentX:M??0,parentY:P??0}))),lt.default.createElement(g,{className:"mini-icon-button",sx:{top:2,left:2,position:"absolute",width:"16px",height:"16px",visibility:x?"hidden":"inherit",opacity:_&&v?1:0,transition:_?"opacity .25s":"none"},alignItems:"center",justifyContent:"center",id:"max_ai__floating_context_menu__mini_hide_button"},lt.default.createElement(B,{sx:{borderRadius:"50%",height:"8px",width:"8px",backgroundColor:"rgba(144, 101, 176, 1)"}}))),lt.default.createElement(ZT,{showStateTrigger:_}))},nw=zN;var Fi=I(E()),aw=I(Gs());var b1=I(E()),q0=(0,b1.createContext)({caret:null,selection:null,focus:!1}),rw=()=>(0,b1.useContext)(q0);var rn=I(E());var I1=class{constructor(){this._events=new Map}on(t,o){this._events.has(t)||this._events.set(t,[]),this._events.get(t).push(o)}off(t,o){let n=this._events.get(t);n&&n.length&&this._events.set(t,n.filter(r=>r!==o))}emit(t,...o){let n=this._events.get(t);n&&n.length&&n.forEach(r=>{r(...o)})}addListener(t,o){this.on(t,o)}removeListener(t,o){this.off(t,o)}removeAllListeners(t){t?this._events.delete(t):this._events.clear()}};var Rr=new Bu("ContextMenu/GoogleDocHelper");var S1=class extends I1{constructor(){super();this.disabled=!1;this.editable=!0;this.initialized=!1;this.lastCaret=null;this.lastSelection=null;this.observer=null;this.debounceCaretOrSelectionChange=Tn(()=>{this.checkCaretChange(),this.checkSelectionChange()},20);this._onScroll=o=>{Rr.info("onScroll"),this.emit("scroll",o)};this._onMouseUp=o=>{Rr.info("onMouseUp"),o.MAX_AI_IGNORE=!0,this.emit("mouseup",o)};this.onKeyUp=o=>{Rr.info("onKeyUp"),o.MAX_AI_IGNORE=!0,this.emit("keyup",o)};this._onFocus=o=>{Rr.info("onFocus"),this.emit("focus",o)};this._onBlur=o=>{Rr.info("onBlur"),this.emit("blur",o)};this.disabled=!location.href.startsWith("https://docs.google.com/document"),this.editable=!!document.querySelector("#docs-insert-menu")}init(){this.disabled||this.initialized||(this.initElement(),this.initListener())}initElement(){this.editorElement=document.querySelector("div.kix-appview-editor"),this.scrollElement=document.querySelector("div.kix-scrollareadocumentplugin"),this.iframeElement=document.querySelector("iframe.docs-texteventtarget-iframe"),this.inputElement=this.iframeElement?.contentDocument?.querySelector('div[contenteditable="true"]'),this.caretElement=document.querySelector("#kix-current-user-cursor-caret")}initListener(){let o=document.querySelector("div.kix-cursor");this.observer=new MutationObserver(n=>{n.some(r=>r.target.classList?.contains("kix-cursor"))&&(Rr.info("\u5149\u6807\u79FB\u52A8"),this.debounceCaretOrSelectionChange())}),o&&this.observer.observe(o,{attributes:!0,attributeFilter:["style"],childList:!1,characterData:!1,subtree:!1}),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.addEventListener("mouseup",this._onMouseUp),this.inputElement?.addEventListener("keyup",this.onKeyUp),this.inputElement?.addEventListener("focus",this._onFocus),this.inputElement?.addEventListener("blur",this._onBlur)}destroy(){this.initialized=!1,this.observer?.disconnect(),this.editorElement?.addEventListener("scroll",this._onScroll),this.editorElement?.removeEventListener("mouseup",this._onMouseUp),this.inputElement?.removeEventListener("keyup",this.onKeyUp),this.inputElement?.removeEventListener("focus",this._onFocus),this.inputElement?.removeEventListener("blur",this._onBlur),this.removeAllListeners()}isSelectionChange(o,n){return!(o===n||o&&n&&o.layouts.length===n.layouts.length&&o.layouts.every((r,i)=>!ch(r,n.layouts[i])))}isCaretChange(o,n){if(o===n)return!1;if(!(o&&n&&!ch(o.layout,n.layout)))return!0}isFocus(){return document.activeElement===this.iframeElement}checkSelectionChange(){let o=this.getCurrentSelection();this.isSelectionChange(o,this.lastSelection)&&(this.lastSelection=o,this.emit("selection-change",this.lastSelection))}checkCaretChange(){let o=this.getCurrentCaret();this.isCaretChange(o,this.lastCaret)&&(this.lastCaret=o,this.emit("caret-change",this.lastCaret))}calculateRelativeLayout(o){return this.scrollElement?XC(this.scrollElement?.getBoundingClientRect(),o):KC}replaceSelection(o){Rr.info(o);let n=new DataTransfer;n.setData("text/plain",o),this.inputElement?.focus(),this.inputElement?.dispatchEvent(new ClipboardEvent("paste",{clipboardData:n,bubbles:!0,cancelable:!0}))}insertBelowSelection(o){if(Rr.info(o),this.inputElement?.focus(),this.lastSelection){let n={code:"ArrowRight",key:"ArrowRight",keyCode:39,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",n))}this.replaceSelection(`
${o}`)}insertAboveSelection(o){if(Rr.info(o),this.inputElement?.focus(),this.lastSelection){let n={charCode:0,code:"ArrowLeft",key:"ArrowLeft",keyCode:37,bubbles:!0,repeat:!1};this.inputElement?.dispatchEvent(new KeyboardEvent("keydown",n))}this.replaceSelection(`${o}
`)}copySelection(o=!1){Rr.info(o),this.inputElement?.focus(),o?this.iframeElement?.contentDocument?.execCommand("copy"):this.inputElement?.dispatchEvent(new ClipboardEvent("copy",{bubbles:!0,cancelable:!0}));let n=this.inputElement?.innerText||"";return n.endsWith(`
`)?n.slice(0,-1):n}selectContent(o){if(!this.editorElement||!this.inputElement)return;let n=o<0?"ArrowLeft":"ArrowRight",r=o<0?37:39;this.inputElement.focus();for(let i=0;i<Math.abs(o);i++)this.inputElement.dispatchEvent(new KeyboardEvent("keydown",{charCode:0,code:n,key:n,keyCode:r,bubbles:!0,repeat:!1,shiftKey:!0}))}getCaretBeforeContent(o){if(!this.editorElement||!this.inputElement)return"";let n=o.rect.left+o.rect.width/2,r=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).some(a=>{let s="",l=null;return this.getTextElements(a).some(p=>{let c=this.parseTextElement(p);if(c.rect.bottom<r||c.rect.top<r&&c.rect.right<n)l&&c.rect.top>=l.rect.bottom?s+=`
${c.content}`:s+=c.content,l=c;else if(Vp(n,r,[c.rect])){let u=this.getCaretOffset(c,o.rect);if(u>0){let m=c.content.slice(0,u);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s),a.getBoundingClientRect().bottom>r}),i}getCaretAfterContent(o){if(!this.editorElement||!this.inputElement)return"";let n=o.rect.left+o.rect.width/2,r=o.rect.top+o.rect.height/2,i="";return this.getParagraphElements().sort((a,s)=>a.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom).filter(a=>a.getBoundingClientRect().bottom>r).forEach(a=>{let s="",l=null;this.getTextElements(a).forEach(p=>{let c=this.parseTextElement(p);if(c.rect.top>r||c.rect.bottom>r&&c.rect.left>n)l&&c.rect.top>=l.rect.bottom?s+=`
${c.content}`:s+=c.content,l=c;else if(Vp(n,r,[c.rect])){let u=this.getCaretOffset(c,o.rect);if(u>0){let m=c.content.slice(u);s+=m}return!0}}),s&&(i?i+=`

${s}`:i=s)}),i}async selectSelection(o){if(!this.editorElement||!this.scrollElement)return;let{layouts:n}=o,r=n[0],i=n[n.length-1],a=this.scrollElement.getBoundingClientRect(),s={bubbles:!0,clientX:a.left+r.left,clientY:a.top+r.top+r.height/2},l={bubbles:!0,clientX:a.left+i.right,clientY:a.top+i.top+i.height/2},p=Math.max(r.bottom,i.bottom),c=Math.max(r.top,i.top);if(this.editorElement.scrollTop+this.editorElement.offsetHeight<p)return this.editorElement.scrollTo({top:c,behavior:"auto"}),await new Promise(m=>setTimeout(m,50)),this.selectSelection(o);[new MouseEvent("click",s),new MouseEvent("mousedown",s),new MouseEvent("mousemove",l),new MouseEvent("mouseup",l)].forEach(m=>this.editorElement?.dispatchEvent(m)),await new Promise(m=>setTimeout(m,50)),this.inputElement?.dispatchEvent(new KeyboardEvent("keyup",{shiftKey:!0,key:"Shift",code:"ShiftLeft"}))}getCurrentSelection(){if(!this.editorElement)return null;let o=[],n=[],r=this.getSelectionElements();if(r.forEach(s=>{let l=s.getBoundingClientRect().toJSON();o.push(this.calculateRelativeLayout(l)),n.push(l)}),!r.length)return null;let i=this.getParagraphElements().filter(s=>n.some(l=>$C(l,s.getBoundingClientRect()))).map(s=>this.parseParagraphElement(s)),a=this.copySelection();return Rr.info({paragraphs:i,rects:n,layouts:o,content:a}),{elements:r,rects:n,paragraphs:i,layouts:o,content:a}}getCurrentCaret(){if(!this.editorElement||!this.caretElement)return null;let o=this.caretElement,n=this.caretElement.getBoundingClientRect(),r=this.calculateRelativeLayout(n);return Rr.info({element:o,rect:n,layout:r}),{element:o,rect:n,layout:r}}getCaretOffset(o,n){let{left:r,top:i,width:a,height:s}=n,l=r+a/2,p=i+s/2;if(l<o.rect.left||p<o.rect.top)return 0;if(l>o.rect.right||p>o.rect.bottom)return o.content.length;let{element:c,content:u}=o,m=document.createTextNode(u),d=this.createTextOverlay(c,m);if(!d)return 0;let{width:f,left:h}=d.getBoundingClientRect(),_=document.createRange(),x=m.nodeValue?.length||0,C=f/x,y={},b=Math.floor((l-h)/C);for(;b<=x;){_.setStart(m,0),_.setEnd(m,b);let v=_.getClientRects()[0].toJSON(),S=y[b-1],M=S?S.right+(v.right-S.right)/2:v.left+v.width;if(l<M)if(S){b=Math.max(b-1,0);break}else{b--;continue}y[b]=v,b++}return d.remove(),b}parseTextElement(o){let n=o.getAttribute("aria-label")||"",r=o.getAttribute("data-font-css")||"",[i,a,s]=r.split(" "),l=o.getBoundingClientRect().toJSON(),p=this.calculateRelativeLayout(l);return{element:o,content:n,rect:l,layout:p,style:{top:p.top,left:p.left,width:p.width,height:p.height,fontWeight:i,fontSize:a,fontFamily:s?.replaceAll('"',"")}}}parseParagraphElement(o){let n=o.getBoundingClientRect().toJSON(),r=this.calculateRelativeLayout(n),i=this.getTextElements(o).map(a=>this.parseTextElement(a));return{element:o,rect:n,layout:r,texts:i,style:{top:r.top,left:r.left,width:r.width,height:r.height}}}getSelectionElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll(".kix-canvas-tile-selection rect")).filter(o=>o.parentElement?.tagName!=="clipPath"&&["rgba(118,167,250,0.5)","rgba(0,0,0,0.15)"].includes(o.getAttribute("fill")||"")):[]}getParagraphElements(){return this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"]')):[]}getTextElements(o){return o?Array.from(o.querySelectorAll("rect")).filter(n=>n.parentElement?.tagName!=="clipPath"):this.editorElement?Array.from(this.editorElement.querySelectorAll('canvas ~ .kix-canvas-tile-content:not(.kix-canvas-tile-selection) g[role="paragraph"] rect')).filter(n=>n.parentElement?.tagName!=="clipPath"):[]}getTextElementFromPoint(o,n){let r=this.getParagraphElements().find(i=>Vp(o,n,[i.getBoundingClientRect()]));return r?this.getTextElements(r).find(i=>Vp(o,n,[i.getBoundingClientRect()])):null}getElementFromPoint(o,n){this.styleElement||(this.styleElement=document.createElement("style"),this.styleElement.id="enable-pointer-events-on-rect",this.styleElement.textContent=[".kix-canvas-tile-content{pointer-events:none!important;}","#kix-current-user-cursor-caret{pointer-events:none!important;}",".kix-canvas-tile-content svg>g>rect{pointer-events:all!important; stroke-width:7px !important;}"].join(`
`),(document.head||document.documentElement).appendChild(this.styleElement)),this.styleElement.disabled=!1;let r=document.elementFromPoint(o,n);return this.styleElement.disabled=!0,r}createTextOverlay(o,n){if(!o||o.tagName!=="rect")return null;let r=document.createElementNS("http://www.w3.org/2000/svg","text"),i=o.getAttribute("transform")||"",a=o.getAttribute("data-font-css")||"";r.setAttribute("x",o.getAttribute("x")||""),r.setAttribute("y",o.getAttribute("y")||""),r.appendChild(n),r.style.setProperty("all","initial","important"),r.style.setProperty("transform",i,"important"),r.style.setProperty("font",a,"important"),r.style.setProperty("text-anchor","start","important"),o.parentNode?.appendChild(r);let s=o.getBoundingClientRect(),l=r.getBoundingClientRect(),p=(s.top-l.top+(s.bottom-l.bottom))*.5;return r.style.setProperty("transform",`translate(0px,${p}px) ${i}`,"important"),r}};var v1=Xo(),VN=()=>{let{control:e,focus:t,caret:o,selection:n}=rw(),r=$t(vl),i=bo(qr),[a,s]=li(sy),l=bo(ym),p=(0,rn.useRef)({}),c=(0,rn.useRef)(null),u=(0,rn.useRef)(a);u.current=a;let m=(0,rn.useRef)(n);m.current=n;let d=(0,rn.useCallback)(()=>uh(Object.values(p.current).filter(Boolean).map(C=>C.getBoundingClientRect().toJSON())),[]),f=(0,rn.useCallback)(()=>c.current?.getBoundingClientRect().toJSON(),[]),h=(0,rn.useCallback)((C,y,b=y,v="")=>{window.postMessage({id:R1,type:"iframeSelection",data:{virtual:!0,iframeId:v1,tagName:"",id:v1,className:"",windowRect:document.body.getBoundingClientRect().toJSON(),targetRect:C,selectionRect:C,iframeSelectionRect:C,iframePosition:[0,0],selectionText:y,selectionHTML:y,editableElementSelectionText:b,editableElementSelectionHTML:b,eventType:"keyup",isEmbedPage:!1,isEditableElement:!!e?.editable,caretOffset:1,startMarkerId:"",endMarkerId:"",relatedContent:v}},"*")},[]);(0,rn.useEffect)(()=>{if(!r){let C=[];return l(y=>(y.range&&C.push(setTimeout(()=>{let b=new KeyboardEvent("keyup",{key:" ",code:"Space",bubbles:!0,cancelable:!0});b.MAX_AI_IGNORE=!0,document.body.dispatchEvent(b)},1)),y)),e?.inputElement?.focus(),()=>{C.forEach(y=>clearTimeout(y))}}},[r]),(0,rn.useEffect)(()=>{if(!e)return;let C=Tn(()=>{if((u.current.currentSelection?.selectionElement||u.current.tempSelection?.selectionElement)?.id!==v1)return;let b=m.current?.content?d():f();i(v=>({...v,rootRect:b})),s(v=>({...v,tempSelection:v.tempSelection?{...v.tempSelection,selectionRect:b}:v.tempSelection}))},200);return e.addListener("scroll",C),()=>{e.removeListener("scroll",C),C.cancel()}},[e]),(0,rn.useEffect)(()=>{if(!(!t||!e)){if(n&&n.content){let C="",y=n.rects[0],b=n.rects[n.rects.length-1],v=2e3;if(y&&b&&n.content.length<=v*.75){let S={element:null,rect:{...y,width:1,right:y.left+1},layout:{...y,width:1,right:y.left+1}},M={element:null,rect:{...b,width:1,left:b.right-1},layout:{...b,width:1,left:b.right-1}},P=e.getCaretBeforeContent(S),O=e.getCaretAfterContent(M),L=Math.ceil((v-n.content.length)/2),H=P.slice(-L),z=v-L,R=O.slice(0,z);C=`${H}${n.content}${R}`.trim()}h(uh(n.rects),n.content,n.content,C);return}if(o&&t&&e?.editable){h(o.rect,e?.getCaretBeforeContent(o)||"","");return}u.current.show&&(e?.editable||h(d(),"",""),s({show:!1,tempSelection:null,currentSelection:null,lastCursorPosition:null}))}},[n,o,t,e]),bl(async(C,y,b)=>{if(C!=="Client_listenUpdateIframeInput"||y.id!==v1)return;let{type:v,value:S}=y;switch(v){case"INSERT_BELOW":e?.insertBelowSelection(S);break;case"INSERT":e?.replaceSelection(S);break;case"INSERT_ABOVE":e?.insertAboveSelection(S);break;case"REPLACE_SELECTION":e?.replaceSelection(S);break}});let _=Hi?0:1,x=Hi?-1:9999;return rn.default.createElement("div",{style:{opacity:_}},n?.layouts.map((C,y)=>rn.default.createElement("div",{ref:b=>{p.current[y]=b},key:y,style:{position:"absolute",border:Hi?void 0:"1px solid red",opacity:_,zIndex:x,...C}})),o&&rn.default.createElement("div",{ref:c,style:{position:"absolute",border:Hi?void 0:"1px solid blue",opacity:_,zIndex:x,...o.layout}}))},iw=VN;var UN=()=>{let e=(0,Fi.useMemo)(()=>new S1,[]),[t,o]=(0,Fi.useState)(e.lastCaret),[n,r]=(0,Fi.useState)(e.lastSelection),[i,a]=(0,Fi.useState)(!1);return wn(()=>{if(e.init(),e.disabled)return;let s=u=>{r(u)},l=u=>{o(u)},p=()=>{a(!0)},c=()=>{a(!1)};return e.addListener("selection-change",s),e.addListener("caret-change",l),e.addListener("focus",p),e.addListener("blur",c),e.isFocus()&&(e.checkSelectionChange(),e.checkCaretChange(),a(!0)),()=>{e.removeListener("selection-change",s),e.removeListener("caret-change",l),e.removeListener("focus",p),e.removeListener("blur",c),e.destroy()}}),!e||!e.scrollElement||e.disabled?null:Fi.default.createElement(q0.Provider,{value:{control:e,caret:t,selection:n,focus:i}},(0,aw.createPortal)(Fi.default.createElement(iw,null),e.scrollElement))},sw=Fi.default.memo(UN);var yo=I(E());var WN=e=>{let{...t}=e,{onResetConversation:o,onCreateConversation:n,onUpdateConversation:r,onSwitchConversation:i,onStopShortcutsActions:a,onRunShortcutsActions:s,onAskAIQuestion:l}=t,p=he(_=>_.setOnCreateConversation),c=he(_=>_.setOnUpdateConversation),u=he(_=>_.setOnSwitchConversation),m=he(_=>_.setOnResetConversation),d=he(_=>_.setOnAskAIQuestion),f=he(_=>_.setOnRunShortcutsActions),h=he(_=>_.setOnStopShortcutsActions);return(0,yo.useEffect)(()=>{n&&p(n)},[n]),(0,yo.useEffect)(()=>{r&&c(r)},[r]),(0,yo.useEffect)(()=>{i&&u(i)},[i]),(0,yo.useEffect)(()=>{o&&m(o)},[o]),(0,yo.useEffect)(()=>{l&&d(l)},[l]),(0,yo.useEffect)(()=>{s&&f(s)},[s]),(0,yo.useEffect)(()=>{a&&h(a)},[a]),GN(),yo.default.createElement(yo.default.Fragment,null)},lw=new Map,GN=()=>{let e=he(h=>h.conversationIds),{getConversation:t}=ot(),{addMessagesToPagination:o,syncLocalMessages:n,updateMessagesToPagination:r,removeMessagesToPagination:i}=yi(),[a,s]=(0,yo.useState)(e),{paywallShowDebounce:l}=cl();(0,yo.useEffect)(()=>{s(h=>r2(h.concat(e)))},[e]);let p=(0,yo.useRef)(null),c=B1(({set:h,snapshot:_})=>async(x,C)=>{p.current&&(clearTimeout(p.current),p.current=null);let y=await _.getPromise(rh(x));h(rh(x),C===null?null:Ro([y,C]))}),u=B1(({set:h})=>(_,x)=>{h(om(_),x)});(0,yo.useEffect)(()=>{a.length>0&&a.map(h=>{t(h)})},[a]);let{debounceRefreshModelUsage:m}=di();(0,yo.useEffect)(()=>{a.forEach(h=>{if(lw.has(h))return;let _=Gr.getShortcutsEngine(h),x=async(C,y)=>{if(C==="shortcutsEngineStatus"&&((y.shortcutsEngine.status==="complete"||y.shortcutsEngine.status==="stop")&&(c(h,null),t(h)),u(h,y.shortcutsEngine.status)),C==="actionCustomEvent"&&y.actionCustomEventName==="updateWritingMessage"){let b=y.actionCustomEventData;b?c(h,{...b,conversationId:h}):p.current=setTimeout(()=>{c(h,null)},1e3)}if(C==="shortcutsExternalEngine"){if(y.shortcutsExternalEngineType==="shortcutsExternalEngineChatConversationService"){let{functionName:b,params:v}=y.shortcutsExternalEngineData;b==="addOrUpdateConversation"&&t(v[0])}if(y.shortcutsExternalEngineType==="shortcutsExternalEngineChatMessageService"){let{functionName:b,params:v}=y.shortcutsExternalEngineData;if(b==="addMessages"){let S=v[1].map(O=>O.messageId),M=await Jn.getService().getMessagesByMessageIds(h,S),P=M.find(O=>zi(O)&&O.meta.paywallData||Qn(O)&&O.originalMessage?.metadata?.embeddedPaywall);if(P&&zi(P)){let O=P.meta.paywallData;l({conversationId:h,paywallType:"response",paywallData:O}),Ur.flush(),c(h,null)}P&&Qn(P)&&(l({conversationId:h,paywallType:"response",paywallReason:"ProChat"}),Ur.flush()),o(h,M),await n(h),t(h)}else if(b==="updateMessages"){let S=v[1].map(P=>P.messageId),M=await Jn.getService().getMessagesByMessageIds(h,S);r(h,M),await n(h),t(h)}else if(b==="deleteMessages"){let S=v[1];i(h,S),await n(h),t(h)}}}(C==="afterRunAction"&&(y.currentAction?.type==="ASK_CHATGPT"||y.currentAction?.type==="MAXAI_RESPONSE_RELATED")&&y.currentAction?.status==="complete"||y.shortcutsEngine?.status==="stop")&&m()};lw.set(h,x),_.addListener(x)})},[a]);let{refreshChatAIModelSelector:d,refreshChatHubAIModelSelector:f}=gl();(0,yo.useEffect)(()=>{d(),f()},[d,f])},pw=(0,yo.memo)(WN);var an=I(E());var jN=()=>(Nu(),Ku("floatingMenu"),an.default.createElement(an.default.Fragment,null,an.default.createElement(qN,null))),qN=()=>{let{conversationType:e,setConversationIds:t,setConversationType:o}=he(C=>({conversationType:C.conversationType,setConversationIds:C.setConversationIds,setConversationType:C.setConversationType})),{appSettings:n}=Un(),{betaSettings:r}=Wo(),{getLocalSettings:i,setLocalSettings:a}=tt(),{refreshModelUsageOnce:s}=_u(),[l,p]=li(ly),{createConversation:c,updateConversation:u,getConversation:m}=ot(),[d]=li(qr),f=Uo(l),h=(0,an.useRef)(f);h.current=f,(0,an.useEffect)(()=>{n.userSettings&&(r?.appearance_v2_enabled?o("Chat"):o("ContextMenu"))},[n.userSettings,r?.appearance_v2_enabled]),(0,an.useEffect)(()=>{l&&t([l])},[l]),(0,an.useEffect)(()=>{d.open?(e==="Chat"&&nm("Chat").then(C=>{let y=C[0];h.current&&y&&h.current.meta.AIModel!==y.value&&u(h.current.id,{meta:{AIProvider:y.AIProvider,AIModel:y.value,maxTokens:y.maxTokens}},{syncToRemote:!1})}),s()):c(e,{reason:"initCreate",conversation:{meta:{isContextMenu:!0}}}).then(C=>{p(C[0]?.id||"")}).catch()},[e,d.open]),nl(async()=>{if(l){let{sidebarSettings:C}=await i(),y=C?.contextMenu?.currentAIModel,b=await m(l);if(y&&b?.type==="ContextMenu"&&b?.meta.AIModel!==y){let v=Vo(void 0,y);v&&await u(l,{meta:{AIProvider:v.AIProvider,AIModel:v.value,maxTokens:v.maxTokens}},{syncToRemote:!1})}}});let _=(0,an.useCallback)(async C=>{let{sidebarSettings:y}=await i();if(C.type==="ContextMenu"){let b=y?.contextMenu?.currentAIModel;if(b){let v=Vo(void 0,b);if(v)return{...C,meta:{...C.meta,AIProvider:v.AIProvider,AIModel:v.value,maxTokens:v.maxTokens}}}}return C},[i]),x=(0,an.useCallback)(C=>{a({sidebarSettings:{contextMenu:{currentAIModel:C.meta.AIModel}}})},[a]);return an.default.createElement(an.default.Fragment,null,an.default.createElement(pw,{onCreateConversation:_,onUpdateConversation:x}),d.open&&an.default.createElement(xb,null))},cw=jN;var KN=()=>(Cy(),Sn.default.createElement(I_,{containerId:tx,wrapperId:ox},({rootContainer:e})=>Sn.default.createElement(Kx,{shadowRootElement:e},Sn.default.createElement(r_,{conversationType:"ContextMenu"},Sn.default.createElement(cw,null),Sn.default.createElement(iT,{variant:"custom",disableFileDrag:!0},Sn.default.createElement(AC,null,Sn.default.createElement(ka,{defaultContextMenuPath:"/rewrite"},Sn.default.createElement(GT,{root:e}),Sn.default.createElement(nw,null)),Sn.default.createElement($T,null),Sn.default.createElement(YT,null),Sn.default.createElement(sw,null),Sn.default.createElement(aT,null))))))),uw=(0,Sn.memo)(KN);var w1=I(E());var hw=I(E());var $N={inviteLink:e=>(document.querySelector("#appMaxAIReferralShareOneClickText")?.innerText||"").trim()||`Sign up on MaxAI using my link and both of us will get a free week of MaxAI Pro rewards. It lets you use AI on any webpage with one click, powered by ChatGPT, Claude, Bard, and Bing AI. Here is my link: https://app.maxai.me?invite=${e}`},Ns=$N;var K0=I(mw()),dw=I(ex());var Sp=async(e,t,o="",n)=>{let r=await xu.getUserInfo(),i=r?.user_id||"",a=r?.email||"",{getBrowser:s,getOS:l}=new K0.UAParser,p=s(),c=l(),u={env:Hi?"prod":"dev",type:e,app:"MAXAI",data:{title:t,message:o,...n},user_id:i,email:a,app_version:$x,browser:p.name,browser_version:p.version,platform:c.name,platform_version:c.version,languages:navigator.languages},m=Cx(u,"MaxAI");return by("https://api.extensions-hub.com/extensionhub/send_notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:m})}).then().catch()},fw=async()=>{let{getBrowser:e,getOS:t}=new K0.UAParser;await dw.default.storage.local.set({MAXAI_BROWSER_INFO:JSON.stringify({browser:e(),os:t()})})};var XN=()=>{let{userInfo:e}=_t(),{conversationId:t}=ie(),{createConversation:o}=ot(),{askAIWithShortcuts:n}=ke(),r=fe(t);return{autoFacebookReferral:(0,hw.useCallback)(async()=>{if(!r){let a=Ns.inviteLink(e?.referral_code||""),s=(u,m)=>{let d=m.currentAction;if(u==="afterRunAction"&&d?.type==="SET_VARIABLE"&&d.parameters?.VariableKey==="AutoTwitterReferralResult"){let f=d.parameters.WFFormValues?.Value===!0;Sp("REFERRAL",`[Referral] One-click button [Facebook] ${f?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:f},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),f&&Pl("/user/complete_referral",{referral_types:["FACEBOOK_SHARE"]}).then()}},p=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,c=Gr.getShortcutsEngine(p);return c?.addListener(s),await n([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/sharer/sharer.php?u=https://app.maxai.me"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["textarea[title]"],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:Ns.inviteLink(e?.referral_code||"")},beforeDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[name="__CONFIRM__"]'],actionType:"click",afterDelay:3e3}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.facebook.com/profile.php"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-ad-preview="message"]','div[data-ad-comet-preview="message"]'],executeElementCount:10,actionType:"getText",beforeDelay:2e3}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:p}),c?.removeListener(s),!0}return!1},[r,n,e?.referral_code,e?.email]),autoFacebookReferralLoading:r}},gw=XN;var xw=I(E());var YN=()=>{let{userInfo:e}=_t(),{conversationId:t}=ie(),{createConversation:o}=ot(),{askAIWithShortcuts:n}=ke(),r=fe(t);return{autoLinkedinReferral:(0,xw.useCallback)(async()=>{if(!r){let a=Ns.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;Sp("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&Pl("/user/complete_referral",{referral_types:["LINKEDIN_SHARE"]})}}},c=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,u=Gr.getShortcutsEngine(c);return u?.addListener(l),await n([{type:"OPEN_URLS",parameters:{URLActionURL:"https://www.linkedin.com/shareArticle/?url=https%3A%2F%2Fapp.maxai.me%3Finvite%3DIPn7Xnby"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.artdeco-button"],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[contenteditable="true"]'],actionType:"insertText",actionExtraData:{clearBeforeInsertText:!0,text:a},afterDelay:1e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["button.share-actions__primary-action"],actionType:"click",afterDelay:3e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__view-btn"],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:["a.inshare-success-state__continue-btn"],actionType:"getText"}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:"linkedin",WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:c}),u?.removeListener(l),!0}return!1},[n,r,e?.referral_code,e?.email]),autoLinkedinReferralLoading:r}},_w=YN;var Cw=I(E());var ZN=()=>{let{userInfo:e}=_t(),{conversationId:t}=ie(),{createConversation:o}=ot(),{askAIWithShortcuts:n}=ke(),r=fe(t);return{autoTwitterReferral:(0,Cw.useCallback)(async()=>{if(!r){let a=Ns.inviteLink(e?.referral_code||""),s="",l=(m,d)=>{let f=d?.currentAction;if(m==="afterRunAction"&&f?.type==="SET_VARIABLE"){if(f.parameters?.VariableKey==="SHARE_POST_LINK")s=f.output;else if(f.parameters?.VariableKey==="AutoTwitterReferralResult"){let h=f.parameters.WFFormValues?.Value===!0;Sp("REFERRAL",`[Referral] One-click button [Linkedin] ${h?"Success":"Fail"}`,JSON.stringify({email:e?.email||"unknown",success:h,shareLink:`[ ${s} ]`},null,4),{uuid:"608156c7-e65d-4a69-a055-6c10a6ba7217"}).then().catch(),h&&Pl("/user/complete_referral",{referral_types:["TWITTER_SHARE"]})}}},c=(await o("Chat",{reason:"manualClick",syncToRemote:!1}))[0].id,u=Gr.getShortcutsEngine(c);return u?.addListener(l),await n([{type:"OPEN_URLS",parameters:{URLActionURL:`https://twitter.com/intent/tweet?text=${a}`}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['button[data-testid="tweetButton"]'],actionType:"click",beforeDelay:2e3,afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['a[data-testid="AppTabBar_Profile_Link"]'],actionType:"click",afterDelay:2e3}}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['article[data-testid="tweet"] div[data-testid="User-Name"] a[role="link"]'],actionType:"getLink"}}},{type:"SET_VARIABLE",parameters:{VariableKey:"SHARE_POST_LINK"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['div[data-testid="tweetText"]'],actionType:"getText",executeElementCount:10}}},{type:"SCRIPTS_CONDITIONAL",parameters:{WFCondition:"Contains",WFMatchTextCaseSensitive:!1,WFFormValues:{Value:a.slice(0,10),WFSerializationType:"WFDictionaryFieldValue"},WFConditionalIfTrueActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!0,WFSerializationType:"WFDictionaryFieldValue"}}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"https://twitter.com/MaxAI_HQ"}},{type:"SET_VARIABLE",parameters:{VariableKey:"OperationElementTabID"}},{type:"OPERATION_ELEMENT",parameters:{OperationElementConfig:{elementSelectors:['[data-testid="1667007582270296064-follow"]'],actionType:"click",beforeDelay:2e3,afterDelay:3e3}}}],WFConditionalIfFalseActions:[{type:"SET_VARIABLE",parameters:{VariableKey:"AutoTwitterReferralResult",WFFormValues:{Value:!1,WFSerializationType:"WFDictionaryFieldValue"}}}]}},{type:"CLOSE_URLS",parameters:{}},{type:"OPEN_URLS",parameters:{URLActionURL:"current_page"}}],{conversationId:c,isSaveLastRunShortcuts:!1}),u?.removeListener(l),!0}return!1},[r,n,e?.referral_code,e?.email]),autoTwitterReferralLoading:r}},yw=ZN;var QN=()=>{let{autoTwitterReferral:e}=yw(),{autoFacebookReferral:t}=gw(),{autoLinkedinReferral:o}=_w(),n=(0,w1.useRef)({});(0,w1.useEffect)(()=>{n.current={twitter:e,linkedin:o,facebook:t}},[e,o,t]),wn(()=>{Nn&&location.href.includes(Nn)&&setInterval(()=>{let i=document.querySelector("#appMaxAIReferralShareOneClickContainer"),a=document.querySelector("#appMaxAIReferralShareOneClickButton");if(i&&a){if(!i.classList.contains("loaded"))i.classList.add("loaded");else return;a.addEventListener("click",async()=>{let s=Array.from(document.querySelectorAll('.app-maxai-me__one-click-share-status-card[data-checked="true"]'));for(let c=0;c<s.length;c++){let m=s[c].getAttribute("data-name"),d=n.current?.[m];d&&await d()}await as(3e3);let l=new URL(window.location.href),p=new URLSearchParams(l.search);p.set("show_completed","true"),l.search=p.toString(),window.location.href=l.toString()})}},1e3)})},bw=QN;var $0=I(ex());var Iw=async(e,t)=>{let{rootElementSelector:o,isShadowElement:n=!1,elementSelectors:r,beforeDelay:i=0,afterDelay:a=0,executeElementCount:s=1,durationTimes:l=30*1e3,rotationTimes:p=3e3,rotationInterval:c=1e3,actionType:u="click",actionExtraData:m}=t||{},d={success:!1,elementsInnerText:"",link:""},f=document,h=o?f.querySelector(o):f;if(n&&(h=h.shadowRoot),!r||r?.length===0||!h){$0.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,success:d.success,data:d}});return}if(h){let _=async()=>{await as(i);let x=[],C=0;for(;x.length===0&&C<p;)x=T_(...r.map(y=>Array.from(h.querySelectorAll(y)))),x.length===0&&(C+=c,await as(c));return x.length===0||(x=x.slice(0,s),x.forEach(y=>{switch(u){case"click":y.click();break;case"insertText":{let b=m?.text||m?.value.toString()||"";if(y.focus(),y.getAttribute("contenteditable")==="true"){let v=window.getSelection(),S=document.createRange();S.selectNodeContents(y),v?.removeAllRanges(),v?.addRange(S)}m?.clearBeforeInsertText&&(y.tagName==="INPUT"||y.tagName==="TEXTAREA")&&(y.select(),f.execCommand("Delete",!1,"")),f.execCommand("insertText",!1,b)}break;case"getText":{let b=y?.innerText||"";d.elementsInnerText+=b}break;case"getLink":y.tagName==="A"?(d.link&&(d.link+=","),d.link+=y.href):y.tagName==="IMG"||y.tagName==="VIDEO"||y.tagName==="IFRAME"||y.tagName==="EMBED"||y.tagName==="SOURCE"||y.tagName==="TRACK"?(d.link&&(d.link+=","),d.link+=y.src):(d.link&&(d.link+=","),d.link+=y?.innerText||"");break;default:break}}),d.success=!0,await as(a)),d};await Promise.race([_(),as(l)]),$0.default.runtime.sendMessage({event:"ShortCuts_OperationPageElementResponse",data:{taskId:e,data:{success:d.success,message:d.success?"ok":"error",data:d}}})}};var Sw=()=>{hm(async(e,t,o)=>{switch(e){case"ShortCuts_ClientExecuteOperationPageElement":{let{taskId:n,OperationElementConfig:r}=t;return n?(await Iw(n,r),{success:!0,data:!0,message:"ok"}):{success:!1,message:"No taskId",data:null}}break;default:break}})};var M1=I(E());var vw=la({key:"HaveFilledOutSurveyAtom",default:{feedback:!1}}),Tw=la({key:"firstFetchSurveyStatusLoadedAtom",default:!1}),ANe=la({key:"FunnelSurveyPopupOpenStateAtom",default:{}}),PNe=la({key:"FunnelSurveyPopupOpenTimerAtom",default:{}});var JN=()=>{let e=bo(vw),t=bo(Tw),{isLogin:o}=pn(),n=(0,M1.useRef)(!1),r=async(i=!1)=>{let a=await Sy(i);a&&Object.keys(a).length>0&&e(s=>({...s,...a}))};return(0,M1.useEffect)(()=>{n.current||o&&vy().then(i=>{r(!i).then(()=>{t(!0),n.current=!0})})},[o]),bl(async(i,a)=>{if(n.current&&i==="Client_listenSurveyStatusUpdated"){let s=a;return e(l=>({...l,...s})),{success:!0,message:"ok",data:{}}}}),null},ww=JN;var ez=Tn(()=>{if(va()==="youtube.com"){Ea()&&(document.body.style.position=""),document.documentElement.style.position==="relative"&&(document.documentElement.style.position="unset",document.querySelector(`#${k1}`)?.classList.replace("open","close"));let t=document.querySelector(`#${L1}`);t&&(t.style.display="none")}},100),tz=Tn(()=>{if(va()==="youtube.com"){document.documentElement.style.position==="unset"&&(document.documentElement.style.position="relative",document.querySelector(`#${k1}`)?.classList.replace("close","open")),Ea()&&(document.body.style.position="relative");let t=document.querySelector(`#${L1}`);t&&(t.style.display=""),setTimeout(()=>{window.dispatchEvent(new Event("resize"))},300)}},100),oz=()=>{let e=va();wn(()=>{if(e==="youtube.com"){let t=new MutationObserver(n=>{n.forEach(r=>{r.target&&(r.target.hasAttribute("scrolling")?ez():tz())})}),o=document.querySelector("ytd-app");o&&t.observe(o,{attributes:!0,childList:!1,subtree:!1})}})},Mw=oz;var vp=I(E());var nz=({children:e,...t})=>{let o=vp.default.useRef(null);return vp.default.createElement(c2,{maxSnack:3,preventDuplicate:!0,hideIconVariant:!0,autoHideDuration:3e3,ref:o,anchorOrigin:{vertical:"bottom",horizontal:"left"},action:n=>vp.default.createElement("svg",{focusable:"false","aria-hidden":"true",viewBox:"0 0 24 24",style:{width:"1em",height:"1em",display:"inline-block",fill:"currentcolor",fontSize:18,cursor:"pointer"},onClick:()=>{if(o?.current){let r=o?.current;r.closeSnackbar&&r.closeSnackbar(n)}}},vp.default.createElement("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),...t},vp.default.createElement(u2,null),e)},Ew=nz;var Tp=I(E()),Aw=I(Dw());var rz="MAXAI_SNACKBAR_CONTAINER";var iz=()=>Tp.default.createElement(Ew,{classes:{containerRoot:"maxai-snackbar-container-root"}},Tp.default.createElement("span",null)),Pw=()=>{let e=document.createElement("div");e.id=rz,e.style.zIndex="21474836470",e.style.color="#fff",e.style.position="absolute",document.body.appendChild(e),(0,Aw.createRoot)(e).render(Tp.default.createElement(Tp.default.StrictMode,null,Tp.default.createElement(iz,null)))};var az=new Bu("AppInit"),sz=()=>window.location.host==="www.usechatgpt.ai"||window.location.host==="www.maxai.me"||window.location.host==="www.maxai.co"||window.location.host==="app.maxai.me"?sn.default.createElement(de,{onClick:()=>{ya({key:"shortcuts"})},id:"usechatgpt-www-to-shortcuts",sx:{position:"absolute",width:1,height:1,zIndex:-1,opacity:0}}):sn.default.createElement(sn.default.Fragment,null),lz=()=>{let{setAppSettingsState:e}=Un(),{getLocalSettings:t}=tt(),{isLogin:o}=pn();return yy(),(0,sn.useEffect)(()=>{let n=async()=>{let r=await th();r&&(e({...r}),az.info(" get appSettings",r)),t()};return n(),window.addEventListener("focus",n),()=>{window.removeEventListener("focus",n)}},[]),(0,sn.useEffect)(()=>{o&&setTimeout(()=>{th().then(n=>{n&&e({...n})})},1e3)},[o]),sn.default.createElement(sn.default.Fragment,null)},pz=()=>{let{syncUserInfo:e}=_t(),{fetchPlanPricing:t}=zu(!0);return wn(()=>{if(e().then(),String(Nn).includes(va())){let o=window.location.pathname;["/account/your-plan/","/pricing/","/account/get-started/","/payment/error/","/payment/success/"].includes(o)&&setTimeout(()=>{e(!0).then().catch()},500),["/account/your-plan/","/pricing/"].includes(o)&&setTimeout(()=>{t().then()},500)}}),null},cz=()=>{let e=bo(Yx),t=bo(Xx),{syncUserInfo:o,setUserInfo:n}=_t();return bl(async(r,i)=>{if(r==="Client_AuthMaxAITokenComplete"){if(i?.hasToken){let a=await ma.getAuthTokens(),l=!(a?.refreshToken?ma.isTokenExpired(a.refreshToken):!0)&&!!a;a&&l?(o(),t(p=>p.isLogin===l?p:{...p,isLogin:l,authTokens:a})):t(p=>p.isLogin===l?p:{...p,isLogin:!1,authTokens:null})}else t(a=>({...a,isLogin:!1,authTokens:null}));return e(!0),n(a=>({...a,user:null})),{success:!0,message:"ok",data:{}}}}),null},uz=()=>{Mw(),W2(),Iy(),x2(!1),g2(!1),tl(),cz(),y6(),q2(),wn(()=>{Rp()&&Vi(),Pw(),Sw(),fw().then().catch(),_6()}),bw(),ww(),bb(),Ku(),Z2(),Nu(),_b(),wC(),VC(),vC();let e=Rp();return sn.default.createElement(sn.default.Fragment,null,sn.default.createElement(pz,null),!e&&sn.default.createElement(uw,null),sn.default.createElement(lz,null),sn.default.createElement(sz,null),sn.default.createElement(S_,null),sn.default.createElement(v_,null))},Vze=uz;export{Ty as a,ka as b,Fm as c,Zy as d,cb as e,xb as f,_b as g,eM as h,GA as i,j$ as j,ag as k,Ql as l,a9 as m,l9 as n,g9 as o,Ov as p,Gc as q,iT as r,DEe as s,uT as t,pw as u,mw as v,Sp as w,vw as x,Tw as y,Pw as z,lz as A,Vze as B};
/*! Bundled license information:

chnl/dist/channel.cjs.js:
  (* chnl v1.2.0 by Vitaliy Potapov @preserve *)
*/

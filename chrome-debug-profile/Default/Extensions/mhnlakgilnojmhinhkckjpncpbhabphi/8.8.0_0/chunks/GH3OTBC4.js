import{p as d}from"./2KV3QHEC.js";import{i as o,n as m,o as p}from"./ONVH27HX.js";import{a as T}from"./4B6UFNBQ.js";import{a as W}from"./PJ57C2TE.js";import{f as u}from"./GAV6HCJA.js";var I=u(T());var S=u(W()),A="SEARCH_WITH_AI_STORAGE_KEY",c="SEARCH_WITH_AI_STORAGE_KEY_V2",a={aiProvider:"USE_CHAT_GPT_PLUS",enable:!0,triggerMode:"manual",webAccessPrompt:!0,arkoseToken:"",chatRequirementsToken:"",proofToken:""},s=async()=>{let e=await S.default.storage.local.get(c);if(e[c])return e[c];{let t=await S.default.storage.local.get(A);return t[A]?{...t[A],triggerMode:a.triggerMode,aiProvider:a.aiProvider}:a}},g=async e=>{let t=await s()||a;await S.default.storage.local.set({[c]:{...t,...e}})};var y=o({key:"SearchWithAISearchResultsState",default:{loading:!1,searchResults:[]}}),P=o({key:"SearchWithAISourceCitationsState",default:[]}),h=o({key:"SearchWithAISettingsAtom",default:{loaded:!1,...a}}),H=o({key:"AutoTriggerAskEnableAtom",default:!0}),b=o({key:"SearchWithAIProviderLoadingAtom",default:!1}),M=o({key:"SearchWithAIConversationAtom",default:{conversationId:"",loading:!1,writingMessage:"",completedMessage:"",errorMessage:""}});var _=()=>{let e=p(h),t=(0,I.useRef)(!0);return(0,I.useEffect)(()=>{let n=async()=>{let r=await s();r&&(t.current?(e({...r,loaded:!0}),t.current=!1):e(i=>({...i,...r})))};return n(),window.addEventListener("focus",n),()=>{window.removeEventListener("focus",n)}},[]),d("pageSearchWithAI"),null},N=_;var E=()=>{let[e,t]=m(h);return{searchWithAISettings:e,setSearchWithAISettings:async r=>{try{if(r instanceof Function){let i=await s(),l=r(i);t(f=>({...f,...l})),await g(l)}else t(i=>({...i,...r})),await g(r);return!0}catch{return!1}}}},U=E;export{s as a,y as b,P as c,H as d,b as e,M as f,N as g,U as h};

import{a as d}from"./4VYUSQN4.js";import{i as l}from"./JVSFDP7Y.js";import{n as h}from"./RHEDGG6N.js";import{a as b}from"./PJ57C2TE.js";import{f as w}from"./GAV6HCJA.js";var u=(o,e="")=>{let t=o,s=e;if(t.startsWith("data:")){let[n,c]=t.split(",");s||(s=n.split(";")[0].split(":")[1]),t=c}let r=atob(t),a=[];for(let n=0;n<r.length;n+=512){let c=r.slice(n,n+512),p=new Array(c.length);for(let i=0;i<c.length;i++)p[i]=c.charCodeAt(i);let m=new Uint8Array(p);a.push(m)}return new Blob(a,{type:s})};var F=(o,e)=>new File([o],e,{type:o.type});var y=w(b()),f="x_fid",P=()=>new Promise(o=>{o("")}),g=async()=>{let e=(await y.default.storage.local.get(f))[f];return e?e.replace(/"/g,""):await P()};var A=async(o,e,t)=>{try{e||(e={}),e.method||(e.method="GET");let s=new d,r=await s.postMessage({event:"Client_proxyFetchAPI",data:{url:o,options:e,abortTaskId:t}});if(e.method==="GET"&&r.data.redirected&&r?.data?.response?.url){let a=await s.postMessage({event:"Client_proxyFetchAPI",data:{url:r?.data?.response?.url,options:e,abortTaskId:t}});r.data.data=a?.data?.data,r.data.response=a?.data?.response}return e?.parse==="blob"&&r?.data?.data?.base64&&(r.data.data=u(r.data.data.base64,e?.blobContentType||r.data.data.contentType)),{success:r.success,data:r?.data?.data,responseRaw:r?.data?.response,message:r.message,error:""}}catch(s){return{success:!1,data:null,error:s?.message||s,responseRaw:null,message:""}}},x=async o=>{try{let t=await new d().postMessage({event:"Client_abortProxyFetchAPI",data:{abortTaskId:o}});return{success:t.success,data:t.data,error:t.message}}catch(e){return{success:!1,data:null,error:e?.message||e}}},T=async(o,e,t={})=>{try{let s=new d,r=await g(),a=await h.getAccessToken();t.body=JSON.stringify(e),t.headers||(t.headers={"Content-Type":"application/json",Authorization:`Bearer ${a}`,fp:`${r}`}),t.method||(t.method="POST"),l&&!o.startsWith(l)&&(o=l+o);let n=await s.postMessage({event:"Client_proxyFetchAPI",data:{url:o,options:t,abortTaskId:t.abortTaskId}});return{success:n.success,responseRaw:n?.data?.response,data:n?.data?.data,message:n.message,error:""}}catch(s){return{success:!1,responseRaw:null,data:null,error:s?.message||s,message:""}}};export{F as a,A as b,x as c,T as d};
